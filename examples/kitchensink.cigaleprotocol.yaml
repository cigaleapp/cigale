# yaml-language-server: $schema=../static/protocol.schema.json
id: io.github.cigaleapp.kitchensink
name: Kitchen sink
description: Made to demo all of the available data types and features that are supported by CIGALE protocols.
authors:
  - name: Gwenn Le Bihan

sessionMetadata:
  transect_date:
    type: date
    label: Date du transect
    mergeMethod: average
    required: true
    description: feur
    default: '{{ session.createdAt }}'

  transect_code:
    label: Code du transect
    mergeMethod: none
    required: true
    type: string
    pattern: year month day hours minutes then uppercase letter minimum 2 times
    description: |
      Le code du transect est composé de la date, de l'heure, et de vos initiales. Par exemple, un transect réalisé par Martin Galli le 07/12/2023 à 14h50 s'écrira : 202312071450MG
    default: |
      {{#with (metadata session "transect_date")}}
        {{ year . }}{{ month . }}{{ day . }}{{ hour . }}{{ minute . }}AB
      {{/with}}

  ohio_respect:
    label: ohio respect
    mergeMethod: average
    required: false
    type: float
    description: '*watches*'
    range: 0..10
    default: 6.7

  has_no_default:
    label: has no default
    mergeMethod: average
    required: false
    type: float
    description: 'This metadata has no default value, so it will be undefined if not set'

  sessionwide_file:
    label: sessionwide file
    mergeMethod: none
    required: false
    type: file
    description: 'A file that is accessible from all snippets in the session'
    size:
      minimum: 1 ko
      maximum: 1.2 Mo
    accept: [.jpeg, .jpg, .png, image/tiff, video/*]

metadata:
  crop:
    type: boundingbox
    description: ''
    label: 'crop'
    mergeMethod: union
    required: false

  bool:
    description: boolean metadata
    label: bool
    mergeMethod: average
    required: false
    type: boolean

  date:
    description: date metadata
    label: date
    mergeMethod: average
    required: false
    type: date
    range: future

  enum:
    description: enum metadata
    label: enum
    mergeMethod: average
    required: false
    type: enum
    options:
      - description: Option 1
        key: one
        label: One
      - description: Option 2
        key: two
        label: Two

  float:
    description: float metadata
    label: float
    mergeMethod: average
    required: false
    type: float

  integer:
    description: integer metadata
    label: integer
    mergeMethod: average
    required: false
    type: integer
    range: <= 100

  string:
    description: string metadata
    label: string
    mergeMethod: average
    required: false
    type: string
    regex: ^ohio (understandment|respect).*$

  location:
    description: location metadata
    label: location
    mergeMethod: average
    required: false
    type: location

  sidecar:
    description: sidecar file
    label: sidecar
    mergeMethod: none
    required: false
    type: file
    accept: [application/json, application/yaml]

crop:
  padding: 0px

exports:
  images:
    cropped: image-{{ sequence }}.cropped.{{ extension image.filename }}
    original: image-{{ sequence }}.{{ extension image.filename }}
  metadata:
    csv: metadata.csv
    json: analysis.json
    files: file-{{ metadataKey }}-{{ filename }}
