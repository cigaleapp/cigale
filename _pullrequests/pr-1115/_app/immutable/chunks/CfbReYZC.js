import"./DsnmJJEf.js";import{f as v,a as _,p as M,b as S,g as t,u as s}from"./Dt6m180S.js";import{a as b,b as P}from"./CoW7fDOc.js";import{r as w,p as y}from"./cmrSGx3m.js";import{o as j,i as C,t as p,p as L}from"./h9n_zjAt.js";import{M as U}from"./Cht11lhj.js";import{g as A,s as O}from"./JZH0u_ZA.js";import{t as R}from"./DM93I2Od.js";var T=v('<svg><path fill="currentColor" d="M13 14h-2a9 9 0 0 0-7.968 4.81A10 10 0 0 1 3 18C3 12.477 7.477 8 13 8V2.5L23.5 11L13 19.5zm-2-2h4v3.308L20.321 11L15 6.692V10h-2a7.98 7.98 0 0 0-6.057 2.774A11 11 0 0 1 11 12"></path></svg>');function N(c,o){const a=w(o,["$$slots","$$events","$$legacy"]);var r=T();b(r,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),_(c,r)}function W(c,o){M(o,!0);const a=s(()=>P("main"));let r=y(o,"open",15),e=s(()=>p.Protocol.getFromState(o.id));const f=s(()=>p.Session.state.filter(d=>d.protocol===o.id));{let d=s(()=>t(e)?.name),u=s(()=>[L(t(f).length,t(a).p(401),t(a)._.p)]);U(c,{button:null,key:"modal_delete_protocol",get typeToConfirm(){return t(d)},get consequences(){return t(u)},onconfirm:async()=>{await j(["Protocol","Metadata","MetadataOption"],{},async n=>{if(!t(e))return;n.objectStore("Protocol").delete(t(e).id);const g=t(e).metadata.filter(l=>t(e)&&C(t(e).id,l)),h=await n.objectStore("MetadataOption").getAll();for(const l of g)n.objectStore("Metadata").delete(l),h.filter(m=>m.id.startsWith(`${l}:`)).forEach(m=>n.objectStore("MetadataOption").delete(m.id))});const i=await A("autoUpdateProtocols");delete i[o.id],await O("autoUpdateProtocols",i),R.success(t(a)(133)),o.ondelete?.()},get open(){return r()},set open(i){r(i)}})}S()}export{W as M,N as S};
