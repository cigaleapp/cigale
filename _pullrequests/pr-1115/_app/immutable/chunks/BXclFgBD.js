import"./DsnmJJEf.js";import{a as Le,C as Be,c as Ie,s as te,d as qe,b as Ae}from"./CoW7fDOc.js";import{R as ae}from"./CH5FdpMr.js";import{f as Re,a as s,p as De,I as h,b as Me,g as t,u as m,ai as b,ak as d,K as l,H as A,D as P,F as R,G as re}from"./Dt6m180S.js";import{d as Pe,s as V}from"./BqMK6M8M.js";import{p as y,i as u,r as Oe}from"./cmrSGx3m.js";import{c as Ee}from"./BptB6vFW.js";import{e as Fe,i as Ge}from"./Bmx3KKup.js";import{a as se,t as oe}from"./C3lM_sxf.js";import{A as He}from"./Cyg8Xawz.js";import{D as Ke}from"./C0se_-sl.js";import{I as je}from"./nVGfHLWF.js";import"./69_IOA4Y.js";import{B as ie}from"./cTmsNnlM.js";import{C as le}from"./DzqEHu1p.js";import{C as Je}from"./i0qVP9iW.js";import{L as ne}from"./CJbDBvUJ.js";import{L as Ne}from"./DJljq93Y.js";import{O as Qe}from"./CMjWo4lL.js";var Ue=Re('<svg width="1.2em" height="1.2em" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 8L5.5 11.5L13 4" stroke="currentColor" stroke-linecap="round"></path></svg>');function Ve(O){var e=Ue();s(O,e)}var We=h('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Xe=h('<section class="errored-actions svelte-pa7bo1"><!> <!></section>'),Ye=h('<div class="loading-overlay svelte-pa7bo1"><!> <span class="text smol svelte-pa7bo1"><!></span> <!></div>'),Ze=h('<img class="svelte-pa7bo1"/>'),$e=h('<div class="img-placeholder svelte-pa7bo1"><!></div>'),et=h('<div data-testid="card-observation-bounding-box" class="bb svelte-pa7bo1"></div>'),tt=h('<div class="inner svelte-pa7bo1"><!> <div><!> <!></div> <footer class="svelte-pa7bo1"><div class="check-icon svelte-pa7bo1"><!></div> <h2 class="svelte-pa7bo1"><!></h2> <button class="stack-count svelte-pa7bo1"> </button></footer></div>'),at=h('<div class="stack-background-card svelte-pa7bo1"><!></div>'),rt=h('<article><div class="main-card svelte-pa7bo1"><!></div> <!></article>');function Ct(O,e){De(e,!0);let ve=y(e,"selected",3,!1),W=y(e,"selectable",3,!0),c=y(e,"status",7),E=y(e,"loadingStatusText",7),F=y(e,"stacksize",3,1),G=y(e,"boundingBoxes",19,()=>[]),de=Oe(e,["$$slots","$$events","$$legacy","onclick","onstacksizeclick","ondelete","onretry","title","image","selected","selectable","highlighted","status","statusText","loadingStatusText","stacksize","boundingBoxes","boxes","tooltip","id"]);const X=m(()=>F()>1),D=m(()=>c()==="loading"||c()==="queued"),ce=m(()=>c()==="errored"),S=m(()=>Ae("main")),ue=m(()=>c()==="loading"?t(S)(57):c()==="queued"?t(S)(83):c()==="errored"?t(S)(85):"");var T=rt();Le(T,()=>({class:"observation","data-selectable":W()?"":void 0,"data-id":e.id,"aria-label":e.title,...de,[Be]:{selected:ve(),selectable:W(),highlighted:e.highlighted,loading:t(D),stacked:t(X)}}),void 0,void 0,void 0,"svelte-pa7bo1");var H=d(T),_e=d(H);le(_e,{tag:"div",onclick:f=>{t(D)||t(ce)||f instanceof MouseEvent&&e.onclick?.(f,_=>{_.status&&c(_.status),_.loadingStatusText&&E(_.loadingStatusText)})},children:(f,_)=>{var z=tt(),Y=d(z);{var me=a=>{var o=Ye(),x=d(o);{var B=r=>{var i=We(),k=R(i);Ee(k,()=>({"--size":"1.5em"})),Ne(k.lastChild,{variant:"error"}),l(k),s(r,i)},p=r=>{var i=P(),k=R(i);{var J=w=>{ne(w,{})},N=w=>{var g=P(),C=R(g);{var v=q=>{ne(q,{waiting:!0})};u(C,q=>{c()==="queued"&&q(v)},!0)}s(w,g)};u(k,w=>{c()==="loading"?w(J):w(N,!1)},!0)}s(r,i)};u(x,r=>{c()==="errored"?r(B):r(p,!1)})}var n=b(x,2),I=d(n);{var ye=r=>{var i=re();A(()=>V(i,E())),s(r,i)},Se=r=>{var i=re();A(()=>V(i,e.statusText||t(ue))),s(r,i)};u(I,r=>{c()==="loading"&&E()?r(ye):r(Se,!1)})}l(n);var Te=b(n,2);{var ze=r=>{var i=Xe(),k=d(i);{var J=g=>{{const C=v=>{Ke(v,{})};ie(g,{dangerous:!0,onclick:v=>{v.stopPropagation(),e.ondelete()},_w_snippet_0:C,children:(v,q)=>{{let Q=m(()=>[C]),U=m(()=>t(S).c(15));ae(v,{get t(){return t(Q)},get x(){return t(U)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}};u(k,g=>{e.ondelete&&g(J)})}var N=b(k,2);{var w=g=>{{const C=v=>{He(v,{})};ie(g,{onclick:v=>{v.stopPropagation(),e.onretry()},_w_snippet_1:C,children:(v,q)=>{{let Q=m(()=>[C]),U=m(()=>t(S).c(14));ae(v,{get t(){return t(Q)},get x(){return t(U)}})}},$$slots:{_w_snippet_1:!0,default:!0}})}};u(N,g=>{!t(D)&&e.onretry&&g(w)})}l(i),s(r,i)};u(Te,r=>{(e.ondelete||e.onretry)&&r(ze)})}l(o),s(a,o)};u(Y,a=>{c()!=="ok"&&a(me)})}var M=b(Y,2);let Z;var $=d(M);{var be=a=>{var o=P(),x=R(o);{var B=n=>{Je(n,{blurfill:!0,get src(){return e.image},get alt(){return e.title},get box(){return G()[0]}})},p=n=>{var I=Ze();A(()=>{te(I,"src",e.image),te(I,"alt",e.title)}),s(n,I)};u(x,n=>{e.boxes==="apply-first"&&G().length>0?n(B):n(p,!1)})}s(a,o)},he=a=>{var o=$e(),x=d(o);je(x,{}),l(o),s(a,o)};u($,a=>{e.image?a(be):a(he,!1)})}var xe=b($,2);{var pe=a=>{var o=P(),x=R(o);Fe(x,17,G,Ge,(B,p)=>{var n=et();A(()=>qe(n,`left: ${t(p).x*100}%; top: ${t(p).y*80}%; width: ${t(p).width*100}%; height: ${80*t(p).height}%;`)),s(B,n)}),s(a,o)};u(xe,a=>{e.boxes==="show-all"&&a(pe)})}l(M);var ee=b(M,2),K=d(ee),ke=d(K);Ve(ke),l(K);var j=b(K,2),we=d(j);Qe(we,{get text(){return e.title}}),l(j);var L=b(j,2);L.__click=a=>{a.stopPropagation(),e.onstacksizeclick?.()};var Ce=d(L,!0);l(L),se(L,(a,o)=>oe?.(a,o),()=>`Cette observation regroupe ${F()} images. Cliquez pour les voir toutes.`),l(ee),l(z),A(()=>{Z=Ie(M,1,"boundingboxes-wrapper svelte-pa7bo1",null,Z,{"has-boxes":e.boxes==="show-all"}),L.disabled=t(D),V(Ce,F())}),s(f,z)},$$slots:{default:!0}}),l(H);var fe=b(H,2);{var ge=f=>{var _=at(),z=d(_);le(z,{tag:"div"}),l(_),s(f,_)};u(fe,f=>{t(X)&&f(ge)})}l(T),se(T,(f,_)=>oe?.(f,_),()=>e.tooltip),s(O,T),Me()}Pe(["click"]);export{Ct as C};
