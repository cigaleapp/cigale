import{an as nl}from"./Dt6m180S.js";import{i as il}from"./CoW7fDOc.js";import{_ as yi}from"./PPVm8Dsz.js";import{b as vo,k as jn,u as sl,e as ol,E as bi,F as al}from"./C0SiBqD8.js";class jr extends Error{constructor(e,r,n,i){super(e),this.name="DevalueError",this.path=r.join(""),this.value=n,this.root=i}}function vi(t){return Object(t)!==t}const ul=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ll(t){const e=Object.getPrototypeOf(t);return e===Object.prototype||e===null||Object.getPrototypeOf(e)===null||Object.getOwnPropertyNames(e).sort().join("\0")===ul}function cl(t){return Object.prototype.toString.call(t).slice(8,-1)}function dl(t){switch(t){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return t<" "?`\\u${t.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function Ce(t){let e="",r=0;const n=t.length;for(let i=0;i<n;i+=1){const s=t[i],a=dl(s);a&&(e+=t.slice(r,i)+a,r=i+1)}return`"${r===0?t:e+t.slice(r)}"`}function hl(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.getOwnPropertyDescriptor(t,e).enumerable)}const fl=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function xi(t){return fl.test(t)?"."+t:"["+JSON.stringify(t)+"]"}function pl(t){const e=new DataView(t);let r="";for(let n=0;n<t.byteLength;n++)r+=String.fromCharCode(e.getUint8(n));return yl(r)}function ml(t){const e=gl(t),r=new ArrayBuffer(e.length),n=new DataView(r);for(let i=0;i<r.byteLength;i++)n.setUint8(i,e.charCodeAt(i));return r}const xo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function gl(t){t.length%4===0&&(t=t.replace(/==?$/,""));let e="",r=0,n=0;for(let i=0;i<t.length;i++)r<<=6,r|=xo.indexOf(t[i]),n+=6,n===24&&(e+=String.fromCharCode((r&16711680)>>16),e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255),r=n=0);return n===12?(r>>=4,e+=String.fromCharCode(r)):n===18&&(r>>=2,e+=String.fromCharCode((r&65280)>>8),e+=String.fromCharCode(r&255)),e}function yl(t){let e="";for(let r=0;r<t.length;r+=3){const n=[void 0,void 0,void 0,void 0];n[0]=t.charCodeAt(r)>>2,n[1]=(t.charCodeAt(r)&3)<<4,t.length>r+1&&(n[1]|=t.charCodeAt(r+1)>>4,n[2]=(t.charCodeAt(r+1)&15)<<2),t.length>r+2&&(n[2]|=t.charCodeAt(r+2)>>6,n[3]=t.charCodeAt(r+2)&63);for(let i=0;i<n.length;i++)typeof n[i]>"u"?e+="=":e+=xo[n[i]]}return e}const Un=-1,wo=-2,ko=-3,So=-4,_o=-5,zn=-6;function bl(t,e){return vl(JSON.parse(t),e)}function vl(t,e){if(typeof t=="number")return s(t,!0);if(!Array.isArray(t)||t.length===0)throw new Error("Invalid input");const r=t,n=Array(r.length);let i=null;function s(a,l=!1){if(a===Un)return;if(a===ko)return NaN;if(a===So)return 1/0;if(a===_o)return-1/0;if(a===zn)return-0;if(l||typeof a!="number")throw new Error("Invalid input");if(a in n)return n[a];const h=r[a];if(!h||typeof h!="object")n[a]=h;else if(Array.isArray(h))if(typeof h[0]=="string"){const d=h[0],f=e&&Object.hasOwn(e,d)?e[d]:void 0;if(f){let p=h[1];if(typeof p!="number"&&(p=r.push(h[1])-1),i??=new Set,i.has(p))throw new Error("Invalid circular reference");return i.add(p),n[a]=f(s(p)),i.delete(p),n[a]}switch(d){case"Date":n[a]=new Date(h[1]);break;case"Set":const p=new Set;n[a]=p;for(let o=1;o<h.length;o+=1)p.add(s(h[o]));break;case"Map":const c=new Map;n[a]=c;for(let o=1;o<h.length;o+=2)c.set(s(h[o]),s(h[o+1]));break;case"RegExp":n[a]=new RegExp(h[1],h[2]);break;case"Object":n[a]=Object(h[1]);break;case"BigInt":n[a]=BigInt(h[1]);break;case"null":const u=Object.create(null);n[a]=u;for(let o=1;o<h.length;o+=2)u[h[o]]=s(h[o+1]);break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{if(r[h[1]][0]!=="ArrayBuffer")throw new Error("Invalid data");const o=globalThis[d],g=s(h[1]),m=new o(g);n[a]=h[2]!==void 0?m.subarray(h[2],h[3]):m;break}case"ArrayBuffer":{const o=h[1];if(typeof o!="string")throw new Error("Invalid ArrayBuffer encoding");const g=ml(o);n[a]=g;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":{const o=d.slice(9);n[a]=Temporal[o].from(h[1]);break}case"URL":{const o=new URL(h[1]);n[a]=o;break}case"URLSearchParams":{const o=new URLSearchParams(h[1]);n[a]=o;break}default:throw new Error(`Unknown type ${d}`)}}else{const d=new Array(h.length);n[a]=d;for(let f=0;f<h.length;f+=1){const p=h[f];p!==wo&&(d[f]=s(p))}}else{const d={};n[a]=d;for(const f in h){if(f==="__proto__")throw new Error("Cannot parse an object with a `__proto__` property");const p=h[f];d[f]=s(p)}}return n[a]}return s(0)}function xl(t,e){const r=[],n=new Map,i=[];if(e)for(const d of Object.getOwnPropertyNames(e))i.push({key:d,fn:e[d]});const s=[];let a=0;function l(d){if(d===void 0)return Un;if(Number.isNaN(d))return ko;if(d===1/0)return So;if(d===-1/0)return _o;if(d===0&&1/d<0)return zn;if(n.has(d))return n.get(d);const f=a++;n.set(d,f);for(const{key:c,fn:u}of i){const o=u(d);if(o)return r[f]=`["${c}",${l(o)}]`,f}if(typeof d=="function")throw new jr("Cannot stringify a function",s,d,t);let p="";if(vi(d))p=Ur(d);else{const c=cl(d);switch(c){case"Number":case"String":case"Boolean":p=`["Object",${Ur(d)}]`;break;case"BigInt":p=`["BigInt",${d}]`;break;case"Date":p=`["Date","${!isNaN(d.getDate())?d.toISOString():""}"]`;break;case"URL":p=`["URL",${Ce(d.toString())}]`;break;case"URLSearchParams":p=`["URLSearchParams",${Ce(d.toString())}]`;break;case"RegExp":const{source:o,flags:g}=d;p=g?`["RegExp",${Ce(o)},"${g}"]`:`["RegExp",${Ce(o)}]`;break;case"Array":p="[";for(let m=0;m<d.length;m+=1)m>0&&(p+=","),m in d?(s.push(`[${m}]`),p+=l(d[m]),s.pop()):p+=wo;p+="]";break;case"Set":p='["Set"';for(const m of d)p+=`,${l(m)}`;p+="]";break;case"Map":p='["Map"';for(const[m,b]of d)s.push(`.get(${vi(m)?Ur(m):"..."})`),p+=`,${l(m)},${l(b)}`,s.pop();p+="]";break;case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":{const m=d;p='["'+c+'",'+l(m.buffer);const b=d.byteOffset,v=b+d.byteLength;if(b>0||v!==m.buffer.byteLength){const w=+/(\d+)/.exec(c)[1]/8;p+=`,${b/w},${v/w}`}p+="]";break}case"ArrayBuffer":{p=`["ArrayBuffer","${pl(d)}"]`;break}case"Temporal.Duration":case"Temporal.Instant":case"Temporal.PlainDate":case"Temporal.PlainTime":case"Temporal.PlainDateTime":case"Temporal.PlainMonthDay":case"Temporal.PlainYearMonth":case"Temporal.ZonedDateTime":p=`["${c}",${Ce(d.toString())}]`;break;default:if(!ll(d))throw new jr("Cannot stringify arbitrary non-POJOs",s,d,t);if(hl(d).length>0)throw new jr("Cannot stringify POJOs with symbolic keys",s,d,t);if(Object.getPrototypeOf(d)===null){p='["null"';for(const m in d)s.push(xi(m)),p+=`,${Ce(m)},${l(d[m])}`,s.pop();p+="]"}else{p="{";let m=!1;for(const b in d)m&&(p+=","),m=!0,s.push(xi(b)),p+=`${Ce(b)}:${l(d[b])}`,s.pop();p+="}"}}}return r[f]=p,f}const h=l(t);return h<0?`${h}`:`[${r.join(",")}]`}function Ur(t){const e=typeof t;return e==="string"?Ce(t):t instanceof String?Ce(t.toString()):t===void 0?Un.toString():t===0&&1/t<0?zn.toString():e==="bigint"?`["BigInt","${t}"]`:String(t)}function wl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const dn=(t,e)=>e.some(r=>t instanceof r);let wi,ki;function kl(){return wi||(wi=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Sl(){return ki||(ki=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const hn=new WeakMap,zr=new WeakMap,Mr=new WeakMap;function _l(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(ze(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return Mr.set(e,t),e}function Pl(t){if(hn.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});hn.set(t,e)}let fn={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return hn.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ze(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Po(t){fn=t(fn)}function Il(t){return Sl().includes(t)?function(...e){return t.apply(pn(this),e),ze(this.request)}:function(...e){return ze(t.apply(pn(this),e))}}function Cl(t){return typeof t=="function"?Il(t):(t instanceof IDBTransaction&&Pl(t),dn(t,kl())?new Proxy(t,fn):t)}function ze(t){if(t instanceof IDBRequest)return _l(t);if(zr.has(t))return zr.get(t);const e=Cl(t);return e!==t&&(zr.set(t,e),Mr.set(e,t)),e}const pn=t=>Mr.get(t);function Ol(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(t,e),l=ze(a);return n&&a.addEventListener("upgradeneeded",h=>{n(ze(a.result),h.oldVersion,h.newVersion,ze(a.transaction),h)}),r&&a.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),l.then(h=>{s&&h.addEventListener("close",()=>s()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const Ml=["get","getKey","getAll","getAllKeys","count"],Al=["put","add","delete","clear"],Hr=new Map;function Si(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Hr.get(e))return Hr.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Al.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Ml.includes(r)))return;const s=async function(a,...l){const h=this.transaction(a,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),i&&h.done]))[0]};return Hr.set(e,s),s}Po(t=>({...t,get:(e,r,n)=>Si(e,r)||t.get(e,r,n),has:(e,r)=>!!Si(e,r)||t.has(e,r)}));const Nl=["continue","continuePrimaryKey","advance"],_i={},mn=new WeakMap,Io=new WeakMap,Dl={get(t,e){if(!Nl.includes(e))return t[e];let r=_i[e];return r||(r=_i[e]=function(...n){mn.set(this,Io.get(this)[e](...n))}),r}};async function*El(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const r=new Proxy(e,Dl);for(Io.set(r,e),Mr.set(r,pn(e));e;)yield r,e=await(mn.get(r)||e.continue()),mn.delete(r)}function Pi(t,e){return e===Symbol.asyncIterator&&dn(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&dn(t,[IDBIndex,IDBObjectStore])}Po(t=>({...t,get(e,r,n){return Pi(e,r)?El:t.get(e,r,n)},has(e,r){return Pi(e,r)||t.has(e,r)}}));const Ll="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Co=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Ll[r[t]&63];return e};const Ct=t=>Array.isArray(t)?t:[t],$l=(t,e)=>{const r=[[],[]];for(const n of t)e(n)?r[0].push(n):r[1].push(n);return r},Oo=Array,Oe=(t,e)=>t.includes(e),Rl=(t,e=0)=>[...new Array(t)].map((r,n)=>n+e),q=(t,e,r)=>t===void 0?e===void 0?[]:Array.isArray(e)?e:[e]:(Array.isArray(e)?t.push(...e):t.push(e),t),Ue=(t,e)=>e==null?t??[]:t==null?Ct(e):t.concat(e),Tl=(...t)=>t.reduce(Ue,[]),He=(t,e,r)=>{if(t===void 0)return Array.isArray(e)?e:[e];const n=r?.isEqual??((i,s)=>i===s);for(const i of Ct(e))t.some(s=>n(s,i))||t.push(i);return t},Bl=(t,e)=>t.reduce((r,n)=>{const i=n[e];return r[i]=q(r[i],n),r},{}),it=(t,e,r)=>t.length===e.length&&t.every(r?.isEqual?(n,i)=>r.isEqual(n,e[i]):(n,i)=>n===e[i]),We=(t,e)=>be(t)===e,be=t=>{const e=typeof t;return e==="object"?t===null?"null":"object":e==="function"?"object":e},Me={boolean:"boolean",null:"null",undefined:"undefined",bigint:"a bigint",number:"a number",object:"an object",string:"a string",symbol:"a symbol"},ql={...Me,function:"a function"};class Fl extends Error{}const Q=t=>st(t,Fl),st=(t,e=Error)=>{throw new e(t)};class Kl extends Error{name="ParseError"}const P=t=>st(t,Kl),Mo=t=>` ${t}`,jl="​",F=(t,e)=>{const r={},n=Array.isArray(t);let i=!1;for(const[s,a]of Object.entries(t).entries()){const l=n?e(s,a[1]):e(...a,s);i||=typeof l[0]=="number";const h=Array.isArray(l[0])||l.length===0?l:[l];for(const[d,f]of h)typeof d=="object"?r[d.group]=q(r[d.group],f):r[d]=f}return i?Object.values(r):r},Ao=Object.entries,_e=(t,e)=>t in e,Hn=(t,e)=>e in t;class Ul{constructor(e){Object.assign(this,e)}}const zl=class{};class No extends zl{}const Hl=(t,e)=>{const r={},n={};let i;for(i in t)i in e?r[i]=t[i]:n[i]=t[i];return[r,n]},Do=(t,e)=>Hl(t,e)[1],Ot=t=>Object.keys(t).length===0,gr=t=>[...Object.entries(t),...Object.getOwnPropertySymbols(t).map(e=>[e,t[e]])],Vl=(t,e)=>Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)),Gl=t=>{const e=Object.keys(t).sort(),r={};for(let n=0;n<e.length;n++)r[e[n]]=t[e[n]];return r},xe=Mo(`unset${jl}`),Wl=t=>Object.values(t).filter(e=>typeof e=="number"?!0:typeof t[e]!="number"),Eo={Array,Boolean,Date,Error,Function,Map,Number,Promise,RegExp,Set,String,WeakMap,WeakSet},Lo=globalThis.File??Blob,$o={ArrayBuffer,Blob,File:Lo,FormData,Headers,Request,Response,URL},Jl={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array},ot={...Eo,...$o,...Jl,String,Number,Boolean},Vn=t=>{let e=Object.getPrototypeOf(t);for(;e?.constructor&&(!_e(e.constructor.name,ot)||!(t instanceof ot[e.constructor.name]));)e=Object.getPrototypeOf(e);const r=e?.constructor?.name;if(!(r===void 0||r==="Object"))return r},gn=t=>typeof t=="object"&&t!==null?Vn(t)??"object":be(t),ne=Array.isArray,Yl={Array:"an array",Function:"a function",Date:"a Date",RegExp:"a RegExp",Error:"an Error",Map:"a Map",Set:"a Set",String:"a String object",Number:"a Number object",Boolean:"a Boolean object",Promise:"a Promise",WeakMap:"a WeakMap",WeakSet:"a WeakSet"},Ql={ArrayBuffer:"an ArrayBuffer instance",Blob:"a Blob instance",File:"a File instance",FormData:"a FormData instance",Headers:"a Headers instance",Request:"a Request instance",Response:"a Response instance",URL:"a URL instance"},Xl={Int8Array:"an Int8Array",Uint8Array:"a Uint8Array",Uint8ClampedArray:"a Uint8ClampedArray",Int16Array:"an Int16Array",Uint16Array:"a Uint16Array",Int32Array:"an Int32Array",Uint32Array:"a Uint32Array",Float32Array:"a Float32Array",Float64Array:"a Float64Array",BigInt64Array:"a BigInt64Array",BigUint64Array:"a BigUint64Array"},Zl={...Yl,...Ql,...Xl},Gn=t=>{const e=Object(t).name??null;return e&&_e(e,ot)&&ot[e]===t?e:null},Ii=(t,e)=>{let r=t.prototype;for(;r!==null;){if(r===e.prototype)return!0;r=Object.getPrototypeOf(r)}return!1},ec=t=>Ro(t,new Map),Ro=(t,e)=>{if(typeof t!="object"||t===null)return t;if(e?.has(t))return e.get(t);const r=Gn(t.constructor);if(r==="Date")return new Date(t.getTime());if(r&&r!=="Array")return t;const n=Array.isArray(t)?t.slice():Object.create(Object.getPrototypeOf(t)),i=Object.getOwnPropertyDescriptors(t);if(e){e.set(t,n);for(const s in i){const a=i[s];"get"in a||"set"in a||(a.value=Ro(a.value,e))}}return Object.defineProperties(n,i),n},tc=t=>{let e=xe;return()=>e===xe?e=t():e},Ar=t=>typeof t=="function"&&t.length===0,rc=class extends Function{constructor(...t){const e=t.slice(0,-1),r=t[t.length-1];try{super(...e,r)}catch(n){return Q(`Encountered an unexpected error while compiling your definition:
                Message: ${n} 
                Source: (${t.slice(0,-1)}) => {
                    ${t[t.length-1]}
                }`)}}};class Ke{constructor(e,...[r]){return Object.assign(Object.setPrototypeOf(e.bind(r?.bind??this),this.constructor.prototype),r?.attach)}}const nc=tc(()=>{try{return new Function("return false")()}catch{return!0}});class Pe{constructor(){}}var ic={};const sc=()=>{try{return((new Error().stack?.split(`
`)[2]?.trim()||"").match(/\(?(.+?)(?::\d+:\d+)?\)?$/)?.[1]||"unknown").replace(/^file:\/\//,"")}catch{return"unknown"}},oc=ic??{},ac={fileName:sc,env:oc},uc=t=>t[0].toUpperCase()+t.slice(1),lc=t=>t[0].toLowerCase()+t.slice(1),To=t=>new RegExp(cc(t),typeof t=="string"?"":t.flags),cc=t=>`^(?:${typeof t=="string"?t:t.source})$`,Te={negativeLookahead:t=>`(?!${t})`,nonCapturingGroup:t=>`(?:${t})`},kt="\\",Nr={" ":1,"\n":1,"	":1},dc=/^-0\.?0*$/.source,Bo=/[1-9]\d*/.source,hc=/\.\d+/.source,fc=/\.\d*[1-9]/.source,qo=t=>To(Te.negativeLookahead(dc)+Te.nonCapturingGroup("-?"+Te.nonCapturingGroup(Te.nonCapturingGroup("0|"+Bo)+Te.nonCapturingGroup(t.decimalPattern)+"?")+(t.allowDecimalOnly?"|"+t.decimalPattern:"")+"?")),Ci=qo({decimalPattern:fc,allowDecimalOnly:!1}),pc=Ci.test.bind(Ci),yn=qo({decimalPattern:hc,allowDecimalOnly:!0});yn.test.bind(yn);const mc=/^-?\d*\.?\d*$/,gc=t=>t.length!==0&&mc.test(t),yr=To(Te.negativeLookahead("^-0$")+"-?"+Te.nonCapturingGroup(Te.nonCapturingGroup("0|"+Bo))),yc=yr.test.bind(yr),bn=/^-?\d+$/,bc=bn.test.bind(bn),Fo={number:"a number",bigint:"a bigint",integer:"an integer"},Ko=(t,e)=>`'${t}' was parsed as ${Fo[e]} but could not be narrowed to a literal value. Avoid unnecessary leading or trailing zeros and other abnormal notation`,vc=(t,e)=>e==="number"?pc(t):yc(t),xc=(t,e)=>e==="number"?Number(t):Number.parseInt(t),wc=(t,e)=>e==="number"?gc(t):bc(t),kc=(t,e)=>Wn(t,"number",e),Sc=(t,e)=>Wn(t,"number",{...e,strict:!0}),_c=(t,e)=>Wn(t,"integer",e),Wn=(t,e,r)=>{const n=xc(t,e);return!Number.isNaN(n)&&wc(t,e)?r?.strict?vc(t,e)?n:P(Ko(t,e)):n:r?.errorOnFail?P(r?.errorOnFail===!0?`Failed to parse ${Fo[e]} from '${t}'`:r?.errorOnFail):void 0},Pc=t=>{if(t[t.length-1]!=="n")return;const e=t.slice(0,-1);let r;try{r=BigInt(e)}catch{return}if(yr.test(e))return r;if(bn.test(e))return P(Ko(t,"bigint"))},Ic="0.56.0",Cc={version:Ic,filename:ac.fileName(),FileConstructor:Lo},Mt=Cc,Oi=new Map,Vr=Object.create(null),vn=t=>{const e=Oi.get(t);if(e)return e;let r=Oc(t);return Vr[r]?r=`${r}${Vr[r]++}`:Vr[r]=1,Mt[r]=t,Oi.set(t,r),r},_t=t=>/^[$A-Z_a-z][\w$]*$/.test(t),Oc=t=>{switch(typeof t){case"object":{if(t===null)break;const e=Vn(t)??"object";return e[0].toLowerCase()+e.slice(1)}case"function":return _t(t.name)?t.name:"fn";case"symbol":return t.description&&_t(t.description)?t.description:"symbol"}return Q(`Unexpected attempt to register serializable value of type ${be(t)}`)},Jn=t=>typeof t=="string"?JSON.stringify(t):typeof t=="bigint"?`${t}n`:`${t}`,Mc=(t,e={})=>St(t,{onUndefined:"$ark.undefined",onBigInt:r=>`$ark.bigint-${r}`,...e},[]),B=(t,e)=>{switch(be(t)){case"object":const r=t,n=r.constructor?.name??"Object";return n==="Object"||n==="Array"?e?.quoteKeys===!1?br(r,e?.indent??0,""):JSON.stringify(St(r,at,[]),null,e?.indent):br(r,e?.indent??0,"");case"symbol":return at.onSymbol(t);default:return Jn(t)}},br=(t,e,r)=>{if(typeof t=="function")return at.onFunction(t);if(typeof t!="object"||t===null)return Jn(t);const n=r+" ".repeat(e);if(Array.isArray(t)){if(t.length===0)return"[]";const s=t.map(a=>br(a,e,n)).join(`,
`+n);return e?`[
${n}${s}
${r}]`:`[${s}]`}const i=t.constructor?.name??"Object";if(i==="Object"){const s=gr(t).map(([a,l])=>{const h=typeof a=="symbol"?at.onSymbol(a):_t(a)?a:JSON.stringify(a),d=br(l,e,n);return`${n}${h}: ${d}`});return s.length===0?"{}":e?`{
${s.join(`,
`)}
${r}}`:`{${s.join(", ")}}`}return t instanceof Date?At(t):"expression"in t&&typeof t.expression=="string"?t.expression:i},at={onCycle:()=>"(cycle)",onSymbol:t=>`Symbol(${vn(t)})`,onFunction:t=>`Function(${vn(t)})`},St=(t,e,r)=>{switch(be(t)){case"object":{const n=t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();if(typeof n=="function")return at.onFunction(n);if(r.includes(n))return"(cycle)";const i=[...r,n];if(Array.isArray(n))return n.map(a=>St(a,e,i));if(n instanceof Date)return n.toDateString();const s={};for(const a in n)s[a]=St(n[a],e,i);for(const a of Object.getOwnPropertySymbols(n))s[e.onSymbol?.(a)??a.toString()]=St(n[a],e,i);return s}case"symbol":return at.onSymbol(t);case"bigint":return e.onBigInt?.(t)??`${t}n`;case"undefined":return e.onUndefined??"undefined";case"string":return t.replace(/\\/g,"\\\\");default:return t}},At=t=>{const e=t.getFullYear(),r=t.getMonth(),n=t.getDate(),i=t.getHours(),s=t.getMinutes(),a=t.getSeconds(),l=t.getMilliseconds();if(r===0&&n===1&&i===0&&s===0&&a===0&&l===0)return`${e}`;const h=`${Ac[r]} ${n}, ${e}`;if(i===0&&s===0&&a===0&&l===0)return h;let d=t.toLocaleTimeString();const f=d.endsWith(" AM")||d.endsWith(" PM")?d.slice(-3):"";return f&&(d=d.slice(0,-f.length)),l?d+=`.${Dc(l,3)}`:Nc.test(d)&&(d=d.slice(0,-3)),`${d+f}, ${h}`},Ac=["January","February","March","April","May","June","July","August","September","October","November","December"],Nc=/:\d\d:00$/,Dc=(t,e)=>String(t).padStart(e,"0"),jo=(t,e,...[r])=>{const n=r?.stringifySymbol??B;let i=t;switch(typeof e){case"string":i=_t(e)?t===""?e:`${t}.${e}`:`${t}[${JSON.stringify(e)}]`;break;case"number":i=`${t}[${e}]`;break;case"symbol":i=`${t}[${n(e)}]`;break;default:r?.stringifyNonKey?i=`${t}[${r.stringifyNonKey(e)}]`:P(`${B(e)} must be a PropertyKey or stringifyNonKey must be passed to options`)}return i},Nt=(t,...e)=>t.reduce((r,n)=>jo(r,n,...e),"");class Uo extends Oo{cache={};constructor(...e){super(),this.push(...e)}toJSON(){if(this.cache.json)return this.cache.json;this.cache.json=[];for(let e=0;e<this.length;e++)this.cache.json.push(typeof this[e]=="symbol"?B(this[e]):this[e]);return this.cache.json}stringify(){return this.cache.stringify?this.cache.stringify:this.cache.stringify=Nt(this)}stringifyAncestors(){if(this.cache.stringifyAncestors)return this.cache.stringifyAncestors;let e="";const r=[e];for(const n of this)e=jo(e,n),r.push(e);return this.cache.stringifyAncestors=r}}class zo{chars;i;def;constructor(e){this.def=e,this.chars=[...e],this.i=0}shift(){return this.chars[this.i++]??""}get lookahead(){return this.chars[this.i]??""}get nextLookahead(){return this.chars[this.i+1]??""}get length(){return this.chars.length}shiftUntil(e){let r="";for(;this.lookahead&&!e(this,r);)r+=this.shift();return r}shiftUntilEscapable(e){let r="";for(;this.lookahead;)if(this.lookahead===kt)this.shift(),e(this,r)?r+=this.shift():this.lookahead===kt?r+=this.shift():r+=`${kt}${this.shift()}`;else{if(e(this,r))break;r+=this.shift()}return r}shiftUntilLookahead(e){return typeof e=="string"?this.shiftUntil(r=>r.lookahead===e):this.shiftUntil(r=>r.lookahead in e)}shiftUntilNonWhitespace(){return this.shiftUntil(()=>!(this.lookahead in Nr))}jumpToIndex(e){this.i=e<0?this.length+e:e}jumpForward(e){this.i+=e}get location(){return this.i}get unscanned(){return this.chars.slice(this.i,this.length).join("")}get scanned(){return this.chars.slice(0,this.i).join("")}sliceChars(e,r){return this.chars.slice(e,r).join("")}lookaheadIs(e){return this.lookahead===e}lookaheadIsIn(e){return this.lookahead in e}}const Ec=(t,e)=>`Unmatched ${t}${e===""?"":` before ${e}`}`,Ho=t=>`Missing ${t}`;let xn="$ark",Lc=2;for(;xn in globalThis;)xn=`$ark${Lc++}`;const Vo=xn;globalThis[Vo]=Mt;const M=Mt,$c=t=>`${Vo}.${t}`,oe=t=>$c(vn(t));class Go extends No{argNames;body="";constructor(...e){super(),this.argNames=e;for(const r of e){if(r in this)throw new Error(`Arg name '${r}' would overwrite an existing property on FunctionBody`);this[r]=r}}indentation=0;indent(){return this.indentation+=4,this}dedent(){return this.indentation-=4,this}prop(e,r=!1){return Wo(e,r)}index(e,r=!1){return Jo(`${e}`,r)}line(e){return this.body+=`${" ".repeat(this.indentation)}${e}
`,this}const(e,r){return this.line(`const ${e} = ${r}`),this}let(e,r){return this.line(`let ${e} = ${r}`)}set(e,r){return this.line(`${e} = ${r}`)}if(e,r){return this.block(`if (${e})`,r)}elseIf(e,r){return this.block(`else if (${e})`,r)}else(e){return this.block("else",e)}for(e,r,n=0){return this.block(`for (let i = ${n}; ${e}; i++)`,r)}forIn(e,r){return this.block(`for (const k in ${e})`,r)}block(e,r,n=""){return this.line(`${e} {`),this.indent(),r(this),this.dedent(),this.line(`}${n}`)}return(e=""){return this.line(`return ${e}`)}write(e="anonymous",r=0){return`${e}(${this.argNames.join(", ")}) { ${r?this.body.split(`
`).map(n=>" ".repeat(r)+`${n}`).join(`
`):this.body} }`}compile(){return new rc(...this.argNames,this.body)}}const ct=t=>We(t,"object")||typeof t=="symbol"?oe(t):Jn(t),Wo=(t,e=!1)=>typeof t=="string"&&_t(t)?`${e?"?":""}.${t}`:Jo(Rc(t),e),Rc=t=>typeof t=="symbol"?oe(t):JSON.stringify(t),Jo=(t,e=!1)=>`${e?"?.":""}[${t}]`;class Gr extends Go{traversalKind;optimistic;constructor(e){super("data","ctx"),this.traversalKind=e.kind,this.optimistic=e.optimistic===!0}invoke(e,r){const n=r?.arg??this.data,i=typeof e=="string"?!0:this.requiresContextFor(e),s=typeof e=="string"?e:e.id;return i?`${this.referenceToId(s,r)}(${n}, ${this.ctx})`:`${this.referenceToId(s,r)}(${n})`}referenceToId(e,r){const n=r?.kind??this.traversalKind,i=`this.${e}${n}`;return r?.bind?`${i}.bind(${r?.bind})`:i}requiresContextFor(e){return this.traversalKind==="Apply"||e.allowsRequiresContext}initializeErrorCount(){return this.const("errorCount","ctx.currentErrorCount")}returnIfFail(){return this.if("ctx.currentErrorCount > errorCount",()=>this.return())}returnIfFailFast(){return this.if("ctx.failFast && ctx.currentErrorCount > errorCount",()=>this.return())}traverseKey(e,r,n){const i=this.requiresContextFor(n);return i&&this.line(`${this.ctx}.path.push(${e})`),this.check(n,{arg:r}),i&&this.line(`${this.ctx}.path.pop()`),this}check(e,r){return this.traversalKind==="Allows"?this.if(`!${this.invoke(e,r)}`,()=>this.return(!1)):this.line(this.invoke(e,r))}}const Yo=t=>F(t,(e,r)=>[e,ne(r)?[...r]:r]),Ae=Mo("arkKind"),D=(t,e)=>t?.[Ae]===e,se=t=>D(t,"root")||D(t,"constraint"),Tc=["unit","proto","domain"],Dr=["required","optional","index","sequence"],Qo=["pattern","divisor","exactLength","max","min","maxLength","minLength","before","after"],Xo=[...Qo,"structure","predicate"],Yn=[...Xo,...Dr],Er=["alias","union","morph","unit","intersection","proto","domain"],Bc=[...Er,...Yn],Zo=F(Yn,(t,e)=>[e,1]),qc=F([...Dr,"undeclared"],(t,e)=>[e,1]),ea=F(Bc,(t,e)=>[e,t]),pr=t=>typeof t=="string"&&t in ea,vr=t=>ea[t],Qn=t=>Er.slice(vr(t)+1);[...Qn("union")];[...Qn("morph")];const Ge=t=>typeof t=="string"||typeof t=="boolean"||t===null?t:typeof t=="number"?Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t:ct(t),Lr=t=>{let e="{ ";for(const[r,n]of Object.entries(t))e+=`${r}: ${ct(n)}, `;return e+" }"},V=t=>{const e=t;return e.hasAssociatedError&&(e.defaults.expected??=r=>"description"in r?r.description:e.defaults.description(r),e.defaults.actual??=r=>B(r),e.defaults.problem??=r=>`must be ${r.expected}${r.actual?` (was ${r.actual})`:""}`,e.defaults.message??=r=>{if(r.path.length===0)return r.problem;const n=`${r.propString} ${r.problem}`;return n[0]==="["?`value at ${n}`:n}),e};class Fc extends Error{name="ToJsonSchemaError";code;context;constructor(e,r){super(B(r,{quoteKeys:!1,indent:4})),this.code=e,this.context=r}hasCode(e){return this.code===e}}const Kc={target:"draft-2020-12",dialect:"https://json-schema.org/draft/2020-12/schema",useRefs:!1,fallback:{arrayObject:t=>X.throw("arrayObject",t),arrayPostfix:t=>X.throw("arrayPostfix",t),defaultValue:t=>X.throw("defaultValue",t),domain:t=>X.throw("domain",t),morph:t=>X.throw("morph",t),patternIntersection:t=>X.throw("patternIntersection",t),predicate:t=>X.throw("predicate",t),proto:t=>X.throw("proto",t),symbolKey:t=>X.throw("symbolKey",t),unit:t=>X.throw("unit",t),date:t=>X.throw("date",t)}},X={Error:Fc,throw:(...t)=>{throw new X.Error(...t)},throwInternalOperandError:(t,e)=>Q(`Unexpected JSON Schema input for ${t}: ${B(e)}`),defaultConfig:Kc};M.config??={};const wn=(t,e)=>{if(!e)return t;const r={...t};let n;for(n in e){const i={...t.keywords};if(n==="keywords"){for(const s in e[n]){const a=e.keywords[s];a!==void 0&&(i[s]=typeof a=="string"?{description:a}:a)}r.keywords=i}else n==="toJsonSchema"?r[n]=ta(t.toJsonSchema,e.toJsonSchema):pr(n)?r[n]={...t[n],...e[n]}:r[n]=e[n]}return r},jc={"draft-2020-12":"https://json-schema.org/draft/2020-12/schema","draft-07":"http://json-schema.org/draft-07/schema#"},ta=((t,e)=>{if(!t)return Mi(e??{},void 0);if(!e)return t;const r={...t};let n;for(n in e)n==="fallback"?r.fallback=Uc(t.fallback,e.fallback):r[n]=e[n];return Mi(r,e)}),Mi=(t,e)=>e?.dialect!==void 0?t:e?.target!==void 0?{...t,dialect:jc[e.target]}:t,Uc=(t,e)=>{t=Ai(t),e=Ai(e);const r={};let n;for(n in X.defaultConfig.fallback)r[n]=e[n]??e.default??t[n]??t.default??X.defaultConfig.fallback[n];return r},Ai=t=>typeof t=="function"?{default:t}:t??{};class ut extends No{[Ae]="error";path;data;nodeConfig;input;ctx;constructor({prefixPath:e,relativePath:r,...n},i){super(),this.input=n,this.ctx=i,Vl(this,n);const s=i.data;n.code==="union"&&(n.errors=n.errors.flatMap(l=>{const h=l.hasCode("union")?l.errors:[l];return!e&&!r?h:h.map(d=>d.transform(f=>({...f,path:Tl(e,f.path,r)})))})),this.nodeConfig=i.config[this.code];const a=[...n.path??i.path];r&&a.push(...r),e&&a.unshift(...e),this.path=new Uo(...a),this.data="data"in n?n.data:s}transform(e){return new ut(e({data:this.data,path:this.path,...this.input}),this.ctx)}hasCode(e){return this.code===e}get propString(){return Nt(this.path)}get expected(){if(this.input.expected)return this.input.expected;const e=this.meta?.expected??this.nodeConfig.expected;return typeof e=="function"?e(this.input):e}get actual(){if(this.input.actual)return this.input.actual;const e=this.meta?.actual??this.nodeConfig.actual;return typeof e=="function"?e(this.data):e}get problem(){if(this.input.problem)return this.input.problem;const e=this.meta?.problem??this.nodeConfig.problem;return typeof e=="function"?e(this):e}get message(){if(this.input.message)return this.input.message;const e=this.meta?.message??this.nodeConfig.message;return typeof e=="function"?e(this):e}get flat(){return this.hasCode("intersection")?[...this.errors]:[this]}toJSON(){return{data:this.data,path:this.path,...this.input,expected:this.expected,actual:this.actual,problem:this.problem,message:this.message}}toString(){return this.message}throw(){throw this}}class qe extends Oo{[Ae]="errors";ctx;constructor(e){super(),this.ctx=e}byPath=Object.create(null);get flatByPath(){return F(this.byPath,(e,r)=>[e,r.flat])}get flatProblemsByPath(){return F(this.byPath,(e,r)=>[e,r.flat.map(n=>n.problem)])}byAncestorPath=Object.create(null);count=0;mutable=this;throw(){throw this.toTraversalError()}toTraversalError(){return new zc(this)}add(e){const r=this.byPath[e.propString];if(r){if(e===r||r.hasCode("union")&&r.errors.length===0)return;const n=e.hasCode("union")&&e.errors.length===0?e:new ut({code:"intersection",errors:r.hasCode("intersection")?[...r.errors,e]:[r,e]},this.ctx),i=this.indexOf(r);this.mutable[i===-1?this.length:i]=n,this.byPath[e.propString]=n,this.addAncestorPaths(e)}else this.byPath[e.propString]=e,this.addAncestorPaths(e),this.mutable.push(e);this.count++}transform(e){const r=new qe(this.ctx);for(const n of this)r.add(e(n));return r}merge(e){for(const r of e)this.add(new ut({...r,path:[...this.ctx.path,...r.path]},this.ctx))}affectsPath(e){return this.length===0?!1:e.stringifyAncestors().some(r=>r in this.byPath)||e.stringify()in this.byAncestorPath}get summary(){return this.toString()}get issues(){return this}toJSON(){return[...this.map(e=>e.toJSON())]}toString(){return this.join(`
`)}addAncestorPaths(e){for(const r of e.path.stringifyAncestors())this.byAncestorPath[r]=q(this.byAncestorPath[r],e)}}class zc extends Error{name="TraversalError";constructor(e){e.length===1?super(e.summary):super(`
`+e.map(r=>`  • ${Hc(r)}`).join(`
`)),Object.defineProperty(this,"arkErrors",{value:e,enumerable:!1})}}const Hc=t=>t.toString().split(`
`).join(`
  `);class tt{path=[];errors=new qe(this);root;config;queuedMorphs=[];branches=[];seen={};constructor(e,r){this.root=e,this.config=r}get data(){let e=this.root;for(const r of this.path)e=e?.[r];return e}get propString(){return Nt(this.path)}reject(e){return this.error(e),!1}mustBe(e){return this.error(e),!1}error(e){const r=typeof e=="object"?e.code?e:{...e,code:"predicate"}:{code:"predicate",expected:e};return this.errorFromContext(r)}hasError(){return this.currentErrorCount!==0}get currentBranch(){return this.branches[this.branches.length-1]}queueMorphs(e){const r={path:new Uo(...this.path),morphs:e};this.currentBranch?this.currentBranch.queuedMorphs.push(r):this.queuedMorphs.push(r)}finalize(e){return this.queuedMorphs.length&&(typeof this.root=="object"&&this.root!==null&&this.config.clone&&(this.root=this.config.clone(this.root)),this.applyQueuedMorphs()),this.hasError()?e?e(this.errors):this.errors:this.root}get currentErrorCount(){return this.currentBranch?this.currentBranch.error?1:0:this.errors.count}get failFast(){return this.branches.length!==0}pushBranch(){this.branches.push({error:void 0,queuedMorphs:[]})}popBranch(){return this.branches.pop()}get external(){return this}errorFromNodeContext(e){return this.errorFromContext(e)}errorFromContext(e){const r=new ut(e,this);return this.currentBranch?this.currentBranch.error=r:this.errors.add(r),r}applyQueuedMorphs(){for(;this.queuedMorphs.length;){const e=this.queuedMorphs;this.queuedMorphs=[];for(const{path:r,morphs:n}of e)this.errors.affectsPath(r)||this.applyMorphsAtPath(r,n)}}applyMorphsAtPath(e,r){const n=e[e.length-1];let i;if(n!==void 0){i=this.root;for(let s=0;s<e.length-1;s++)i=i[e[s]]}for(const s of r){this.path=[...e];const a=se(s),l=s(i===void 0?this.root:i[n],this);if(l instanceof ut){this.errors.includes(l)||this.errors.add(l);break}if(l instanceof qe){a||this.errors.merge(l),this.queuedMorphs=[];break}i===void 0?this.root=l:i[n]=l,this.applyQueuedMorphs()}}}const Ne=(t,e,r)=>{if(!r)return e();r.path.push(t);const n=e();return r.path.pop(),n};class ra extends Ke{attachments;$;onFail;includesTransform;includesContextualPredicate;isCyclic;allowsRequiresContext;rootApplyStrategy;contextFreeMorph;rootApply;referencesById;shallowReferences;flatRefs;flatMorphs;allows;get shallowMorphs(){return[]}constructor(e,r){super((i,s,a=this.onFail)=>s?(this.traverseApply(i,s),s.hasError()?s.errors:s.data):this.rootApply(i,a),{attach:e}),this.attachments=e,this.$=r,this.onFail=this.meta.onFail??this.$.resolvedConfig.onFail,this.includesTransform=this.hasKind("morph")||this.hasKind("structure")&&this.structuralMorph!==void 0||this.hasKind("sequence")&&this.inner.defaultables!==void 0,this.includesContextualPredicate=this.hasKind("predicate")&&this.inner.predicate.length!==1,this.isCyclic=this.kind==="alias",this.referencesById={[this.id]:this},this.shallowReferences=this.hasKind("structure")?[this,...this.children]:this.children.reduce((i,s)=>Jc(i,s.shallowReferences),[this]);const n=this.isStructural();this.flatRefs=[],this.flatMorphs=[];for(let i=0;i<this.children.length;i++){if(this.includesTransform||=this.children[i].includesTransform,this.includesContextualPredicate||=this.children[i].includesContextualPredicate,this.isCyclic||=this.children[i].isCyclic,!n){const s=this.children[i].flatRefs;for(let a=0;a<s.length;a++){const l=s[a];if(!this.flatRefs.some(h=>na(h,l))){this.flatRefs.push(l);for(const h of l.node.branches)(h.hasKind("morph")||h.hasKind("intersection")&&h.structure?.structuralMorph!==void 0)&&this.flatMorphs.push({path:l.path,propString:l.propString,node:h})}}}Object.assign(this.referencesById,this.children[i].referencesById)}this.flatRefs.sort((i,s)=>i.path.length>s.path.length?1:i.path.length<s.path.length?-1:i.propString>s.propString?1:i.propString<s.propString||i.node.expression<s.node.expression?-1:1),this.allowsRequiresContext=this.includesContextualPredicate||this.isCyclic,this.rootApplyStrategy=!this.allowsRequiresContext&&this.flatMorphs.length===0?this.shallowMorphs.length===0?"allows":this.shallowMorphs.every(i=>i.length===1||i.name==="$arkStructuralMorph")?this.hasKind("union")?this.branches.some(i=>i.shallowMorphs.length>1)?"contextual":"branchedOptimistic":this.shallowMorphs.length>1?"contextual":"optimistic":"contextual":"contextual",this.rootApply=this.createRootApply(),this.allows=this.allowsRequiresContext?i=>this.traverseAllows(i,new tt(i,this.$.resolvedConfig)):i=>this.traverseAllows(i)}createRootApply(){switch(this.rootApplyStrategy){case"allows":return(r,n)=>{if(this.allows(r))return r;const i=new tt(r,this.$.resolvedConfig);return this.traverseApply(r,i),i.finalize(n)};case"contextual":return(r,n)=>{const i=new tt(r,this.$.resolvedConfig);return this.traverseApply(r,i),i.finalize(n)};case"optimistic":this.contextFreeMorph=this.shallowMorphs[0];const e=this.$.resolvedConfig.clone;return(r,n)=>{if(this.allows(r))return this.contextFreeMorph(e&&(typeof r=="object"&&r!==null||typeof r=="function")?e(r):r);const i=new tt(r,this.$.resolvedConfig);return this.traverseApply(r,i),i.finalize(n)};case"branchedOptimistic":return this.createBranchedOptimisticRootApply();default:return this.rootApplyStrategy,Q(`Unexpected rootApplyStrategy ${this.rootApplyStrategy}`)}}compiledMeta=Wc(this.metaJson);cacheGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}get description(){return this.cacheGetter("description",this.meta?.description??this.$.resolvedConfig[this.kind].description(this))}get references(){return Object.values(this.referencesById)}precedence=vr(this.kind);precompilation;assert=(e,r)=>this(e,r,n=>n.throw());traverse(e,r){return this(e,r,null)}get in(){return this.cacheGetter("in",this.rawIn.isRoot()?this.$.finalize(this.rawIn):this.rawIn)}get rawIn(){return this.cacheGetter("rawIn",this.getIo("in"))}get out(){return this.cacheGetter("out",this.rawOut.isRoot()?this.$.finalize(this.rawOut):this.rawOut)}get rawOut(){return this.cacheGetter("rawOut",this.getIo("out"))}getIo(e){if(!this.includesTransform)return this;const r={};for(const[n,i]of this.innerEntries){const s=this.impl.keys[n];if(s.reduceIo)s.reduceIo(e,r,i);else if(s.child){const a=i;r[n]=ne(a)?a.map(l=>e==="in"?l.rawIn:l.rawOut):e==="in"?a.rawIn:a.rawOut}else r[n]=i}return this.$.node(this.kind,r)}toJSON(){return this.json}toString(){return`Type<${this.expression}>`}equals(e){const r=se(e)?e:this.$.parseDefinition(e);return this.innerHash===r.innerHash}ifEquals(e){return this.equals(e)?this:void 0}hasKind(e){return this.kind===e}assertHasKind(e){return this.kind!==e&&st(`${this.kind} node was not of asserted kind ${e}`),this}hasKindIn(...e){return e.includes(this.kind)}assertHasKindIn(...e){return Oe(e,this.kind)||st(`${this.kind} node was not one of asserted kinds ${e}`),this}isBasis(){return Oe(Tc,this.kind)}isConstraint(){return Oe(Yn,this.kind)}isStructural(){return Oe(Dr,this.kind)}isRefinement(){return Oe(Xo,this.kind)}isRoot(){return Oe(Er,this.kind)}isUnknown(){return this.hasKind("intersection")&&this.children.length===0}isNever(){return this.hasKind("union")&&this.children.length===0}hasUnit(e){return this.hasKind("unit")&&this.allows(e)}hasOpenIntersection(){return this.impl.intersectionIsOpen}get nestableExpression(){return this.expression}select(e){const r=xt.normalize(e);return this._select(r)}_select(e){let r=xt.applyBoundary[e.boundary??"references"](this);return e.kind&&(r=r.filter(n=>n.kind===e.kind)),e.where&&(r=r.filter(e.where)),xt.applyMethod[e.method??"filter"](r,this,e)}transform(e,r){return this._transform(e,this._createTransformContext(r))}_createTransformContext(e){return{root:this,selected:void 0,seen:{},path:[],parseOptions:{prereduced:e?.prereduced??!1},undeclaredKeyHandling:void 0,...e}}_transform(e,r){const n=r.bindScope??this.$;if(r.seen[this.id])return this.$.lazilyResolve(r.seen[this.id]);if(r.shouldTransform?.(this,r)===!1)return this;let i;r.seen[this.id]=()=>i,this.hasKind("structure")&&this.undeclared!==r.undeclaredKeyHandling&&(r={...r,undeclaredKeyHandling:this.undeclared});const s=F(this.inner,(f,p)=>{if(!this.impl.keys[f].child)return[f,p];const c=p;if(!ne(c)){const o=c._transform(e,r);return o?[f,o]:[]}if(c.length===0)return[f,p];const u=c.flatMap(o=>o._transform(e,r)??[]);return u.length?[f,u]:[]});delete r.seen[this.id];const a=Object.assign(s,{meta:this.meta}),l=r.selected&&!r.selected.includes(this)?a:e(this.kind,a,r);if(l===null)return null;if(se(l))return i=l;const h=Object.keys(l);return(h.length===0||h.length===1&&h[0]==="meta")&&!Ot(this.inner)?null:(this.kind==="required"||this.kind==="optional"||this.kind==="index")&&!("value"in l)?r.undeclaredKeyHandling?{...l,value:M.intrinsic.unknown}:null:(this.kind==="morph"&&(l.in??=M.intrinsic.unknown),i=n.node(this.kind,l,r.parseOptions))}configureReferences(e,r="references"){const n=xt.normalize(r),i=typeof e=="string"?(h,d)=>({...d,meta:{...d.meta,description:e}}):typeof e=="function"?(h,d)=>({...d,meta:e(d.meta)}):(h,d)=>({...d,meta:{...d.meta,...e}});if(n.boundary==="self")return this.$.node(this.kind,i(this.kind,{...this.inner,meta:this.meta}));const s=this._select(n),a=s&&Ct(s),l=n.boundary==="child"?(h,d)=>d.root.children.includes(h):n.boundary==="shallow"?h=>h.kind!=="structure":()=>!0;return this.$.finalize(this.transform(i,{shouldTransform:l,selected:a}))}}const xt={applyBoundary:{self:t=>[t],child:t=>[...t.children],shallow:t=>[...t.shallowReferences],references:t=>[...t.references]},applyMethod:{filter:t=>t,assertFilter:(t,e,r)=>(t.length===0&&st(Ni(e,r)),t),find:t=>t[0],assertFind:(t,e,r)=>(t.length===0&&st(Ni(e,r)),t[0])},normalize:t=>typeof t=="function"?{boundary:"references",method:"filter",where:t}:typeof t=="string"?_e(t,xt.applyBoundary)?{method:"filter",boundary:t}:{boundary:"references",method:"filter",kind:t}:{boundary:"references",method:"filter",...t}},Ni=(t,e)=>`${t} had no references matching ${B(e)}.`,Vc=t=>Nt(t,{stringifyNonKey:e=>e.expression}),Gc=/"(\$ark\.[^"]+)"/g,Wc=t=>JSON.stringify(t).replace(Gc,"$1"),Be=(t,e)=>({path:t,node:e,propString:Vc(t)}),na=(t,e)=>t.propString===e.propString&&t.node.equals(e.node),Di=(t,e)=>He(t,e,{isEqual:na}),Jc=(t,e)=>He(t,e,{isEqual:(r,n)=>r.equals(n)});class N extends Array{static init(e,r,n,i){return new N({kind:e,l:r,r:n,path:i?.path??[],optional:i?.optional??!1})}add(e,r,n,i){return this.push({kind:e,l:r,r:n,path:i?.path??[],optional:i?.optional??!1}),this}get summary(){return this.describeReasons()}describeReasons(){if(this.length===1){const{path:e,l:r,r:n}=this[0],i=Nt(e);return ia(`Intersection${i&&` at ${i}`} of ${Ei(r,n)}`)}return`The following intersections result in unsatisfiable types:
• ${this.map(({path:e,l:r,r:n})=>`${e}: ${Ei(r,n)}`).join(`
• `)}`}throw(){return P(this.describeReasons())}invert(){const e=this.map(r=>({...r,l:r.r,r:r.l}));return e instanceof N?e:new N(...e)}withPrefixKey(e,r){return this.map(n=>({...n,path:[e,...n.path],optional:n.optional||r==="optional"}))}toNeverIfDisjoint(){return M.intrinsic.never}}const Ei=(t,e)=>`${kn(t)} and ${kn(e)}`,kn=t=>se(t)?t.expression:ne(t)?t.map(kn).join(" | ")||"never":String(t),ia=t=>`${t} results in an unsatisfiable type`,Je={},De=(t,e,r)=>ee(t,e,{$:r,invert:!1,pipe:!1}),Sn=(t,e,r)=>ee(t,e,{$:r,invert:!1,pipe:!0}),ee=((t,e,r)=>{const n=r.pipe?"|>":"&",i=`${t.hash}${n}${e.hash}`;if(Je[i]!==void 0)return Je[i];if(!r.pipe){const l=`${e.hash}${n}${t.hash}`;if(Je[l]!==void 0){const h=Je[l],d=h instanceof N?h.invert():h;return Je[i]=d,d}}const s=!r.pipe||!t.includesTransform&&!e.includesTransform;if(s&&t.equals(e))return t;let a=s?_n(t,e,r):t.hasKindIn(...Er)?Yc(t,e,r):_n(t,e,r);return se(a)&&(t.equals(a)?a=t:e.equals(a)&&(a=e)),Je[i]=a,a}),_n=(t,e,r)=>{const n=t.precedence<e.precedence?t.kind:e.kind,i=t.impl.intersections[e.kind]??e.impl.intersections[t.kind];if(i===void 0)return null;if(n===t.kind)return i(t,e,r);{let s=i(e,t,{...r,invert:!r.invert});return s instanceof N&&(s=s.invert()),s}},Yc=(t,e,r)=>t.includesTransform||e.includesTransform?r.invert?Li(e,t,r):Li(t,e,r):_n(t,e,r),Li=(t,e,r)=>t.distribute(n=>Qc(n,e,r),n=>{const i=n.filter(se);if(i.length===0)return N.init("union",t.branches,e.branches);if(i.length<t.branches.length||!t.branches.every((a,l)=>a.rawIn.equals(i[l].rawIn)))return r.$.parseSchema(i);if(i.length===1)return i[0];const s={branches:i};return r.$.parseSchema(s)}),Qc=(t,e,r)=>{if(t.hasKind("morph")){const i=[...t.morphs];if(t.lastMorphIfNode){const s=ee(t.lastMorphIfNode,e,r);if(s instanceof N)return s;i[i.length-1]=s}else i.push(e);return r.$.node("morph",{morphs:i,in:t.inner.in})}if(e.hasKind("morph")){const i=ee(t,e.rawIn,r);return i instanceof N?i:r.$.node("morph",{morphs:[e],in:i})}return r.$.node("morph",{morphs:[e],in:t})};class dt extends ra{constructor(e,r){super(e,r),Object.defineProperty(this,Ae,{value:"constraint",enumerable:!1})}impliedSiblings;intersect(e){return De(this,e,this.$)}}class $r extends dt{traverseApply=(e,r)=>{this.traverseAllows(e,r)||r.errorFromNodeContext(this.errorContext)};compile(e){e.traversalKind==="Allows"?e.return(this.compiledCondition):e.if(this.compiledNegation,()=>e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return Lr(this.errorContext)}}const le=t=>(e,r)=>{if(ne(e)){if(e.length===0)return;const i=e.map(s=>r.$.node(t,s));return t==="predicate"?i:i.sort((s,a)=>s.hash<a.hash?-1:1)}const n=r.$.node(t,e);return n.hasOpenIntersection()?[n]:n},xr=t=>{const e=t.r.shift();if(!e){let n=t.l.length===0&&t.kind==="structure"?M.intrinsic.unknown.internal:t.ctx.$.node(t.kind,Object.assign(t.baseInner,Xc(t.l)),{prereduced:!0});for(const i of t.roots){if(n instanceof N)return n;n=ee(i,n,t.ctx)}return n}let r=!1;for(let n=0;n<t.l.length;n++){const i=ee(t.l[n],e,t.ctx);if(i!==null){if(i instanceof N)return i;if(i.isRoot())return t.roots.push(i),t.l.splice(n),xr(t);if(!r)t.l[n]=i,r=!0;else if(!t.l.includes(i))return Q(`Unexpectedly encountered multiple distinct intersection results for refinement ${e}`)}}if(r||t.l.push(e),t.kind==="intersection"&&e.impliedSiblings)for(const n of e.impliedSiblings)He(t.r,n);return xr(t)},wr=t=>Object.entries(t).flatMap(([r,n])=>r in Zo?n:[]).sort((r,n)=>r.precedence<n.precedence?-1:r.precedence>n.precedence?1:r.kind==="predicate"&&n.kind==="predicate"?0:r.hash<n.hash?-1:1),Xc=t=>{const e={};for(const r of t)if(r.hasOpenIntersection())e[r.kind]=q(e[r.kind],r);else{if(e[r.kind])return Q(`Unexpected intersection of closed refinements of kind ${r.kind}`);e[r.kind]=r}return e},Zc=(...t)=>P(ed(...t)),ed=(t,e,r)=>{const n=r.hasKind("morph")?"a morph":r.isUnknown()?"unknown":r.exclude(e).defaultShortDescription;return`${uc(t)} operand must be ${e.description} (was ${n})`},td=(t,e,r)=>new kr(t,e,r,r,null);class sa extends Ke{}class kr extends Ke{[Ae]="generic";paramDefs;bodyDef;$;arg$;baseInstantiation;hkt;description;constructor(e,r,n,i,s){super((...a)=>{const l=F(this.names,(h,d)=>{const f=this.arg$.parse(a[h]);return f.extends(this.constraints[h])||P(rd(d,this.constraints[h].expression,f.expression)),[d,f]});if(this.defIsLazy()){const h=this.bodyDef(l);return this.$.parse(h)}return this.$.parse(r,{args:l})}),this.paramDefs=e,this.bodyDef=r,this.$=n,this.arg$=i,this.hkt=s,this.description=s?new s().description??`a generic type for ${s.constructor.name}`:"a generic type",this.baseInstantiation=this(...this.constraints)}defIsLazy(){return this.bodyDef instanceof sa}cacheGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}get json(){return this.cacheGetter("json",{params:this.params.map(e=>e[1].isUnknown()?e[0]:[e[0],e[1].json]),body:Mc(this.bodyDef)})}get params(){return this.cacheGetter("params",this.paramDefs.map(e=>typeof e=="string"?[e,M.intrinsic.unknown]:[e[0],this.$.parse(e[1])]))}get names(){return this.cacheGetter("names",this.params.map(e=>e[0]))}get constraints(){return this.cacheGetter("constraints",this.params.map(e=>e[1]))}get internal(){return this}get referencesById(){return this.baseInstantiation.internal.referencesById}get references(){return this.baseInstantiation.internal.references}}const rd=(t,e,r)=>`${t} must be assignable to ${e} (was ${r})`,nd=V({kind:"predicate",hasAssociatedError:!0,collapsibleKey:"predicate",keys:{predicate:{}},normalize:t=>typeof t=="function"?{predicate:t}:t,defaults:{description:t=>`valid according to ${t.predicate.name||"an anonymous predicate"}`},intersectionIsOpen:!0,intersections:{predicate:()=>null}});class id extends dt{serializedPredicate=oe(this.predicate);compiledCondition=`${this.serializedPredicate}(data, ctx)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=null;expression=this.serializedPredicate;traverseAllows=this.predicate;errorContext={code:"predicate",description:this.description,meta:this.meta};compiledErrorContext=Lr(this.errorContext);traverseApply=(e,r)=>{const n=r.currentErrorCount;!this.predicate(e,r.external)&&r.currentErrorCount===n&&r.errorFromNodeContext(this.errorContext)};compile(e){if(e.traversalKind==="Allows"){e.return(this.compiledCondition);return}e.initializeErrorCount(),e.if(`${this.compiledNegation} && ctx.currentErrorCount === errorCount`,()=>e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}reduceJsonSchema(e,r){return r.fallback.predicate({code:"predicate",base:e,predicate:this.predicate})}}const oa={implementation:nd,Node:id},sd=V({kind:"divisor",collapsibleKey:"rule",keys:{rule:{parse:t=>Number.isInteger(t)?t:P(ad(t))}},normalize:t=>typeof t=="number"?{rule:t}:t,hasAssociatedError:!0,defaults:{description:t=>t.rule===1?"an integer":t.rule===2?"even":`a multiple of ${t.rule}`},intersections:{divisor:(t,e,r)=>r.$.node("divisor",{rule:Math.abs(t.rule*e.rule/ud(t.rule,e.rule))})},obviatesBasisDescription:!0});class od extends $r{traverseAllows=e=>e%this.rule===0;compiledCondition=`data % ${this.rule} === 0`;compiledNegation=`data % ${this.rule} !== 0`;impliedBasis=M.intrinsic.number.internal;expression=`% ${this.rule}`;reduceJsonSchema(e){return e.type="integer",this.rule===1||(e.multipleOf=this.rule),e}}const aa={implementation:sd,Node:od},ad=t=>`divisor must be an integer (was ${t})`,ud=(t,e)=>{let r,n=t,i=e;for(;i!==0;)r=i,i=n%i,n=r;return n};class ht extends $r{boundOperandKind=hd[this.kind];compiledActual=this.boundOperandKind==="value"?"data":this.boundOperandKind==="length"?"data.length":"data.valueOf()";comparator=fd(this.kind,this.exclusive);numericLimit=this.rule.valueOf();expression=`${this.comparator} ${this.rule}`;compiledCondition=`${this.compiledActual} ${this.comparator} ${this.numericLimit}`;compiledNegation=`${this.compiledActual} ${ld[this.comparator]} ${this.numericLimit}`;stringLimit=this.boundOperandKind==="date"?pd(this.numericLimit):`${this.numericLimit}`;limitKind=this.comparator[0]==="<"?"upper":"lower";isStricterThan(e){return(this.limitKind==="upper"?this.numericLimit<e.numericLimit:this.numericLimit>e.numericLimit)||this.numericLimit===e.numericLimit&&this.exclusive===!0&&!e.exclusive}overlapsRange(e){return!(this.isStricterThan(e)||this.numericLimit===e.numericLimit&&(this.exclusive||e.exclusive))}overlapIsUnit(e){return this.numericLimit===e.numericLimit&&!this.exclusive&&!e.exclusive}}const ld={"<":">=","<=":">",">":"<=",">=":"<"},cd={min:"max",minLength:"maxLength",after:"before"},ua={parse:t=>t||void 0},la=t=>e=>{if(typeof e=="number")return{rule:e};const{exclusive:r,...n}=e;return r?{...n,rule:t==="minLength"?n.rule+1:n.rule-1}:n},ca=t=>e=>{if(typeof e=="number"||typeof e=="string"||e instanceof Date)return{rule:e};const{exclusive:r,...n}=e;if(!r)return n;const i=typeof n.rule=="number"?n.rule:typeof n.rule=="string"?new Date(n.rule).valueOf():n.rule.valueOf();return r?{...n,rule:t==="after"?i+1:i-1}:n},da=t=>typeof t=="string"||typeof t=="number"?new Date(t):t,dd=(t,e)=>`${t} bound must be a positive integer (was ${e})`,Xn=t=>e=>((!Number.isInteger(e)||e<0)&&P(dd(t,e)),e),hd={min:"value",max:"value",minLength:"length",maxLength:"length",after:"date",before:"date"},fd=(t,e)=>`${_e(t,cd)?">":"<"}${e?"":"="}`,pd=t=>typeof t=="string"?t:new Date(t).toLocaleString(),md=t=>`Bounded expression ${t} must be exactly one of number, string, Array, or Date`,gd=V({kind:"after",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:da,serialize:t=>t.toISOString()}},normalize:ca("after"),defaults:{description:t=>`${t.collapsibleLimitString} or later`,actual:At},intersections:{after:(t,e)=>t.isStricterThan(e)?t:e}});class yd extends ht{impliedBasis=M.intrinsic.Date.internal;collapsibleLimitString=At(this.rule);traverseAllows=e=>e>=this.rule;reduceJsonSchema(e,r){return r.fallback.date({code:"date",base:e,after:this.rule})}}const ha={implementation:gd,Node:yd},bd=V({kind:"before",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:da,serialize:t=>t.toISOString()}},normalize:ca("before"),defaults:{description:t=>`${t.collapsibleLimitString} or earlier`,actual:At},intersections:{before:(t,e)=>t.isStricterThan(e)?t:e,after:(t,e,r)=>t.overlapsRange(e)?t.overlapIsUnit(e)?r.$.node("unit",{unit:t.rule}):null:N.init("range",t,e)}});class vd extends ht{collapsibleLimitString=At(this.rule);traverseAllows=e=>e<=this.rule;impliedBasis=M.intrinsic.Date.internal;reduceJsonSchema(e,r){return r.fallback.date({code:"date",base:e,before:this.rule})}}const fa={implementation:bd,Node:vd},xd=V({kind:"exactLength",collapsibleKey:"rule",keys:{rule:{parse:Xn("exactLength")}},normalize:t=>typeof t=="number"?{rule:t}:t,hasAssociatedError:!0,defaults:{description:t=>`exactly length ${t.rule}`,actual:t=>`${t.length}`},intersections:{exactLength:(t,e,r)=>N.init("unit",r.$.node("unit",{unit:t.rule}),r.$.node("unit",{unit:e.rule}),{path:["length"]}),minLength:(t,e)=>t.rule>=e.rule?t:N.init("range",t,e),maxLength:(t,e)=>t.rule<=e.rule?t:N.init("range",t,e)}});class wd extends $r{traverseAllows=e=>e.length===this.rule;compiledCondition=`data.length === ${this.rule}`;compiledNegation=`data.length !== ${this.rule}`;impliedBasis=M.intrinsic.lengthBoundable.internal;expression=`== ${this.rule}`;reduceJsonSchema(e){switch(e.type){case"string":return e.minLength=this.rule,e.maxLength=this.rule,e;case"array":return e.minItems=this.rule,e.maxItems=this.rule,e;default:return X.throwInternalOperandError("exactLength",e)}}}const pa={implementation:xd,Node:wd},kd=V({kind:"max",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:ua},normalize:t=>typeof t=="number"?{rule:t}:t,defaults:{description:t=>t.rule===0?t.exclusive?"negative":"non-positive":`${t.exclusive?"less than":"at most"} ${t.rule}`},intersections:{max:(t,e)=>t.isStricterThan(e)?t:e,min:(t,e,r)=>t.overlapsRange(e)?t.overlapIsUnit(e)?r.$.node("unit",{unit:t.rule}):null:N.init("range",t,e)},obviatesBasisDescription:!0});class Sd extends ht{impliedBasis=M.intrinsic.number.internal;traverseAllows=this.exclusive?e=>e<this.rule:e=>e<=this.rule;reduceJsonSchema(e){return this.exclusive?e.exclusiveMaximum=this.rule:e.maximum=this.rule,e}}const ma={implementation:kd,Node:Sd},_d=V({kind:"maxLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:Xn("maxLength")}},reduce:(t,e)=>t.rule===0?e.node("exactLength",t):void 0,normalize:la("maxLength"),defaults:{description:t=>`at most length ${t.rule}`,actual:t=>`${t.length}`},intersections:{maxLength:(t,e)=>t.isStricterThan(e)?t:e,minLength:(t,e,r)=>t.overlapsRange(e)?t.overlapIsUnit(e)?r.$.node("exactLength",{rule:t.rule}):null:N.init("range",t,e)}});class Pd extends ht{impliedBasis=M.intrinsic.lengthBoundable.internal;traverseAllows=e=>e.length<=this.rule;reduceJsonSchema(e){switch(e.type){case"string":return e.maxLength=this.rule,e;case"array":return e.maxItems=this.rule,e;default:return X.throwInternalOperandError("maxLength",e)}}}const ga={implementation:_d,Node:Pd},Id=V({kind:"min",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{},exclusive:ua},normalize:t=>typeof t=="number"?{rule:t}:t,defaults:{description:t=>t.rule===0?t.exclusive?"positive":"non-negative":`${t.exclusive?"more than":"at least"} ${t.rule}`},intersections:{min:(t,e)=>t.isStricterThan(e)?t:e},obviatesBasisDescription:!0});class Cd extends ht{impliedBasis=M.intrinsic.number.internal;traverseAllows=this.exclusive?e=>e>this.rule:e=>e>=this.rule;reduceJsonSchema(e){return this.exclusive?e.exclusiveMinimum=this.rule:e.minimum=this.rule,e}}const ya={implementation:Id,Node:Cd},Od=V({kind:"minLength",collapsibleKey:"rule",hasAssociatedError:!0,keys:{rule:{parse:Xn("minLength")}},reduce:t=>t.rule===0?M.intrinsic.unknown:void 0,normalize:la("minLength"),defaults:{description:t=>t.rule===1?"non-empty":`at least length ${t.rule}`,actual:t=>t.length===0?"":`${t.length}`},intersections:{minLength:(t,e)=>t.isStricterThan(e)?t:e}});class Md extends ht{impliedBasis=M.intrinsic.lengthBoundable.internal;traverseAllows=e=>e.length>=this.rule;reduceJsonSchema(e){switch(e.type){case"string":return e.minLength=this.rule,e;case"array":return e.minItems=this.rule,e;default:return X.throwInternalOperandError("minLength",e)}}}const ba={implementation:Od,Node:Md},Ad={min:ya.implementation,max:ma.implementation,minLength:ba.implementation,maxLength:ga.implementation,exactLength:pa.implementation,after:ha.implementation,before:fa.implementation},Nd={min:ya.Node,max:ma.Node,minLength:ba.Node,maxLength:ga.Node,exactLength:pa.Node,after:ha.Node,before:fa.Node},Dd=V({kind:"pattern",collapsibleKey:"rule",keys:{rule:{},flags:{}},normalize:t=>typeof t=="string"?{rule:t}:t instanceof RegExp?t.flags?{rule:t.source,flags:t.flags}:{rule:t.source}:t,obviatesBasisDescription:!0,obviatesBasisExpression:!0,hasAssociatedError:!0,intersectionIsOpen:!0,defaults:{description:t=>`matched by ${t.rule}`},intersections:{pattern:()=>null}});class Ed extends $r{instance=new RegExp(this.rule,this.flags);expression=`${this.instance}`;traverseAllows=this.instance.test.bind(this.instance);compiledCondition=`${this.expression}.test(data)`;compiledNegation=`!${this.compiledCondition}`;impliedBasis=M.intrinsic.string.internal;reduceJsonSchema(e,r){return e.pattern?r.fallback.patternIntersection({code:"patternIntersection",base:e,pattern:this.rule}):(e.pattern=this.rule,e)}}const va={implementation:Dd,Node:Ed},mr=(t,e)=>{const r=Ld(t);return e&&!e.includes(r)?P(`Root of kind ${r} should be one of ${e}`):r},Ld=t=>{if(D(t,"root"))return t.kind;if(typeof t=="string")return t[0]==="$"?"alias":t in Me?"domain":"proto";if(typeof t=="function")return"proto";if(typeof t!="object"||t===null)return P($i(t));if("morphs"in t)return"morph";if("branches"in t||ne(t))return"union";if("unit"in t)return"unit";if("reference"in t)return"alias";const e=Object.keys(t);return e.length===0||e.some(r=>r in Zo)?"intersection":"proto"in t?"proto":"domain"in t?"domain":P($i(t))},$i=t=>`${B(t)} is not a valid type schema`,Ri={},$d=t=>ne(t)?t.map(e=>e.collapsibleJson):t.collapsibleJson,me={};M.nodesByRegisteredId=me;const xa=t=>(Ri[t]??=0,`${t}${++Ri[t]}`),wa=t=>{const e=Rr[t.kind],r=e.applyConfig?.(t.def,t.$.resolvedConfig)??t.def,n={},{meta:i,...s}=r,a=i===void 0?{}:typeof i=="string"?{description:i}:i,l=Ao(s).sort(([d],[f])=>pr(d)?pr(f)?vr(d)-vr(f):1:pr(f)||d<f?-1:1).filter(([d,f])=>{if(d.startsWith("meta.")){const p=d.slice(5);return a[p]=f,!1}return!0});for(const d of l){const f=d[0],p=e.keys[f];if(!p)return P(`Key ${f} is not valid on ${t.kind} schema`);const c=p.parse?p.parse(d[1],t):d[1];c!==xe&&(c!==void 0||p.preserveUndefined)&&(n[f]=c)}if(e.reduce&&!t.prereduced){const d=e.reduce(n,t.$);if(d)return d instanceof N?d.throw():Td(d,a)}return Zn({id:t.id,kind:t.kind,inner:n,meta:a,$:t.$})},Zn=({id:t,kind:e,inner:r,meta:n,$:i,ignoreCache:s})=>{const a=Rr[e],l=Ao(r),h=[];let d={};for(const[b,v]of l){const w=a.keys[b],y=w.serialize??(w.child?$d:Ge);if(d[b]=y(v),w.child===!0){const x=v;ne(x)?h.push(...x):h.push(x)}else typeof w.child=="function"&&h.push(...w.child(v))}a.finalizeInnerJson&&(d=a.finalizeInnerJson(d));let f={...d},p={};Ot(n)||(p=F(n,(b,v)=>[b,b==="examples"?v:Ge(v)]),f.meta=Bt(p,"description",!0)),d=Bt(d,a.collapsibleKey,!1);const c=JSON.stringify({kind:e,...d});f=Bt(f,a.collapsibleKey,!1);const u=Bt(f,a.collapsibleKey,!0),o=JSON.stringify({kind:e,...f});if(i.nodesByHash[o]&&!s)return i.nodesByHash[o];const g={id:t,kind:e,impl:a,inner:r,innerEntries:l,innerJson:d,innerHash:c,meta:n,metaJson:p,json:f,hash:o,collapsibleJson:u,children:h};if(e!=="intersection")for(const b in r)b!=="in"&&b!=="out"&&(g[b]=r[b]);const m=new zh[e](g,i);return i.nodesByHash[o]=m},Rd=(t,e)=>t.id===e?t:(se(me[e])&&Q(`Unexpected attempt to overwrite node id ${e}`),Zn({id:e,kind:t.kind,inner:t.inner,meta:t.meta,$:t.$,ignoreCache:!0})),Td=(t,e,r)=>Zn({id:xa(e.alias??t.kind),kind:t.kind,inner:t.inner,meta:e,$:t.$}),Bt=(t,e,r)=>{const n=Object.keys(t);if(n.length===1&&n[0]===e){const i=t[e];if(r||We(i,"object")&&(Object.keys(i).length===1||Array.isArray(i)))return i}return t},Pn=(t,e,r)=>{if(t.key!==e.key)return null;const n=t.key;let i=ee(t.value,e.value,r);const s=t.required||e.required?"required":"optional";if(i instanceof N)if(s==="optional")i=M.intrinsic.never.internal;else return i.withPrefixKey(t.key,t.required&&e.required?"required":"optional");if(s==="required")return r.$.node("required",{key:n,value:i});const a=t.hasDefault()?e.hasDefault()?t.default===e.default?t.default:P(Sa(t.default,e.default)):t.default:e.hasDefault()?e.default:xe;return r.$.node("optional",{key:n,value:i,default:a})};class ka extends dt{required=this.kind==="required";optional=this.kind==="optional";impliedBasis=M.intrinsic.object.internal;serializedKey=ct(this.key);compiledKey=typeof this.key=="string"?this.key:this.serializedKey;flatRefs=q(this.value.flatRefs.map(e=>Be([this.key,...e.path],e.node)),Be([this.key],this.value));_transform(e,r){r.path.push(this.key);const n=super._transform(e,r);return r.path.pop(),n}hasDefault(){return"default"in this.inner}traverseAllows=(e,r)=>this.key in e?Ne(this.key,()=>this.value.traverseAllows(e[this.key],r),r):this.optional;traverseApply=(e,r)=>{this.key in e?Ne(this.key,()=>this.value.traverseApply(e[this.key],r),r):this.hasKind("required")&&r.errorFromNodeContext(this.errorContext)};compile(e){e.if(`${this.serializedKey} in data`,()=>e.traverseKey(this.serializedKey,`data${e.prop(this.key)}`,this.value)),this.hasKind("required")&&e.else(()=>e.traversalKind==="Apply"?e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`):e.return(!1)),e.traversalKind==="Allows"&&e.return(!0)}}const Sa=(t,e)=>`Invalid intersection of default values ${B(t)} & ${B(e)}`,Bd=V({kind:"optional",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(t,e)=>e.$.parseSchema(t)},default:{preserveUndefined:!0}},normalize:t=>t,reduce:(t,e)=>{if(e.resolvedConfig.exactOptionalPropertyTypes===!1&&!t.value.allows(void 0))return e.node("optional",{...t,value:t.value.or(E.undefined)},{prereduced:!0})},defaults:{description:t=>`${t.compiledKey}?: ${t.value.description}`},intersections:{optional:Pn}});class qd extends ka{constructor(...e){super(...e),"default"in this.inner&&ti(this.value,this.inner.default,this.key)}get rawIn(){const e=super.rawIn;return this.hasDefault()?this.$.node("optional",Do(e.inner,{default:!0}),{prereduced:!0}):e}get outProp(){if(!this.hasDefault())return this;const{default:e,...r}=this.inner;return this.cacheGetter("outProp",this.$.node("required",r,{prereduced:!0}))}expression=this.hasDefault()?`${this.compiledKey}: ${this.value.expression} = ${B(this.inner.default)}`:`${this.compiledKey}?: ${this.value.expression}`;defaultValueMorph=Kd(this);defaultValueMorphRef=this.defaultValueMorph&&oe(this.defaultValueMorph)}const ei={implementation:Bd,Node:qd},Fd={},Kd=t=>{if(!t.hasDefault())return;const e=`{${t.compiledKey}: ${t.value.id} = ${Ge(t.default)}}`;return Fd[e]??=_a(t.key,t.value,t.default)},_a=(t,e,r)=>{if(typeof r=="function")return e.includesTransform?(i,s)=>(Ne(t,()=>e(i[t]=r(),s),s),i):i=>(i[t]=r(),i);const n=e.includesTransform?e.assert(r):r;return We(n,"object")?(i,s)=>(Ne(t,()=>e(i[t]=r,s),s),i):i=>(i[t]=n,i)},ti=(t,e,r)=>{const n=Ar(e);We(e,"object")&&!n&&P(jd(r));const i=t.in(n?e():e);if(i instanceof qe){r===null&&P(`Default ${i.summary}`);const s=i.transform(a=>a.transform(l=>({...l,prefixPath:[r]})));P(`Default for ${s.summary}`)}return e},jd=t=>`Non-primitive default ${t===null?"":typeof t=="number"?`for value at [${t}] `:`for ${ct(t)} `}must be specified as a function like () => ({my: 'object'})`;class Dt extends ra{constructor(e,r){super(e,r),Object.defineProperty(this,Ae,{value:"root",enumerable:!1})}get rawIn(){return super.rawIn}get rawOut(){return super.rawOut}get internal(){return this}get"~standard"(){return{vendor:"arktype",version:1,validate:e=>{const r=this(e);return r instanceof qe?r:{value:r}},jsonSchema:{input:e=>this.rawIn.toJsonSchema({target:Ti(e.target),...e.libraryOptions}),output:e=>this.rawOut.toJsonSchema({target:Ti(e.target),...e.libraryOptions})}}}as(){return this}brand(e){return e===""?P(Ud):this}readonly(){return this}branches=this.hasKind("union")?this.inner.branches:[this];distribute(e,r){const n=this.branches.map(e);return r?.(n)??n}get shortDescription(){return this.meta.description??this.defaultShortDescription}toJsonSchema(e={}){const r=ta(this.$.resolvedConfig.toJsonSchema,e);r.useRefs||=this.isCyclic;const n=typeof r.dialect=="string"?{$schema:r.dialect}:{};if(Object.assign(n,this.toJsonSchemaRecurse(r)),r.useRefs){const i=F(this.references,(s,a)=>a.isRoot()&&!a.alwaysExpandJsonSchema?[a.id,a.toResolvedJsonSchema(r)]:[]);r.target==="draft-07"?Object.assign(n,{definitions:i}):n.$defs=i}return n}toJsonSchemaRecurse(e){return e.useRefs&&!this.alwaysExpandJsonSchema?{$ref:`#/${e.target==="draft-07"?"definitions":"$defs"}/${this.id}`}:this.toResolvedJsonSchema(e)}get alwaysExpandJsonSchema(){return this.isBasis()||this.kind==="alias"||this.hasKind("union")&&this.isBoolean}toResolvedJsonSchema(e){const r=this.innerToJsonSchema(e);return Object.assign(r,this.metaJson)}intersect(e){const r=this.$.parseDefinition(e),n=this.rawIntersect(r);return n instanceof N?n:this.$.finalize(n)}rawIntersect(e){return De(this,e,this.$)}toNeverIfDisjoint(){return this}and(e){const r=this.intersect(e);return r instanceof N?r.throw():r}rawAnd(e){const r=this.rawIntersect(e);return r instanceof N?r.throw():r}or(e){const r=this.$.parseDefinition(e);return this.$.finalize(this.rawOr(r))}rawOr(e){const r=[...this.branches,...e.branches];return this.$.node("union",r)}map(e){return this.$.schema(this.applyStructuralOperation("map",[e]))}pick(...e){return this.$.schema(this.applyStructuralOperation("pick",e))}omit(...e){return this.$.schema(this.applyStructuralOperation("omit",e))}required(){return this.$.schema(this.applyStructuralOperation("required",[]))}partial(){return this.$.schema(this.applyStructuralOperation("partial",[]))}_keyof;keyof(){if(this._keyof)return this._keyof;const e=this.applyStructuralOperation("keyof",[]).reduce((r,n)=>r.intersect(n).toNeverIfDisjoint(),M.intrinsic.unknown.internal);return e.branches.length===0&&P(ia(`keyof ${this.expression}`)),this._keyof=this.$.finalize(e)}get props(){return this.branches.length!==1?P(Hd(this.expression)):[...this.applyStructuralOperation("props",[])[0]]}merge(e){const r=this.$.parseDefinition(e);return this.$.schema(r.distribute(n=>this.applyStructuralOperation("merge",[Bi(n)??P(qi("merge",n.expression))])))}applyStructuralOperation(e,r){return this.distribute(n=>{if(n.equals(M.intrinsic.object)&&e!=="merge")return n;const i=Bi(n);if(i||P(qi(e,n.expression)),e==="keyof")return i.keyof();if(e==="get")return i.get(...r);if(e==="props")return i.props;const s=e==="required"?"require":e==="partial"?"optionalize":e;return this.$.node("intersection",{domain:"object",structure:i[s](...r)})})}get(...e){return e[0]===void 0?this:this.$.schema(this.applyStructuralOperation("get",e))}extract(e){const r=this.$.parseDefinition(e);return this.$.schema(this.branches.filter(n=>n.extends(r)))}exclude(e){const r=this.$.parseDefinition(e);return this.$.schema(this.branches.filter(n=>!n.extends(r)))}array(){return this.$.schema(this.isUnknown()?{proto:Array}:{proto:Array,sequence:this},{prereduced:!0})}overlaps(e){return!(this.intersect(e)instanceof N)}extends(e){if(this.isNever())return!0;const r=this.intersect(e);return!(r instanceof N)&&this.equals(r)}ifExtends(e){return this.extends(e)?this:void 0}subsumes(e){return this.$.parseDefinition(e).extends(this)}configure(e,r="shallow"){return this.configureReferences(e,r)}describe(e,r="shallow"){return this.configure({description:e},r)}optional(){return[this,"?"]}default(e){return ti(this,e,null),[this,"=",e]}from(e){return this.assert(e)}_pipe(...e){const r=e.reduce((n,i)=>n.rawPipeOnce(i),this);return this.$.finalize(r)}tryPipe(...e){const r=e.reduce((n,i)=>n.rawPipeOnce(D(i,"root")?i:((s,a)=>{try{return i(s,a)}catch(l){return a.error({code:"predicate",predicate:i,actual:`aborted due to error:
    ${l}
`})}})),this);return this.$.finalize(r)}pipe=Object.assign(this._pipe.bind(this),{try:this.tryPipe.bind(this)});to(e){return this.$.finalize(this.toNode(this.$.parseDefinition(e)))}toNode(e){const r=Sn(this,e,this.$);return r instanceof N?r.throw():r}rawPipeOnce(e){return D(e,"root")?this.toNode(e):this.distribute(r=>r.hasKind("morph")?this.$.node("morph",{in:r.inner.in,morphs:[...r.morphs,e]}):this.$.node("morph",{in:r,morphs:[e]}),this.$.parseSchema)}narrow(e){return this.constrainOut("predicate",e)}constrain(e,r){return this._constrain("root",e,r)}constrainIn(e,r){return this._constrain("in",e,r)}constrainOut(e,r){return this._constrain("out",e,r)}_constrain(e,r,n){const i=this.$.node(r,n);if(i.isRoot())return i.isUnknown()?this:Q(`Unexpected constraint node ${i}`);const s=e==="root"?this:e==="in"?this.rawIn:this.rawOut;if(s.hasKind("morph")||i.impliedBasis&&!s.extends(i.impliedBasis))return Zc(r,i.impliedBasis,this);const a=this.$.node("intersection",{[i.kind]:i}),l=e==="out"?Sn(this,a,this.$):De(this,a,this.$);return l instanceof N&&l.throw(),this.$.finalize(l)}onUndeclaredKey(e){const r=typeof e=="string"?e:e.rule,n=typeof e=="string"?!1:e.deep;return this.$.finalize(this.transform((i,s)=>i==="structure"?r==="ignore"?Do(s,{undeclared:1}):{...s,undeclared:r}:s,n?void 0:{shouldTransform:i=>!Oe(Dr,i.kind)}))}hasEqualMorphs(e){return!this.includesTransform&&!e.includesTransform?!0:!(!it(this.shallowMorphs,e.shallowMorphs)||!it(this.flatMorphs,e.flatMorphs,{isEqual:(r,n)=>r.propString===n.propString&&(r.node.hasKind("morph")&&n.node.hasKind("morph")?r.node.hasEqualMorphs(n.node):r.node.hasKind("intersection")&&n.node.hasKind("intersection")?r.node.structure?.structuralMorphRef===n.node.structure?.structuralMorphRef:!1)}))}onDeepUndeclaredKey(e){return this.onUndeclaredKey({rule:e,deep:!0})}filter(e){return this.constrainIn("predicate",e)}divisibleBy(e){return this.constrain("divisor",e)}matching(e){return this.constrain("pattern",e)}atLeast(e){return this.constrain("min",e)}atMost(e){return this.constrain("max",e)}moreThan(e){return this.constrain("min",Ye(e))}lessThan(e){return this.constrain("max",Ye(e))}atLeastLength(e){return this.constrain("minLength",e)}atMostLength(e){return this.constrain("maxLength",e)}moreThanLength(e){return this.constrain("minLength",Ye(e))}lessThanLength(e){return this.constrain("maxLength",Ye(e))}exactlyLength(e){return this.constrain("exactLength",e)}atOrAfter(e){return this.constrain("after",e)}atOrBefore(e){return this.constrain("before",e)}laterThan(e){return this.constrain("after",Ye(e))}earlierThan(e){return this.constrain("before",Ye(e))}}const Ud="Expected a non-empty brand name after #",Pa=["draft-2020-12","draft-07"],zd=t=>`JSONSchema target '${t}' is not supported (must be ${Pa.map(e=>`"${e}"`).join(" or ")})`,Ti=t=>(Oe(Pa,t)||P(zd(t)),t),Ye=t=>typeof t=="object"&&!(t instanceof Date)?{...t,exclusive:!0}:{rule:t,exclusive:!0},qt=(t,e)=>D(e,"root")?D(t,"root")?t.extends(e):e.allows(t):D(t,"root")?t.hasUnit(e):e===t,Bi=t=>t.hasKind("morph")?null:t.hasKind("intersection")?t.inner.structure??(t.basis?.domain==="object"?t.$.bindReference(M.intrinsic.emptyStructure):null):t.isBasis()&&t.domain==="object"?t.$.bindReference(M.intrinsic.emptyStructure):null,Hd=t=>`Props cannot be extracted from a union. Use .distribute to extract props from each branch instead. Received:
${t}`,qi=(t,e)=>`${t} operand must be an object (was ${e})`,Et=(t,e)=>F(Qn(t),(r,n)=>[n,e]),Vd=t=>typeof t=="string"?{reference:t}:t,Fi=t=>t instanceof N?M.intrinsic.never.internal:t,Gd=V({kind:"alias",hasAssociatedError:!1,collapsibleKey:"reference",keys:{reference:{serialize:t=>t.startsWith("$")?t:`$ark.${t}`},resolve:{}},normalize:Vd,defaults:{description:t=>t.reference},intersections:{alias:(t,e,r)=>r.$.lazilyResolve(()=>Fi(ee(t.resolution,e.resolution,r)),`${t.reference}${r.pipe?"=>":"&"}${e.reference}`),...Et("alias",(t,e,r)=>e.isUnknown()?t:e.isNever()?e:e.isBasis()&&!e.overlaps(M.intrinsic.object)?N.init("assignability",M.intrinsic.object,e):r.$.lazilyResolve(()=>Fi(ee(t.resolution,e,r)),`${t.reference}${r.pipe?"=>":"&"}${e.id}`))}});class Wd extends Dt{expression=this.reference;structure=void 0;get resolution(){const e=this._resolve();return me[this.id]=e}_resolve(){if(this.resolve)return this.resolve();if(this.reference[0]==="$")return this.$.resolveRoot(this.reference.slice(1));const e=this.reference;let r=me[e];const n=[];for(;D(r,"context");){if(n.includes(r.id))return P(Jd(r.id,n));n.push(r.id),r=me[r.id]}return D(r,"root")?r:Q(`Unexpected resolution for reference ${this.reference}
Seen: [${n.join("->")}] 
Resolution: ${B(r)}`)}get resolutionId(){if(this.reference.includes("&")||this.reference.includes("=>"))return this.resolution.id;if(this.reference[0]!=="$")return this.reference;const e=this.reference.slice(1),r=this.$.resolutions[e];return typeof r=="string"?r:D(r,"root")?r.id:Q(`Unexpected resolution for reference ${this.reference}: ${B(r)}`)}get defaultShortDescription(){return Me.object}innerToJsonSchema(e){return this.resolution.toJsonSchemaRecurse(e)}traverseAllows=(e,r)=>{const n=r.seen[this.reference];return n?.includes(e)?!0:(r.seen[this.reference]=q(n,e),this.resolution.traverseAllows(e,r))};traverseApply=(e,r)=>{const n=r.seen[this.reference];n?.includes(e)||(r.seen[this.reference]=q(n,e),this.resolution.traverseApply(e,r))};compile(e){const r=this.resolutionId;e.if(`ctx.seen.${r} && ctx.seen.${r}.includes(data)`,()=>e.return(!0)),e.if(`!ctx.seen.${r}`,()=>e.line(`ctx.seen.${r} = []`)),e.line(`ctx.seen.${r}.push(data)`),e.return(e.invoke(r))}}const Jd=(t,e)=>`Alias '${t}' has a shallow resolution cycle: ${[...e,t].join("->")}`,ri={implementation:Gd,Node:Wd};class ni extends Dt{traverseApply=(e,r)=>{this.traverseAllows(e,r)||r.errorFromNodeContext(this.errorContext)};get errorContext(){return{code:this.kind,description:this.description,meta:this.meta,...this.inner}}get compiledErrorContext(){return Lr(this.errorContext)}compile(e){e.traversalKind==="Allows"?e.return(this.compiledCondition):e.if(this.compiledNegation,()=>e.line(`ctx.errorFromNodeContext(${this.compiledErrorContext})`))}}const Yd=V({kind:"domain",hasAssociatedError:!0,collapsibleKey:"domain",keys:{domain:{},numberAllowsNaN:{}},normalize:t=>typeof t=="string"?{domain:t}:Hn(t,"numberAllowsNaN")&&t.domain!=="number"?P(ii.writeBadAllowNanMessage(t.domain)):t,applyConfig:(t,e)=>t.numberAllowsNaN===void 0&&t.domain==="number"&&e.numberAllowsNaN?{...t,numberAllowsNaN:!0}:t,defaults:{description:t=>Me[t.domain],actual:t=>Number.isNaN(t)?"NaN":Me[be(t)]},intersections:{domain:(t,e)=>t.domain==="number"&&e.domain==="number"?t.numberAllowsNaN?e:t:N.init("domain",t,e)}});class Qd extends ni{requiresNaNCheck=this.domain==="number"&&!this.numberAllowsNaN;traverseAllows=this.requiresNaNCheck?e=>typeof e=="number"&&!Number.isNaN(e):e=>be(e)===this.domain;compiledCondition=this.domain==="object"?'((typeof data === "object" && data !== null) || typeof data === "function")':`typeof data === "${this.domain}"${this.requiresNaNCheck?" && !Number.isNaN(data)":""}`;compiledNegation=this.domain==="object"?'((typeof data !== "object" || data === null) && typeof data !== "function")':`typeof data !== "${this.domain}"${this.requiresNaNCheck?" || Number.isNaN(data)":""}`;expression=this.numberAllowsNaN?"number | NaN":this.domain;get nestableExpression(){return this.numberAllowsNaN?`(${this.expression})`:this.expression}get defaultShortDescription(){return Me[this.domain]}innerToJsonSchema(e){return this.domain==="bigint"||this.domain==="symbol"?e.fallback.domain({code:"domain",base:{},domain:this.domain}):{type:this.domain}}}const ii={implementation:Yd,Node:Qd,writeBadAllowNanMessage:t=>`numberAllowsNaN may only be specified with domain "number" (was ${t})`},Xd=V({kind:"intersection",hasAssociatedError:!0,normalize:t=>{if(se(t))return t;const{structure:e,...r}=t,n=!!e,i=e??{},s=F(r,(a,l)=>_e(a,qc)?(n&&P(`Flattened structure key ${a} cannot be specified alongside a root 'structure' key.`),i[a]=l,[]):[a,l]);return(D(i,"constraint")||!Ot(i))&&(s.structure=i),s},finalizeInnerJson:({structure:t,...e})=>We(t,"object")?{...t,...e}:e,keys:{domain:{child:!0,parse:(t,e)=>e.$.node("domain",t)},proto:{child:!0,parse:(t,e)=>e.$.node("proto",t)},structure:{child:!0,parse:(t,e)=>e.$.node("structure",t),serialize:t=>{if(!t.sequence?.minLength)return t.collapsibleJson;const{sequence:e,...r}=t.collapsibleJson,{minVariadicLength:n,...i}=e,s=i.variadic&&Object.keys(i).length===1?i.variadic:i;return{...r,sequence:s}}},divisor:{child:!0,parse:le("divisor")},max:{child:!0,parse:le("max")},min:{child:!0,parse:le("min")},maxLength:{child:!0,parse:le("maxLength")},minLength:{child:!0,parse:le("minLength")},exactLength:{child:!0,parse:le("exactLength")},before:{child:!0,parse:le("before")},after:{child:!0,parse:le("after")},pattern:{child:!0,parse:le("pattern")},predicate:{child:!0,parse:le("predicate")}},reduce:(t,e)=>Ki({},t,{$:e,invert:!1,pipe:!1}),defaults:{description:t=>{if(t.children.length===0)return"unknown";if(t.structure)return t.structure.description;const e=[];if(t.basis&&!t.prestructurals.some(r=>r.impl.obviatesBasisDescription)&&e.push(t.basis.description),t.prestructurals.length){const r=t.prestructurals.slice().sort((n,i)=>n.kind==="min"&&i.kind==="max"?-1:0).map(n=>n.description);e.push(...r)}return t.inner.predicate&&e.push(...t.inner.predicate.map(r=>r.description)),e.join(" and ")},expected:t=>`  ◦ ${t.errors.map(e=>e.expected).join(`
  ◦ `)}`,problem:t=>`(${t.actual}) must be...
${t.expected}`},intersections:{intersection:(t,e,r)=>Ki(t.inner,e.inner,r),...Et("intersection",(t,e,r)=>{if(t.children.length===0)return e;const{domain:n,proto:i,...s}=t.inner,a=i??n,l=a?ee(a,e,r):e;return l instanceof N?l:t?.basis?.equals(l)?t:t.$.node("intersection",{...s,[l.kind]:l},{prereduced:!0})})}});class Zd extends Dt{basis=this.inner.domain??this.inner.proto??null;prestructurals=[];refinements=this.children.filter(e=>e.isRefinement()?(Oe(Qo,e.kind)&&this.prestructurals.push(e),!0):!1);structure=this.inner.structure;expression=eh(this);get shallowMorphs(){return this.inner.structure?.structuralMorph?[this.inner.structure.structuralMorph]:[]}get defaultShortDescription(){return this.basis?.defaultShortDescription??"present"}innerToJsonSchema(e){return this.children.reduce((r,n)=>n.isBasis()?n.toJsonSchemaRecurse(e):n.reduceJsonSchema(r,e),{})}traverseAllows=(e,r)=>this.children.every(n=>n.traverseAllows(e,r));traverseApply=(e,r)=>{const n=r.currentErrorCount;if(!(this.basis&&(this.basis.traverseApply(e,r),r.currentErrorCount>n))){if(this.prestructurals.length){for(let i=0;i<this.prestructurals.length-1;i++)if(this.prestructurals[i].traverseApply(e,r),r.failFast&&r.currentErrorCount>n)return;if(this.prestructurals[this.prestructurals.length-1].traverseApply(e,r),r.currentErrorCount>n)return}if(!(this.structure&&(this.structure.traverseApply(e,r),r.currentErrorCount>n))&&this.inner.predicate){for(let i=0;i<this.inner.predicate.length-1;i++)if(this.inner.predicate[i].traverseApply(e,r),r.failFast&&r.currentErrorCount>n)return;this.inner.predicate[this.inner.predicate.length-1].traverseApply(e,r)}}};compile(e){if(e.traversalKind==="Allows"){for(const r of this.children)e.check(r);e.return(!0);return}if(e.initializeErrorCount(),this.basis&&(e.check(this.basis),this.children.length>1&&e.returnIfFail()),this.prestructurals.length){for(let r=0;r<this.prestructurals.length-1;r++)e.check(this.prestructurals[r]),e.returnIfFailFast();e.check(this.prestructurals[this.prestructurals.length-1]),(this.structure||this.inner.predicate)&&e.returnIfFail()}if(this.structure&&(e.check(this.structure),this.inner.predicate&&e.returnIfFail()),this.inner.predicate){for(let r=0;r<this.inner.predicate.length-1;r++)e.check(this.inner.predicate[r]),e.returnIfFail();e.check(this.inner.predicate[this.inner.predicate.length-1])}}}const Ia={implementation:Xd,Node:Zd},eh=t=>{if(t.structure?.expression)return t.structure.expression;const e=t.basis&&!t.prestructurals.some(i=>i.impl.obviatesBasisExpression)?t.basis.nestableExpression:"",r=t.prestructurals.map(i=>i.expression).join(" & "),n=`${e}${e?" ":""}${r}`;return n==="Array == 0"?"[]":n||"unknown"},Ki=(t,e,r)=>{const n={},i=t.proto??t.domain,s=e.proto??e.domain,a=i?s?ee(i,s,r):i:s;return a instanceof N?a:(a&&(n[a.kind]=a),xr({kind:"intersection",baseInner:n,l:wr(t),r:wr(e),roots:[],ctx:r}))},th=V({kind:"morph",hasAssociatedError:!1,keys:{in:{child:!0,parse:(t,e)=>e.$.parseSchema(t)},morphs:{parse:Ct,serialize:t=>t.map(e=>D(e,"root")?e.json:oe(e))},declaredIn:{child:!1,serialize:t=>t.json},declaredOut:{child:!1,serialize:t=>t.json}},normalize:t=>t,defaults:{description:t=>`a morph from ${t.rawIn.description} to ${t.rawOut?.description??"unknown"}`},intersections:{morph:(t,e,r)=>{if(!t.hasEqualMorphs(e))return P(nh(t.expression,e.expression));const n=ee(t.rawIn,e.rawIn,r);if(n instanceof N)return n;const i={morphs:t.morphs};if(t.declaredIn||e.declaredIn){const s=ee(t.rawIn,e.rawIn,r);if(s instanceof N)return s.throw();i.declaredIn=s}if(t.declaredOut||e.declaredOut){const s=ee(t.rawOut,e.rawOut,r);if(s instanceof N)return s.throw();i.declaredOut=s}return n.distribute(s=>r.$.node("morph",{...i,in:s}),r.$.parseSchema)},...Et("morph",(t,e,r)=>{const n=t.inner.in?ee(t.inner.in,e,r):e;return n instanceof N?n:n.equals(t.inner.in)?t:r.$.node("morph",{...t.inner,in:n})})}});class rh extends Dt{serializedMorphs=this.morphs.map(oe);compiledMorphs=`[${this.serializedMorphs}]`;lastMorph=this.inner.morphs[this.inner.morphs.length-1];lastMorphIfNode=D(this.lastMorph,"root")?this.lastMorph:void 0;introspectableIn=this.inner.in;introspectableOut=this.lastMorphIfNode?Object.assign(this.referencesById,this.lastMorphIfNode.referencesById)&&this.lastMorphIfNode.rawOut:void 0;get shallowMorphs(){return Array.isArray(this.inner.in?.shallowMorphs)?[...this.inner.in.shallowMorphs,...this.morphs]:this.morphs}get rawIn(){return this.declaredIn??this.inner.in?.rawIn??M.intrinsic.unknown.internal}get rawOut(){return this.declaredOut??this.introspectableOut??M.intrinsic.unknown.internal}declareIn(e){return this.$.node("morph",{...this.inner,declaredIn:e})}declareOut(e){return this.$.node("morph",{...this.inner,declaredOut:e})}expression=`(In: ${this.rawIn.expression}) => ${this.lastMorphIfNode?"To":"Out"}<${this.rawOut.expression}>`;get defaultShortDescription(){return this.rawIn.meta.description??this.rawIn.defaultShortDescription}innerToJsonSchema(e){return e.fallback.morph({code:"morph",base:this.rawIn.toJsonSchemaRecurse(e),out:this.introspectableOut?.toJsonSchemaRecurse(e)??null})}compile(e){if(e.traversalKind==="Allows"){if(!this.introspectableIn)return;e.return(e.invoke(this.introspectableIn));return}this.introspectableIn&&e.line(e.invoke(this.introspectableIn)),e.line(`ctx.queueMorphs(${this.compiledMorphs})`)}traverseAllows=(e,r)=>!this.introspectableIn||this.introspectableIn.traverseAllows(e,r);traverseApply=(e,r)=>{this.introspectableIn&&this.introspectableIn.traverseApply(e,r),r.queueMorphs(this.morphs)};hasEqualMorphs(e){return it(this.morphs,e.morphs,{isEqual:(r,n)=>r===n||D(r,"root")&&D(n,"root")&&r.equals(n)})}}const Ca={implementation:th,Node:rh},nh=(t,e)=>`The intersection of distinct morphs at a single path is indeterminate:
Left: ${t}
Right: ${e}`,ih=V({kind:"proto",hasAssociatedError:!0,collapsibleKey:"proto",keys:{proto:{serialize:t=>Gn(t)??Ge(t)},dateAllowsInvalid:{}},normalize:t=>{const e=typeof t=="string"?{proto:ot[t]}:typeof t=="function"?se(t)?t:{proto:t}:typeof t.proto=="string"?{...t,proto:ot[t.proto]}:t;return typeof e.proto!="function"&&P(Sr.writeInvalidSchemaMessage(e.proto)),Hn(e,"dateAllowsInvalid")&&e.proto!==Date&&P(Sr.writeBadInvalidDateMessage(e.proto)),e},applyConfig:(t,e)=>t.dateAllowsInvalid===void 0&&t.proto===Date&&e.dateAllowsInvalid?{...t,dateAllowsInvalid:!0}:t,defaults:{description:t=>t.builtinName?Zl[t.builtinName]:`an instance of ${t.proto.name}`,actual:t=>t instanceof Date&&t.toString()==="Invalid Date"?"an invalid Date":gn(t)},intersections:{proto:(t,e)=>t.proto===Date&&e.proto===Date?t.dateAllowsInvalid?e:t:Ii(t.proto,e.proto)?t:Ii(e.proto,t.proto)?e:N.init("proto",t,e),domain:(t,e)=>e.domain==="object"?t:N.init("domain",M.intrinsic.object.internal,e)}});class sh extends ni{builtinName=Gn(this.proto);serializedConstructor=this.json.proto;requiresInvalidDateCheck=this.proto===Date&&!this.dateAllowsInvalid;traverseAllows=this.requiresInvalidDateCheck?e=>e instanceof Date&&e.toString()!=="Invalid Date":e=>e instanceof this.proto;compiledCondition=`data instanceof ${this.serializedConstructor}${this.requiresInvalidDateCheck?' && data.toString() !== "Invalid Date"':""}`;compiledNegation=`!(${this.compiledCondition})`;innerToJsonSchema(e){switch(this.builtinName){case"Array":return{type:"array"};case"Date":return e.fallback.date?.({code:"date",base:{}})??e.fallback.proto({code:"proto",base:{},proto:this.proto});default:return e.fallback.proto({code:"proto",base:{},proto:this.proto})}}expression=this.dateAllowsInvalid?"Date | InvalidDate":this.proto.name;get nestableExpression(){return this.dateAllowsInvalid?`(${this.expression})`:this.expression}domain="object";get defaultShortDescription(){return this.description}}const Sr={implementation:ih,Node:sh,writeBadInvalidDateMessage:t=>`dateAllowsInvalid may only be specified with constructor Date (was ${t.name})`,writeInvalidSchemaMessage:t=>`instanceOf operand must be a function (was ${be(t)})`},oh=V({kind:"union",hasAssociatedError:!0,collapsibleKey:"branches",keys:{ordered:{},branches:{child:!0,parse:(t,e)=>{const r=[];for(const n of t){const i=D(n,"root")?n.branches:e.$.parseSchema(n).branches;for(const s of i)if(s.hasKind("morph")){const a=r.findIndex(l=>l.hasKind("morph")&&l.hasEqualMorphs(s));if(a===-1)r.push(s);else{const l=r[a];r[a]=e.$.node("morph",{...l.inner,in:l.rawIn.rawOr(s.rawIn)})}}else r.push(s)}return e.def.ordered||r.sort((n,i)=>n.hash<i.hash?-1:1),r}}},normalize:t=>ne(t)?{branches:t}:t,reduce:(t,e)=>{const r=yh(t);if(r.length===1)return r[0];if(r.length!==t.branches.length)return e.node("union",{...t,branches:r},{prereduced:!0})},defaults:{description:t=>t.distribute(e=>e.description,rt),expected:t=>{const e=Bl(t.errors,"propString"),r=Object.entries(e).map(([n,i])=>{const s=[];for(const h of i)He(s,h.expected);const a=rt(s),l=i.every(h=>h.actual===i[0].actual)?i[0].actual:B(i[0].data);return`${n&&`${n} `}must be ${a}${l&&` (was ${l})`}`});return rt(r)},problem:t=>t.expected,message:t=>t.problem[0]==="["?`value at ${t.problem}`:t.problem},intersections:{union:(t,e,r)=>{if(t.isNever!==e.isNever)return N.init("presence",t,e);let n;return t.ordered?(e.ordered&&P(vh(t.expression,e.expression)),n=Wr(e.branches,t.branches,r),n instanceof N&&n.invert()):n=Wr(t.branches,e.branches,r),n instanceof N?n:r.$.parseSchema(t.ordered||e.ordered?{branches:n,ordered:!0}:{branches:n})},...Et("union",(t,e,r)=>{const n=Wr(t.branches,[e],r);return n instanceof N?n:n.length===1?n[0]:r.$.parseSchema(t.ordered?{branches:n,ordered:!0}:{branches:n})})}});class ah extends Dt{isBoolean=this.branches.length===2&&this.branches[0].hasUnit(!1)&&this.branches[1].hasUnit(!0);get branchGroups(){const e=[];let r=-1;for(const n of this.branches){if(n.hasKind("unit")&&n.domain==="boolean"){r===-1?(r=e.length,e.push(n)):e[r]=M.intrinsic.boolean;continue}e.push(n)}return e}unitBranches=this.branches.filter(e=>e.rawIn.hasKind("unit"));discriminant=this.discriminate();discriminantJson=this.discriminant?ph(this.discriminant):null;expression=this.distribute(e=>e.nestableExpression,gh);createBranchedOptimisticRootApply(){return(e,r)=>{const n=this.traverseOptimistic(e);if(n!==xe)return n;const i=new tt(e,this.$.resolvedConfig);return this.traverseApply(e,i),i.finalize(r)}}get shallowMorphs(){return this.branches.reduce((e,r)=>He(e,r.shallowMorphs),[])}get defaultShortDescription(){return this.distribute(e=>e.defaultShortDescription,rt)}innerToJsonSchema(e){if(this.branchGroups.length===1&&this.branchGroups[0].equals(M.intrinsic.boolean))return{type:"boolean"};const r=this.branchGroups.map(n=>n.toJsonSchemaRecurse(e));return r.every(n=>Object.keys(n).length===1&&Hn(n,"const"))?{enum:r.map(n=>n.const)}:{anyOf:r}}traverseAllows=(e,r)=>this.branches.some(n=>n.traverseAllows(e,r));traverseApply=(e,r)=>{const n=[];for(let i=0;i<this.branches.length;i++){if(r.pushBranch(),this.branches[i].traverseApply(e,r),!r.hasError())return this.branches[i].includesTransform?r.queuedMorphs.push(...r.popBranch().queuedMorphs):r.popBranch();n.push(r.popBranch().error)}r.errorFromNodeContext({code:"union",errors:n,meta:this.meta})};traverseOptimistic=e=>{for(let r=0;r<this.branches.length;r++){const n=this.branches[r];if(n.traverseAllows(e))return n.contextFreeMorph?n.contextFreeMorph(e):e}return xe};compile(e){if(!this.discriminant||this.unitBranches.length===this.branches.length&&this.branches.length===2)return this.compileIndiscriminable(e);let r=this.discriminant.optionallyChainedPropString;this.discriminant.kind==="domain"&&(r=`typeof ${r} === "object" ? ${r} === null ? "null" : "object" : typeof ${r} === "function" ? "object" : typeof ${r}`);const n=this.discriminant.cases,i=Object.keys(n),{optimistic:s}=e;if(e.optimistic=!1,e.block(`switch(${r})`,()=>{for(const f in n){const p=n[f],c=f==="default"?f:`case ${f}`;let u;p===!0?u=s?"data":"true":s?p.rootApplyStrategy==="branchedOptimistic"?u=e.invoke(p,{kind:"Optimistic"}):p.contextFreeMorph?u=`${e.invoke(p)} ? ${oe(p.contextFreeMorph)}(data) : "${xe}"`:u=`${e.invoke(p)} ? data : "${xe}"`:u=e.invoke(p),e.line(`${c}: return ${u}`)}return e}),e.traversalKind==="Allows"){e.return(s?`"${xe}"`:!1);return}const a=rt(this.discriminant.kind==="domain"?i.map(f=>{const p=f.slice(1,-1);return p==="function"?Me.object:Me[p]}):i),l=this.discriminant.path.map(f=>typeof f=="symbol"?oe(f):JSON.stringify(f)),h=JSON.stringify(a),d=this.discriminant.kind==="domain"?`${hh}[${r}]`:`${fh}(${r})`;e.line(`ctx.errorFromNodeContext({
	code: "predicate",
	expected: ${h},
	actual: ${d},
	relativePath: [${l}],
	meta: ${this.compiledMeta}
})`)}compileIndiscriminable(e){if(e.traversalKind==="Apply"){e.const("errors","[]");for(const r of this.branches)e.line("ctx.pushBranch()").line(e.invoke(r)).if("!ctx.hasError()",()=>e.return(r.includesTransform?"ctx.queuedMorphs.push(...ctx.popBranch().queuedMorphs)":"ctx.popBranch()")).line("errors.push(ctx.popBranch().error)");e.line(`ctx.errorFromNodeContext({ code: "union", errors, meta: ${this.compiledMeta} })`)}else{const{optimistic:r}=e;e.optimistic=!1;for(const n of this.branches)e.if(`${e.invoke(n)}`,()=>e.return(r?n.contextFreeMorph?`${oe(n.contextFreeMorph)}(data)`:"data":!0));e.return(r?`"${xe}"`:!1)}}get nestableExpression(){return this.isBoolean?"boolean":`(${this.expression})`}discriminate(){if(this.branches.length<2||this.isCyclic)return null;if(this.unitBranches.length===this.branches.length){const s=F(this.unitBranches,(a,l)=>[`${l.rawIn.serializedValue}`,l.hasKind("morph")?l:!0]);return{kind:"unit",path:[],optionallyChainedPropString:"data",cases:s}}const e=[];for(let s=0;s<this.branches.length-1;s++){const a=this.branches[s];for(let l=s+1;l<this.branches.length;l++){const h=this.branches[l],d=De(a.rawIn,h.rawIn,a.$);if(d instanceof N)for(const f of d){if(!f.kind||f.optional)continue;let p,c;if(f.kind==="domain"){const o=f.l,g=f.r;p=`"${typeof o=="string"?o:o.domain}"`,c=`"${typeof g=="string"?g:g.domain}"`}else if(f.kind==="unit")p=f.l.serializedValue,c=f.r.serializedValue;else continue;const u=e.find(o=>it(o.path,f.path)&&o.kind===f.kind);u?(u.cases[p]?u.cases[p].branchIndices=He(u.cases[p].branchIndices,s):u.cases[p]??={branchIndices:[s],condition:f.l},u.cases[c]?u.cases[c].branchIndices=He(u.cases[c].branchIndices,l):u.cases[c]??={branchIndices:[l],condition:f.r}):e.push({kind:f.kind,cases:{[p]:{branchIndices:[s],condition:f.l},[c]:{branchIndices:[l],condition:f.r}},path:f.path})}}}const r=this.ordered?ch(e,this.branches):e;if(!r.length)return null;const n=uh(r,this),i={};for(const s in n.best.cases){const a=lh(n,s);if(a===null){i[s]=!0;continue}if(a.length===this.branches.length)return null;this.ordered&&a.sort((d,f)=>d.originalIndex-f.originalIndex);const l=a.map(d=>d.branch),h=l.length===1?l[0]:this.$.node("union",this.ordered?{branches:l,ordered:!0}:l);Object.assign(this.referencesById,h.referencesById),i[s]=h}if(n.defaultEntries.length){const s=n.defaultEntries.map(a=>a.branch);i.default=this.$.node("union",this.ordered?{branches:s,ordered:!0}:s,{prereduced:!0}),Object.assign(this.referencesById,i.default.referencesById)}return Object.assign(n.location,{cases:i})}}const uh=(t,e)=>{const n=t.sort((a,l)=>a.path.length===l.path.length?Object.keys(l.cases).length-Object.keys(a.cases).length:a.path.length-l.path.length)[0],i={kind:n.kind,path:n.path,optionallyChainedPropString:Oa(n.path)},s=e.branches.map((a,l)=>({originalIndex:l,branch:a}));return{best:n,location:i,defaultEntries:s,node:e}},lh=(t,e)=>{const r=t.best.cases[e],n=dh(r.condition,t.location.path,t.node.$);let i=[];const s=[];for(let a=0;a<t.defaultEntries.length;a++){const l=t.defaultEntries[a];if(r.branchIndices.includes(l.originalIndex)){const h=ji(t.node.branches[l.originalIndex],t.location);h===null?i=null:i?.push({originalIndex:l.originalIndex,branch:h})}else if(l.branch.hasKind("alias")&&n.hasKind("domain")&&n.domain==="object")i?.push(l);else{if(l.branch.rawIn.overlaps(n)){const h=ji(l.branch,t.location);i?.push({originalIndex:l.originalIndex,branch:h})}s.push(l)}}return t.defaultEntries=s,i},ch=(t,e)=>t.filter(n=>{const i=Object.values(n.cases).map(s=>s.branchIndices);for(let s=0;s<i.length-1;s++){const a=i[s];for(let l=s+1;l<i.length;l++){const h=i[l];for(const d of a)for(const f of h)if(d>f&&e[d].overlaps(e[f]))return!1}}return!0}),dh=(t,e,r)=>{let n=t==="undefined"?r.node("unit",{unit:void 0}):t==="null"?r.node("unit",{unit:null}):t==="boolean"?r.units([!0,!1]):t;for(let i=e.length-1;i>=0;i--){const s=e[i];n=r.node("intersection",typeof s=="number"?{proto:"Array",sequence:[...Rl(s).map(a=>({})),n]}:{domain:"object",required:[{key:s,value:n}]})}return n},Oa=t=>t.reduce((e,r)=>e+Wo(r,!0),"data"),hh=oe(ql),fh=oe(B),Ma={implementation:oh,Node:ah},ph=t=>({kind:t.kind,path:t.path.map(e=>typeof e=="string"?e:ct(e)),cases:F(t.cases,(e,r)=>[e,r===!0?r:r.hasKind("union")&&r.discriminantJson?r.discriminantJson:r.json])}),mh={delimiter:" | ",finalDelimiter:" | "},gh=t=>rt(t,mh),rt=(t,e)=>{const r=e?.delimiter??", ",n=e?.finalDelimiter??" or ";if(t.length===0)return"never";if(t.length===1)return t[0];if(t.length===2&&t[0]==="false"&&t[1]==="true"||t[0]==="true"&&t[1]==="false")return"boolean";const i={},s=t.filter(l=>i[l]?!1:i[l]=!0),a=s.pop();return`${s.join(r)}${s.length?n:""}${a}`},Wr=(t,e,r)=>{const n=e.map(()=>[]);for(let s=0;s<t.length;s++){let a={};for(let l=0;l<e.length;l++){if(n[l]===null)continue;if(t[s].equals(e[l])){n[l]=null,a={};break}const h=ee(t[s],e[l],r);if(!(h instanceof N)){if(h.equals(t[s])){n[l].push(t[s]),a={};break}h.equals(e[l])?n[l]=null:a[l]=h}}for(const l in a)n[l][s]=a[l]}const i=n.flatMap((s,a)=>s?.flatMap(l=>l.branches)??e[a]);return i.length===0?N.init("union",t,e):i},yh=({branches:t,ordered:e})=>{if(t.length<2)return t;const r=t.map(()=>!0);for(let n=0;n<t.length;n++)for(let i=n+1;i<t.length&&r[n]&&r[i];i++){if(t[n].equals(t[i])){r[i]=!1;continue}const s=De(t[n].rawIn,t[i].rawIn,t[0].$);s instanceof N||(e||bh(t[n],t[i]),s.equals(t[n].rawIn)?r[n]=!!e:s.equals(t[i].rawIn)&&(r[i]=!1))}return t.filter((n,i)=>r[i])},bh=(t,e)=>{!t.includesTransform&&!e.includesTransform||(it(t.shallowMorphs,e.shallowMorphs)||P(Ui(t.expression,e.expression)),it(t.flatMorphs,e.flatMorphs,{isEqual:(r,n)=>r.propString===n.propString&&(r.node.hasKind("morph")&&n.node.hasKind("morph")?r.node.hasEqualMorphs(n.node):r.node.hasKind("intersection")&&n.node.hasKind("intersection")?r.node.structure?.structuralMorphRef===n.node.structure?.structuralMorphRef:!1)})||P(Ui(t.expression,e.expression)))},ji=(t,e)=>t.transform((r,n)=>r==="domain"||r==="unit"?null:n,{shouldTransform:(r,n)=>{const i=Oa(n.path);return e.optionallyChainedPropString.startsWith(i)?r.hasKind("domain")&&r.domain==="object"||(r.hasKind("domain")||e.kind==="unit")&&i===e.optionallyChainedPropString?!0:r.children.length!==0&&r.kind!=="index":!1}}),Ui=(t,e)=>`An unordered union of a type including a morph and a type with overlapping input is indeterminate:
Left: ${t}
Right: ${e}`,vh=(t,e)=>`The intersection of two ordered unions is indeterminate:
Left: ${t}
Right: ${e}`,xh=V({kind:"unit",hasAssociatedError:!0,keys:{unit:{preserveUndefined:!0,serialize:t=>t instanceof Date?t.toISOString():Ge(t)}},normalize:t=>t,defaults:{description:t=>B(t.unit),problem:({expected:t,actual:e})=>`${t===e?`must be reference equal to ${t} (serialized to the same value)`:`must be ${t} (was ${e})`}`},intersections:{unit:(t,e)=>N.init("unit",t,e),...Et("unit",(t,e)=>{if(e.allows(t.unit))return t;const r=e.hasKind("intersection")?e.basis:e;if(r){const n=r.hasKind("domain")?r:M.intrinsic.object;if(t.domain!==n.domain){const i=t.domain==="undefined"||t.domain==="null"||t.domain==="boolean"?t.domain:M.intrinsic[t.domain];return N.init("domain",i,n)}}return N.init("assignability",t,e.hasKind("intersection")?e.children.find(n=>!n.allows(t.unit)):e)})}});class wh extends ni{compiledValue=this.json.unit;serializedValue=typeof this.unit=="string"||this.unit instanceof Date?JSON.stringify(this.compiledValue):`${this.compiledValue}`;compiledCondition=zi(this.unit,this.serializedValue);compiledNegation=zi(this.unit,this.serializedValue,"negated");expression=B(this.unit);domain=be(this.unit);get defaultShortDescription(){return this.domain==="object"?Me.object:this.description}innerToJsonSchema(e){return this.unit===null?{type:"null"}:M.intrinsic.jsonPrimitive.allows(this.unit)?{const:this.unit}:e.fallback.unit({code:"unit",base:{},unit:this.unit})}traverseAllows=this.unit instanceof Date?e=>e instanceof Date&&e.toISOString()===this.compiledValue:Number.isNaN(this.unit)?e=>Number.isNaN(e):e=>e===this.unit}const Aa={implementation:xh,Node:wh},zi=(t,e,r)=>{if(t instanceof Date){const n=`data instanceof Date && data.toISOString() === ${e}`;return r?`!(${n})`:n}return Number.isNaN(t)?`${r?"!":""}Number.isNaN(data)`:`data ${r?"!":"="}== ${e}`},kh=V({kind:"index",hasAssociatedError:!1,intersectionIsOpen:!0,keys:{signature:{child:!0,parse:(t,e)=>{const r=e.$.parseSchema(t);if(!r.extends(M.intrinsic.key))return P(Ph(r.expression));const n=r.branches.filter(i=>i.hasKind("unit"));return n.length?P(_h(n.map(i=>B(i.unit)))):r}},value:{child:!0,parse:(t,e)=>e.$.parseSchema(t)}},normalize:t=>t,defaults:{description:t=>`[${t.signature.expression}]: ${t.value.description}`},intersections:{index:(t,e,r)=>{if(t.signature.equals(e.signature)){const n=ee(t.value,e.value,r),i=n instanceof N?M.intrinsic.never.internal:n;return r.$.node("index",{signature:t.signature,value:i})}return t.signature.extends(e.signature)&&t.value.subsumes(e.value)?e:e.signature.extends(t.signature)&&e.value.subsumes(t.value)?t:null}}});class Sh extends dt{impliedBasis=M.intrinsic.object.internal;expression=`[${this.signature.expression}]: ${this.value.expression}`;flatRefs=q(this.value.flatRefs.map(e=>Be([this.signature,...e.path],e.node)),Be([this.signature],this.value));traverseAllows=(e,r)=>gr(e).every(n=>this.signature.traverseAllows(n[0],r)?Ne(n[0],()=>this.value.traverseAllows(n[1],r),r):!0);traverseApply=(e,r)=>{for(const n of gr(e))this.signature.traverseAllows(n[0],r)&&Ne(n[0],()=>this.value.traverseApply(n[1],r),r)};_transform(e,r){r.path.push(this.signature);const n=super._transform(e,r);return r.path.pop(),n}compile(){}}const Na={implementation:kh,Node:Sh},_h=t=>`Index keys ${t.join(", ")} should be specified as named props.`,Ph=t=>`Indexed key definition '${t}' must be a string or symbol`,Ih=V({kind:"required",hasAssociatedError:!0,intersectionIsOpen:!0,keys:{key:{},value:{child:!0,parse:(t,e)=>e.$.parseSchema(t)}},normalize:t=>t,defaults:{description:t=>`${t.compiledKey}: ${t.value.description}`,expected:t=>t.missingValueDescription,actual:()=>"missing"},intersections:{required:Pn,optional:Pn}});class Ch extends ka{expression=`${this.compiledKey}: ${this.value.expression}`;errorContext=Object.freeze({code:"required",missingValueDescription:this.value.defaultShortDescription,relativePath:[this.key],meta:this.meta});compiledErrorContext=Lr(this.errorContext)}const Da={implementation:Ih,Node:Ch},Oh=V({kind:"sequence",hasAssociatedError:!1,collapsibleKey:"variadic",keys:{prefix:{child:!0,parse:(t,e)=>{if(t.length!==0)return t.map(r=>e.$.parseSchema(r))}},optionals:{child:!0,parse:(t,e)=>{if(t.length!==0)return t.map(r=>e.$.parseSchema(r))}},defaultables:{child:t=>t.map(e=>e[0]),parse:(t,e)=>{if(t.length!==0)return t.map(r=>{const n=e.$.parseSchema(r[0]);return ti(n,r[1],null),[n,r[1]]})},serialize:t=>t.map(e=>[e[0].collapsibleJson,Ge(e[1])]),reduceIo:(t,e,r)=>{if(t==="in"){e.optionals=r.map(n=>n[0].rawIn);return}e.prefix=r.map(n=>n[0].rawOut)}},variadic:{child:!0,parse:(t,e)=>e.$.parseSchema(t,e)},minVariadicLength:{parse:t=>t===0?void 0:t},postfix:{child:!0,parse:(t,e)=>{if(t.length!==0)return t.map(r=>e.$.parseSchema(r))}}},normalize:t=>{if(typeof t=="string")return{variadic:t};if("variadic"in t||"prefix"in t||"defaultables"in t||"optionals"in t||"postfix"in t||"minVariadicLength"in t){if(t.postfix?.length){if(!t.variadic)return P(Eh);if(t.optionals?.length||t.defaultables?.length)return P(La)}return t.minVariadicLength&&!t.variadic?P("minVariadicLength may not be specified without a variadic element"):t}return{variadic:t}},reduce:(t,e)=>{let r=t.minVariadicLength??0;const n=t.prefix?.slice()??[],i=t.defaultables?.slice()??[],s=t.optionals?.slice()??[],a=t.postfix?.slice()??[];if(t.variadic){for(;s[s.length-1]?.equals(t.variadic);)s.pop();if(s.length===0&&i.length===0)for(;n[n.length-1]?.equals(t.variadic);)n.pop(),r++;for(;a[0]?.equals(t.variadic);)a.shift(),r++}else s.length===0&&i.length===0&&n.push(...a.splice(0));if(r!==t.minVariadicLength||t.prefix&&t.prefix.length!==n.length)return e.node("sequence",{...t,prefix:n,defaultables:i,optionals:s,postfix:a,minVariadicLength:r},{prereduced:!0})},defaults:{description:t=>t.isVariadicOnly?`${t.variadic.nestableExpression}[]`:`[${t.tuple.map(r=>r.kind==="defaultables"?`${r.node.nestableExpression} = ${B(r.default)}`:r.kind==="optionals"?`${r.node.nestableExpression}?`:r.kind==="variadic"?`...${r.node.nestableExpression}[]`:r.node.expression).join(", ")}]`},intersections:{sequence:(t,e,r)=>{const n=wt({l:t.tuple,r:e.tuple,disjoint:new N,result:[],fixedVariants:[],ctx:r}),i=n.disjoint.length===0?[n,...n.fixedVariants]:n.fixedVariants;return i.length===0?n.disjoint:i.length===1?r.$.node("sequence",Hi(i[0].result)):r.$.node("union",i.map(s=>({proto:Array,sequence:Hi(s.result)})))}}});class Mh extends dt{impliedBasis=M.intrinsic.Array.internal;tuple=Dh(this.inner);prefixLength=this.prefix?.length??0;defaultablesLength=this.defaultables?.length??0;optionalsLength=this.optionals?.length??0;postfixLength=this.postfix?.length??0;defaultablesAndOptionals=[];prevariadic=this.tuple.filter(e=>e.kind==="defaultables"||e.kind==="optionals"?(this.defaultablesAndOptionals.push(e.node),!0):e.kind==="prefix");variadicOrPostfix=Ue(this.variadic&&[this.variadic],this.postfix);flatRefs=this.addFlatRefs();addFlatRefs(){return Di(this.flatRefs,this.prevariadic.flatMap((e,r)=>q(e.node.flatRefs.map(n=>Be([`${r}`,...n.path],n.node)),Be([`${r}`],e.node)))),Di(this.flatRefs,this.variadicOrPostfix.flatMap(e=>q(e.flatRefs.map(r=>Be([M.intrinsic.nonNegativeIntegerString.internal,...r.path],r.node)),Be([M.intrinsic.nonNegativeIntegerString.internal],e)))),this.flatRefs}isVariadicOnly=this.prevariadic.length+this.postfixLength===0;minVariadicLength=this.inner.minVariadicLength??0;minLength=this.prefixLength+this.minVariadicLength+this.postfixLength;minLengthNode=this.minLength===0?null:this.$.node("minLength",this.minLength);maxLength=this.variadic?null:this.tuple.length;maxLengthNode=this.maxLength===null?null:this.$.node("maxLength",this.maxLength);impliedSiblings=this.minLengthNode?this.maxLengthNode?[this.minLengthNode,this.maxLengthNode]:[this.minLengthNode]:this.maxLengthNode?[this.maxLengthNode]:[];defaultValueMorphs=Nh(this);defaultValueMorphsReference=this.defaultValueMorphs.length?oe(this.defaultValueMorphs):void 0;elementAtIndex(e,r){if(r<this.prevariadic.length)return this.tuple[r];const n=e.length-this.postfixLength;return r>=n?{kind:"postfix",node:this.postfix[r-n]}:{kind:"variadic",node:this.variadic??Q(`Unexpected attempt to access index ${r} on ${this}`)}}traverseAllows=(e,r)=>{for(let n=0;n<e.length;n++)if(!this.elementAtIndex(e,n).node.traverseAllows(e[n],r))return!1;return!0};traverseApply=(e,r)=>{let n=0;for(;n<e.length;n++)Ne(n,()=>this.elementAtIndex(e,n).node.traverseApply(e[n],r),r)};get element(){return this.cacheGetter("element",this.$.node("union",this.children))}compile(e){if(this.prefix)for(const[r,n]of this.prefix.entries())e.traverseKey(`${r}`,`data[${r}]`,n);for(const[r,n]of this.defaultablesAndOptionals.entries()){const i=`${r+this.prefixLength}`;e.if(`${i} >= data.length`,()=>e.traversalKind==="Allows"?e.return(!0):e.return()),e.traverseKey(i,`data[${i}]`,n)}if(this.variadic&&(this.postfix&&e.const("firstPostfixIndex",`data.length${this.postfix?`- ${this.postfix.length}`:""}`),e.for(`i < ${this.postfix?"firstPostfixIndex":"data.length"}`,()=>e.traverseKey("i","data[i]",this.variadic),this.prevariadic.length),this.postfix))for(const[r,n]of this.postfix.entries()){const i=`firstPostfixIndex + ${r}`;e.traverseKey(i,`data[${i}]`,n)}e.traversalKind==="Allows"&&e.return(!0)}_transform(e,r){r.path.push(M.intrinsic.nonNegativeIntegerString.internal);const n=super._transform(e,r);return r.path.pop(),n}expression=this.description;reduceJsonSchema(e,r){const n=r.target==="draft-07";if(this.prevariadic.length){const i=this.prevariadic.map(s=>{const a=s.node.toJsonSchemaRecurse(r);if(s.kind==="defaultables"){const l=typeof s.default=="function"?s.default():s.default;a.default=M.intrinsic.jsonData.allows(l)?l:r.fallback.defaultValue({code:"defaultValue",base:a,value:l})}return a});n?e.items=i:e.prefixItems=i}if(this.minLength&&(e.minItems=this.minLength),this.variadic){const i=this.variadic.toJsonSchemaRecurse(r);if(n&&this.prevariadic.length?e.additionalItems=i:e.items=i,this.maxLength&&(e.maxItems=this.maxLength),this.postfix){const s=this.postfix.map(a=>a.toJsonSchemaRecurse(r));e=r.fallback.arrayPostfix({code:"arrayPostfix",base:e,elements:s})}}else n?e.additionalItems=!1:e.items=!1,delete e.maxItems;return e}}const Ah={},Nh=t=>{if(!t.defaultables)return[];const e=[];let r="[";const n=t.prefixLength+t.defaultablesLength-1;for(let i=t.prefixLength;i<=n;i++){const[s,a]=t.defaultables[i-t.prefixLength];e.push(_a(i,s,a)),r+=`${i}: ${s.id} = ${Ge(a)}, `}return r+="]",Ah[r]??=e},Ea={implementation:Oh,Node:Mh},Dh=t=>{const e=[];if(t.prefix)for(const r of t.prefix)e.push({kind:"prefix",node:r});if(t.defaultables)for(const[r,n]of t.defaultables)e.push({kind:"defaultables",node:r,default:n});if(t.optionals)for(const r of t.optionals)e.push({kind:"optionals",node:r});if(t.variadic&&e.push({kind:"variadic",node:t.variadic}),t.postfix)for(const r of t.postfix)e.push({kind:"postfix",node:r});return e},Hi=t=>t.reduce((e,r)=>(r.kind==="variadic"?e.variadic=r.node:r.kind==="defaultables"?e.defaultables=q(e.defaultables,[[r.node,r.default]]):e[r.kind]=q(e[r.kind],r.node),e),{}),La="A postfix required element cannot follow an optional or defaultable element",Eh="A postfix element requires a variadic element",wt=t=>{const[e,...r]=t.l,[n,...i]=t.r;if(!e||!n)return t;const s=r[r.length-1]?.kind==="postfix",a=i[i.length-1]?.kind==="postfix",l=e.kind==="prefix"||n.kind==="prefix"?"prefix":e.kind==="postfix"||n.kind==="postfix"?"postfix":e.kind==="variadic"&&n.kind==="variadic"?"variadic":s||a?"prefix":e.kind==="defaultables"||n.kind==="defaultables"?"defaultables":"optionals";if(e.kind==="prefix"&&n.kind==="variadic"&&a){const p=wt({...t,fixedVariants:[],r:i.map(c=>({...c,kind:"prefix"}))});p.disjoint.length===0&&t.fixedVariants.push(p)}else if(n.kind==="prefix"&&e.kind==="variadic"&&s){const p=wt({...t,fixedVariants:[],l:r.map(c=>({...c,kind:"prefix"}))});p.disjoint.length===0&&t.fixedVariants.push(p)}const h=ee(e.node,n.node,t.ctx);if(h instanceof N)if(l==="prefix"||l==="postfix")t.disjoint.push(...h.withPrefixKey(l==="prefix"?t.result.length:`-${r.length+1}`,Vi(e)&&Vi(n)?"required":"optional")),t.result=[...t.result,{kind:l,node:M.intrinsic.never.internal}];else return l==="optionals"||l==="defaultables"?t:wt({...t,fixedVariants:[],l:r.map(p=>({...p,kind:"prefix"})),r:r.map(p=>({...p,kind:"prefix"}))});else l==="defaultables"?(e.kind==="defaultables"&&n.kind==="defaultables"&&e.default!==n.default&&P(Sa(e.default,n.default)),t.result=[...t.result,{kind:l,node:h,default:e.kind==="defaultables"?e.default:n.kind==="defaultables"?n.default:Q(`Unexpected defaultable intersection from ${e.kind} and ${n.kind} elements.`)}]):t.result=[...t.result,{kind:l,node:h}];const d=t.l.length,f=t.r.length;return(e.kind!=="variadic"||d>=f&&(n.kind==="variadic"||f===1))&&(t.l=r),(n.kind!=="variadic"||f>=d&&(e.kind==="variadic"||d===1))&&(t.r=i),wt(t)},Vi=t=>t.kind==="prefix"||t.kind==="postfix",$a=t=>e=>{if(e.props.length||e.index){const r=e.index?.map(i=>i[t])??[];for(const i of e.props)r.push(i[t]);e.undeclared&&r.push(`+ (undeclared): ${e.undeclared}`);const n=`{ ${r.join(", ")} }`;return e.sequence?`${n} & ${e.sequence.description}`:n}return e.sequence?.description??"{}"},Lh=$a("description"),$h=$a("expression"),Gi=(t,e,r)=>{const n=t.required?"required":"optional";if(!e.signature.allows(t.key))return null;const i=De(t.value,e.value,r);return i instanceof N?n==="optional"?r.node("optional",{key:t.key,value:M.intrinsic.never.internal}):i.withPrefixKey(t.key,t.kind):null},Rh=V({kind:"structure",hasAssociatedError:!1,normalize:t=>t,applyConfig:(t,e)=>!t.undeclared&&e.onUndeclaredKey!=="ignore"?{...t,undeclared:e.onUndeclaredKey}:t,keys:{required:{child:!0,parse:le("required"),reduceIo:(t,e,r)=>{e.required=q(e.required,r.map(n=>t==="in"?n.rawIn:n.rawOut))}},optional:{child:!0,parse:le("optional"),reduceIo:(t,e,r)=>{if(t==="in"){e.optional=r.map(n=>n.rawIn);return}for(const n of r)e[n.outProp.kind]=q(e[n.outProp.kind],n.outProp.rawOut)}},index:{child:!0,parse:le("index")},sequence:{child:!0,parse:le("sequence")},undeclared:{parse:t=>t==="ignore"?void 0:t,reduceIo:(t,e,r)=>{if(r==="reject"){e.undeclared="reject";return}t==="in"?delete e.undeclared:e.undeclared="reject"}}},defaults:{description:Lh},intersections:{structure:(t,e,r)=>{const n={...t.inner},i={...e.inner},s=new N;if(t.undeclared){const h=t.keyof();for(const d of e.requiredKeys)h.allows(d)||s.add("presence",M.intrinsic.never.internal,e.propsByKey[d].value,{path:[d]});i.optional&&(i.optional=i.optional.filter(d=>h.allows(d.key))),i.index&&(i.index=i.index.flatMap(d=>{if(d.signature.extends(h))return d;const f=De(h,d.signature,r.$);if(f instanceof N)return[];const p=In(f,d.value,r.$);return p.required&&(i.required=Ue(i.required,p.required)),p.optional&&(i.optional=Ue(i.optional,p.optional)),p.index??[]}))}if(e.undeclared){const h=e.keyof();for(const d of t.requiredKeys)h.allows(d)||s.add("presence",t.propsByKey[d].value,M.intrinsic.never.internal,{path:[d]});n.optional&&(n.optional=n.optional.filter(d=>h.allows(d.key))),n.index&&(n.index=n.index.flatMap(d=>{if(d.signature.extends(h))return d;const f=De(h,d.signature,r.$);if(f instanceof N)return[];const p=In(f,d.value,r.$);return p.required&&(n.required=Ue(n.required,p.required)),p.optional&&(n.optional=Ue(n.optional,p.optional)),p.index??[]}))}const a={};(t.undeclared||e.undeclared)&&(a.undeclared=t.undeclared==="reject"||e.undeclared==="reject"?"reject":"delete");const l=xr({kind:"structure",baseInner:a,l:wr(n),r:wr(i),roots:[],ctx:r});return l instanceof N&&s.push(...l),s.length?s:l}},reduce:(t,e)=>{if(!t.required&&!t.optional)return;const r={};let n=!1;const i=t.optional?[...t.optional]:[];if(t.required)for(let s=0;s<t.required.length;s++){const a=t.required[s];if(a.key in r&&P(Ji(a.key)),r[a.key]=!0,t.index)for(const l of t.index){const h=Gi(a,l,e);if(h instanceof N)return h}}if(t.optional)for(let s=0;s<t.optional.length;s++){const a=t.optional[s];if(a.key in r&&P(Ji(a.key)),r[a.key]=!0,t.index)for(const l of t.index){const h=Gi(a,l,e);if(h instanceof N)return h;h!==null&&(i[s]=h,n=!0)}}if(n)return e.node("structure",{...t,optional:i},{prereduced:!0})}});class Th extends dt{impliedBasis=M.intrinsic.object.internal;impliedSiblings=this.children.flatMap(e=>e.impliedSiblings??[]);props=Ue(this.required,this.optional);propsByKey=F(this.props,(e,r)=>[r.key,r]);propsByKeyReference=oe(this.propsByKey);expression=$h(this);requiredKeys=this.required?.map(e=>e.key)??[];optionalKeys=this.optional?.map(e=>e.key)??[];literalKeys=[...this.requiredKeys,...this.optionalKeys];_keyof;keyof(){if(this._keyof)return this._keyof;let e=this.$.units(this.literalKeys).branches;if(this.index)for(const{signature:r}of this.index)e=e.concat(r.branches);return this._keyof=this.$.node("union",e)}map(e){return this.$.node("structure",this.props.flatMap(e).reduce((r,n)=>{const i=this.propsByKey[n.key];if(se(n))return n.kind!=="required"&&n.kind!=="optional"?P(`Map result must have kind "required" or "optional" (was ${n.kind})`):(r[n.kind]=q(r[n.kind],n),r);const s=n.kind??i?.kind??"required",a=F(n,(l,h)=>l in ei.implementation.keys?[l,h]:[]);return r[s]=q(r[s],this.$.node(s,a)),r},{}))}assertHasKeys(e){const r=e.filter(n=>!qt(n,this.keyof()));if(r.length)return P(Wi(this.expression,r))}get(e,...r){let n,i=!1;const s=Kh(e);if((typeof s=="string"||typeof s=="symbol")&&this.propsByKey[s]&&(n=this.propsByKey[s].value,i=this.propsByKey[s].required),this.index)for(const l of this.index)qt(s,l.signature)&&(n=n?.and(l.value)??l.value);if(this.sequence&&qt(s,M.intrinsic.nonNegativeIntegerString))if(D(s,"root"))this.sequence.variadic&&(n=n?.and(this.sequence.element)??this.sequence.element);else{const l=Number.parseInt(s);if(l<this.sequence.prevariadic.length){const h=this.sequence.prevariadic[l].node;n=n?.and(h)??h,i||=l<this.sequence.prefixLength}else if(this.sequence.variadic){const h=this.$.node("union",this.sequence.variadicOrPostfix);n=n?.and(h)??h}}if(!n)return this.sequence?.variadic&&D(s,"root")&&s.extends(M.intrinsic.number)?P(jh(s.expression,this.sequence.expression)):P(Wi(this.expression,[s]));const a=n.get(...r);return i?a:a.or(M.intrinsic.undefined)}pick(...e){return this.assertHasKeys(e),this.$.node("structure",this.filterKeys("pick",e))}omit(...e){return this.assertHasKeys(e),this.$.node("structure",this.filterKeys("omit",e))}optionalize(){const{required:e,...r}=this.inner;return this.$.node("structure",{...r,optional:this.props.map(n=>n.hasKind("required")?this.$.node("optional",n.inner):n)})}require(){const{optional:e,...r}=this.inner;return this.$.node("structure",{...r,required:this.props.map(n=>n.hasKind("optional")?{key:n.key,value:n.value}:n)})}merge(e){const r=this.filterKeys("omit",[e.keyof()]);return e.required&&(r.required=q(r.required,e.required)),e.optional&&(r.optional=q(r.optional,e.optional)),e.index&&(r.index=q(r.index,e.index)),e.sequence&&(r.sequence=e.sequence),e.undeclared?r.undeclared=e.undeclared:delete r.undeclared,this.$.node("structure",r)}filterKeys(e,r){const n=Yo(this.inner),i=s=>{const a=r.some(l=>qt(s,l));return e==="pick"?a:!a};return n.required&&(n.required=n.required.filter(s=>i(s.key))),n.optional&&(n.optional=n.optional.filter(s=>i(s.key))),n.index&&(n.index=n.index.filter(s=>i(s.signature))),n}traverseAllows=(e,r)=>this._traverse("Allows",e,r);traverseApply=(e,r)=>this._traverse("Apply",e,r);_traverse=(e,r,n)=>{const i=n?.currentErrorCount??0;for(let s=0;s<this.props.length;s++)if(e==="Allows"){if(!this.props[s].traverseAllows(r,n))return!1}else if(this.props[s].traverseApply(r,n),n.failFast&&n.currentErrorCount>i)return!1;if(this.sequence){if(e==="Allows"){if(!this.sequence.traverseAllows(r,n))return!1}else if(this.sequence.traverseApply(r,n),n.failFast&&n.currentErrorCount>i)return!1}if(this.index||this.undeclared==="reject"){const s=Object.keys(r);s.push(...Object.getOwnPropertySymbols(r));for(let a=0;a<s.length;a++){const l=s[a];if(this.index){for(const h of this.index)if(h.signature.traverseAllows(l,n)){if(e==="Allows"){if(!Ne(l,()=>h.value.traverseAllows(r[l],n),n))return!1}else if(Ne(l,()=>h.value.traverseApply(r[l],n),n),n.failFast&&n.currentErrorCount>i)return!1}}if(this.undeclared==="reject"&&!this.declaresKey(l)&&(e==="Allows"||(n.errorFromNodeContext({code:"predicate",expected:"removed",actual:"",relativePath:[l],meta:this.meta}),n.failFast)))return!1}}return this.structuralMorph&&n&&!n.hasError()&&n.queueMorphs([this.structuralMorph]),!0};get defaultable(){return this.cacheGetter("defaultable",this.optional?.filter(e=>e.hasDefault())??[])}declaresKey=e=>e in this.propsByKey||this.index?.some(r=>r.signature.allows(e))||this.sequence!==void 0&&M.intrinsic.nonNegativeIntegerString.allows(e);_compileDeclaresKey(e){const r=[];if(this.props.length&&r.push(`k in ${this.propsByKeyReference}`),this.index)for(const n of this.index)r.push(e.invoke(n.signature,{kind:"Allows",arg:"k"}));return this.sequence&&r.push("$ark.intrinsic.nonNegativeIntegerString.allows(k)"),r.join(" || ")||"false"}get structuralMorph(){return this.cacheGetter("structuralMorph",qh(this))}structuralMorphRef=this.structuralMorph&&oe(this.structuralMorph);compile(e){e.traversalKind==="Apply"&&e.initializeErrorCount();for(const r of this.props)e.check(r),e.traversalKind==="Apply"&&e.returnIfFailFast();if(this.sequence&&(e.check(this.sequence),e.traversalKind==="Apply"&&e.returnIfFailFast()),(this.index||this.undeclared==="reject")&&(e.const("keys","Object.keys(data)"),e.line("keys.push(...Object.getOwnPropertySymbols(data))"),e.for("i < keys.length",()=>this.compileExhaustiveEntry(e))),e.traversalKind==="Allows")return e.return(!0);this.structuralMorphRef&&e.if("ctx && !ctx.hasError()",()=>(e.line("ctx.queueMorphs(["),Fh(e,this),e.line("])")))}compileExhaustiveEntry(e){if(e.const("k","keys[i]"),this.index)for(const r of this.index)e.if(`${e.invoke(r.signature,{arg:"k",kind:"Allows"})}`,()=>e.traverseKey("k","data[k]",r.value));return this.undeclared==="reject"&&e.if(`!(${this._compileDeclaresKey(e)})`,()=>e.traversalKind==="Allows"?e.return(!1):e.line(`ctx.errorFromNodeContext({ code: "predicate", expected: "removed", actual: "", relativePath: [k], meta: ${this.compiledMeta} })`).if("ctx.failFast",()=>e.return())),e}reduceJsonSchema(e,r){switch(e.type){case"object":return this.reduceObjectJsonSchema(e,r);case"array":const n=this.sequence?.reduceJsonSchema(e,r)??e;return this.props.length||this.index?r.fallback.arrayObject({code:"arrayObject",base:n,object:this.reduceObjectJsonSchema({type:"object"},r)}):n;default:return X.throwInternalOperandError("structure",e)}}reduceObjectJsonSchema(e,r){if(this.props.length){e.properties={};for(const n of this.props){const i=n.value.toJsonSchemaRecurse(r);if(typeof n.key=="symbol"){r.fallback.symbolKey({code:"symbolKey",base:e,key:n.key,value:i,optional:n.optional});continue}if(n.hasDefault()){const s=typeof n.default=="function"?n.default():n.default;i.default=M.intrinsic.jsonData.allows(s)?s:r.fallback.defaultValue({code:"defaultValue",base:i,value:s})}e.properties[n.key]=i}this.requiredKeys.length&&e.properties&&(e.required=this.requiredKeys.filter(n=>typeof n=="string"&&n in e.properties))}if(this.index)for(const n of this.index){const i=n.value.toJsonSchemaRecurse(r);if(n.signature.equals(M.intrinsic.string)){e.additionalProperties=i;continue}for(const s of n.signature.branches){if(!s.extends(M.intrinsic.string)){e=r.fallback.symbolKey({code:"symbolKey",base:e,key:null,value:i,optional:!1});continue}let a={type:"string"};if(s.hasKind("morph")&&(a=r.fallback.morph({code:"morph",base:s.rawIn.toJsonSchemaRecurse(r),out:s.rawOut.toJsonSchemaRecurse(r)})),!s.hasKind("intersection"))return Q(`Unexpected index branch kind ${s.kind}.`);const{pattern:l}=s.inner;if(l){const h=Object.assign(a,{pattern:l[0].rule});for(let d=1;d<l.length;d++)a=r.fallback.patternIntersection({code:"patternIntersection",base:h,pattern:l[d].rule});e.patternProperties??={},e.patternProperties[h.pattern]=i}}}return this.undeclared&&!e.additionalProperties&&(e.additionalProperties=!1),e}}const Jr={},Bh=t=>{let e="";for(let r=0;r<t.defaultable.length;r++)e+=t.defaultable[r].defaultValueMorphRef;if(t.sequence?.defaultValueMorphsReference&&(e+=t.sequence?.defaultValueMorphsReference),t.undeclared==="delete"){if(e+="delete !(",t.required)for(const r of t.required)e+=r.compiledKey+" | ";if(t.optional)for(const r of t.optional)e+=r.compiledKey+" | ";if(t.index)for(const r of t.index)e+=r.signature.id+" | ";if(t.sequence)if(t.sequence.maxLength===null)e+=E.nonNegativeIntegerString.id;else for(let r=0;r<t.sequence.tuple.length;r++)e+=r+" | ";e+=")"}return e},qh=t=>{const e=Bh(t);if(!e)return;if(Jr[e])return Jr[e];const r=(n,i)=>{for(let s=0;s<t.defaultable.length;s++)t.defaultable[s].key in n||t.defaultable[s].defaultValueMorph(n,i);if(t.sequence?.defaultables)for(let s=n.length-t.sequence.prefixLength;s<t.sequence.defaultables.length;s++)t.sequence.defaultValueMorphs[s](n,i);if(t.undeclared==="delete")for(const s in n)t.declaresKey(s)||delete n[s];return n};return Jr[e]=r},Fh=(t,e)=>{const n=`(data${e.defaultable.some(i=>i.defaultValueMorph.length===2)||e.sequence?.defaultValueMorphs.some(i=>i.length===2)?", ctx":""})`;return t.block(`${n} => `,i=>{for(let s=0;s<e.defaultable.length;s++){const{serializedKey:a,defaultValueMorphRef:l}=e.defaultable[s];i.if(`!(${a} in data)`,h=>h.line(`${l}${n}`))}return e.sequence?.defaultables&&i.for(`i < ${e.sequence.defaultables.length}`,s=>s.set("data[i]",5),`data.length - ${e.sequence.prefixLength}`),e.undeclared==="delete"&&i.forIn("data",s=>s.if(`!(${e._compileDeclaresKey(s)})`,a=>a.line("delete data[k]"))),i.return("data")})},Ra={implementation:Rh,Node:Th},Kh=t=>(D(t,"root")&&t.hasKind("unit")&&(t=t.unit),typeof t=="number"&&(t=`${t}`),t),jh=(t,e)=>`${t} is not allowed as an array index on ${e}. Use the 'nonNegativeIntegerString' keyword instead.`,In=(t,e,r)=>{const[n,i]=$l(t.branches,a=>a.hasKind("unit"));if(!n.length)return{index:r.node("index",{signature:t,value:e})};const s={};for(const a of n){const l=r.node("required",{key:a.unit,value:e});s[l.kind]=q(s[l.kind],l)}return i.length&&(s.index=r.node("index",{signature:i,value:e})),s},Uh=t=>D(t,"root")?t.expression:B(t),Wi=(t,e)=>`Key${e.length===1?"":"s"} ${e.map(Uh).join(", ")} ${e.length===1?"does":"do"} not exist on ${t}`,Ji=t=>`Duplicate key ${ct(t)}`,Rr={...Ad,alias:ri.implementation,domain:ii.implementation,unit:Aa.implementation,proto:Sr.implementation,union:Ma.implementation,morph:Ca.implementation,intersection:Ia.implementation,divisor:aa.implementation,pattern:va.implementation,predicate:oa.implementation,required:Da.implementation,optional:ei.implementation,index:Na.implementation,sequence:Ea.implementation,structure:Ra.implementation};M.defaultConfig=Gl(Object.assign(F(Rr,(t,e)=>[t,e.defaults]),{jitless:nc(),clone:ec,onUndeclaredKey:"ignore",exactOptionalPropertyTypes:!0,numberAllowsNaN:!1,dateAllowsInvalid:!1,onFail:null,keywords:{},toJsonSchema:X.defaultConfig}));M.resolvedConfig=wn(M.defaultConfig,M.config);const zh={...Nd,alias:ri.Node,domain:ii.Node,unit:Aa.Node,proto:Sr.Node,union:Ma.Node,morph:Ca.Node,intersection:Ia.Node,divisor:aa.Node,pattern:va.Node,predicate:oa.Node,required:Da.Node,optional:ei.Node,index:Na.Node,sequence:Ea.Node,structure:Ra.Node};class Cn extends Ul{get[Ae](){return"module"}}const Ta=(t,e)=>new Cn(F(t,(r,n)=>[r,D(n,"module")?Ta(n,e):e.bindReference(n)])),Hh=t=>ne(t)?t:"branches"in t&&ne(t.branches)?t.branches:void 0,Vh=(t,e)=>P(`Node of kind ${e} is not valid as a ${t} definition`),Yi=t=>`#${t} duplicates public alias ${t}`,Yr={};M.ambient??={};let Qi;const Ba="function $",Gh=t=>qa(t,Fa(t)),qa=(t,e)=>{const r=e.write(Ba,4),n=e.compile()();for(const i of t)i.precompilation||(i.traverseAllows=n[`${i.id}Allows`].bind(n),i.isRoot()&&!i.allowsRequiresContext&&(i.allows=i.traverseAllows),i.traverseApply=n[`${i.id}Apply`].bind(n),n[`${i.id}Optimistic`]&&(i.traverseOptimistic=n[`${i.id}Optimistic`].bind(n)),i.precompilation=r)},Fa=t=>new Go().return(t.reduce((e,r)=>{const n=new Gr({kind:"Allows"}).indent();r.compile(n);const i=n.write(`${r.id}Allows`),s=new Gr({kind:"Apply"}).indent();r.compile(s);const a=s.write(`${r.id}Apply`),l=`${e}${i},
${a},
`;if(!r.hasKind("union"))return l;const h=new Gr({kind:"Allows",optimistic:!0}).indent();r.compile(h);const d=h.write(`${r.id}Optimistic`);return`${l}${d},
`},`{
`)+"}");class Ka{config;resolvedConfig;name;get[Ae](){return"scope"}referencesById={};references=[];resolutions={};exportedNames=[];aliases={};resolved=!1;nodesByHash={};intrinsic;constructor(e,r){this.config=wn(M.config,r),this.resolvedConfig=wn(M.resolvedConfig,r),this.name=this.resolvedConfig.name??`anonymousScope${Object.keys(Yr).length}`,this.name in Yr&&P(`A Scope already named ${this.name} already exists`),Yr[this.name]=this;const n=Object.entries(e).map(i=>this.preparseOwnAliasEntry(...i));for(const[i,s]of n){let a=i;if(i[0]==="#"?(a=i.slice(1),a in this.aliases&&P(Yi(a)),this.aliases[a]=s):(a in this.aliases&&P(Yi(i)),this.aliases[a]=s,this.exportedNames.push(a)),!D(s,"module")&&!D(s,"generic")&&!Ar(s)){const l=this.preparseOwnDefinitionFormat(s,{alias:a});this.resolutions[a]=D(l,"root")?this.bindReference(l):this.createParseContext(l).id}}Qi??=this.node("union",{branches:["string","number","object","bigint","symbol",{unit:!0},{unit:!1},{unit:void 0},{unit:null}]},{prereduced:!0}),this.nodesByHash[Qi.hash]=this.node("intersection",{},{prereduced:!0}),this.intrinsic=M.intrinsic?F(M.intrinsic,(i,s)=>i.startsWith("json")?[]:[i,this.bindReference(s)]):{}}cacheGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}get internal(){return this}_json;get json(){return this._json||this.export(),this._json}defineSchema(e){return e}generic=(...e)=>{const r=this;return(n,i)=>new kr(e,i?new sa(n):n,r,r,i??null)};units=(e,r)=>{const n=[];for(const s of e)n.includes(s)||n.push(s);const i=n.map(s=>this.node("unit",{unit:s},r));return this.node("union",i,{...r,prereduced:!0})};lazyResolutions=[];lazilyResolve(e,r){const n=this.node("alias",{reference:r??"synthetic",resolve:e},{prereduced:!0});return this.resolved||this.lazyResolutions.push(n),n}schema=(e,r)=>this.finalize(this.parseSchema(e,r));parseSchema=(e,r)=>this.node(mr(e),e,r);preparseNode(e,r,n){let i=typeof e=="string"?e:mr(r,e);if(se(r)&&r.kind===i)return r;if(i==="alias"&&!n?.prereduced){const{reference:l}=ri.implementation.normalize(r,this);if(l.startsWith("$")){const h=this.resolveRoot(l.slice(1));r=h,i=h.kind}}else if(i==="union"&&We(r,"object")){const l=Hh(r);l?.length===1&&(r=l[0],i=mr(r))}if(se(r)&&r.kind===i)return r;const a=Rr[i].normalize?.(r,this)??r;return se(a)?a.kind===i?a:Vh(i,a.kind):{...n,$:this,kind:i,def:a,prefix:n.alias??i}}bindReference(e){let r;return se(e)?r=e.$===this?e:new e.constructor(e.attachments,this):r=e.$===this?e:new kr(e.params,e.bodyDef,e.$,this,e.hkt),this.resolved||Object.assign(this.referencesById,r.referencesById),r}resolveRoot(e){return this.maybeResolveRoot(e)??P(Ha(e))}maybeResolveRoot(e){const r=this.maybeResolve(e);if(!D(r,"generic"))return r}maybeResolveSubalias(e){return On(this.aliases,e)??On(this.ambient,e)}get ambient(){return M.ambient}maybeResolve(e){const r=this.resolutions[e];if(r){if(typeof r!="string")return this.bindReference(r);const i=me[r];if(D(i,"root"))return this.resolutions[e]=i;if(D(i,"context")){if(i.phase==="resolving")return this.node("alias",{reference:`$${e}`},{prereduced:!0});if(i.phase==="resolved")return Q(`Unexpected resolved context for was uncached by its scope: ${B(i)}`);i.phase="resolving";const s=this.bindReference(this.parseOwnDefinitionFormat(i.def,i));return i.phase="resolved",me[s.id]=s,me[i.id]=s,this.resolutions[e]=s}return Q(`Unexpected nodesById entry for ${r}: ${B(i)}`)}let n=this.aliases[e]??this.ambient?.[e];return n?(n=this.normalizeRootScopeValue(n),D(n,"generic")?this.resolutions[e]=this.bindReference(n):D(n,"module")?(n.root||P(Va(e)),this.resolutions[e]=this.bindReference(n.root)):this.resolutions[e]=this.parse(n,{alias:e})):this.maybeResolveSubalias(e)}createParseContext(e){const r=e.id??xa(e.prefix);return me[r]=Object.assign(e,{[Ae]:"context",$:this,id:r,phase:"unresolved"})}traversal(e){return new tt(e,this.resolvedConfig)}import(...e){return new Cn(F(this.export(...e),(r,n)=>[`#${r}`,n]))}precompilation;_exportedResolutions;_exports;export(...e){if(!this._exports){this._exports={};for(const n of this.exportedNames){const i=this.aliases[n];this._exports[n]=D(i,"module")?Ta(i,this):Xi(this.maybeResolve(n))}for(const n of this.lazyResolutions)n.resolution;if(this._exportedResolutions=za(this,this._exports),this._json=Ua(this._exportedResolutions),Object.assign(this.resolutions,this._exportedResolutions),this.references=Object.values(this.referencesById),!this.resolvedConfig.jitless){const n=Fa(this.references);this.precompilation=n.write(Ba,4),qa(this.references,n)}this.resolved=!0}const r=e.length?e:this.exportedNames;return new Cn(F(r,(n,i)=>[i,this._exports[i]]))}resolve(e){return this.export()[e]}node=(e,r,n={})=>{const i=this.preparseNode(e,r,n);if(se(i))return this.bindReference(i);const s=this.createParseContext(i),a=wa(s),l=this.bindReference(a);return me[s.id]=l};parse=(e,r={})=>this.finalize(this.parseDefinition(e,r));parseDefinition(e,r={}){if(D(e,"root"))return this.bindReference(e);const n=this.preparseOwnDefinitionFormat(e,r);if(D(n,"root"))return this.bindReference(n);const i=this.createParseContext(n);me[i.id]=i;let s=this.bindReference(this.parseOwnDefinitionFormat(e,i));return s.isCyclic&&(s=Rd(s,i.id)),me[i.id]=s,s}finalize(e){return Xi(e),!e.precompilation&&!this.resolvedConfig.jitless&&Gh(e.references),e}}class ja extends Ka{parseOwnDefinitionFormat(e,r){return wa(r)}preparseOwnDefinitionFormat(e,r){return this.preparseNode(mr(e),e,r)}preparseOwnAliasEntry(e,r){return[e,r]}normalizeRootScopeValue(e){return e}}const Xi=t=>{const e=t.references.filter(r=>r.hasKind("alias"));for(const r of e){Object.assign(r.referencesById,r.resolution.referencesById);for(const n of t.references)r.id in n.referencesById&&Object.assign(n.referencesById,r.referencesById)}return t},Ua=t=>F(t,(e,r)=>[e,D(r,"root")||D(r,"generic")?r.json:D(r,"module")?Ua(r):Q(`Unexpected resolution ${B(r)}`)]),On=(t,e)=>{const r=e.indexOf(".");if(r===-1)return;const n=e.slice(0,r),i=t[n];if(i===void 0)return;if(!D(i,"module"))return P(Wh(n));const s=e.slice(r+1),a=i[s];if(a===void 0)return On(i,s);if(D(a,"root")||D(a,"generic"))return a;if(D(a,"module"))return a.root??P(Va(e));Q(`Unexpected resolution for alias '${e}': ${B(a)}`)},si=(t,e)=>new ja(t,e),Lt=new ja({}),za=(t,e)=>{const r={};for(const n in e){const i=e[n];if(D(i,"module")){const s=za(t,i),a=F(s,(l,h)=>[`${n}.${l}`,h]);Object.assign(r,a)}else D(i,"root")||D(i,"generic")?r[n]=i:Q(`Unexpected scope resolution ${B(i)}`)}return r},Ha=t=>`'${t}' is unresolvable`,Wh=t=>`'${t}' must reference a module to be accessed using dot syntax`,Va=t=>`Reference to submodule '${t}' must specify an alias`;Lt.export();const K=Lt.schema,oi=Lt.node;Lt.defineSchema;const Ee=Lt.generic,Ga="^(?:0|[1-9]\\d*)$",Jh=new RegExp(Ga);oe(Jh);const Wa=si({bigint:"bigint",boolean:[{unit:!1},{unit:!0}],false:{unit:!1},never:[],null:{unit:null},number:"number",object:"object",string:"string",symbol:"symbol",true:{unit:!0},unknown:{},undefined:{unit:void 0},Array,Date},{prereducedAliases:!0}).export();M.intrinsic={...Wa};const Ja=si({integer:{domain:"number",divisor:1},lengthBoundable:["string",Array],key:["string","symbol"],nonNegativeIntegerString:{domain:"string",pattern:Ga}},{prereducedAliases:!0}).export();Object.assign(M.intrinsic,Ja);const Yh=si({jsonPrimitive:["string","number",{unit:!0},{unit:!1},{unit:null}],jsonObject:{domain:"object",index:{signature:"string",value:"$jsonData"}},jsonData:["$jsonPrimitive","$jsonObject"]},{prereducedAliases:!0}).export(),E={...Wa,...Ja,...Yh,emptyStructure:oi("structure",{},{prereduced:!0})};M.intrinsic={...E};const Zi=((t,e)=>new RegExp(t,e));Object.assign(Zi,{as:Zi});const Qh=t=>typeof t=="string"&&t[0]==="d"&&(t[1]==="'"||t[1]==='"')&&t[t.length-1]===t[1],es=t=>t.toString()!=="Invalid Date",Xh=t=>t.slice(2,-1),Ya=t=>`'${t}' could not be parsed by the Date constructor`,Zh=(t,e)=>ef(t,e),ef=(t,e)=>{const r=new Date(t);if(es(r))return r;const n=kc(t);if(n!==void 0){const i=new Date(n);if(es(i))return i}return e?P(e===!0?Ya(t):e):void 0},tf=K({proto:"Array",sequence:"string",required:{key:"groups",value:["object",{unit:void 0}]}}),Qr=(t,e)=>{const r=t.scanner.shiftUntilEscapable(sf[Za[e]]);if(t.scanner.lookahead==="")return t.error(af(r,e));if(t.scanner.shift(),e in Xa){let n;try{n=new RegExp(r)}catch(i){P(String(i))}t.root=t.ctx.$.node("intersection",{domain:"string",pattern:r},{prereduced:!0}),e==="x/"&&(t.root=t.ctx.$.node("morph",{in:t.root,morphs:i=>n.exec(i),declaredOut:tf}))}else if(_e(e,Qa))t.root=t.ctx.$.node("unit",{unit:r});else{const n=Zh(r,Ya(r));t.root=t.ctx.$.node("unit",{meta:r,unit:n})}},Qa={"'":1,'"':1},rf={"/":1,"'":1,'"':1},nf={"d'":"'",'d"':'"',"'":"'",'"':'"'},Xa={"/":"/","x/":"/"},Za={...nf,...Xa},sf={"'":t=>t.lookahead==="'",'"':t=>t.lookahead==='"',"/":t=>t.lookahead==="/"},of={'"':"double-quote","'":"single-quote","/":"forward slash"},af=(t,e)=>`${e}${t} requires a closing ${of[Za[e]]}`,uf=t=>`Private type references should not include '#'. Use '${t}' instead.`,eu="Optional definitions like 'string?' are only valid as properties in an object or tuple",tu="Defaultable definitions like 'number = 0' are only valid as properties in an object or tuple",ft={"<":1,">":1,"=":1,"|":1,"&":1,")":1,"[":1,"%":1,",":1,":":1,"?":1,"#":1,...Nr},lf=(t,e)=>t===">"?e[0]==="="?e[1]==="=":e.trimStart()===""||_e(e.trimStart()[0],ft):t==="="?e[0]!=="=":t===","||t==="?",cf=(t,e,r)=>ru(t,e,r,[]),ru=(t,e,r,n)=>{const i=r.parseUntilFinalizer();return n.push(i.root),i.finalizer===">"?n.length!==e.params.length?r.error(nu(t,e.names,n.map(s=>s.expression))):n:i.finalizer===","?ru(t,e,r,n):i.error(Ho(">"))},nu=(t,e,r)=>`${t}<${e.join(", ")}> requires exactly ${e.length} args (got ${r.length}${r.length===0?"":`: ${r.join(", ")}`})`,Xr=t=>{const e=t.scanner.shiftUntilLookahead(ft);e==="keyof"?t.addPrefix("keyof"):t.root=hf(t,e)},df=(t,e,r)=>{if(r.scanner.shiftUntilNonWhitespace(),r.scanner.shift()!=="<")return r.error(nu(t,e.names,[]));const i=cf(t,e,r);return e(...i)},hf=(t,e)=>ff(t,e)??pf(t,e)??t.error(e===""?t.scanner.lookahead==="#"?uf(t.shiftedBy(1).scanner.shiftUntilLookahead(ft)):iu(t):Ha(e)),ff=(t,e)=>{if(t.ctx.args?.[e]){const n=t.ctx.args[e];return typeof n!="string"?n:t.ctx.$.node("alias",{reference:n},{prereduced:!0})}const r=t.ctx.$.maybeResolve(e);if(D(r,"root"))return r;if(r!==void 0)return D(r,"generic")?df(e,r,t):P(`Unexpected resolution ${B(r)}`)},pf=(t,e)=>{const r=Sc(e);if(r!==void 0)return t.ctx.$.node("unit",{unit:r});const n=Pc(e);if(n!==void 0)return t.ctx.$.node("unit",{unit:n})},iu=t=>{const e=t.previousOperator();return e?su(e,t.scanner.unscanned):mf(t.scanner.unscanned)},su=(t,e="")=>`Token '${t}' requires a right operand${e?` before '${e}'`:""}`,mf=t=>`Expected an expression${t?` before '${t}'`:""}`,ou=t=>t.scanner.lookahead===""?t.error(iu(t)):t.scanner.lookahead==="("?t.shiftedBy(1).reduceGroupOpen():t.scanner.lookaheadIsIn(rf)?Qr(t,t.scanner.shift()):t.scanner.lookaheadIsIn(Nr)?ou(t.shiftedBy(1)):t.scanner.lookahead==="d"?t.scanner.nextLookahead in Qa?Qr(t,`${t.scanner.shift()}${t.scanner.shift()}`):Xr(t):t.scanner.lookahead==="x"&&t.scanner.nextLookahead==="/"?t.shiftedBy(2)&&Qr(t,"x/"):Xr(t),gf={">":!0,">=":!0},yf={"<":!0,"<=":!0},_r={"<":">",">":"<","<=":">=",">=":"<=","==":"=="},bf=(t,e)=>`Left bounds are only valid when paired with right bounds (try ...${e}${t})`,au=t=>`Left-bounded expressions must specify their limits using < or <= (was ${t})`,vf=(t,e,r,n)=>`An expression may have at most one left bound (parsed ${t}${_r[e]}, ${r}${_r[n]})`,xf=(t,e)=>{const r=kf(t,e);if(t.root.hasKind("unit")){if(typeof t.root.unit=="number"){t.reduceLeftBound(t.root.unit,r),t.unsetRoot();return}if(t.root.unit instanceof Date){const n=`d'${t.root.description??t.root.unit.toISOString()}'`;t.unsetRoot(),t.reduceLeftBound(n,r);return}}return _f(t,r)},wf={"<":1,">":1,"=":1},kf=(t,e)=>t.scanner.lookaheadIs("=")?`${e}${t.scanner.shift()}`:e,ts=(t,e,r,n)=>r.extends(M.intrinsic.number)?typeof e!="number"?P(Mn(t,e,n)):t==="=="?["min","max"]:t[0]===">"?["min"]:["max"]:r.extends(M.intrinsic.lengthBoundable)?typeof e!="number"?P(Mn(t,e,n)):t==="=="?["exactLength"]:t[0]===">"?["minLength"]:["maxLength"]:r.extends(M.intrinsic.Date)?t==="=="?["after","before"]:t[0]===">"?["after"]:["before"]:P(md(r.expression)),Sf=t=>({rule:Qh(t.limit)?Xh(t.limit):t.limit,exclusive:t.comparator.length===1}),_f=(t,e)=>{const r=t.unsetRoot(),n=t.scanner.location;t.parseOperand();const i=t.unsetRoot(),s=t.scanner.sliceChars(n,t.scanner.location);if(t.root=r,!i.hasKind("unit")||typeof i.unit!="number"&&!(i.unit instanceof Date))return t.error(Mn(e,s,"right"));const a=i.unit,l=e.length===1,h=ts(e,typeof a=="number"?a:s,r,"right");for(const f of h)t.constrainRoot(f,e==="=="?{rule:a}:{rule:a,exclusive:l});if(!t.branches.leftBound)return;if(!_e(e,yf))return t.error(au(e));const d=ts(t.branches.leftBound.comparator,t.branches.leftBound.limit,r,"left");t.constrainRoot(d[0],Sf(t.branches.leftBound)),t.branches.leftBound=null},Mn=(t,e,r)=>`Comparator ${r==="left"?_r[t]:t} must be ${r==="left"?"preceded":"followed"} by a corresponding literal (was ${e})`,Pf=t=>{t.scanner.shiftUntilNonWhitespace();const e=t.scanner.shiftUntilLookahead(ft);t.root=t.root.brand(e)},If=t=>{t.scanner.shiftUntilNonWhitespace();const e=t.scanner.shiftUntilLookahead(ft),r=_c(e,{errorOnFail:rs(e)});r===0&&t.error(rs(0)),t.root=t.root.constrain("divisor",r)},rs=t=>`% operator must be followed by a non-zero integer literal (was ${t})`,uu=t=>{const e=t.scanner.shift();return e===""?t.finalize(""):e==="["?t.scanner.shift()==="]"?t.setRoot(t.root.array()):t.error(Cf):e==="|"?t.scanner.lookahead===">"?t.shiftedBy(1).pushRootToBranch("|>"):t.pushRootToBranch(e):e==="&"?t.pushRootToBranch(e):e===")"?t.finalizeGroup():lf(e,t.scanner.unscanned)?t.finalize(e):_e(e,wf)?xf(t,e):e==="%"?If(t):e==="#"?Pf(t):e in Nr?uu(t):t.error(ai(e))},ai=(t,e="")=>`'${t}' is not allowed here${e&&` (should be ${e})`}`,Cf="Missing expected ']'",Of=t=>{const e=t.unsetRoot();t.parseOperand();const r=t.unsetRoot();if(!r.hasKind("unit"))return t.error(Mf(r.expression));const n=r.unit instanceof Date?()=>new Date(r.unit):r.unit;return[e,"=",n]},Mf=t=>`Default value '${t}' must be a literal value`,ns=(t,e)=>{const r=e.$.maybeResolveRoot(t);if(r)return r;if(t.endsWith("[]")){const s=e.$.maybeResolveRoot(t.slice(0,-2));if(s)return s.array()}const n=new Tr(new zo(t),e),i=Af(n);return n.finalizer===">"&&P(ai(">")),i},Af=t=>{t.parseOperand();let e=ui(t).root;return e?(t.finalizer==="="?e=Of(t):t.finalizer==="?"&&(e=[e,"?"]),t.scanner.shiftUntilNonWhitespace(),t.scanner.lookahead&&P(ai(t.scanner.lookahead)),e):Q(`Root was unexpectedly unset after parsing string '${t.scanner.scanned}'`)},ui=t=>{for(;t.finalizer===void 0;)Nf(t);return t},Nf=t=>t.hasRoot()?t.parseOperator():t.parseOperand();class Tr{root;branches={prefixes:[],leftBound:null,intersection:null,union:null,pipe:null};finalizer;groups=[];scanner;ctx;constructor(e,r){this.scanner=e,this.ctx=r}error(e){return P(e)}hasRoot(){return this.root!==void 0}setRoot(e){this.root=e}unsetRoot(){const e=this.root;return this.root=void 0,e}constrainRoot(...e){this.root=this.root.constrain(e[0],e[1])}finalize(e){if(this.groups.length)return this.error(Ho(")"));this.finalizeBranches(),this.finalizer=e}reduceLeftBound(e,r){const n=_r[r];if(!_e(n,gf))return this.error(au(r));if(this.branches.leftBound)return this.error(vf(this.branches.leftBound.limit,this.branches.leftBound.comparator,e,n));this.branches.leftBound={comparator:n,limit:e}}finalizeBranches(){if(this.assertRangeUnset(),this.branches.pipe){this.pushRootToBranch("|>"),this.root=this.branches.pipe;return}if(this.branches.union){this.pushRootToBranch("|"),this.root=this.branches.union;return}if(this.branches.intersection){this.pushRootToBranch("&"),this.root=this.branches.intersection;return}this.applyPrefixes()}finalizeGroup(){this.finalizeBranches();const e=this.groups.pop();if(!e)return this.error(Ec(")",this.scanner.unscanned));this.branches=e}addPrefix(e){this.branches.prefixes.push(e)}applyPrefixes(){for(;this.branches.prefixes.length;){const e=this.branches.prefixes.pop();this.root=e==="keyof"?this.root.keyof():Q(`Unexpected prefix '${e}'`)}}pushRootToBranch(e){this.assertRangeUnset(),this.applyPrefixes();const r=this.root;this.root=void 0,this.branches.intersection=this.branches.intersection?.rawAnd(r)??r,e!=="&"&&(this.branches.union=this.branches.union?.rawOr(this.branches.intersection)??this.branches.intersection,this.branches.intersection=null,e!=="|"&&(this.branches.pipe=this.branches.pipe?.rawPipeOnce(this.branches.union)??this.branches.union,this.branches.union=null))}parseUntilFinalizer(){return ui(new Tr(this.scanner,this.ctx))}parseOperator(){return uu(this)}parseOperand(){return ou(this)}assertRangeUnset(){if(this.branches.leftBound)return this.error(bf(this.branches.leftBound.limit,this.branches.leftBound.comparator))}reduceGroupOpen(){this.groups.push(this.branches),this.branches={prefixes:[],leftBound:null,union:null,intersection:null,pipe:null}}previousOperator(){return this.branches.leftBound?.comparator??this.branches.prefixes[this.branches.prefixes.length-1]??(this.branches.intersection?"&":this.branches.union?"|":this.branches.pipe?"|>":void 0)}shiftedBy(e){return this.scanner.jumpForward(e),this}}const Df="An empty string is not a valid generic parameter name",An=(t,e,r)=>{t.shiftUntilNonWhitespace();const n=t.shiftUntilLookahead(ft);return n===""?t.lookahead===""&&e.length?e:P(Df):(t.shiftUntilNonWhitespace(),Ef(t,n,e,r))},is="extends ",Ef=(t,e,r,n)=>{if(t.shiftUntilNonWhitespace(),t.unscanned.startsWith(is))t.jumpForward(is.length);else return t.lookahead===","&&t.shift(),r.push(e),An(t,r,n);const i=ui(new Tr(t,n));return r.push([e,i.root]),An(t,r,n)};class Lf extends Ke{constructor(e){const r={$:e,raw:e.fn};super((...n)=>{const i=n.indexOf(":"),s=i===-1?n.length-1:i-1,a=n.slice(0,s+1),l=e.parse(a).assertHasKind("intersection");let h=e.intrinsic.unknown;if(i!==-1){if(i!==n.length-2)return P(Rf);h=e.parse(n[i+1])}return d=>new $f(d,l,h)},{attach:r})}}class $f extends Ke{raw;params;returns;expression;constructor(e,r,n){const i=`typed ${e.name}`,s={[i]:(...l)=>{const h=r.assert(l),d=e(...h);return n.assert(d)}}[i];super(s),this.raw=e,this.params=r,this.returns=n;let a=r.expression;a[0]==="["&&a[a.length-1]==="]"?a=a.slice(1,-1):a.endsWith("[]")&&(a=`...${a}`),this.expression=`(${a}) => ${n?.expression??"unknown"}`}}const Rf=`":" must be followed by exactly one return type e.g:
fn("string", ":", "number")(s => s.length)`;class Tf extends Ke{$;constructor(e){super((...r)=>new Ft(e)(...r),{bind:e}),this.$=e}in(e){return new Ft(this.$,e===void 0?void 0:this.$.parse(e))}at(e,r){return new Ft(this.$).at(e,r)}case(e,r){return new Ft(this.$).case(e,r)}}class Ft extends Ke{$;in;key;branches=[];constructor(e,r){super(n=>this.caseEntries(Object.entries(n).map(([i,s])=>i==="default"?[i,s]:[this.$.parse(i),s]))),this.$=e,this.in=r}at(e,r){return this.key&&P(qf),this.branches.length&&P(Bf),this.key=e,r?this.match(r):this}case(e,r){return this.caseEntry(this.$.parse(e),r)}caseEntry(e,r){const i=(this.key?this.$.parse({[this.key]:e}):e).pipe(r);return this.branches.push(i),this}match(e){return this(e)}strings(e){return this.caseEntries(Object.entries(e).map(([r,n])=>r==="default"?[r,n]:[this.$.node("unit",{unit:r}),n]))}caseEntries(e){for(let r=0;r<e.length;r++){const[n,i]=e[r];if(n==="default")return r!==e.length-1&&P("default may only be specified as the last key of a switch definition"),this.default(i);if(typeof i!="function")return P(`Value for case "${n}" must be a function (was ${be(i)})`);this.caseEntry(n,i)}return this}default(e){typeof e=="function"&&this.case(E.unknown,e);const r={branches:this.branches,ordered:!0};(e==="never"||e==="assert")&&(r.meta={onFail:ss});const n=this.$.node("union",r);if(!this.in)return this.$.finalize(n);let i=this.in.pipe(n);return(e==="never"||e==="assert")&&(i=i.configureReferences({onFail:ss},"self")),this.$.finalize(i)}}const ss=t=>t.throw(),Bf="A key matcher must be specified before the first case i.e. match.at('foo') or match.in<object>().at('bar')",qf="At most one key matcher may be specified per expression",lu=(t,e)=>{if(ne(t)){if(t[1]==="=")return[e.$.parseOwnDefinitionFormat(t[0],e),"=",t[2]];if(t[1]==="?")return[e.$.parseOwnDefinitionFormat(t[0],e),"?"]}return gu(t,e)},Ff="Only required keys may make their values optional, e.g. { [mySymbol]: ['number', '?'] }",Kf="Only required keys may specify default values, e.g. { value: 'number = 0' }",jf=(t,e)=>{let r;const n={},i=gr(t);for(const[a,l]of i){const h=Hf(a);if(h.kind==="spread"){if(!Ot(n))return P(zf);const u=e.$.parseOwnDefinitionFormat(l,e);if(u.equals(E.object))continue;if(!u.hasKind("intersection")||!u.basis?.equals(E.object))return P(Vf(u.expression));r=u.structure;continue}if(h.kind==="undeclared"){l!=="reject"&&l!=="delete"&&l!=="ignore"&&P(Uf(l)),n.undeclared=l;continue}const d=lu(l,e),f=h;if(h.kind==="required"){ne(d)?Zr(n,"optional",d[1]==="="?{key:h.normalized,value:d[0],default:d[2]}:{key:h.normalized,value:d[0]},e):Zr(n,"required",{key:h.normalized,value:d},e);continue}if(ne(d)&&(d[1]==="?"&&P(Ff),d[1]==="="&&P(Kf)),h.kind==="optional"){Zr(n,"optional",{key:h.normalized,value:d},e);continue}const p=e.$.parseOwnDefinitionFormat(f.normalized,e),c=In(p,d,e.$);c.index&&(n.index=q(n.index,c.index)),c.required&&(n.required=q(n.required,c.required))}const s=e.$.node("structure",n);return e.$.parseSchema({domain:"object",structure:r?.merge(s)??s})},Zr=(t,e,r,n)=>{t[e]=q(t[e],n.$.node(e,r))},Uf=t=>`Value of '+' key must be 'reject', 'delete', or 'ignore' (was ${B(t)})`,zf="Spread operator may only be used as the first key in an object",Hf=t=>typeof t=="symbol"?{kind:"required",normalized:t}:t[t.length-1]==="?"?t[t.length-2]===kt?{kind:"required",normalized:`${t.slice(0,-2)}?`}:{kind:"optional",normalized:t.slice(0,-1)}:t[0]==="["&&t[t.length-1]==="]"?{kind:"index",normalized:t.slice(1,-1)}:t[0]===kt&&t[1]==="["&&t[t.length-1]==="]"?{kind:"required",normalized:t.slice(1)}:t==="..."?{kind:"spread"}:t==="+"?{kind:"undeclared"}:{kind:"required",normalized:t==="\\..."?"...":t==="\\+"?"+":t},Vf=t=>`Spread operand must resolve to an object literal type (was ${t})`,Gf=(t,e)=>np(t)?fu[t[0]](t,e):tp(t)?hu[t[1]](t,e):null,Wf=(t,e)=>e.$.parseOwnDefinitionFormat(t[1],e).keyof(),en=(t,e)=>{if(t[2]===void 0)return P(su(t[1],""));const r=e.$.parseOwnDefinitionFormat(t[0],e),n=e.$.parseOwnDefinitionFormat(t[2],e);if(t[1]==="|")return e.$.node("union",{branches:[r,n]});const i=t[1]==="&"?De(r,n,e.$):Sn(r,n,e.$);return i instanceof N?i.throw():i},Jf=(t,e)=>e.$.parseOwnDefinitionFormat(t[0],e).array(),Yf=(t,e)=>typeof t[2]!="function"?P(cu("=>",t[2])):e.$.parseOwnDefinitionFormat(t[0],e).pipe(t[2]),cu=(t,e)=>`${t===":"?"Narrow":"Morph"} expression requires a function following '${t}' (was ${typeof e})`,Qf=(t,e)=>typeof t[2]!="function"?P(cu(":",t[2])):e.$.parseOwnDefinitionFormat(t[0],e).constrain("predicate",t[2]),Xf=(t,e)=>e.$.parseOwnDefinitionFormat(t[0],e).configure(t[2],t[3]),du=t=>t,Zf=du({"[]":Jf,"?":()=>P(eu)}),ep=du({"|":en,"&":en,":":Qf,"=>":Yf,"|>":en,"@":Xf,"=":()=>P(tu)}),hu={...Zf,...ep},tp=t=>hu[t[1]]!==void 0,rp=t=>t,fu=rp({keyof:Wf,instanceof:(t,e)=>{if(typeof t[1]!="function")return P(os(gn(t[1])));const r=t.slice(1).map(n=>typeof n=="function"?e.$.node("proto",{proto:n}):P(os(gn(n))));return r.length===1?r[0]:e.$.node("union",{branches:r})},"===":(t,e)=>e.$.units(t.slice(1))}),np=t=>fu[t[0]]!==void 0,os=t=>`Expected a constructor following 'instanceof' operator (was ${t})`,ip=(t,e)=>{let r=[{}],n=0;for(;n<t.length;){let i=!1;t[n]==="..."&&n<t.length-1&&(i=!0,n++);const s=lu(t[n],e),[a,l,h]=ne(s)?s:[s];if(n++,i){if(!a.extends(M.intrinsic.Array))return P(ap(a.expression));r=r.flatMap(d=>a.distribute(f=>op(Yo(d),f)))}else r=r.map(d=>l==="?"?pu(d,a):l==="="?sp(d,a,h):Nn(d,a))}return e.$.parseSchema(r.map(i=>Ot(i)?{proto:Array,exactLength:0}:{proto:Array,sequence:i}))},Nn=(t,e)=>t.defaultables||t.optionals?P(t.variadic?La:up):(t.variadic?t.postfix=q(t.postfix,e):t.prefix=q(t.prefix,e),t),pu=(t,e)=>t.variadic?P(mu):(t.optionals=q(t.optionals,e),t),sp=(t,e,r)=>t.variadic?P(mu):t.optionals?P(lp):(t.defaultables=q(t.defaultables,[[e,r]]),t),as=(t,e)=>(t.postfix&&P(us),t.variadic?t.variadic.equals(e)||P(us):t.variadic=e.internal,t),op=(t,e)=>{const r=e.select({method:"find",kind:"sequence"});if(!r)return as(t,M.intrinsic.unknown);if(r.prefix)for(const n of r.prefix)Nn(t,n);if(r.optionals)for(const n of r.optionals)pu(t,n);if(r.variadic&&as(t,r.variadic),r.postfix)for(const n of r.postfix)Nn(t,n);return t},ap=t=>`Spread element must be an array (was ${t})`,us="A tuple may have at most one variadic element",up="A required element may not follow an optional element",mu="An optional element may not follow a variadic element",lp="A defaultable element may not follow an optional element without a default",cp={},gu=(t,e)=>{if(typeof t=="string"){if(e.args&&Object.keys(e.args).some(n=>t.includes(n)))return ns(t,e);const r=cp[e.$.name]??={};return r[t]??=ns(t,e)}return We(t,"object")?dp(t,e):P(Dn(be(t)))},dp=(t,e)=>{const r=Vn(t);switch(r){case void 0:return D(t,"root")?t:"~standard"in t?hp(t,e):jf(t,e);case"Array":return fp(t,e);case"RegExp":return e.$.node("intersection",{domain:"string",pattern:t},{prereduced:!0});case"Function":{const n=Ar(t)?t():t;return D(n,"root")?n:P(Dn("Function"))}default:return P(Dn(r??B(t)))}},hp=(t,e)=>e.$.intrinsic.unknown.pipe((r,n)=>{const i=t["~standard"].validate(r);if(!i.issues)return i.value;for(const{message:s,path:a}of i.issues)a?a.length?n.error({problem:lc(s),relativePath:a.map(l=>typeof l=="object"?l.key:l)}):n.error({message:s}):n.error({message:s})}),fp=(t,e)=>Gf(t,e)??ip(t,e),Dn=t=>`Type definitions must be strings or objects (was ${t})`;class pp extends Ke{constructor(e){const r=Object.assign({errors:qe,hkt:Pe,$:e,raw:e.parse,module:e.constructor.module,scope:e.constructor.scope,declare:e.declare,define:e.define,match:e.match,generic:e.generic,schema:e.schema,keywords:e.ambient,unit:e.unit,enumerated:e.enumerated,instanceOf:e.instanceOf,valueOf:e.valueOf,or:e.or,and:e.and,merge:e.merge,pipe:e.pipe,fn:e.fn},e.ambientAttachments);super((...n)=>{if(n.length===1)return e.parse(n[0]);if(n.length===2&&typeof n[0]=="string"&&n[0][0]==="<"&&n[0][n[0].length-1]===">"){const i=n[0].slice(1,-1),s=e.parseGenericParams(i,{});return new kr(s,n[1],e,e,null)}return e.parse(n)},{attach:r})}}const Pt=M;class Br extends Ka{get ambientAttachments(){if(Pt.typeAttachments)return this.cacheGetter("ambientAttachments",F(Pt.typeAttachments,(e,r)=>[e,this.bindReference(r)]))}preparseOwnAliasEntry(e,r){const n=e.indexOf("<");if(n===-1){if(D(r,"module")||D(r,"generic"))return[e,r];const a=this.name==="ark"?e:e==="root"?this.name:`${this.name}.${e}`,l=this.resolvedConfig.keywords?.[a];return l&&(r=[r,"@",l]),[e,r]}e[e.length-1]!==">"&&P("'>' must be the last character of a generic declaration in a scope");const i=e.slice(0,n),s=e.slice(n+1,-1);return[i,()=>{const a=this.parseGenericParams(s,{alias:i});return td(a,r,this)}]}parseGenericParams(e,r){return An(new zo(e),[],this.createParseContext({...r,def:e,prefix:"generic"}))}normalizeRootScopeValue(e){return Ar(e)&&!D(e,"generic")?e():e}preparseOwnDefinitionFormat(e,r){return{...r,def:e,prefix:r.alias??"type"}}parseOwnDefinitionFormat(e,r){!(r.alias&&r.alias in this.aliases)&&!r.args&&(r.args={this:r.id});const i=gu(e,r);if(ne(i)){if(i[1]==="=")return P(tu);if(i[1]==="?")return P(eu)}return i}unit=e=>this.units([e]);valueOf=e=>this.units(Wl(e));enumerated=(...e)=>this.units(e);instanceOf=e=>this.node("proto",{proto:e},{prereduced:!0});or=(...e)=>this.schema(e.map(r=>this.parse(r)));and=(...e)=>e.reduce((r,n)=>r.and(this.parse(n)),this.intrinsic.unknown);merge=(...e)=>e.reduce((r,n)=>r.merge(this.parse(n)),this.intrinsic.object);pipe=(...e)=>this.intrinsic.unknown.pipe(...e);fn=new Lf(this);match=new Tf(this);declare=()=>({type:this.type});define(e){return e}type=new pp(this);static scope=((e,r={})=>new Br(e,r));static module=((e,r={})=>this.scope(e,r).export())}const qr=Object.assign(Br.scope,{define:t=>t}),R=Br;class mp extends Pe{description='merge an object\'s properties onto another like `Merge(User, { isAdmin: "true" })`'}const gp=Ee(["base",E.object],["props",E.object])(t=>t.base.merge(t.props),mp),yp=R.module({Key:E.key,Merge:gp});class bp extends Pe{}const vp=Ee("element")(t=>{const e=t.element.exclude(E.Array),r=e.array();return e.rawOr(r).pipe(Ct).distribute(n=>n.assertHasKind("morph").declareOut(r),K)},bp),xp=R.module({root:E.Array,readonly:"root",index:E.nonNegativeIntegerString,liftFrom:vp},{name:"Array"}),En=K(["string",Mt.FileConstructor]),wp=En.rawOr(En.array()),ls=K({meta:"an object representing parsed form data",domain:"object",index:{signature:"string",value:wp}}),kp=R.module({root:["instanceof",FormData],value:En,parsed:ls,parse:K({in:FormData,morphs:t=>{const e={};for(const[r,n]of t)if(r in e){const i=e[r];typeof i=="string"||i instanceof Mt.FileConstructor?e[r]=[i,n]:i.push(n)}else e[r]=n;return e},declaredOut:ls})},{name:"FormData"}),Sp=R.module({Int8:["instanceof",Int8Array],Uint8:["instanceof",Uint8Array],Uint8Clamped:["instanceof",Uint8ClampedArray],Int16:["instanceof",Int16Array],Uint16:["instanceof",Uint16Array],Int32:["instanceof",Int32Array],Uint32:["instanceof",Uint32Array],Float32:["instanceof",Float32Array],Float64:["instanceof",Float64Array],BigInt64:["instanceof",BigInt64Array],BigUint64:["instanceof",BigUint64Array]},{name:"TypedArray"}),_p={Boolean:1,Number:1,String:1},Pp=R.module({...F({...Eo,...$o},(t,e)=>t in _p?[]:[t,["instanceof",e]]),Array:xp,TypedArray:Sp,FormData:kp}),Ip=K({domain:{domain:"number",meta:"a number representing a Unix timestamp"},divisor:{rule:1,meta:"an integer representing a Unix timestamp"},min:{rule:-864e13,meta:"a Unix timestamp after -8640000000000000"},max:{rule:864e13,meta:"a Unix timestamp before 8640000000000000"},meta:"an integer representing a safe Unix timestamp"}),Cp=K({domain:"number",divisor:1}),yu=R.module({root:E.number,integer:Cp,epoch:Ip,safe:K({domain:{domain:"number",numberAllowsNaN:!1},min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER}),NaN:["===",Number.NaN],Infinity:["===",Number.POSITIVE_INFINITY],NegativeInfinity:["===",Number.NEGATIVE_INFINITY]},{name:"number"}),j=(t,e,r)=>{const n={domain:"string",pattern:{rule:t.source,flags:t.flags,meta:e}};return r&&(n.meta={format:r}),oi("intersection",n)},cs=j(yr,"a well-formed integer string"),bu=R.module({root:cs,parse:K({in:cs,morphs:(t,e)=>{const r=Number.parseInt(t);return Number.isSafeInteger(r)?r:e.error("an integer in the range Number.MIN_SAFE_INTEGER to Number.MAX_SAFE_INTEGER")},declaredOut:E.integer})},{name:"string.integer"}),Op=j(/^[\dA-Fa-f]+$/,"hex characters only"),Mp=R.module({root:j(/^(?:[\d+/A-Za-z]{4})*(?:[\d+/A-Za-z]{2}==|[\d+/A-Za-z]{3}=)?$/,"base64-encoded"),url:j(/^(?:[\w-]{4})*(?:[\w-]{2}(?:==|%3D%3D)?|[\w-]{3}(?:=|%3D)?)?$/,"base64url-encoded")},{name:"string.base64"}),ds=j(/^[A-Z].*$/,"capitalized"),Ap=R.module({root:K({in:"string",morphs:t=>t.charAt(0).toUpperCase()+t.slice(1),declaredOut:ds}),preformatted:ds},{name:"string.capitalize"}),Np=t=>{const e=t.replace(/[ -]+/g,"");let r=0,n,i,s=!1;for(let a=e.length-1;a>=0;a--)n=e.substring(a,a+1),i=Number.parseInt(n,10),s?(i*=2,r+=i>=10?i%10+1:i):r+=i,s=!s;return!!(r%10===0&&e)},Dp=/^(?:4\d{12}(?:\d{3,6})?|5[1-5]\d{14}|(222[1-9]|22[3-9]\d|2[3-6]\d{2}|27[01]\d|2720)\d{12}|6(?:011|5\d\d)\d{12,15}|3[47]\d{13}|3(?:0[0-5]|[68]\d)\d{11}|(?:2131|1800|35\d{3})\d{11}|6[27]\d{14}|^(81\d{14,17}))$/,Ep=K({domain:"string",pattern:{meta:"a credit card number",rule:Dp.source},predicate:{meta:"a credit card number",predicate:Np}}),Lp=/^([+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))(T((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([,.]\d+(?!:))?)?(\17[0-5]\d([,.]\d+)?)?([Zz]|([+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,$p=t=>!Number.isNaN(new Date(t).valueOf()),hs=K({domain:"string",predicate:{meta:"a parsable date",predicate:$p}}).assertHasKind("intersection"),fs=bu.root.internal.narrow((t,e)=>{const r=Number.parseInt(t),n=yu.epoch(r);return n instanceof qe?(e.errors.merge(n),!1):!0}).configure({description:"an integer string representing a safe Unix timestamp"},"self").assertHasKind("intersection"),Rp=R.module({root:fs,parse:K({in:fs,morphs:t=>new Date(t),declaredOut:E.Date})},{name:"string.date.epoch"}),ps=j(Lp,"an ISO 8601 (YYYY-MM-DDTHH:mm:ss.sssZ) date").internal.assertHasKind("intersection"),Tp=R.module({root:ps,parse:K({in:ps,morphs:t=>new Date(t),declaredOut:E.Date})},{name:"string.date.iso"}),Bp=R.module({root:hs,parse:K({declaredIn:hs,in:"string",morphs:(t,e)=>{const r=new Date(t);return Number.isNaN(r.valueOf())?e.error("a parsable date"):r},declaredOut:E.Date}),iso:Tp,epoch:Rp},{name:"string.date"}),qp=j(/^[\w%+.-]+@[\d.A-Za-z-]+\.[A-Za-z]{2,}$/,"an email address","email"),ms="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",Re=`(${ms}[.]){3}${ms}`,Fp=new RegExp(`^${Re}$`),Y="(?:[0-9a-fA-F]{1,4})",Kp=new RegExp(`^((?:${Y}:){7}(?:${Y}|:)|(?:${Y}:){6}(?:${Re}|:${Y}|:)|(?:${Y}:){5}(?::${Re}|(:${Y}){1,2}|:)|(?:${Y}:){4}(?:(:${Y}){0,1}:${Re}|(:${Y}){1,3}|:)|(?:${Y}:){3}(?:(:${Y}){0,2}:${Re}|(:${Y}){1,4}|:)|(?:${Y}:){2}(?:(:${Y}){0,3}:${Re}|(:${Y}){1,5}|:)|(?:${Y}:){1}(?:(:${Y}){0,4}:${Re}|(:${Y}){1,6}|:)|(?::((?::${Y}){0,5}:${Re}|(?::${Y}){1,7}|:)))(%[0-9a-zA-Z.]{1,})?$`),jp=R.module({root:["v4 | v6","@","an IP address"],v4:j(Fp,"an IPv4 address","ipv4"),v6:j(Kp,"an IPv6 address","ipv6")},{name:"string.ip"}),nt="a JSON string",vu=t=>{if(!(t instanceof SyntaxError))throw t;return`must be ${nt} (${t})`},Up=K({meta:nt,domain:"string",predicate:{meta:nt,predicate:(t,e)=>{try{return JSON.parse(t),!0}catch(r){return e.reject({code:"predicate",expected:nt,problem:vu(r)})}}}}),zp=(t,e)=>{if(t.length===0)return e.error({code:"predicate",expected:nt,actual:"empty"});try{return JSON.parse(t)}catch(r){return e.error({code:"predicate",expected:nt,problem:vu(r)})}},Hp=R.module({root:Up,parse:K({meta:"safe JSON string parser",in:"string",morphs:zp,declaredOut:E.jsonObject})},{name:"string.json"}),gs=j(/^[a-z]*$/,"only lowercase letters"),Vp=R.module({root:K({in:"string",morphs:t=>t.toLowerCase(),declaredOut:gs}),preformatted:gs},{name:"string.lower"}),xu=["NFC","NFD","NFKC","NFKD"],$t=F(xu,(t,e)=>[e,K({domain:"string",predicate:r=>r.normalize(e)===r,meta:`${e}-normalized unicode`})]),Fr=F(xu,(t,e)=>[e,K({in:"string",morphs:r=>r.normalize(e),declaredOut:$t[e]})]),Gp=R.module({root:Fr.NFC,preformatted:$t.NFC},{name:"string.normalize.NFC"}),Wp=R.module({root:Fr.NFD,preformatted:$t.NFD},{name:"string.normalize.NFD"}),Jp=R.module({root:Fr.NFKC,preformatted:$t.NFKC},{name:"string.normalize.NFKC"}),Yp=R.module({root:Fr.NFKD,preformatted:$t.NFKD},{name:"string.normalize.NFKD"}),Qp=R.module({root:"NFC",NFC:Gp,NFD:Wp,NFKC:Jp,NFKD:Yp},{name:"string.normalize"}),ys=j(yn,"a well-formed numeric string"),Xp=R.module({root:ys,parse:K({in:ys,morphs:t=>Number.parseFloat(t),declaredOut:E.number})},{name:"string.numeric"}),bs="a regex pattern",Zp=K({domain:"string",predicate:{meta:bs,predicate:(t,e)=>{try{return new RegExp(t),!0}catch(r){return e.reject({code:"predicate",expected:bs,problem:String(r)})}}},meta:{format:"regex"}}),em=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*)(?:\.(?:0|[1-9]\d*|\d*[A-Za-z-][\dA-Za-z-]*))*))?(?:\+([\dA-Za-z-]+(?:\.[\dA-Za-z-]+)*))?$/,tm=j(em,"a semantic version (see https://semver.org/)"),vs=j(/^\S.*\S$|^\S?$/,"trimmed"),rm=R.module({root:K({in:"string",morphs:t=>t.trim(),declaredOut:vs}),preformatted:vs},{name:"string.trim"}),xs=j(/^[A-Z]*$/,"only uppercase letters"),nm=R.module({root:K({in:"string",morphs:t=>t.toUpperCase(),declaredOut:xs}),preformatted:xs},{name:"string.upper"}),im=t=>URL.canParse(t),ws=K({domain:"string",predicate:{meta:"a URL string",predicate:im},meta:{format:"uri"}}),sm=R.module({root:ws,parse:K({declaredIn:ws,in:"string",morphs:(t,e)=>{try{return new URL(t)}catch{return e.error("a URL string")}},declaredOut:K(URL)})},{name:"string.url"}),om=R.module({root:["versioned | nil | max","@",{description:"a UUID",format:"uuid"}],"#nil":"'00000000-0000-0000-0000-000000000000'","#max":"'ffffffff-ffff-ffff-ffff-ffffffffffff'","#versioned":/[\da-f]{8}-[\da-f]{4}-[1-8][\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}/i,v1:j(/^[\da-f]{8}-[\da-f]{4}-1[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv1"),v2:j(/^[\da-f]{8}-[\da-f]{4}-2[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv2"),v3:j(/^[\da-f]{8}-[\da-f]{4}-3[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv3"),v4:j(/^[\da-f]{8}-[\da-f]{4}-4[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv4"),v5:j(/^[\da-f]{8}-[\da-f]{4}-5[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv5"),v6:j(/^[\da-f]{8}-[\da-f]{4}-6[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv6"),v7:j(/^[\da-f]{8}-[\da-f]{4}-7[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv7"),v8:j(/^[\da-f]{8}-[\da-f]{4}-8[\da-f]{3}-[89ab][\da-f]{3}-[\da-f]{12}$/i,"a UUIDv8")},{name:"string.uuid"}),am=R.module({root:E.string,alpha:j(/^[A-Za-z]*$/,"only letters"),alphanumeric:j(/^[\dA-Za-z]*$/,"only letters and digits 0-9"),hex:Op,base64:Mp,capitalize:Ap,creditCard:Ep,date:Bp,digits:j(/^\d*$/,"only digits 0-9"),email:qp,integer:bu,ip:jp,json:Hp,lower:Vp,normalize:Qp,numeric:Xp,regex:Zp,semver:tm,trim:rm,upper:nm,url:sm,uuid:om},{name:"string"}),um=R.module({bigint:E.bigint,boolean:E.boolean,false:E.false,never:E.never,null:E.null,number:E.number,object:E.object,string:E.string,symbol:E.symbol,true:E.true,unknown:E.unknown,undefined:E.undefined}),lm=R.module({root:E.unknown,any:E.unknown},{name:"unknown"}),cm=R.module({root:E.jsonObject,stringify:oi("morph",{in:E.jsonObject,morphs:t=>JSON.stringify(t),declaredOut:E.string})},{name:"object.json"}),dm=R.module({root:E.object,json:cm},{name:"object"});class hm extends Pe{description='instantiate an object from an index signature and corresponding value type like `Record("string", "number")`'}const fm=Ee(["K",E.key],"V")(t=>({domain:"object",index:{signature:t.K,value:t.V}}),hm);class pm extends Pe{description='pick a set of properties from an object like `Pick(User, "name | age")`'}const mm=Ee(["T",E.object],["K",E.key])(t=>t.T.pick(t.K),pm);class gm extends Pe{description='omit a set of properties from an object like `Omit(User, "age")`'}const ym=Ee(["T",E.object],["K",E.key])(t=>t.T.omit(t.K),gm);class bm extends Pe{description="make all named properties of an object optional like `Partial(User)`"}const vm=Ee(["T",E.object])(t=>t.T.partial(),bm);class xm extends Pe{description="make all named properties of an object required like `Required(User)`"}const wm=Ee(["T",E.object])(t=>t.T.required(),xm);class km extends Pe{description='exclude branches of a union like `Exclude("boolean", "true")`'}const Sm=Ee("T","U")(t=>t.T.exclude(t.U),km);class _m extends Pe{description='extract branches of a union like `Extract("0 | false | 1", "number")`'}const Pm=Ee("T","U")(t=>t.T.extract(t.U),_m),Im=R.module({Exclude:Sm,Extract:Pm,Omit:ym,Partial:vm,Pick:mm,Record:fm,Required:wm}),je=qr({...um,...Im,...Pp,...yp,string:am,number:yu,object:dm,unknown:lm},{prereducedAliases:!0,name:"ark"}),Z=je.export();Object.assign(Pt.ambient,Z);Pt.typeAttachments={string:Z.string.root,number:Z.number.root,bigint:Z.bigint,boolean:Z.boolean,symbol:Z.symbol,undefined:Z.undefined,null:Z.null,object:Z.object.root,unknown:Z.unknown.root,false:Z.false,true:Z.true,never:Z.never,arrayIndex:Z.Array.index,Key:Z.Key,Record:Z.Record,Array:Z.Array.root,Date:Z.Date};const _=Object.assign(je.type,Pt.typeAttachments),jy=je.match;je.fn;je.generic;je.schema;je.define;je.declare;const Cm={js:{fr:()=>yi(()=>import("./iE9-RDim.js"),[],import.meta.url),en:()=>yi(()=>import("./ChK4yKOo.js"),[],import.meta.url)}},Om=(t,e)=>Cm[t][e](),Mm=["js"],Am="js",Nm=il(Am,Om,Mm);function Uy(t,e,r=n=>n===1?0:1){const n=r(t);return e[n]?.replace("#",Intl.NumberFormat().format(t))}function zy(t,e=0,{pad:r="none"}={}){let n=(t*100).toFixed(e);return e>0&&(n=n.replace(/\.?0+$/,"")),r!=="none"&&(n=n.padStart(2+e,r==="nbsp"?" ":"0")),n+"%"}function Hy(t){const[e,r]=t.split("/",2);let n=r.replace(/^x-/,"");return["image","video","audio"].includes(e)&&(n=n.toUpperCase()),n}function Dm(t,e=""){const n=Nm("js")(86);let i=n;for(t instanceof Error&&("message"in t&&t.message&&(i=t.message||n),"cause"in t&&t.cause&&(i=Dm(t.cause))),i=t?.toString()||n;i.startsWith("Error: ");)i=i.slice(7);return i||=n,e?`${e}: ${i}`:i}function Em(){return navigator.language.split("-")[0]==="fr"?"fr":"en"}function Vy(t){return t&&t.charAt(0).toUpperCase()+t.slice(1)}function Gy(t){const e=t<1e3?0:t<1e6?1:t<1e9?2:t<1e12?3:4,r=new Intl.NumberFormat(void 0,{style:"unit",unitDisplay:"narrow",unit:{0:"byte",1:"kilobyte",2:"megabyte",3:"gigabyte",4:"terabyte"}[e]}),n=t/2**(10*e),i=n>10?0:n>1?1:2,s=Math.round(n*10**i)/10**i;return r.format(s)}const z=_(/^[\w._]+$/),Pr=z.array().pipe(t=>[...new Set(t)]),ks=_("0 <= number <= 1.0001").pipe(t=>vo(t,0,1)),Ve=_(/https?:\/\/.+/),Lm=_(/^#?[0-9A-Fa-f]{6}$/).pipe(t=>t.startsWith("#")?t:`#${t}`),Ir=Ve.configure("L'URL à laquelle se situe le fichier. Effectue une requête GET sans en-têtes particuliers.","self").or({url:Ve.describe("L'URL de la requête"),"headers?":_({"[string]":"string"}).describe("Les en-têtes à ajouter dans la requête"),"method?":_.enumerated("GET","POST","PUT","DELETE").describe("La méthode de la requête (GET par défaut)")}).configure("Le requête HTTP pour obtenir le fichier, avec des en-têtes et une méthode personnalisable","self"),li=_({width:["number < 1024","@","Largeur en pixels du tenseur d'entrée du modèle"],height:["number < 1024","@","Hauteur en pixels du tenseur d'entrée du modèle"],"disposition?":_(['"CHW"',"@","Tenseurs de la forme [3, H, W]"]).or(_(['"1CHW"',"@","Tenseurs de la forme [1, 3, H, W]"])),normalized:["boolean","@","Si les valeurs des pixels doivent être normalisées entre 0 et 1. Sinon, elles sont entre 0 et 255"],"name?":["string","@","Nom de l'input du modèle à utiliser. Par défaut, prend la première input"]}),ci=_({width:"number > 0",height:"number > 0"}).pipe(({width:t,height:e})=>({width:t,height:e,aspectRatio:t/e})),wu=6048e5,Wy=864e5,$m=6e4,Rm=36e5,Tm=1e3,Jy=43200,Yy=1440,Ss=Symbol.for("constructDateFrom");function re(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Ss in t?t[Ss](e):t instanceof Date?new t.constructor(e):new Date(e)}function ie(t,e){return re(e||t,t)}function ku(t,e,r){const n=ie(t,r?.in);return isNaN(e)?re(r?.in||t,NaN):(e&&n.setDate(n.getDate()+e),n)}let Su={};function Rt(){return Su}function Qy(t){Su=t}function Fe(t,e){const r=Rt(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=ie(t,e?.in),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function lt(t,e){return Fe(t,{...e,weekStartsOn:1})}function Bm(t,e){const r=ie(t,e?.in),n=r.getFullYear(),i=re(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const s=lt(i),a=re(r,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const l=lt(a);return r.getTime()>=s.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function _u(t){const e=ie(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function qm(t,e){const r=Bm(t,e),n=re(t,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),lt(n)}function Fm(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Km(t){return!(!Fm(t)&&typeof t!="number"||isNaN(+ie(t)))}const jm={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Um=(t,e,r)=>{let n;const i=jm[t];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function tn(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const zm={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Hm={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Vm={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Gm={date:tn({formats:zm,defaultWidth:"full"}),time:tn({formats:Hm,defaultWidth:"full"}),dateTime:tn({formats:Vm,defaultWidth:"full"})},Wm={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Jm=(t,e,r,n)=>Wm[t];function mt(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&t.formattingValues){const a=t.defaultFormattingWidth||t.defaultWidth,l=r?.width?String(r.width):a;i=t.formattingValues[l]||t.formattingValues[a]}else{const a=t.defaultWidth,l=r?.width?String(r.width):t.defaultWidth;i=t.values[l]||t.values[a]}const s=t.argumentCallback?t.argumentCallback(e):e;return i[s]}}const Ym={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Qm={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Xm={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Zm={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eg={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tg={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rg=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ng={ordinalNumber:rg,era:mt({values:Ym,defaultWidth:"wide"}),quarter:mt({values:Qm,defaultWidth:"wide",argumentCallback:t=>t-1}),month:mt({values:Xm,defaultWidth:"wide"}),day:mt({values:Zm,defaultWidth:"wide"}),dayPeriod:mt({values:eg,defaultWidth:"wide",formattingValues:tg,defaultFormattingWidth:"wide"})};function gt(t){return(e,r={})=>{const n=r.width,i=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],h=Array.isArray(l)?sg(l,p=>p.test(a)):ig(l,p=>p.test(a));let d;d=t.valueCallback?t.valueCallback(h):h,d=r.valueCallback?r.valueCallback(d):d;const f=e.slice(a.length);return{value:d,rest:f}}}function ig(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function sg(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function og(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const i=n[0],s=e.match(t.parsePattern);if(!s)return null;let a=t.valueCallback?t.valueCallback(s[0]):s[0];a=r.valueCallback?r.valueCallback(a):a;const l=e.slice(i.length);return{value:a,rest:l}}}const ag=/^(\d+)(th|st|nd|rd)?/i,ug=/\d+/i,lg={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},cg={any:[/^b/i,/^(a|c)/i]},dg={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},hg={any:[/1/i,/2/i,/3/i,/4/i]},fg={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},pg={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},mg={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},gg={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},yg={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},bg={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vg={ordinalNumber:og({matchPattern:ag,parsePattern:ug,valueCallback:t=>parseInt(t,10)}),era:gt({matchPatterns:lg,defaultMatchWidth:"wide",parsePatterns:cg,defaultParseWidth:"any"}),quarter:gt({matchPatterns:dg,defaultMatchWidth:"wide",parsePatterns:hg,defaultParseWidth:"any",valueCallback:t=>t+1}),month:gt({matchPatterns:fg,defaultMatchWidth:"wide",parsePatterns:pg,defaultParseWidth:"any"}),day:gt({matchPatterns:mg,defaultMatchWidth:"wide",parsePatterns:gg,defaultParseWidth:"any"}),dayPeriod:gt({matchPatterns:yg,defaultMatchWidth:"any",parsePatterns:bg,defaultParseWidth:"any"})},xg={code:"en-US",formatDistance:Um,formatLong:Gm,formatRelative:Jm,localize:ng,match:vg,options:{weekStartsOn:0,firstWeekContainsDate:1}};function wg(t,e){const r=ie(t,e?.in),n=+lt(r)-+qm(r);return Math.round(n/wu)+1}function Pu(t,e){const r=ie(t,e?.in),n=r.getFullYear(),i=Rt(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,a=re(e?.in||t,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const l=Fe(a,e),h=re(e?.in||t,0);h.setFullYear(n,0,s),h.setHours(0,0,0,0);const d=Fe(h,e);return+r>=+l?n+1:+r>=+d?n:n-1}function kg(t,e){const r=Rt(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=Pu(t,e),s=re(e?.in||t,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),Fe(s,e)}function Sg(t,e){const r=ie(t,e?.in),n=+Fe(r,e)-+kg(r,e);return Math.round(n/wu)+1}const _s=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Iu=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},_g=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return _s(t,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",_s(n,e)).replace("{{time}}",Iu(i,e))},Ps={p:Iu,P:_g},Pg=/^D+$/,Ig=/^Y+$/,Cg=["D","DD","YY","YYYY"];function Og(t){return Pg.test(t)}function Mg(t){return Ig.test(t)}function Is(t,e,r){const n=Ag(t,e,r);if(console.warn(n),Cg.includes(t))throw new RangeError(n)}function Ag(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function Ng(){return Object.assign({},Rt())}function Dg(t,e){const r=ie(t,e?.in).getDay();return r===0?7:r}function Eg(t,e){const r=Lg(e)?new e(0):re(e,0);return r.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),r.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),r}function Lg(t){return typeof t=="function"&&t.prototype?.constructor===t}const $g=10;class Cu{subPriority=0;validate(e,r){return!0}}class Rg extends Cu{constructor(e,r,n,i,s){super(),this.value=e,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(e,r){return this.validateValue(e,this.value,r)}set(e,r,n){return this.setValue(e,r,this.value,n)}}class Tg extends Cu{priority=$g;subPriority=-1;constructor(e,r){super(),this.context=e||(n=>re(r,n))}set(e,r){return r.timestampIsSet?e:re(e,Eg(e,this.context))}}class T{run(e,r,n,i){const s=this.parse(e,r,n,i);return s?{setter:new Rg(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,r,n){return!0}}class Bg extends T{priority=140;parse(e,r,n){switch(r){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});case"GGGG":default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,r,n){return r.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]}const W={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},we={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function J(t,e){return t&&{value:e(t.value),rest:t.rest}}function U(t,e){const r=e.match(t);return r?{value:parseInt(r[0],10),rest:e.slice(r[0].length)}:null}function ke(t,e){const r=e.match(t);if(!r)return null;if(r[0]==="Z")return{value:0,rest:e.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,a=r[5]?parseInt(r[5],10):0;return{value:n*(i*Rm+s*$m+a*Tm),rest:e.slice(r[0].length)}}function Ou(t){return U(W.anyDigitsSigned,t)}function H(t,e){switch(t){case 1:return U(W.singleDigit,e);case 2:return U(W.twoDigits,e);case 3:return U(W.threeDigits,e);case 4:return U(W.fourDigits,e);default:return U(new RegExp("^\\d{1,"+t+"}"),e)}}function Cr(t,e){switch(t){case 1:return U(W.singleDigitSigned,e);case 2:return U(W.twoDigitsSigned,e);case 3:return U(W.threeDigitsSigned,e);case 4:return U(W.fourDigitsSigned,e);default:return U(new RegExp("^-?\\d{1,"+t+"}"),e)}}function di(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function Mu(t,e){const r=e>0,n=r?e:1-e;let i;if(n<=50)i=t||100;else{const s=n+50,a=Math.trunc(s/100)*100,l=t>=s%100;i=t+a-(l?100:0)}return r?i:1-i}function Au(t){return t%400===0||t%4===0&&t%100!==0}class qg extends T{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,r,n){const i=s=>({year:s,isTwoDigitYear:r==="yy"});switch(r){case"y":return J(H(4,e),i);case"yo":return J(n.ordinalNumber(e,{unit:"year"}),i);default:return J(H(r.length,e),i)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,n){const i=e.getFullYear();if(n.isTwoDigitYear){const a=Mu(n.year,i);return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}const s=!("era"in r)||r.era===1?n.year:1-n.year;return e.setFullYear(s,0,1),e.setHours(0,0,0,0),e}}class Fg extends T{priority=130;parse(e,r,n){const i=s=>({year:s,isTwoDigitYear:r==="YY"});switch(r){case"Y":return J(H(4,e),i);case"Yo":return J(n.ordinalNumber(e,{unit:"year"}),i);default:return J(H(r.length,e),i)}}validate(e,r){return r.isTwoDigitYear||r.year>0}set(e,r,n,i){const s=Pu(e,i);if(n.isTwoDigitYear){const l=Mu(n.year,s);return e.setFullYear(l,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Fe(e,i)}const a=!("era"in r)||r.era===1?n.year:1-n.year;return e.setFullYear(a,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Fe(e,i)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class Kg extends T{priority=130;parse(e,r){return Cr(r==="R"?4:r.length,e)}set(e,r,n){const i=re(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),lt(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class jg extends T{priority=130;parse(e,r){return Cr(r==="u"?4:r.length,e)}set(e,r,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class Ug extends T{priority=120;parse(e,r,n){switch(r){case"Q":case"QQ":return H(r.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=1&&r<=4}set(e,r,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class zg extends T{priority=120;parse(e,r,n){switch(r){case"q":case"qq":return H(r.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=1&&r<=4}set(e,r,n){return e.setMonth((n-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class Hg extends T{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,r,n){const i=s=>s-1;switch(r){case"M":return J(U(W.month,e),i);case"MM":return J(H(2,e),i);case"Mo":return J(n.ordinalNumber(e,{unit:"month"}),i);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}}class Vg extends T{priority=110;parse(e,r,n){const i=s=>s-1;switch(r){case"L":return J(U(W.month,e),i);case"LL":return J(H(2,e),i);case"Lo":return J(n.ordinalNumber(e,{unit:"month"}),i);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function Gg(t,e,r){const n=ie(t,r?.in),i=Sg(n,r)-e;return n.setDate(n.getDate()-i*7),ie(n,r?.in)}class Wg extends T{priority=100;parse(e,r,n){switch(r){case"w":return U(W.week,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return H(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,n,i){return Fe(Gg(e,n,i),i)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function Jg(t,e,r){const n=ie(t,r?.in),i=wg(n,r)-e;return n.setDate(n.getDate()-i*7),n}class Yg extends T{priority=100;parse(e,r,n){switch(r){case"I":return U(W.week,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return H(r.length,e)}}validate(e,r){return r>=1&&r<=53}set(e,r,n){return lt(Jg(e,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const Qg=[31,28,31,30,31,30,31,31,30,31,30,31],Xg=[31,29,31,30,31,30,31,31,30,31,30,31];class Zg extends T{priority=90;subPriority=1;parse(e,r,n){switch(r){case"d":return U(W.date,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return H(r.length,e)}}validate(e,r){const n=e.getFullYear(),i=Au(n),s=e.getMonth();return i?r>=1&&r<=Xg[s]:r>=1&&r<=Qg[s]}set(e,r,n){return e.setDate(n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class e0 extends T{priority=90;subpriority=1;parse(e,r,n){switch(r){case"D":case"DD":return U(W.dayOfYear,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return H(r.length,e)}}validate(e,r){const n=e.getFullYear();return Au(n)?r>=1&&r<=366:r>=1&&r<=365}set(e,r,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function hi(t,e,r){const n=Rt(),i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=ie(t,r?.in),a=s.getDay(),h=(e%7+7)%7,d=7-i,f=e<0||e>6?e-(a+d)%7:(h+d)%7-(a+d)%7;return ku(s,f,r)}class t0 extends T{priority=90;parse(e,r,n){switch(r){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=hi(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]}class r0 extends T{priority=90;parse(e,r,n,i){const s=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(r){case"e":case"ee":return J(H(r.length,e),s);case"eo":return J(n.ordinalNumber(e,{unit:"day"}),s);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=hi(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class n0 extends T{priority=90;parse(e,r,n,i){const s=a=>{const l=Math.floor((a-1)/7)*7;return(a+i.weekStartsOn+6)%7+l};switch(r){case"c":case"cc":return J(H(r.length,e),s);case"co":return J(n.ordinalNumber(e,{unit:"day"}),s);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,r){return r>=0&&r<=6}set(e,r,n,i){return e=hi(e,n,i),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function i0(t,e,r){const n=ie(t,r?.in),i=Dg(n,r),s=e-i;return ku(n,s,r)}class s0 extends T{priority=90;parse(e,r,n){const i=s=>s===0?7:s;switch(r){case"i":case"ii":return H(r.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return J(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiii":return J(n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiiii":return J(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiii":default:return J(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i)}}validate(e,r){return r>=1&&r<=7}set(e,r,n){return e=i0(e,n),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class o0 extends T{priority=80;parse(e,r,n){switch(r){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(di(n),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]}class a0 extends T{priority=80;parse(e,r,n){switch(r){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(di(n),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]}class u0 extends T{priority=80;parse(e,r,n){switch(r){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,r,n){return e.setHours(di(n),0,0,0),e}incompatibleTokens=["a","b","t","T"]}class l0 extends T{priority=70;parse(e,r,n){switch(r){case"h":return U(W.hour12h,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return H(r.length,e)}}validate(e,r){return r>=1&&r<=12}set(e,r,n){const i=e.getHours()>=12;return i&&n<12?e.setHours(n+12,0,0,0):!i&&n===12?e.setHours(0,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]}class c0 extends T{priority=70;parse(e,r,n){switch(r){case"H":return U(W.hour23h,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return H(r.length,e)}}validate(e,r){return r>=0&&r<=23}set(e,r,n){return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]}class d0 extends T{priority=70;parse(e,r,n){switch(r){case"K":return U(W.hour11h,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return H(r.length,e)}}validate(e,r){return r>=0&&r<=11}set(e,r,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]}class h0 extends T{priority=70;parse(e,r,n){switch(r){case"k":return U(W.hour24h,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return H(r.length,e)}}validate(e,r){return r>=1&&r<=24}set(e,r,n){const i=n<=24?n%24:n;return e.setHours(i,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]}class f0 extends T{priority=60;parse(e,r,n){switch(r){case"m":return U(W.minute,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return H(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,n){return e.setMinutes(n,0,0),e}incompatibleTokens=["t","T"]}class p0 extends T{priority=50;parse(e,r,n){switch(r){case"s":return U(W.second,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return H(r.length,e)}}validate(e,r){return r>=0&&r<=59}set(e,r,n){return e.setSeconds(n,0),e}incompatibleTokens=["t","T"]}class m0 extends T{priority=30;parse(e,r){const n=i=>Math.trunc(i*Math.pow(10,-r.length+3));return J(H(r.length,e),n)}set(e,r,n){return e.setMilliseconds(n),e}incompatibleTokens=["t","T"]}class g0 extends T{priority=10;parse(e,r){switch(r){case"X":return ke(we.basicOptionalMinutes,e);case"XX":return ke(we.basic,e);case"XXXX":return ke(we.basicOptionalSeconds,e);case"XXXXX":return ke(we.extendedOptionalSeconds,e);case"XXX":default:return ke(we.extended,e)}}set(e,r,n){return r.timestampIsSet?e:re(e,e.getTime()-_u(e)-n)}incompatibleTokens=["t","T","x"]}class y0 extends T{priority=10;parse(e,r){switch(r){case"x":return ke(we.basicOptionalMinutes,e);case"xx":return ke(we.basic,e);case"xxxx":return ke(we.basicOptionalSeconds,e);case"xxxxx":return ke(we.extendedOptionalSeconds,e);case"xxx":default:return ke(we.extended,e)}}set(e,r,n){return r.timestampIsSet?e:re(e,e.getTime()-_u(e)-n)}incompatibleTokens=["t","T","X"]}class b0 extends T{priority=40;parse(e){return Ou(e)}set(e,r,n){return[re(e,n*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class v0 extends T{priority=20;parse(e){return Ou(e)}set(e,r,n){return[re(e,n),{timestampIsSet:!0}]}incompatibleTokens="*"}const x0={G:new Bg,y:new qg,Y:new Fg,R:new Kg,u:new jg,Q:new Ug,q:new zg,M:new Hg,L:new Vg,w:new Wg,I:new Yg,d:new Zg,D:new e0,E:new t0,e:new r0,c:new n0,i:new s0,a:new o0,b:new a0,B:new u0,h:new l0,H:new c0,K:new d0,k:new h0,m:new f0,s:new p0,S:new m0,X:new g0,x:new y0,t:new b0,T:new v0},w0=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,k0=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,S0=/^'([^]*?)'?$/,_0=/''/g,P0=/\S/,I0=/[a-zA-Z]/;function C0(t,e,r,n){const i=()=>re(r,NaN),s=Ng(),a=s.locale??xg,l=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,h=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(!e)return t?i():ie(r,n?.in);const d={firstWeekContainsDate:l,weekStartsOn:h,locale:a},f=[new Tg(n?.in,r)],p=e.match(k0).map(m=>{const b=m[0];if(b in Ps){const v=Ps[b];return v(m,a.formatLong)}return m}).join("").match(w0),c=[];for(let m of p){Mg(m)&&Is(m,e,t),Og(m)&&Is(m,e,t);const b=m[0],v=x0[b];if(v){const{incompatibleTokens:w}=v;if(Array.isArray(w)){const x=c.find(k=>w.includes(k.token)||k.token===b);if(x)throw new RangeError(`The format string mustn't contain \`${x.fullToken}\` and \`${m}\` at the same time`)}else if(v.incompatibleTokens==="*"&&c.length>0)throw new RangeError(`The format string mustn't contain \`${m}\` and any other token at the same time`);c.push({token:b,fullToken:m});const y=v.run(t,m,a.match,d);if(!y)return i();f.push(y.setter),t=y.rest}else{if(b.match(I0))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");if(m==="''"?m="'":b==="'"&&(m=O0(m)),t.indexOf(m)===0)t=t.slice(m.length);else return i()}}if(t.length>0&&P0.test(t))return i();const u=f.map(m=>m.priority).sort((m,b)=>b-m).filter((m,b,v)=>v.indexOf(m)===b).map(m=>f.filter(b=>b.priority===m).sort((b,v)=>v.subPriority-b.subPriority)).map(m=>m[0]);let o=ie(r,n?.in);if(isNaN(+o))return i();const g={};for(const m of u){if(!m.validate(o,d))return i();const b=m.set(o,g,d);Array.isArray(b)?(o=b[0],Object.assign(g,b[1])):o=b}return o}function O0(t){return t.match(S0)[1].replace(_0,"'")}function M0(t){return A0(t,"yyyy-MM-dd","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSS","yyyy-MM-dd'T'HH:mm:ssXXX","yyyy-MM-dd'T'HH:mm:ss.SSSXXX")}function A0(t,...e){for(const r of e)try{const n=C0(t,r,new Date);if(Km(n))return n}catch{continue}}const N0={InteropIndex:1,InteropVersion:2,ProcessingSoftware:11,SubfileType:254,OldSubfileType:255,ImageWidth:256,ImageHeight:257,BitsPerSample:258,Compression:259,PhotometricInterpretation:262,Thresholding:263,CellWidth:264,CellLength:265,FillOrder:266,DocumentName:269,ImageDescription:270,Make:271,Model:272,StripOffsets:273,Orientation:274,SamplesPerPixel:277,RowsPerStrip:278,StripByteCounts:279,MinSampleValue:280,MaxSampleValue:281,XResolution:282,YResolution:283,PlanarConfiguration:284,PageName:285,XPosition:286,YPosition:287,FreeOffsets:288,FreeByteCounts:289,GrayResponseUnit:290,GrayResponseCurve:291,T4Options:292,T6Options:293,ResolutionUnit:296,PageNumber:297,ColorResponseUnit:300,TransferFunction:301,Software:305,ModifyDate:306,Artist:315,HostComputer:316,Predictor:317,WhitePoint:318,PrimaryChromaticities:319,ColorMap:320,HalftoneHints:321,TileWidth:322,TileLength:323,TileOffsets:324,TileByteCounts:325,BadFaxLines:326,CleanFaxData:327,ConsecutiveBadFaxLines:328,SubIFD:330,InkSet:332,InkNames:333,NumberofInks:334,DotRange:336,TargetPrinter:337,ExtraSamples:338,SampleFormat:339,SMinSampleValue:340,SMaxSampleValue:341,TransferRange:342,ClipPath:343,XClipPathUnits:344,YClipPathUnits:345,Indexed:346,JPEGTables:347,OPIProxy:351,GlobalParametersIFD:400,ProfileType:401,FaxProfile:402,CodingMethods:403,VersionYear:404,ModeNumber:405,Decode:433,DefaultImageColor:434,T82Options:435,JPEGProc:512,ThumbnailOffset:513,ThumbnailLength:514,JPEGRestartInterval:515,JPEGLosslessPredictors:517,JPEGPointTransforms:518,JPEGQTables:519,JPEGDCTables:520,JPEGACTables:521,YCbCrCoefficients:529,YCbCrSubSampling:530,YCbCrPositioning:531,ReferenceBlackWhite:532,StripRowCounts:559,ApplicationNotes:700,USPTOMiscellaneous:999,RelatedImageFileFormat:4096,RelatedImageWidth:4097,RelatedImageHeight:4098,Rating:18246,XP_DIP_XML:18247,StitchInfo:18248,RatingPercent:18249,ImageID:32781,WangTag1:32931,WangAnnotation:32932,WangTag3:32933,WangTag4:32934,Matteing:32995,DataType:32996,ImageDepth:32997,TileDepth:32998,Model2:33405,CFARepeatPatternDim:33421,CFAPattern2:33422,BatteryLevel:33423,KodakIFD:33424,Copyright:33432,ExposureTime:33434,FNumber:33437,MDFileTag:33445,MDScalePixel:33446,MDColorTable:33447,MDLabName:33448,MDSampleInfo:33449,MDPrepDate:33450,MDPrepTime:33451,MDFileUnits:33452,PixelScale:33550,AdventScale:33589,AdventRevision:33590,UIC1Tag:33628,UIC2Tag:33629,UIC3Tag:33630,UIC4Tag:33631,"IPTC-NAA":33723,IntergraphPacketData:33918,IntergraphFlagRegisters:33919,IntergraphMatrix:33920,INGRReserved:33921,ModelTiePoint:33922,Site:34016,ColorSequence:34017,IT8Header:34018,RasterPadding:34019,BitsPerRunLength:34020,BitsPerExtendedRunLength:34021,ColorTable:34022,ImageColorIndicator:34023,BackgroundColorIndicator:34024,ImageColorValue:34025,BackgroundColorValue:34026,PixelIntensityRange:34027,TransparencyIndicator:34028,ColorCharacterization:34029,HCUsage:34030,TrapIndicator:34031,CMYKEquivalent:34032,SEMInfo:34118,AFCP_IPTC:34152,PixelMagicJBIGOptions:34232,ModelTransform:34264,WB_GRGBLevels:34306,LeafData:34310,PhotoshopSettings:34377,ExifOffset:34665,ICC_Profile:34675,TIFF_FXExtensions:34687,MultiProfiles:34688,SharedData:34689,T88Options:34690,ImageLayer:34732,GeoTiffDirectory:34735,GeoTiffDoubleParams:34736,GeoTiffAsciiParams:34737,ExposureProgram:34850,SpectralSensitivity:34852,GPSInfo:34853,ISO:34855,"Opto-ElectricConvFactor":34856,Interlace:34857,TimeZoneOffset:34858,SelfTimerMode:34859,SensitivityType:34864,StandardOutputSensitivity:34865,RecommendedExposureIndex:34866,ISOSpeed:34867,ISOSpeedLatitudeyyy:34868,ISOSpeedLatitudezzz:34869,FaxRecvParams:34908,FaxSubAddress:34909,FaxRecvTime:34910,LeafSubIFD:34954,ExifVersion:36864,DateTimeOriginal:36867,CreateDate:36868,ComponentsConfiguration:37121,CompressedBitsPerPixel:37122,ShutterSpeedValue:37377,ApertureValue:37378,BrightnessValue:37379,ExposureCompensation:37380,MaxApertureValue:37381,SubjectDistance:37382,MeteringMode:37383,LightSource:37384,Flash:37385,FocalLength:37386,FlashEnergy:37387,SpatialFrequencyResponse:37388,Noise:37389,FocalPlaneXResolution:37390,FocalPlaneYResolution:37391,FocalPlaneResolutionUnit:37392,ImageNumber:37393,SecurityClassification:37394,ImageHistory:37395,SubjectArea:37396,ExposureIndex:37397,"TIFF-EPStandardID":37398,SensingMethod:37399,CIP3DataFile:37434,CIP3Sheet:37435,CIP3Side:37436,StoNits:37439,MakerNote:37500,UserComment:37510,SubSecTime:37520,SubSecTimeOriginal:37521,SubSecTimeDigitized:37522,MSDocumentText:37679,MSPropertySetStorage:37680,MSDocumentTextPosition:37681,ImageSourceData:37724,XPTitle:40091,XPComment:40092,XPAuthor:40093,XPKeywords:40094,XPSubject:40095,FlashpixVersion:40960,ColorSpace:40961,ExifImageWidth:40962,ExifImageHeight:40963,RelatedSoundFile:40964,InteropOffset:40965,SubjectLocation:41492,FileSource:41728,SceneType:41729,CFAPattern:41730,CustomRendered:41985,ExposureMode:41986,WhiteBalance:41987,DigitalZoomRatio:41988,FocalLengthIn35mmFormat:41989,SceneCaptureType:41990,GainControl:41991,Contrast:41992,Saturation:41993,Sharpness:41994,DeviceSettingDescription:41995,SubjectDistanceRange:41996,ImageUniqueID:42016,OwnerName:42032,SerialNumber:42033,LensInfo:42034,LensMake:42035,LensModel:42036,LensSerialNumber:42037,GDALMetadata:42112,GDALNoData:42113,Gamma:42240,ExpandSoftware:44992,ExpandLens:44993,ExpandFilm:44994,ExpandFilterLens:44995,ExpandScanner:44996,ExpandFlashLamp:44997,PixelFormat:48129,Transformation:48130,Uncompressed:48131,ImageType:48132,WidthResolution:48258,HeightResolution:48259,ImageOffset:48320,ImageByteCount:48321,AlphaOffset:48322,AlphaByteCount:48323,ImageDataDiscard:48324,AlphaDataDiscard:48325,OceScanjobDesc:50215,OceApplicationSelector:50216,OceIDNumber:50217,OceImageLogic:50218,Annotations:50255,PrintIM:50341,USPTOOriginalContentType:50560,DNGVersion:50706,DNGBackwardVersion:50707,UniqueCameraModel:50708,LocalizedCameraModel:50709,CFAPlaneColor:50710,CFALayout:50711,LinearizationTable:50712,BlackLevelRepeatDim:50713,BlackLevel:50714,BlackLevelDeltaH:50715,BlackLevelDeltaV:50716,WhiteLevel:50717,DefaultScale:50718,DefaultCropOrigin:50719,DefaultCropSize:50720,ColorMatrix1:50721,ColorMatrix2:50722,CameraCalibration1:50723,CameraCalibration2:50724,ReductionMatrix1:50725,ReductionMatrix2:50726,AnalogBalance:50727,AsShotNeutral:50728,AsShotWhiteXY:50729,BaselineExposure:50730,BaselineNoise:50731,BaselineSharpness:50732,BayerGreenSplit:50733,LinearResponseLimit:50734,CameraSerialNumber:50735,DNGLensInfo:50736,ChromaBlurRadius:50737,AntiAliasStrength:50738,ShadowScale:50739,DNGPrivateData:50740,MakerNoteSafety:50741,RawImageSegmentation:50752,CalibrationIlluminant1:50778,CalibrationIlluminant2:50779,BestQualityScale:50780,RawDataUniqueID:50781,AliasLayerMetadata:50784,OriginalRawFileName:50827,OriginalRawFileData:50828,ActiveArea:50829,MaskedAreas:50830,AsShotICCProfile:50831,AsShotPreProfileMatrix:50832,CurrentICCProfile:50833,CurrentPreProfileMatrix:50834,ColorimetricReference:50879,PanasonicTitle:50898,PanasonicTitle2:50899,CameraCalibrationSig:50931,ProfileCalibrationSig:50932,ProfileIFD:50933,AsShotProfileName:50934,NoiseReductionApplied:50935,ProfileName:50936,ProfileHueSatMapDims:50937,ProfileHueSatMapData1:50938,ProfileHueSatMapData2:50939,ProfileToneCurve:50940,ProfileEmbedPolicy:50941,ProfileCopyright:50942,ForwardMatrix1:50964,ForwardMatrix2:50965,PreviewApplicationName:50966,PreviewApplicationVersion:50967,PreviewSettingsName:50968,PreviewSettingsDigest:50969,PreviewColorSpace:50970,PreviewDateTime:50971,RawImageDigest:50972,OriginalRawFileDigest:50973,SubTileBlockSize:50974,RowInterleaveFactor:50975,ProfileLookTableDims:50981,ProfileLookTableData:50982,OpcodeList1:51008,OpcodeList2:51009,OpcodeList3:51022,NoiseProfile:51041,TimeCodes:51043,FrameRate:51044,TStop:51058,ReelName:51081,OriginalDefaultFinalSize:51089,OriginalBestQualitySize:51090,OriginalDefaultCropSize:51091,CameraLabel:51105,ProfileHueSatMapEncoding:51107,ProfileLookTableEncoding:51108,BaselineExposureOffset:51109,DefaultBlackRender:51110,NewRawImageDigest:51111,RawToPreviewGain:51112,DefaultUserCrop:51125,Padding:59932,OffsetSchema:59933,Lens:65002,KDC_IFD:65024,RawFile:65100,Converter:65101,Exposure:65105,Shadows:65106,Brightness:65107,Smoothness:65111,MoireFilter:65112},D0={GPSVersionID:0,GPSLatitudeRef:1,GPSLatitude:2,GPSLongitudeRef:3,GPSLongitude:4,GPSAltitudeRef:5,GPSAltitude:6,GPSTimeStamp:7,GPSSatellites:8,GPSStatus:9,GPSMeasureMode:10,GPSDOP:11,GPSSpeedRef:12,GPSSpeed:13,GPSTrackRef:14,GPSTrack:15,GPSImgDirectionRef:16,GPSImgDirection:17,GPSMapDatum:18,GPSDestLatitudeRef:19,GPSDestLatitude:20,GPSDestLongitudeRef:21,GPSDestLongitude:22,GPSDestBearingRef:23,GPSDestBearing:24,GPSDestDistanceRef:25,GPSDestDistance:26,GPSProcessingMethod:27,GPSAreaInformation:28,GPSDateStamp:29,GPSDifferential:30,GPSHPositioningError:31},E0={...N0,...D0};function Xy(t,e){return`${t}:${e}`}function Zy(t){const e=t.split(":");if(e.length<2)throw new Error(`Invalid metadata option ID: ${t}`);const r=e.slice(0,-1).join(":"),n=e[e.length-1];return{metadataId:r,key:n}}const $e={string:{label:"texte",help:"du texte"},boolean:{label:"booléen",help:"vrai ou faux"},integer:{label:"entier",help:"un entier"},float:{label:"nombre",help:"un nombre, potentiellement à virgule"},enum:{label:"énumération",help:"un ensemble de valeur fixes"},date:{label:"date",help:"une date"},location:{label:"localisation",help:"un objet avec deux nombres, `latitude` et `longitude`"},boundingbox:{label:"région d'image",help:"un objet représentant une région rectangulaire au format YOLO"}},Ln=_.or(_("'string'","@",$e.string.help),_("'boolean'","@",$e.boolean.help),_("'integer'","@",$e.integer.help),_("'float'","@",$e.float.help),_("'enum'","@",$e.enum.help),_("'date'","@",$e.date.help),_("'location'","@",$e.location.help),_("'boundingbox'","@",$e.boundingbox.help)),ce={string:_("string"),boolean:_("boolean"),integer:_("number"),float:_("number"),enum:_("string | number"),date:_("Date"),location:_({latitude:"number",longitude:"number"}),boundingbox:_({x:"number",y:"number",w:"number",h:"number"})},L0=_.or(ce.string,ce.boolean,ce.integer,ce.float,ce.enum,ce.date,ce.location,ce.boundingbox),$0=_({value:_("string.json").pipe(t=>{let e=JSON.parse(t);return typeof e=="string"&&(e=M0(e)??e),e},L0),confidence:ks.default(1),manuallyModified:_("boolean").describe("Si la valeur a été modifiée manuellement").default(!1),alternatives:{"[string.json]":ks}}),fi=qr({ID:z}).type({"[ID]":$0}),Qe={min:{label:"Minimum",help:"Choisir la valeur avec la meilleure confiance, et prendre la plus petite valeur en cas d'ambuiguité"},max:{label:"Maximum",help:"Choisir la valeur avec la meilleure confiance, et prendre la plus grande valeur en cas d'ambuiguité"},average:{label:"Moyenne",help:"Prend la moyenne des valeurs"},median:{label:"Médiane",help:"Prend la médiane des valeurs"},union:{label:"Union",help:"Spécifique aux boîtes de recadrage: fusionne les boîtes de recadrage en la plus petite boîte englobant toutes les boîtes"},none:{label:"Aucune",help:"Ne pas fusionner"}},R0=_.or(_('"min"',"@",Qe.min.help),_('"max"',"@",Qe.max.help),_('"average"',"@",Qe.average.help),_('"median"',"@",Qe.median.help),_('"none"',"@",Qe.none.help),_('"union"',"@",Qe.union.help)),Nu=_({key:[z,"@","Identifiant unique pour cette option"],label:["string","@","Nom de l'option, affichable dans une interface utilisateur"],synonyms:_("string[]").describe("Synonymes (labels alternatifs) pour cette option").default(()=>[]),"description?":_("string").describe("Description (optionnelle) de cette option"),"index?":_("number").describe("Nombre permettant de trier les options dans l'interface. Par défaut, correspond à l'indice de l'option dans l'ordre de définition de sa métadonnée"),"image?":Ve.configure({deprecated:!0,description:"Image illustrant cette option de l'énumération. Utiliser plutôt `images` avec un seul élément."}),"images?":Ve.array().describe("Liste d'images illustrant cette option de l'énumération. Permet d'en spécifier plusieurs"),"learnMore?":Ve.describe("Lien pour en savoir plus sur cette option de l'énumération en particulier"),"color?":Lm.describe("Code hexadécimal (avec ou sans le # préfixe) d'une couleur associée à cette option, pour l'affichage dans l'interface"),"icon?":_(/^ri:[\w-]+$/).describe("Code Iconify d'une icône associée à cette option, provenant du pack d'icônes “Remix Icon”. Voir https://icon-sets.iconify.design/ri/ pour la liste."),"cascade?":qr({ID:z}).type({"[ID]":"ID"}).describe('Objet contenant pour clés des identifiants d\'autres métadonnées, et pour valeurs la valeur à assigner à cette métadonnée si cette option est choisie. Le processus est récursif: Imaginons une métadonnée species ayant une option avec `{ key: "1", cascade: { genus: "2" } }`, une métadonnée genus ayant une option `{ key: "2", cascade: { family: "3" } }`. Si l\'option "1" de la métadonnée species est choisie, la métadonnée genus sera définie sur l\'option "2" et la métadonnée family sera à son tour définie sur l\'option "3".')}),T0=_.enumerated(...jn(E0)),B0=_({neural:_({model:Ir.describe("Lien vers le modèle de classification utilisé pour inférer les métadonnées. Au format ONNX (.onnx) seulement, pour le moment."),classmapping:Ir.describe("Fichier texte contenant une clé de la métadonnée par ligne, dans le même ordre que les neurones de sortie du modèle."),"name?":["string","@","Nom du réseau à afficher dans l'interface. Particulièrement utile si il y a plusieurs réseaux"],input:li.describe("Configuration de l'entrée des modèles"),"output?":_({"name?":["string","@","Nom de l'output du modèle à utiliser. output0 par défaut"]})}).array()}).describe("Inférer depuis un modèle de réseau de neurones","self"),q0=_({exif:T0}).describe("Inférer depuis un champ EXIF","self"),rn=_.or(q0,B0).describe("Comment inférer la valeur de cette métadonnée","self"),$n=_({id:z.describe("Identifiant unique pour la métadonnée. On conseille de mettre une partie qui vous identifie dans cet identifiant, car il doit être globalement unique. Par exemple, mon-organisation.ma-métadonnée"),label:["string","@","Nom de la métadonnée"],mergeMethod:R0.configure("Méthode utiliser pour fusionner plusieurs différentes valeurs d'une métadonnée. Notamment utilisé pour calculer la valeur d'une métadonnée sur une Observation à partir de ses images","self"),required:["boolean","@","Si la métadonnée est obligatoire"],description:["string","@","Description, pour aider à comprendre la métadonnée"],sortable:_("boolean").describe("Si la métadonnée peut être utilisée pour trier des images ou observations").default(!1),groupable:_("boolean").describe("Si la métadonnée peut être utilisée pour grouper des images ou observations").default(!1),type:Ln.describe("Type de la métadonnée"),learnMore:Ve.describe("Un lien pour en apprendre plus sur ce que cette métadonnée décrit").optional(),"options?":Nu.array().pipe(t=>sl(t,e=>e.key)).pipe(t=>t.map((e,r)=>({index:r,...e}))).describe('Les options valides. Uniquement utile pour une métadonnée de type "enum"')}).and(_.or({type:"'location'","infer?":{latitude:rn,longitude:rn}},{type:Ln.exclude('"location"'),"infer?":rn}));function Rn(t,e){return e=e.replace(/^.+__/,""),`${t}__${e}`}function eb(t,e){return F0(e,t)?t:Rn(e,t)}function F0(t,e){return e.startsWith(`${t}__`)}function K0(t){return t.replace(/^.+__/,"")}function j0(t){const e=t.split("__");if(!(e.length<2))return e.slice(0,-1).join("__")}function tb(t){return{namespace:j0(t),id:K0(t)}}const Du=_({id:/\d+(_\d+)*/,filename:"string",addedAt:"string.date.iso.parse",dimensions:ci,metadata:fi,contentType:/\w+\/\w+/,fileId:z.or("null").describe("ID vers l'objet ImageFile associé"),sessionId:z.describe("ID de la session à laquelle cette image appartient"),boundingBoxesAnalyzed:"boolean = false"}),Eu=_({id:z,sessionId:z.describe("ID de la session à laquelle cette observation appartient"),label:"string",addedAt:"string.date.iso.parse",metadataOverrides:fi,images:Pr});var Kt={exports:{}},jt={exports:{}},ye={},ue={},Cs;function de(){if(Cs)return ue;Cs=1,ue.__esModule=!0,ue.extend=i,ue.indexOf=h,ue.escapeExpression=d,ue.isEmpty=f,ue.createFrame=p,ue.blockParams=c,ue.appendContextPath=u;var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},e=/[&<>"'`=]/g,r=/[&<>"'`=]/;function n(o){return t[o]}function i(o){for(var g=1;g<arguments.length;g++)for(var m in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],m)&&(o[m]=arguments[g][m]);return o}var s=Object.prototype.toString;ue.toString=s;var a=function(g){return typeof g=="function"};a(/x/)&&(ue.isFunction=a=function(o){return typeof o=="function"&&s.call(o)==="[object Function]"}),ue.isFunction=a;var l=Array.isArray||function(o){return o&&typeof o=="object"?s.call(o)==="[object Array]":!1};ue.isArray=l;function h(o,g){for(var m=0,b=o.length;m<b;m++)if(o[m]===g)return m;return-1}function d(o){if(typeof o!="string"){if(o&&o.toHTML)return o.toHTML();if(o==null)return"";if(!o)return o+"";o=""+o}return r.test(o)?o.replace(e,n):o}function f(o){return!o&&o!==0?!0:!!(l(o)&&o.length===0)}function p(o){var g=i({},o);return g._parent=o,g}function c(o,g){return o.path=g,o}function u(o,g){return(o?o+".":"")+g}return ue}var Ut={exports:{}},Os;function ve(){return Os||(Os=1,(function(t,e){e.__esModule=!0;var r=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function n(i,s){var a=s&&s.loc,l=void 0,h=void 0,d=void 0,f=void 0;a&&(l=a.start.line,h=a.end.line,d=a.start.column,f=a.end.column,i+=" - "+l+":"+d);for(var p=Error.prototype.constructor.call(this,i),c=0;c<r.length;c++)this[r[c]]=p[r[c]];Error.captureStackTrace&&Error.captureStackTrace(this,n);try{a&&(this.lineNumber=l,this.endLineNumber=h,Object.defineProperty?(Object.defineProperty(this,"column",{value:d,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:f,enumerable:!0})):(this.column=d,this.endColumn=f))}catch{}}n.prototype=new Error,e.default=n,t.exports=e.default})(Ut,Ut.exports)),Ut.exports}var yt={},zt={exports:{}},Ms;function U0(){return Ms||(Ms=1,(function(t,e){e.__esModule=!0;var r=de();e.default=function(n){n.registerHelper("blockHelperMissing",function(i,s){var a=s.inverse,l=s.fn;if(i===!0)return l(this);if(i===!1||i==null)return a(this);if(r.isArray(i))return i.length>0?(s.ids&&(s.ids=[s.name]),n.helpers.each(i,s)):a(this);if(s.data&&s.ids){var h=r.createFrame(s.data);h.contextPath=r.appendContextPath(s.data.contextPath,s.name),s={data:h}}return l(i,s)})},t.exports=e.default})(zt,zt.exports)),zt.exports}var Ht={exports:{}},As;function z0(){return As||(As=1,(function(t,e){e.__esModule=!0;function r(a){return a&&a.__esModule?a:{default:a}}var n=de(),i=ve(),s=r(i);e.default=function(a){a.registerHelper("each",function(l,h){if(!h)throw new s.default("Must pass iterator to #each");var d=h.fn,f=h.inverse,p=0,c="",u=void 0,o=void 0;h.data&&h.ids&&(o=n.appendContextPath(h.data.contextPath,h.ids[0])+"."),n.isFunction(l)&&(l=l.call(this)),h.data&&(u=n.createFrame(h.data));function g(y,x,k){u&&(u.key=y,u.index=x,u.first=x===0,u.last=!!k,o&&(u.contextPath=o+y)),c=c+d(l[y],{data:u,blockParams:n.blockParams([l[y],y],[o+y,null])})}if(l&&typeof l=="object")if(n.isArray(l))for(var m=l.length;p<m;p++)p in l&&g(p,p,p===l.length-1);else if(typeof Symbol=="function"&&l[Symbol.iterator]){for(var b=[],v=l[Symbol.iterator](),w=v.next();!w.done;w=v.next())b.push(w.value);l=b;for(var m=l.length;p<m;p++)g(p,p,p===l.length-1)}else(function(){var y=void 0;Object.keys(l).forEach(function(x){y!==void 0&&g(y,p-1),y=x,p++}),y!==void 0&&g(y,p-1,!0)})();return p===0&&(c=f(this)),c})},t.exports=e.default})(Ht,Ht.exports)),Ht.exports}var Vt={exports:{}},Ns;function H0(){return Ns||(Ns=1,(function(t,e){e.__esModule=!0;function r(s){return s&&s.__esModule?s:{default:s}}var n=ve(),i=r(n);e.default=function(s){s.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new i.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default})(Vt,Vt.exports)),Vt.exports}var Gt={exports:{}},Ds;function V0(){return Ds||(Ds=1,(function(t,e){e.__esModule=!0;function r(a){return a&&a.__esModule?a:{default:a}}var n=de(),i=ve(),s=r(i);e.default=function(a){a.registerHelper("if",function(l,h){if(arguments.length!=2)throw new s.default("#if requires exactly one argument");return n.isFunction(l)&&(l=l.call(this)),!h.hash.includeZero&&!l||n.isEmpty(l)?h.inverse(this):h.fn(this)}),a.registerHelper("unless",function(l,h){if(arguments.length!=2)throw new s.default("#unless requires exactly one argument");return a.helpers.if.call(this,l,{fn:h.inverse,inverse:h.fn,hash:h.hash})})},t.exports=e.default})(Gt,Gt.exports)),Gt.exports}var Wt={exports:{}},Es;function G0(){return Es||(Es=1,(function(t,e){e.__esModule=!0,e.default=function(r){r.registerHelper("log",function(){for(var n=[void 0],i=arguments[arguments.length-1],s=0;s<arguments.length-1;s++)n.push(arguments[s]);var a=1;i.hash.level!=null?a=i.hash.level:i.data&&i.data.level!=null&&(a=i.data.level),n[0]=a,r.log.apply(r,n)})},t.exports=e.default})(Wt,Wt.exports)),Wt.exports}var Jt={exports:{}},Ls;function W0(){return Ls||(Ls=1,(function(t,e){e.__esModule=!0,e.default=function(r){r.registerHelper("lookup",function(n,i,s){return n&&s.lookupProperty(n,i)})},t.exports=e.default})(Jt,Jt.exports)),Jt.exports}var Yt={exports:{}},$s;function J0(){return $s||($s=1,(function(t,e){e.__esModule=!0;function r(a){return a&&a.__esModule?a:{default:a}}var n=de(),i=ve(),s=r(i);e.default=function(a){a.registerHelper("with",function(l,h){if(arguments.length!=2)throw new s.default("#with requires exactly one argument");n.isFunction(l)&&(l=l.call(this));var d=h.fn;if(n.isEmpty(l))return h.inverse(this);var f=h.data;return h.data&&h.ids&&(f=n.createFrame(h.data),f.contextPath=n.appendContextPath(h.data.contextPath,h.ids[0])),d(l,{data:f,blockParams:n.blockParams([l],[f&&f.contextPath])})})},t.exports=e.default})(Yt,Yt.exports)),Yt.exports}var Rs;function Lu(){if(Rs)return yt;Rs=1,yt.__esModule=!0,yt.registerDefaultHelpers=g,yt.moveHelperToHooks=m;function t(b){return b&&b.__esModule?b:{default:b}}var e=U0(),r=t(e),n=z0(),i=t(n),s=H0(),a=t(s),l=V0(),h=t(l),d=G0(),f=t(d),p=W0(),c=t(p),u=J0(),o=t(u);function g(b){r.default(b),i.default(b),a.default(b),h.default(b),f.default(b),c.default(b),o.default(b)}function m(b,v,w){b.helpers[v]&&(b.hooks[v]=b.helpers[v],w||delete b.helpers[v])}return yt}var Qt={},Xt={exports:{}},Ts;function Y0(){return Ts||(Ts=1,(function(t,e){e.__esModule=!0;var r=de();e.default=function(n){n.registerDecorator("inline",function(i,s,a,l){var h=i;return s.partials||(s.partials={},h=function(d,f){var p=a.partials;a.partials=r.extend({},p,s.partials);var c=i(d,f);return a.partials=p,c}),s.partials[l.args[0]]=l.fn,h})},t.exports=e.default})(Xt,Xt.exports)),Xt.exports}var Bs;function Q0(){if(Bs)return Qt;Bs=1,Qt.__esModule=!0,Qt.registerDefaultDecorators=n;function t(i){return i&&i.__esModule?i:{default:i}}var e=Y0(),r=t(e);function n(i){r.default(i)}return Qt}var Zt={exports:{}},qs;function $u(){return qs||(qs=1,(function(t,e){e.__esModule=!0;var r=de(),n={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(s){if(typeof s=="string"){var a=r.indexOf(n.methodMap,s.toLowerCase());a>=0?s=a:s=parseInt(s,10)}return s},log:function(s){if(s=n.lookupLevel(s),typeof console<"u"&&n.lookupLevel(n.level)<=s){var a=n.methodMap[s];console[a]||(a="log");for(var l=arguments.length,h=Array(l>1?l-1:0),d=1;d<l;d++)h[d-1]=arguments[d];console[a].apply(console,h)}}};e.default=n,t.exports=e.default})(Zt,Zt.exports)),Zt.exports}var Xe={},er={},Fs;function X0(){if(Fs)return er;Fs=1,er.__esModule=!0,er.createNewLookupObject=e;var t=de();function e(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.extend.apply(void 0,[Object.create(null)].concat(n))}return er}var Ks;function Ru(){if(Ks)return Xe;Ks=1,Xe.__esModule=!0,Xe.createProtoAccessControl=s,Xe.resultIsAllowed=a,Xe.resetLoggedProperties=d;function t(f){return f&&f.__esModule?f:{default:f}}var e=X0(),r=$u(),n=t(r),i=Object.create(null);function s(f){var p=Object.create(null);p.constructor=!1,p.__defineGetter__=!1,p.__defineSetter__=!1,p.__lookupGetter__=!1;var c=Object.create(null);return c.__proto__=!1,{properties:{whitelist:e.createNewLookupObject(c,f.allowedProtoProperties),defaultValue:f.allowProtoPropertiesByDefault},methods:{whitelist:e.createNewLookupObject(p,f.allowedProtoMethods),defaultValue:f.allowProtoMethodsByDefault}}}function a(f,p,c){return l(typeof f=="function"?p.methods:p.properties,c)}function l(f,p){return f.whitelist[p]!==void 0?f.whitelist[p]===!0:f.defaultValue!==void 0?f.defaultValue:(h(p),!1)}function h(f){i[f]!==!0&&(i[f]=!0,n.default.log("error",'Handlebars: Access has been denied to resolve the property "'+f+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function d(){Object.keys(i).forEach(function(f){delete i[f]})}return Xe}var js;function pi(){if(js)return ye;js=1,ye.__esModule=!0,ye.HandlebarsEnvironment=o;function t(m){return m&&m.__esModule?m:{default:m}}var e=de(),r=ve(),n=t(r),i=Lu(),s=Q0(),a=$u(),l=t(a),h=Ru(),d="4.7.8";ye.VERSION=d;var f=8;ye.COMPILER_REVISION=f;var p=7;ye.LAST_COMPATIBLE_COMPILER_REVISION=p;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};ye.REVISION_CHANGES=c;var u="[object Object]";function o(m,b,v){this.helpers=m||{},this.partials=b||{},this.decorators=v||{},i.registerDefaultHelpers(this),s.registerDefaultDecorators(this)}o.prototype={constructor:o,logger:l.default,log:l.default.log,registerHelper:function(b,v){if(e.toString.call(b)===u){if(v)throw new n.default("Arg not supported with multiple helpers");e.extend(this.helpers,b)}else this.helpers[b]=v},unregisterHelper:function(b){delete this.helpers[b]},registerPartial:function(b,v){if(e.toString.call(b)===u)e.extend(this.partials,b);else{if(typeof v>"u")throw new n.default('Attempting to register a partial called "'+b+'" as undefined');this.partials[b]=v}},unregisterPartial:function(b){delete this.partials[b]},registerDecorator:function(b,v){if(e.toString.call(b)===u){if(v)throw new n.default("Arg not supported with multiple decorators");e.extend(this.decorators,b)}else this.decorators[b]=v},unregisterDecorator:function(b){delete this.decorators[b]},resetLoggedPropertyAccesses:function(){h.resetLoggedProperties()}};var g=l.default.log;return ye.log=g,ye.createFrame=e.createFrame,ye.logger=l.default,ye}var tr={exports:{}},Us;function Z0(){return Us||(Us=1,(function(t,e){e.__esModule=!0;function r(n){this.string=n}r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default})(tr,tr.exports)),tr.exports}var Ie={},rr={},zs;function ey(){if(zs)return rr;zs=1,rr.__esModule=!0,rr.wrapHelper=t;function t(e,r){if(typeof e!="function")return e;var n=function(){var s=arguments[arguments.length-1];return arguments[arguments.length-1]=r(s),e.apply(this,arguments)};return n}return rr}var Hs;function ty(){if(Hs)return Ie;Hs=1,Ie.__esModule=!0,Ie.checkRevision=f,Ie.template=p,Ie.wrapProgram=c,Ie.resolvePartial=u,Ie.invokePartial=o,Ie.noop=g;function t(y){return y&&y.__esModule?y:{default:y}}function e(y){if(y&&y.__esModule)return y;var x={};if(y!=null)for(var k in y)Object.prototype.hasOwnProperty.call(y,k)&&(x[k]=y[k]);return x.default=y,x}var r=de(),n=e(r),i=ve(),s=t(i),a=pi(),l=Lu(),h=ey(),d=Ru();function f(y){var x=y&&y[0]||1,k=a.COMPILER_REVISION;if(!(x>=a.LAST_COMPATIBLE_COMPILER_REVISION&&x<=a.COMPILER_REVISION))if(x<a.LAST_COMPATIBLE_COMPILER_REVISION){var S=a.REVISION_CHANGES[k],O=a.REVISION_CHANGES[x];throw new s.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+S+") or downgrade your runtime to an older version ("+O+").")}else throw new s.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+y[1]+").")}function p(y,x){if(!x)throw new s.default("No environment passed to template");if(!y||!y.main)throw new s.default("Unknown template object: "+typeof y);y.main.decorator=y.main_d,x.VM.checkRevision(y.compiler);var k=y.compiler&&y.compiler[0]===7;function S(C,I,A){A.hash&&(I=n.extend({},I,A.hash),A.ids&&(A.ids[0]=!0)),C=x.VM.resolvePartial.call(this,C,I,A);var $=n.extend({},A,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),G=x.VM.invokePartial.call(this,C,I,$);if(G==null&&x.compile&&(A.partials[A.name]=x.compile(C,y.compilerOptions,x),G=A.partials[A.name](I,$)),G!=null){if(A.indent){for(var ae=G.split(`
`),he=0,pt=ae.length;he<pt&&!(!ae[he]&&he+1===pt);he++)ae[he]=A.indent+ae[he];G=ae.join(`
`)}return G}else throw new s.default("The partial "+A.name+" could not be compiled when running in runtime-only mode")}var O={strict:function(I,A,$){if(!I||!(A in I))throw new s.default('"'+A+'" not defined in '+I,{loc:$});return O.lookupProperty(I,A)},lookupProperty:function(I,A){var $=I[A];if($==null||Object.prototype.hasOwnProperty.call(I,A)||d.resultIsAllowed($,O.protoAccessControl,A))return $},lookup:function(I,A){for(var $=I.length,G=0;G<$;G++){var ae=I[G]&&O.lookupProperty(I[G],A);if(ae!=null)return I[G][A]}},lambda:function(I,A){return typeof I=="function"?I.call(A):I},escapeExpression:n.escapeExpression,invokePartial:S,fn:function(I){var A=y[I];return A.decorator=y[I+"_d"],A},programs:[],program:function(I,A,$,G,ae){var he=this.programs[I],pt=this.fn(I);return A||ae||G||$?he=c(this,I,pt,A,$,G,ae):he||(he=this.programs[I]=c(this,I,pt)),he},data:function(I,A){for(;I&&A--;)I=I._parent;return I},mergeIfNeeded:function(I,A){var $=I||A;return I&&A&&I!==A&&($=n.extend({},A,I)),$},nullContext:Object.seal({}),noop:x.VM.noop,compilerInfo:y.compiler};function L(C){var I=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],A=I.data;L._setup(I),!I.partial&&y.useData&&(A=m(C,A));var $=void 0,G=y.useBlockParams?[]:void 0;y.useDepths&&(I.depths?$=C!=I.depths[0]?[C].concat(I.depths):I.depths:$=[C]);function ae(he){return""+y.main(O,he,O.helpers,O.partials,A,G,$)}return ae=b(y.main,ae,O,I.depths||[],A,G),ae(C,I)}return L.isTop=!0,L._setup=function(C){if(C.partial)O.protoAccessControl=C.protoAccessControl,O.helpers=C.helpers,O.partials=C.partials,O.decorators=C.decorators,O.hooks=C.hooks;else{var I=n.extend({},x.helpers,C.helpers);v(I,O),O.helpers=I,y.usePartial&&(O.partials=O.mergeIfNeeded(C.partials,x.partials)),(y.usePartial||y.useDecorators)&&(O.decorators=n.extend({},x.decorators,C.decorators)),O.hooks={},O.protoAccessControl=d.createProtoAccessControl(C);var A=C.allowCallsToHelperMissing||k;l.moveHelperToHooks(O,"helperMissing",A),l.moveHelperToHooks(O,"blockHelperMissing",A)}},L._child=function(C,I,A,$){if(y.useBlockParams&&!A)throw new s.default("must pass block params");if(y.useDepths&&!$)throw new s.default("must pass parent depths");return c(O,C,y[C],I,0,A,$)},L}function c(y,x,k,S,O,L,C){function I(A){var $=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],G=C;return C&&A!=C[0]&&!(A===y.nullContext&&C[0]===null)&&(G=[A].concat(C)),k(y,A,y.helpers,y.partials,$.data||S,L&&[$.blockParams].concat(L),G)}return I=b(k,I,y,C,S,L),I.program=x,I.depth=C?C.length:0,I.blockParams=O||0,I}function u(y,x,k){return y?!y.call&&!k.name&&(k.name=y,y=k.partials[y]):k.name==="@partial-block"?y=k.data["partial-block"]:y=k.partials[k.name],y}function o(y,x,k){var S=k.data&&k.data["partial-block"];k.partial=!0,k.ids&&(k.data.contextPath=k.ids[0]||k.data.contextPath);var O=void 0;if(k.fn&&k.fn!==g&&(function(){k.data=a.createFrame(k.data);var L=k.fn;O=k.data["partial-block"]=function(I){var A=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return A.data=a.createFrame(A.data),A.data["partial-block"]=S,L(I,A)},L.partials&&(k.partials=n.extend({},k.partials,L.partials))})(),y===void 0&&O&&(y=O),y===void 0)throw new s.default("The partial "+k.name+" could not be found");if(y instanceof Function)return y(x,k)}function g(){return""}function m(y,x){return(!x||!("root"in x))&&(x=x?a.createFrame(x):{},x.root=y),x}function b(y,x,k,S,O,L){if(y.decorator){var C={};x=y.decorator(x,C,k,S&&S[0],O,L,S),n.extend(x,C)}return x}function v(y,x){Object.keys(y).forEach(function(k){var S=y[k];y[k]=w(S,x)})}function w(y,x){var k=x.lookupProperty;return h.wrapHelper(y,function(S){return n.extend({lookupProperty:k},S)})}return Ie}var nr={exports:{}},Vs;function Tu(){return Vs||(Vs=1,(function(t,e){e.__esModule=!0,e.default=function(r){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var n=globalThis.Handlebars;r.noConflict=function(){return globalThis.Handlebars===r&&(globalThis.Handlebars=n),r}},t.exports=e.default})(nr,nr.exports)),nr.exports}var Gs;function ry(){return Gs||(Gs=1,(function(t,e){e.__esModule=!0;function r(v){return v&&v.__esModule?v:{default:v}}function n(v){if(v&&v.__esModule)return v;var w={};if(v!=null)for(var y in v)Object.prototype.hasOwnProperty.call(v,y)&&(w[y]=v[y]);return w.default=v,w}var i=pi(),s=n(i),a=Z0(),l=r(a),h=ve(),d=r(h),f=de(),p=n(f),c=ty(),u=n(c),o=Tu(),g=r(o);function m(){var v=new s.HandlebarsEnvironment;return p.extend(v,s),v.SafeString=l.default,v.Exception=d.default,v.Utils=p,v.escapeExpression=p.escapeExpression,v.VM=u,v.template=function(w){return u.template(w,v)},v}var b=m();b.create=m,g.default(b),b.default=b,e.default=b,t.exports=e.default})(jt,jt.exports)),jt.exports}var ir={exports:{}},Ws;function Bu(){return Ws||(Ws=1,(function(t,e){e.__esModule=!0;var r={helpers:{helperExpression:function(i){return i.type==="SubExpression"||(i.type==="MustacheStatement"||i.type==="BlockStatement")&&!!(i.params&&i.params.length||i.hash)},scopedId:function(i){return/^\.|this\b/.test(i.original)},simpleId:function(i){return i.parts.length===1&&!r.helpers.scopedId(i)&&!i.depth}}};e.default=r,t.exports=e.default})(ir,ir.exports)),ir.exports}var Ze={},sr={exports:{}},Js;function ny(){return Js||(Js=1,(function(t,e){e.__esModule=!0;var r=(function(){var n={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(l,h,d,f,p,c,u){var o=c.length-1;switch(p){case 1:return c[o-1];case 2:this.$=f.prepareProgram(c[o]);break;case 3:this.$=c[o];break;case 4:this.$=c[o];break;case 5:this.$=c[o];break;case 6:this.$=c[o];break;case 7:this.$=c[o];break;case 8:this.$=c[o];break;case 9:this.$={type:"CommentStatement",value:f.stripComment(c[o]),strip:f.stripFlags(c[o],c[o]),loc:f.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:c[o],value:c[o],loc:f.locInfo(this._$)};break;case 11:this.$=f.prepareRawBlock(c[o-2],c[o-1],c[o],this._$);break;case 12:this.$={path:c[o-3],params:c[o-2],hash:c[o-1]};break;case 13:this.$=f.prepareBlock(c[o-3],c[o-2],c[o-1],c[o],!1,this._$);break;case 14:this.$=f.prepareBlock(c[o-3],c[o-2],c[o-1],c[o],!0,this._$);break;case 15:this.$={open:c[o-5],path:c[o-4],params:c[o-3],hash:c[o-2],blockParams:c[o-1],strip:f.stripFlags(c[o-5],c[o])};break;case 16:this.$={path:c[o-4],params:c[o-3],hash:c[o-2],blockParams:c[o-1],strip:f.stripFlags(c[o-5],c[o])};break;case 17:this.$={path:c[o-4],params:c[o-3],hash:c[o-2],blockParams:c[o-1],strip:f.stripFlags(c[o-5],c[o])};break;case 18:this.$={strip:f.stripFlags(c[o-1],c[o-1]),program:c[o]};break;case 19:var g=f.prepareBlock(c[o-2],c[o-1],c[o],c[o],!1,this._$),m=f.prepareProgram([g],c[o-1].loc);m.chained=!0,this.$={strip:c[o-2].strip,program:m,chain:!0};break;case 20:this.$=c[o];break;case 21:this.$={path:c[o-1],strip:f.stripFlags(c[o-2],c[o])};break;case 22:this.$=f.prepareMustache(c[o-3],c[o-2],c[o-1],c[o-4],f.stripFlags(c[o-4],c[o]),this._$);break;case 23:this.$=f.prepareMustache(c[o-3],c[o-2],c[o-1],c[o-4],f.stripFlags(c[o-4],c[o]),this._$);break;case 24:this.$={type:"PartialStatement",name:c[o-3],params:c[o-2],hash:c[o-1],indent:"",strip:f.stripFlags(c[o-4],c[o]),loc:f.locInfo(this._$)};break;case 25:this.$=f.preparePartialBlock(c[o-2],c[o-1],c[o],this._$);break;case 26:this.$={path:c[o-3],params:c[o-2],hash:c[o-1],strip:f.stripFlags(c[o-4],c[o])};break;case 27:this.$=c[o];break;case 28:this.$=c[o];break;case 29:this.$={type:"SubExpression",path:c[o-3],params:c[o-2],hash:c[o-1],loc:f.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:c[o],loc:f.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:f.id(c[o-2]),value:c[o],loc:f.locInfo(this._$)};break;case 32:this.$=f.id(c[o-1]);break;case 33:this.$=c[o];break;case 34:this.$=c[o];break;case 35:this.$={type:"StringLiteral",value:c[o],original:c[o],loc:f.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(c[o]),original:Number(c[o]),loc:f.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:c[o]==="true",original:c[o]==="true",loc:f.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:f.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:f.locInfo(this._$)};break;case 40:this.$=c[o];break;case 41:this.$=c[o];break;case 42:this.$=f.preparePath(!0,c[o],this._$);break;case 43:this.$=f.preparePath(!1,c[o],this._$);break;case 44:c[o-2].push({part:f.id(c[o]),original:c[o],separator:c[o-1]}),this.$=c[o-2];break;case 45:this.$=[{part:f.id(c[o]),original:c[o]}];break;case 46:this.$=[];break;case 47:c[o-1].push(c[o]);break;case 48:this.$=[];break;case 49:c[o-1].push(c[o]);break;case 50:this.$=[];break;case 51:c[o-1].push(c[o]);break;case 58:this.$=[];break;case 59:c[o-1].push(c[o]);break;case 64:this.$=[];break;case 65:c[o-1].push(c[o]);break;case 70:this.$=[];break;case 71:c[o-1].push(c[o]);break;case 78:this.$=[];break;case 79:c[o-1].push(c[o]);break;case 82:this.$=[];break;case 83:c[o-1].push(c[o]);break;case 86:this.$=[];break;case 87:c[o-1].push(c[o]);break;case 90:this.$=[];break;case 91:c[o-1].push(c[o]);break;case 94:this.$=[];break;case 95:c[o-1].push(c[o]);break;case 98:this.$=[c[o]];break;case 99:c[o-1].push(c[o]);break;case 100:this.$=[c[o]];break;case 101:c[o-1].push(c[o]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(l,h){throw new Error(l)},parse:function(l){var h=this,d=[0],f=[null],p=[],c=this.table,u="",o=0,g=0;this.lexer.setInput(l),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc>"u"&&(this.lexer.yylloc={});var m=this.lexer.yylloc;p.push(m);var b=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function v(){var $;return $=h.lexer.lex()||1,typeof $!="number"&&($=h.symbols_[$]||$),$}for(var w,y,x,k,S={},O,L,C,I;;){if(y=d[d.length-1],this.defaultActions[y]?x=this.defaultActions[y]:((w===null||typeof w>"u")&&(w=v()),x=c[y]&&c[y][w]),typeof x>"u"||!x.length||!x[0]){var A="";{I=[];for(O in c[y])this.terminals_[O]&&O>2&&I.push("'"+this.terminals_[O]+"'");this.lexer.showPosition?A="Parse error on line "+(o+1)+`:
`+this.lexer.showPosition()+`
Expecting `+I.join(", ")+", got '"+(this.terminals_[w]||w)+"'":A="Parse error on line "+(o+1)+": Unexpected "+(w==1?"end of input":"'"+(this.terminals_[w]||w)+"'"),this.parseError(A,{text:this.lexer.match,token:this.terminals_[w]||w,line:this.lexer.yylineno,loc:m,expected:I})}}if(x[0]instanceof Array&&x.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+w);switch(x[0]){case 1:d.push(w),f.push(this.lexer.yytext),p.push(this.lexer.yylloc),d.push(x[1]),w=null,g=this.lexer.yyleng,u=this.lexer.yytext,o=this.lexer.yylineno,m=this.lexer.yylloc;break;case 2:if(L=this.productions_[x[1]][1],S.$=f[f.length-L],S._$={first_line:p[p.length-(L||1)].first_line,last_line:p[p.length-1].last_line,first_column:p[p.length-(L||1)].first_column,last_column:p[p.length-1].last_column},b&&(S._$.range=[p[p.length-(L||1)].range[0],p[p.length-1].range[1]]),k=this.performAction.call(S,u,g,o,this.yy,x[1],f,p),typeof k<"u")return k;L&&(d=d.slice(0,-1*L*2),f=f.slice(0,-1*L),p=p.slice(0,-1*L)),d.push(this.productions_[x[1]][0]),f.push(S.$),p.push(S._$),C=c[d[d.length-2]][d[d.length-1]],d.push(C);break;case 3:return!0}}return!0}},i=(function(){var a={EOF:1,parseError:function(h,d){if(this.yy.parser)this.yy.parser.parseError(h,d);else throw new Error(h)},setInput:function(h){return this._input=h,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var h=this._input[0];this.yytext+=h,this.yyleng++,this.offset++,this.match+=h,this.matched+=h;var d=h.match(/(?:\r\n?|\n).*/g);return d?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),h},unput:function(h){var d=h.length,f=h.split(/(?:\r\n?|\n)/g);this._input=h+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-d-1),this.offset-=d;var p=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),f.length-1&&(this.yylineno-=f.length-1);var c=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:f?(f.length===p.length?this.yylloc.first_column:0)+p[p.length-f.length].length-f[0].length:this.yylloc.first_column-d},this.options.ranges&&(this.yylloc.range=[c[0],c[0]+this.yyleng-d]),this},more:function(){return this._more=!0,this},less:function(h){this.unput(this.match.slice(h))},pastInput:function(){var h=this.matched.substr(0,this.matched.length-this.match.length);return(h.length>20?"...":"")+h.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var h=this.match;return h.length<20&&(h+=this._input.substr(0,20-h.length)),(h.substr(0,20)+(h.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var h=this.pastInput(),d=new Array(h.length+1).join("-");return h+this.upcomingInput()+`
`+d+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var h,d,f,p,c;this._more||(this.yytext="",this.match="");for(var u=this._currentRules(),o=0;o<u.length&&(f=this._input.match(this.rules[u[o]]),!(f&&(!d||f[0].length>d[0].length)&&(d=f,p=o,!this.options.flex)));o++);return d?(c=d[0].match(/(?:\r\n?|\n).*/g),c&&(this.yylineno+=c.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+d[0].length},this.yytext+=d[0],this.match+=d[0],this.matches=d,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(d[0].length),this.matched+=d[0],h=this.performAction.call(this,this.yy,this,u[p],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),h||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var h=this.next();return typeof h<"u"?h:this.lex()},begin:function(h){this.conditionStack.push(h)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(h){this.begin(h)}};return a.options={},a.performAction=function(h,d,f,p){function c(u,o){return d.yytext=d.yytext.substring(u,d.yyleng-o+u)}switch(f){case 0:if(d.yytext.slice(-2)==="\\\\"?(c(0,1),this.begin("mu")):d.yytext.slice(-1)==="\\"?(c(0,1),this.begin("emu")):this.begin("mu"),d.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;case 3:return this.begin("raw"),15;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(c(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;case 16:return this.popState(),44;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(d.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;case 30:return this.popState(),33;case 31:return d.yytext=c(1,2).replace(/\\"/g,'"'),80;case 32:return d.yytext=c(1,2).replace(/\\'/g,"'"),80;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return d.yytext=d.yytext.replace(/\\([\\\]])/g,"$1"),72;case 43:return"INVALID";case 44:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},a})();n.lexer=i;function s(){this.yy={}}return s.prototype=n,n.Parser=s,new s})();e.default=r,t.exports=e.default})(sr,sr.exports)),sr.exports}var or={exports:{}},ar={exports:{}},Ys;function qu(){return Ys||(Ys=1,(function(t,e){e.__esModule=!0;function r(d){return d&&d.__esModule?d:{default:d}}var n=ve(),i=r(n);function s(){this.parents=[]}s.prototype={constructor:s,mutating:!1,acceptKey:function(f,p){var c=this.accept(f[p]);if(this.mutating){if(c&&!s.prototype[c.type])throw new i.default('Unexpected node type "'+c.type+'" found when accepting '+p+" on "+f.type);f[p]=c}},acceptRequired:function(f,p){if(this.acceptKey(f,p),!f[p])throw new i.default(f.type+" requires "+p)},acceptArray:function(f){for(var p=0,c=f.length;p<c;p++)this.acceptKey(f,p),f[p]||(f.splice(p,1),p--,c--)},accept:function(f){if(f){if(!this[f.type])throw new i.default("Unknown type: "+f.type,f);this.current&&this.parents.unshift(this.current),this.current=f;var p=this[f.type](f);if(this.current=this.parents.shift(),!this.mutating||p)return p;if(p!==!1)return f}},Program:function(f){this.acceptArray(f.body)},MustacheStatement:a,Decorator:a,BlockStatement:l,DecoratorBlock:l,PartialStatement:h,PartialBlockStatement:function(f){h.call(this,f),this.acceptKey(f,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:a,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(f){this.acceptArray(f.pairs)},HashPair:function(f){this.acceptRequired(f,"value")}};function a(d){this.acceptRequired(d,"path"),this.acceptArray(d.params),this.acceptKey(d,"hash")}function l(d){a.call(this,d),this.acceptKey(d,"program"),this.acceptKey(d,"inverse")}function h(d){this.acceptRequired(d,"name"),this.acceptArray(d.params),this.acceptKey(d,"hash")}e.default=s,t.exports=e.default})(ar,ar.exports)),ar.exports}var Qs;function iy(){return Qs||(Qs=1,(function(t,e){e.__esModule=!0;function r(f){return f&&f.__esModule?f:{default:f}}var n=qu(),i=r(n);function s(){var f=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=f}s.prototype=new i.default,s.prototype.Program=function(f){var p=!this.options.ignoreStandalone,c=!this.isRootSeen;this.isRootSeen=!0;for(var u=f.body,o=0,g=u.length;o<g;o++){var m=u[o],b=this.accept(m);if(b){var v=a(u,o,c),w=l(u,o,c),y=b.openStandalone&&v,x=b.closeStandalone&&w,k=b.inlineStandalone&&v&&w;b.close&&h(u,o,!0),b.open&&d(u,o,!0),p&&k&&(h(u,o),d(u,o)&&m.type==="PartialStatement"&&(m.indent=/([ \t]+$)/.exec(u[o-1].original)[1])),p&&y&&(h((m.program||m.inverse).body),d(u,o)),p&&x&&(h(u,o),d((m.inverse||m.program).body))}}return f},s.prototype.BlockStatement=s.prototype.DecoratorBlock=s.prototype.PartialBlockStatement=function(f){this.accept(f.program),this.accept(f.inverse);var p=f.program||f.inverse,c=f.program&&f.inverse,u=c,o=c;if(c&&c.chained)for(u=c.body[0].program;o.chained;)o=o.body[o.body.length-1].program;var g={open:f.openStrip.open,close:f.closeStrip.close,openStandalone:l(p.body),closeStandalone:a((u||p).body)};if(f.openStrip.close&&h(p.body,null,!0),c){var m=f.inverseStrip;m.open&&d(p.body,null,!0),m.close&&h(u.body,null,!0),f.closeStrip.open&&d(o.body,null,!0),!this.options.ignoreStandalone&&a(p.body)&&l(u.body)&&(d(p.body),h(u.body))}else f.closeStrip.open&&d(p.body,null,!0);return g},s.prototype.Decorator=s.prototype.MustacheStatement=function(f){return f.strip},s.prototype.PartialStatement=s.prototype.CommentStatement=function(f){var p=f.strip||{};return{inlineStandalone:!0,open:p.open,close:p.close}};function a(f,p,c){p===void 0&&(p=f.length);var u=f[p-1],o=f[p-2];if(!u)return c;if(u.type==="ContentStatement")return(o||!c?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(u.original)}function l(f,p,c){p===void 0&&(p=-1);var u=f[p+1],o=f[p+2];if(!u)return c;if(u.type==="ContentStatement")return(o||!c?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(u.original)}function h(f,p,c){var u=f[p==null?0:p+1];if(!(!u||u.type!=="ContentStatement"||!c&&u.rightStripped)){var o=u.value;u.value=u.value.replace(c?/^\s+/:/^[ \t]*\r?\n?/,""),u.rightStripped=u.value!==o}}function d(f,p,c){var u=f[p==null?f.length-1:p-1];if(!(!u||u.type!=="ContentStatement"||!c&&u.leftStripped)){var o=u.value;return u.value=u.value.replace(c?/\s+$/:/[ \t]+$/,""),u.leftStripped=u.value!==o,u.leftStripped}}e.default=s,t.exports=e.default})(or,or.exports)),or.exports}var fe={},Xs;function sy(){if(Xs)return fe;Xs=1,fe.__esModule=!0,fe.SourceLocation=i,fe.id=s,fe.stripFlags=a,fe.stripComment=l,fe.preparePath=h,fe.prepareMustache=d,fe.prepareRawBlock=f,fe.prepareBlock=p,fe.prepareProgram=c,fe.preparePartialBlock=u;function t(o){return o&&o.__esModule?o:{default:o}}var e=ve(),r=t(e);function n(o,g){if(g=g.path?g.path.original:g,o.path.original!==g){var m={loc:o.path.loc};throw new r.default(o.path.original+" doesn't match "+g,m)}}function i(o,g){this.source=o,this.start={line:g.first_line,column:g.first_column},this.end={line:g.last_line,column:g.last_column}}function s(o){return/^\[.*\]$/.test(o)?o.substring(1,o.length-1):o}function a(o,g){return{open:o.charAt(2)==="~",close:g.charAt(g.length-3)==="~"}}function l(o){return o.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function h(o,g,m){m=this.locInfo(m);for(var b=o?"@":"",v=[],w=0,y=0,x=g.length;y<x;y++){var k=g[y].part,S=g[y].original!==k;if(b+=(g[y].separator||"")+k,!S&&(k===".."||k==="."||k==="this")){if(v.length>0)throw new r.default("Invalid path: "+b,{loc:m});k===".."&&w++}else v.push(k)}return{type:"PathExpression",data:o,depth:w,parts:v,original:b,loc:m}}function d(o,g,m,b,v,w){var y=b.charAt(3)||b.charAt(2),x=y!=="{"&&y!=="&",k=/\*/.test(b);return{type:k?"Decorator":"MustacheStatement",path:o,params:g,hash:m,escaped:x,strip:v,loc:this.locInfo(w)}}function f(o,g,m,b){n(o,m),b=this.locInfo(b);var v={type:"Program",body:g,strip:{},loc:b};return{type:"BlockStatement",path:o.path,params:o.params,hash:o.hash,program:v,openStrip:{},inverseStrip:{},closeStrip:{},loc:b}}function p(o,g,m,b,v,w){b&&b.path&&n(o,b);var y=/\*/.test(o.open);g.blockParams=o.blockParams;var x=void 0,k=void 0;if(m){if(y)throw new r.default("Unexpected inverse block on decorator",m);m.chain&&(m.program.body[0].closeStrip=b.strip),k=m.strip,x=m.program}return v&&(v=x,x=g,g=v),{type:y?"DecoratorBlock":"BlockStatement",path:o.path,params:o.params,hash:o.hash,program:g,inverse:x,openStrip:o.strip,inverseStrip:k,closeStrip:b&&b.strip,loc:this.locInfo(w)}}function c(o,g){if(!g&&o.length){var m=o[0].loc,b=o[o.length-1].loc;m&&b&&(g={source:m.source,start:{line:m.start.line,column:m.start.column},end:{line:b.end.line,column:b.end.column}})}return{type:"Program",body:o,strip:{},loc:g}}function u(o,g,m,b){return n(o,m),{type:"PartialBlockStatement",name:o.path,params:o.params,hash:o.hash,program:g,openStrip:o.strip,closeStrip:m&&m.strip,loc:this.locInfo(b)}}return fe}var Zs;function oy(){if(Zs)return Ze;Zs=1,Ze.__esModule=!0,Ze.parseWithoutProcessing=f,Ze.parse=p;function t(c){if(c&&c.__esModule)return c;var u={};if(c!=null)for(var o in c)Object.prototype.hasOwnProperty.call(c,o)&&(u[o]=c[o]);return u.default=c,u}function e(c){return c&&c.__esModule?c:{default:c}}var r=ny(),n=e(r),i=iy(),s=e(i),a=sy(),l=t(a),h=de();Ze.parser=n.default;var d={};h.extend(d,l);function f(c,u){if(c.type==="Program")return c;n.default.yy=d,d.locInfo=function(g){return new d.SourceLocation(u&&u.srcName,g)};var o=n.default.parse(c);return o}function p(c,u){var o=f(c,u),g=new s.default(u);return g.accept(o)}return Ze}var et={},eo;function ay(){if(eo)return et;eo=1,et.__esModule=!0,et.Compiler=l,et.precompile=h,et.compile=d;function t(c){return c&&c.__esModule?c:{default:c}}var e=ve(),r=t(e),n=de(),i=Bu(),s=t(i),a=[].slice;function l(){}l.prototype={compiler:l,equals:function(u){var o=this.opcodes.length;if(u.opcodes.length!==o)return!1;for(var g=0;g<o;g++){var m=this.opcodes[g],b=u.opcodes[g];if(m.opcode!==b.opcode||!f(m.args,b.args))return!1}o=this.children.length;for(var g=0;g<o;g++)if(!this.children[g].equals(u.children[g]))return!1;return!0},guid:0,compile:function(u,o){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=o,this.stringParams=o.stringParams,this.trackIds=o.trackIds,o.blockParams=o.blockParams||[],o.knownHelpers=n.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},o.knownHelpers),this.accept(u)},compileProgram:function(u){var o=new this.compiler,g=o.compile(u,this.options),m=this.guid++;return this.usePartial=this.usePartial||g.usePartial,this.children[m]=g,this.useDepths=this.useDepths||g.useDepths,m},accept:function(u){if(!this[u.type])throw new r.default("Unknown type: "+u.type,u);this.sourceNode.unshift(u);var o=this[u.type](u);return this.sourceNode.shift(),o},Program:function(u){this.options.blockParams.unshift(u.blockParams);for(var o=u.body,g=o.length,m=0;m<g;m++)this.accept(o[m]);return this.options.blockParams.shift(),this.isSimple=g===1,this.blockParams=u.blockParams?u.blockParams.length:0,this},BlockStatement:function(u){p(u);var o=u.program,g=u.inverse;o=o&&this.compileProgram(o),g=g&&this.compileProgram(g);var m=this.classifySexpr(u);m==="helper"?this.helperSexpr(u,o,g):m==="simple"?(this.simpleSexpr(u),this.opcode("pushProgram",o),this.opcode("pushProgram",g),this.opcode("emptyHash"),this.opcode("blockValue",u.path.original)):(this.ambiguousSexpr(u,o,g),this.opcode("pushProgram",o),this.opcode("pushProgram",g),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(u){var o=u.program&&this.compileProgram(u.program),g=this.setupFullMustacheParams(u,o,void 0),m=u.path;this.useDecorators=!0,this.opcode("registerDecorator",g.length,m.original)},PartialStatement:function(u){this.usePartial=!0;var o=u.program;o&&(o=this.compileProgram(u.program));var g=u.params;if(g.length>1)throw new r.default("Unsupported number of partial arguments: "+g.length,u);g.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):g.push({type:"PathExpression",parts:[],depth:0}));var m=u.name.original,b=u.name.type==="SubExpression";b&&this.accept(u.name),this.setupFullMustacheParams(u,o,void 0,!0);var v=u.indent||"";this.options.preventIndent&&v&&(this.opcode("appendContent",v),v=""),this.opcode("invokePartial",b,m,v),this.opcode("append")},PartialBlockStatement:function(u){this.PartialStatement(u)},MustacheStatement:function(u){this.SubExpression(u),u.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(u){this.DecoratorBlock(u)},ContentStatement:function(u){u.value&&this.opcode("appendContent",u.value)},CommentStatement:function(){},SubExpression:function(u){p(u);var o=this.classifySexpr(u);o==="simple"?this.simpleSexpr(u):o==="helper"?this.helperSexpr(u):this.ambiguousSexpr(u)},ambiguousSexpr:function(u,o,g){var m=u.path,b=m.parts[0],v=o!=null||g!=null;this.opcode("getContext",m.depth),this.opcode("pushProgram",o),this.opcode("pushProgram",g),m.strict=!0,this.accept(m),this.opcode("invokeAmbiguous",b,v)},simpleSexpr:function(u){var o=u.path;o.strict=!0,this.accept(o),this.opcode("resolvePossibleLambda")},helperSexpr:function(u,o,g){var m=this.setupFullMustacheParams(u,o,g),b=u.path,v=b.parts[0];if(this.options.knownHelpers[v])this.opcode("invokeKnownHelper",m.length,v);else{if(this.options.knownHelpersOnly)throw new r.default("You specified knownHelpersOnly, but used the unknown helper "+v,u);b.strict=!0,b.falsy=!0,this.accept(b),this.opcode("invokeHelper",m.length,b.original,s.default.helpers.simpleId(b))}},PathExpression:function(u){this.addDepth(u.depth),this.opcode("getContext",u.depth);var o=u.parts[0],g=s.default.helpers.scopedId(u),m=!u.depth&&!g&&this.blockParamIndex(o);m?this.opcode("lookupBlockParam",m,u.parts):o?u.data?(this.options.data=!0,this.opcode("lookupData",u.depth,u.parts,u.strict)):this.opcode("lookupOnContext",u.parts,u.falsy,u.strict,g):this.opcode("pushContext")},StringLiteral:function(u){this.opcode("pushString",u.value)},NumberLiteral:function(u){this.opcode("pushLiteral",u.value)},BooleanLiteral:function(u){this.opcode("pushLiteral",u.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(u){var o=u.pairs,g=0,m=o.length;for(this.opcode("pushHash");g<m;g++)this.pushParam(o[g].value);for(;g--;)this.opcode("assignToHash",o[g].key);this.opcode("popHash")},opcode:function(u){this.opcodes.push({opcode:u,args:a.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(u){u&&(this.useDepths=!0)},classifySexpr:function(u){var o=s.default.helpers.simpleId(u.path),g=o&&!!this.blockParamIndex(u.path.parts[0]),m=!g&&s.default.helpers.helperExpression(u),b=!g&&(m||o);if(b&&!m){var v=u.path.parts[0],w=this.options;w.knownHelpers[v]?m=!0:w.knownHelpersOnly&&(b=!1)}return m?"helper":b?"ambiguous":"simple"},pushParams:function(u){for(var o=0,g=u.length;o<g;o++)this.pushParam(u[o])},pushParam:function(u){var o=u.value!=null?u.value:u.original||"";if(this.stringParams)o.replace&&(o=o.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),u.depth&&this.addDepth(u.depth),this.opcode("getContext",u.depth||0),this.opcode("pushStringParam",o,u.type),u.type==="SubExpression"&&this.accept(u);else{if(this.trackIds){var g=void 0;if(u.parts&&!s.default.helpers.scopedId(u)&&!u.depth&&(g=this.blockParamIndex(u.parts[0])),g){var m=u.parts.slice(1).join(".");this.opcode("pushId","BlockParam",g,m)}else o=u.original||o,o.replace&&(o=o.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",u.type,o)}this.accept(u)}},setupFullMustacheParams:function(u,o,g,m){var b=u.params;return this.pushParams(b),this.opcode("pushProgram",o),this.opcode("pushProgram",g),u.hash?this.accept(u.hash):this.opcode("emptyHash",m),b},blockParamIndex:function(u){for(var o=0,g=this.options.blockParams.length;o<g;o++){var m=this.options.blockParams[o],b=m&&n.indexOf(m,u);if(m&&b>=0)return[o,b]}}};function h(c,u,o){if(c==null||typeof c!="string"&&c.type!=="Program")throw new r.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+c);u=u||{},"data"in u||(u.data=!0),u.compat&&(u.useDepths=!0);var g=o.parse(c,u),m=new o.Compiler().compile(g,u);return new o.JavaScriptCompiler().compile(m,u)}function d(c,u,o){if(u===void 0&&(u={}),c==null||typeof c!="string"&&c.type!=="Program")throw new r.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+c);u=n.extend({},u),"data"in u||(u.data=!0),u.compat&&(u.useDepths=!0);var g=void 0;function m(){var v=o.parse(c,u),w=new o.Compiler().compile(v,u),y=new o.JavaScriptCompiler().compile(w,u,void 0,!0);return o.template(y)}function b(v,w){return g||(g=m()),g.call(this,v,w)}return b._setup=function(v){return g||(g=m()),g._setup(v)},b._child=function(v,w,y,x){return g||(g=m()),g._child(v,w,y,x)},b}function f(c,u){if(c===u)return!0;if(n.isArray(c)&&n.isArray(u)&&c.length===u.length){for(var o=0;o<c.length;o++)if(!f(c[o],u[o]))return!1;return!0}}function p(c){if(!c.path.parts){var u=c.path;c.path={type:"PathExpression",data:!1,depth:0,parts:[u.original+""],original:u.original+"",loc:u.loc}}}return et}var ur={exports:{}},lr={exports:{}},bt={},nn={},cr={},dr={},to;function uy(){if(to)return dr;to=1;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return dr.encode=function(e){if(0<=e&&e<t.length)return t[e];throw new TypeError("Must be between 0 and 63: "+e)},dr.decode=function(e){var r=65,n=90,i=97,s=122,a=48,l=57,h=43,d=47,f=26,p=52;return r<=e&&e<=n?e-r:i<=e&&e<=s?e-i+f:a<=e&&e<=l?e-a+p:e==h?62:e==d?63:-1},dr}var ro;function Fu(){if(ro)return cr;ro=1;var t=uy(),e=5,r=1<<e,n=r-1,i=r;function s(l){return l<0?(-l<<1)+1:(l<<1)+0}function a(l){var h=(l&1)===1,d=l>>1;return h?-d:d}return cr.encode=function(h){var d="",f,p=s(h);do f=p&n,p>>>=e,p>0&&(f|=i),d+=t.encode(f);while(p>0);return d},cr.decode=function(h,d,f){var p=h.length,c=0,u=0,o,g;do{if(d>=p)throw new Error("Expected more digits in base 64 VLQ value.");if(g=t.decode(h.charCodeAt(d++)),g===-1)throw new Error("Invalid base64 digit: "+h.charAt(d-1));o=!!(g&i),g&=n,c=c+(g<<u),u+=e}while(o);f.value=a(c),f.rest=d},cr}var sn={},no;function Tt(){return no||(no=1,(function(t){function e(y,x,k){if(x in y)return y[x];if(arguments.length===3)return k;throw new Error('"'+x+'" is a required argument.')}t.getArg=e;var r=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,n=/^data:.+\,.+$/;function i(y){var x=y.match(r);return x?{scheme:x[1],auth:x[2],host:x[3],port:x[4],path:x[5]}:null}t.urlParse=i;function s(y){var x="";return y.scheme&&(x+=y.scheme+":"),x+="//",y.auth&&(x+=y.auth+"@"),y.host&&(x+=y.host),y.port&&(x+=":"+y.port),y.path&&(x+=y.path),x}t.urlGenerate=s;function a(y){var x=y,k=i(y);if(k){if(!k.path)return y;x=k.path}for(var S=t.isAbsolute(x),O=x.split(/\/+/),L,C=0,I=O.length-1;I>=0;I--)L=O[I],L==="."?O.splice(I,1):L===".."?C++:C>0&&(L===""?(O.splice(I+1,C),C=0):(O.splice(I,2),C--));return x=O.join("/"),x===""&&(x=S?"/":"."),k?(k.path=x,s(k)):x}t.normalize=a;function l(y,x){y===""&&(y="."),x===""&&(x=".");var k=i(x),S=i(y);if(S&&(y=S.path||"/"),k&&!k.scheme)return S&&(k.scheme=S.scheme),s(k);if(k||x.match(n))return x;if(S&&!S.host&&!S.path)return S.host=x,s(S);var O=x.charAt(0)==="/"?x:a(y.replace(/\/+$/,"")+"/"+x);return S?(S.path=O,s(S)):O}t.join=l,t.isAbsolute=function(y){return y.charAt(0)==="/"||r.test(y)};function h(y,x){y===""&&(y="."),y=y.replace(/\/$/,"");for(var k=0;x.indexOf(y+"/")!==0;){var S=y.lastIndexOf("/");if(S<0||(y=y.slice(0,S),y.match(/^([^\/]+:\/)?\/*$/)))return x;++k}return Array(k+1).join("../")+x.substr(y.length+1)}t.relative=h;var d=(function(){var y=Object.create(null);return!("__proto__"in y)})();function f(y){return y}function p(y){return u(y)?"$"+y:y}t.toSetString=d?f:p;function c(y){return u(y)?y.slice(1):y}t.fromSetString=d?f:c;function u(y){if(!y)return!1;var x=y.length;if(x<9||y.charCodeAt(x-1)!==95||y.charCodeAt(x-2)!==95||y.charCodeAt(x-3)!==111||y.charCodeAt(x-4)!==116||y.charCodeAt(x-5)!==111||y.charCodeAt(x-6)!==114||y.charCodeAt(x-7)!==112||y.charCodeAt(x-8)!==95||y.charCodeAt(x-9)!==95)return!1;for(var k=x-10;k>=0;k--)if(y.charCodeAt(k)!==36)return!1;return!0}function o(y,x,k){var S=m(y.source,x.source);return S!==0||(S=y.originalLine-x.originalLine,S!==0)||(S=y.originalColumn-x.originalColumn,S!==0||k)||(S=y.generatedColumn-x.generatedColumn,S!==0)||(S=y.generatedLine-x.generatedLine,S!==0)?S:m(y.name,x.name)}t.compareByOriginalPositions=o;function g(y,x,k){var S=y.generatedLine-x.generatedLine;return S!==0||(S=y.generatedColumn-x.generatedColumn,S!==0||k)||(S=m(y.source,x.source),S!==0)||(S=y.originalLine-x.originalLine,S!==0)||(S=y.originalColumn-x.originalColumn,S!==0)?S:m(y.name,x.name)}t.compareByGeneratedPositionsDeflated=g;function m(y,x){return y===x?0:y===null?1:x===null?-1:y>x?1:-1}function b(y,x){var k=y.generatedLine-x.generatedLine;return k!==0||(k=y.generatedColumn-x.generatedColumn,k!==0)||(k=m(y.source,x.source),k!==0)||(k=y.originalLine-x.originalLine,k!==0)||(k=y.originalColumn-x.originalColumn,k!==0)?k:m(y.name,x.name)}t.compareByGeneratedPositionsInflated=b;function v(y){return JSON.parse(y.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=v;function w(y,x,k){if(x=x||"",y&&(y[y.length-1]!=="/"&&x[0]!=="/"&&(y+="/"),x=y+x),k){var S=i(k);if(!S)throw new Error("sourceMapURL could not be parsed");if(S.path){var O=S.path.lastIndexOf("/");O>=0&&(S.path=S.path.substring(0,O+1))}x=l(s(S),x)}return a(x)}t.computeSourceURL=w})(sn)),sn}var on={},io;function Ku(){if(io)return on;io=1;var t=Tt(),e=Object.prototype.hasOwnProperty,r=typeof Map<"u";function n(){this._array=[],this._set=r?new Map:Object.create(null)}return n.fromArray=function(s,a){for(var l=new n,h=0,d=s.length;h<d;h++)l.add(s[h],a);return l},n.prototype.size=function(){return r?this._set.size:Object.getOwnPropertyNames(this._set).length},n.prototype.add=function(s,a){var l=r?s:t.toSetString(s),h=r?this.has(s):e.call(this._set,l),d=this._array.length;(!h||a)&&this._array.push(s),h||(r?this._set.set(s,d):this._set[l]=d)},n.prototype.has=function(s){if(r)return this._set.has(s);var a=t.toSetString(s);return e.call(this._set,a)},n.prototype.indexOf=function(s){if(r){var a=this._set.get(s);if(a>=0)return a}else{var l=t.toSetString(s);if(e.call(this._set,l))return this._set[l]}throw new Error('"'+s+'" is not in the set.')},n.prototype.at=function(s){if(s>=0&&s<this._array.length)return this._array[s];throw new Error("No element indexed by "+s)},n.prototype.toArray=function(){return this._array.slice()},on.ArraySet=n,on}var an={},so;function ly(){if(so)return an;so=1;var t=Tt();function e(n,i){var s=n.generatedLine,a=i.generatedLine,l=n.generatedColumn,h=i.generatedColumn;return a>s||a==s&&h>=l||t.compareByGeneratedPositionsInflated(n,i)<=0}function r(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}return r.prototype.unsortedForEach=function(i,s){this._array.forEach(i,s)},r.prototype.add=function(i){e(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))},r.prototype.toArray=function(){return this._sorted||(this._array.sort(t.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},an.MappingList=r,an}var oo;function ju(){if(oo)return nn;oo=1;var t=Fu(),e=Tt(),r=Ku().ArraySet,n=ly().MappingList;function i(s){s||(s={}),this._file=e.getArg(s,"file",null),this._sourceRoot=e.getArg(s,"sourceRoot",null),this._skipValidation=e.getArg(s,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new n,this._sourcesContents=null}return i.prototype._version=3,i.fromSourceMap=function(a){var l=a.sourceRoot,h=new i({file:a.file,sourceRoot:l});return a.eachMapping(function(d){var f={generated:{line:d.generatedLine,column:d.generatedColumn}};d.source!=null&&(f.source=d.source,l!=null&&(f.source=e.relative(l,f.source)),f.original={line:d.originalLine,column:d.originalColumn},d.name!=null&&(f.name=d.name)),h.addMapping(f)}),a.sources.forEach(function(d){var f=d;l!==null&&(f=e.relative(l,d)),h._sources.has(f)||h._sources.add(f);var p=a.sourceContentFor(d);p!=null&&h.setSourceContent(d,p)}),h},i.prototype.addMapping=function(a){var l=e.getArg(a,"generated"),h=e.getArg(a,"original",null),d=e.getArg(a,"source",null),f=e.getArg(a,"name",null);this._skipValidation||this._validateMapping(l,h,d,f),d!=null&&(d=String(d),this._sources.has(d)||this._sources.add(d)),f!=null&&(f=String(f),this._names.has(f)||this._names.add(f)),this._mappings.add({generatedLine:l.line,generatedColumn:l.column,originalLine:h!=null&&h.line,originalColumn:h!=null&&h.column,source:d,name:f})},i.prototype.setSourceContent=function(a,l){var h=a;this._sourceRoot!=null&&(h=e.relative(this._sourceRoot,h)),l!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(h)]=l):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(h)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))},i.prototype.applySourceMap=function(a,l,h){var d=l;if(l==null){if(a.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);d=a.file}var f=this._sourceRoot;f!=null&&(d=e.relative(f,d));var p=new r,c=new r;this._mappings.unsortedForEach(function(u){if(u.source===d&&u.originalLine!=null){var o=a.originalPositionFor({line:u.originalLine,column:u.originalColumn});o.source!=null&&(u.source=o.source,h!=null&&(u.source=e.join(h,u.source)),f!=null&&(u.source=e.relative(f,u.source)),u.originalLine=o.line,u.originalColumn=o.column,o.name!=null&&(u.name=o.name))}var g=u.source;g!=null&&!p.has(g)&&p.add(g);var m=u.name;m!=null&&!c.has(m)&&c.add(m)},this),this._sources=p,this._names=c,a.sources.forEach(function(u){var o=a.sourceContentFor(u);o!=null&&(h!=null&&(u=e.join(h,u)),f!=null&&(u=e.relative(f,u)),this.setSourceContent(u,o))},this)},i.prototype._validateMapping=function(a,l,h,d){if(l&&typeof l.line!="number"&&typeof l.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!l&&!h&&!d)){if(a&&"line"in a&&"column"in a&&l&&"line"in l&&"column"in l&&a.line>0&&a.column>=0&&l.line>0&&l.column>=0&&h)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:h,original:l,name:d}))}},i.prototype._serializeMappings=function(){for(var a=0,l=1,h=0,d=0,f=0,p=0,c="",u,o,g,m,b=this._mappings.toArray(),v=0,w=b.length;v<w;v++){if(o=b[v],u="",o.generatedLine!==l)for(a=0;o.generatedLine!==l;)u+=";",l++;else if(v>0){if(!e.compareByGeneratedPositionsInflated(o,b[v-1]))continue;u+=","}u+=t.encode(o.generatedColumn-a),a=o.generatedColumn,o.source!=null&&(m=this._sources.indexOf(o.source),u+=t.encode(m-p),p=m,u+=t.encode(o.originalLine-1-d),d=o.originalLine-1,u+=t.encode(o.originalColumn-h),h=o.originalColumn,o.name!=null&&(g=this._names.indexOf(o.name),u+=t.encode(g-f),f=g)),c+=u}return c},i.prototype._generateSourcesContent=function(a,l){return a.map(function(h){if(!this._sourcesContents)return null;l!=null&&(h=e.relative(l,h));var d=e.toSetString(h);return Object.prototype.hasOwnProperty.call(this._sourcesContents,d)?this._sourcesContents[d]:null},this)},i.prototype.toJSON=function(){var a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(a.file=this._file),this._sourceRoot!=null&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a},i.prototype.toString=function(){return JSON.stringify(this.toJSON())},nn.SourceMapGenerator=i,nn}var vt={},un={},ao;function cy(){return ao||(ao=1,(function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(r,n,i,s,a,l){var h=Math.floor((n-r)/2)+r,d=a(i,s[h],!0);return d===0?h:d>0?n-h>1?e(h,n,i,s,a,l):l==t.LEAST_UPPER_BOUND?n<s.length?n:-1:h:h-r>1?e(r,h,i,s,a,l):l==t.LEAST_UPPER_BOUND?h:r<0?-1:r}t.search=function(n,i,s,a){if(i.length===0)return-1;var l=e(-1,i.length,n,i,s,a||t.GREATEST_LOWER_BOUND);if(l<0)return-1;for(;l-1>=0&&s(i[l],i[l-1],!0)===0;)--l;return l}})(un)),un}var ln={},uo;function dy(){if(uo)return ln;uo=1;function t(n,i,s){var a=n[i];n[i]=n[s],n[s]=a}function e(n,i){return Math.round(n+Math.random()*(i-n))}function r(n,i,s,a){if(s<a){var l=e(s,a),h=s-1;t(n,l,a);for(var d=n[a],f=s;f<a;f++)i(n[f],d)<=0&&(h+=1,t(n,h,f));t(n,h+1,f);var p=h+1;r(n,i,s,p-1),r(n,i,p+1,a)}}return ln.quickSort=function(n,i){r(n,i,0,n.length-1)},ln}var lo;function hy(){if(lo)return vt;lo=1;var t=Tt(),e=cy(),r=Ku().ArraySet,n=Fu(),i=dy().quickSort;function s(d,f){var p=d;return typeof d=="string"&&(p=t.parseSourceMapInput(d)),p.sections!=null?new h(p,f):new a(p,f)}s.fromSourceMap=function(d,f){return a.fromSourceMap(d,f)},s.prototype._version=3,s.prototype.__generatedMappings=null,Object.defineProperty(s.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),s.prototype.__originalMappings=null,Object.defineProperty(s.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),s.prototype._charIsMappingSeparator=function(f,p){var c=f.charAt(p);return c===";"||c===","},s.prototype._parseMappings=function(f,p){throw new Error("Subclasses must implement _parseMappings")},s.GENERATED_ORDER=1,s.ORIGINAL_ORDER=2,s.GREATEST_LOWER_BOUND=1,s.LEAST_UPPER_BOUND=2,s.prototype.eachMapping=function(f,p,c){var u=p||null,o=c||s.GENERATED_ORDER,g;switch(o){case s.GENERATED_ORDER:g=this._generatedMappings;break;case s.ORIGINAL_ORDER:g=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var m=this.sourceRoot;g.map(function(b){var v=b.source===null?null:this._sources.at(b.source);return v=t.computeSourceURL(m,v,this._sourceMapURL),{source:v,generatedLine:b.generatedLine,generatedColumn:b.generatedColumn,originalLine:b.originalLine,originalColumn:b.originalColumn,name:b.name===null?null:this._names.at(b.name)}},this).forEach(f,u)},s.prototype.allGeneratedPositionsFor=function(f){var p=t.getArg(f,"line"),c={source:t.getArg(f,"source"),originalLine:p,originalColumn:t.getArg(f,"column",0)};if(c.source=this._findSourceIndex(c.source),c.source<0)return[];var u=[],o=this._findMapping(c,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,e.LEAST_UPPER_BOUND);if(o>=0){var g=this._originalMappings[o];if(f.column===void 0)for(var m=g.originalLine;g&&g.originalLine===m;)u.push({line:t.getArg(g,"generatedLine",null),column:t.getArg(g,"generatedColumn",null),lastColumn:t.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++o];else for(var b=g.originalColumn;g&&g.originalLine===p&&g.originalColumn==b;)u.push({line:t.getArg(g,"generatedLine",null),column:t.getArg(g,"generatedColumn",null),lastColumn:t.getArg(g,"lastGeneratedColumn",null)}),g=this._originalMappings[++o]}return u},vt.SourceMapConsumer=s;function a(d,f){var p=d;typeof d=="string"&&(p=t.parseSourceMapInput(d));var c=t.getArg(p,"version"),u=t.getArg(p,"sources"),o=t.getArg(p,"names",[]),g=t.getArg(p,"sourceRoot",null),m=t.getArg(p,"sourcesContent",null),b=t.getArg(p,"mappings"),v=t.getArg(p,"file",null);if(c!=this._version)throw new Error("Unsupported version: "+c);g&&(g=t.normalize(g)),u=u.map(String).map(t.normalize).map(function(w){return g&&t.isAbsolute(g)&&t.isAbsolute(w)?t.relative(g,w):w}),this._names=r.fromArray(o.map(String),!0),this._sources=r.fromArray(u,!0),this._absoluteSources=this._sources.toArray().map(function(w){return t.computeSourceURL(g,w,f)}),this.sourceRoot=g,this.sourcesContent=m,this._mappings=b,this._sourceMapURL=f,this.file=v}a.prototype=Object.create(s.prototype),a.prototype.consumer=s,a.prototype._findSourceIndex=function(d){var f=d;if(this.sourceRoot!=null&&(f=t.relative(this.sourceRoot,f)),this._sources.has(f))return this._sources.indexOf(f);var p;for(p=0;p<this._absoluteSources.length;++p)if(this._absoluteSources[p]==d)return p;return-1},a.fromSourceMap=function(f,p){var c=Object.create(a.prototype),u=c._names=r.fromArray(f._names.toArray(),!0),o=c._sources=r.fromArray(f._sources.toArray(),!0);c.sourceRoot=f._sourceRoot,c.sourcesContent=f._generateSourcesContent(c._sources.toArray(),c.sourceRoot),c.file=f._file,c._sourceMapURL=p,c._absoluteSources=c._sources.toArray().map(function(k){return t.computeSourceURL(c.sourceRoot,k,p)});for(var g=f._mappings.toArray().slice(),m=c.__generatedMappings=[],b=c.__originalMappings=[],v=0,w=g.length;v<w;v++){var y=g[v],x=new l;x.generatedLine=y.generatedLine,x.generatedColumn=y.generatedColumn,y.source&&(x.source=o.indexOf(y.source),x.originalLine=y.originalLine,x.originalColumn=y.originalColumn,y.name&&(x.name=u.indexOf(y.name)),b.push(x)),m.push(x)}return i(c.__originalMappings,t.compareByOriginalPositions),c},a.prototype._version=3,Object.defineProperty(a.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function l(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}a.prototype._parseMappings=function(f,p){for(var c=1,u=0,o=0,g=0,m=0,b=0,v=f.length,w=0,y={},x={},k=[],S=[],O,L,C,I,A;w<v;)if(f.charAt(w)===";")c++,w++,u=0;else if(f.charAt(w)===",")w++;else{for(O=new l,O.generatedLine=c,I=w;I<v&&!this._charIsMappingSeparator(f,I);I++);if(L=f.slice(w,I),C=y[L],C)w+=L.length;else{for(C=[];w<I;)n.decode(f,w,x),A=x.value,w=x.rest,C.push(A);if(C.length===2)throw new Error("Found a source, but no line and column");if(C.length===3)throw new Error("Found a source and line, but no column");y[L]=C}O.generatedColumn=u+C[0],u=O.generatedColumn,C.length>1&&(O.source=m+C[1],m+=C[1],O.originalLine=o+C[2],o=O.originalLine,O.originalLine+=1,O.originalColumn=g+C[3],g=O.originalColumn,C.length>4&&(O.name=b+C[4],b+=C[4])),S.push(O),typeof O.originalLine=="number"&&k.push(O)}i(S,t.compareByGeneratedPositionsDeflated),this.__generatedMappings=S,i(k,t.compareByOriginalPositions),this.__originalMappings=k},a.prototype._findMapping=function(f,p,c,u,o,g){if(f[c]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+f[c]);if(f[u]<0)throw new TypeError("Column must be greater than or equal to 0, got "+f[u]);return e.search(f,p,o,g)},a.prototype.computeColumnSpans=function(){for(var f=0;f<this._generatedMappings.length;++f){var p=this._generatedMappings[f];if(f+1<this._generatedMappings.length){var c=this._generatedMappings[f+1];if(p.generatedLine===c.generatedLine){p.lastGeneratedColumn=c.generatedColumn-1;continue}}p.lastGeneratedColumn=1/0}},a.prototype.originalPositionFor=function(f){var p={generatedLine:t.getArg(f,"line"),generatedColumn:t.getArg(f,"column")},c=this._findMapping(p,this._generatedMappings,"generatedLine","generatedColumn",t.compareByGeneratedPositionsDeflated,t.getArg(f,"bias",s.GREATEST_LOWER_BOUND));if(c>=0){var u=this._generatedMappings[c];if(u.generatedLine===p.generatedLine){var o=t.getArg(u,"source",null);o!==null&&(o=this._sources.at(o),o=t.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var g=t.getArg(u,"name",null);return g!==null&&(g=this._names.at(g)),{source:o,line:t.getArg(u,"originalLine",null),column:t.getArg(u,"originalColumn",null),name:g}}}return{source:null,line:null,column:null,name:null}},a.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(f){return f==null}):!1},a.prototype.sourceContentFor=function(f,p){if(!this.sourcesContent)return null;var c=this._findSourceIndex(f);if(c>=0)return this.sourcesContent[c];var u=f;this.sourceRoot!=null&&(u=t.relative(this.sourceRoot,u));var o;if(this.sourceRoot!=null&&(o=t.urlParse(this.sourceRoot))){var g=u.replace(/^file:\/\//,"");if(o.scheme=="file"&&this._sources.has(g))return this.sourcesContent[this._sources.indexOf(g)];if((!o.path||o.path=="/")&&this._sources.has("/"+u))return this.sourcesContent[this._sources.indexOf("/"+u)]}if(p)return null;throw new Error('"'+u+'" is not in the SourceMap.')},a.prototype.generatedPositionFor=function(f){var p=t.getArg(f,"source");if(p=this._findSourceIndex(p),p<0)return{line:null,column:null,lastColumn:null};var c={source:p,originalLine:t.getArg(f,"line"),originalColumn:t.getArg(f,"column")},u=this._findMapping(c,this._originalMappings,"originalLine","originalColumn",t.compareByOriginalPositions,t.getArg(f,"bias",s.GREATEST_LOWER_BOUND));if(u>=0){var o=this._originalMappings[u];if(o.source===c.source)return{line:t.getArg(o,"generatedLine",null),column:t.getArg(o,"generatedColumn",null),lastColumn:t.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},vt.BasicSourceMapConsumer=a;function h(d,f){var p=d;typeof d=="string"&&(p=t.parseSourceMapInput(d));var c=t.getArg(p,"version"),u=t.getArg(p,"sections");if(c!=this._version)throw new Error("Unsupported version: "+c);this._sources=new r,this._names=new r;var o={line:-1,column:0};this._sections=u.map(function(g){if(g.url)throw new Error("Support for url field in sections not implemented.");var m=t.getArg(g,"offset"),b=t.getArg(m,"line"),v=t.getArg(m,"column");if(b<o.line||b===o.line&&v<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=m,{generatedOffset:{generatedLine:b+1,generatedColumn:v+1},consumer:new s(t.getArg(g,"map"),f)}})}return h.prototype=Object.create(s.prototype),h.prototype.constructor=s,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var d=[],f=0;f<this._sections.length;f++)for(var p=0;p<this._sections[f].consumer.sources.length;p++)d.push(this._sections[f].consumer.sources[p]);return d}}),h.prototype.originalPositionFor=function(f){var p={generatedLine:t.getArg(f,"line"),generatedColumn:t.getArg(f,"column")},c=e.search(p,this._sections,function(o,g){var m=o.generatedLine-g.generatedOffset.generatedLine;return m||o.generatedColumn-g.generatedOffset.generatedColumn}),u=this._sections[c];return u?u.consumer.originalPositionFor({line:p.generatedLine-(u.generatedOffset.generatedLine-1),column:p.generatedColumn-(u.generatedOffset.generatedLine===p.generatedLine?u.generatedOffset.generatedColumn-1:0),bias:f.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(f){return f.consumer.hasContentsOfAllSources()})},h.prototype.sourceContentFor=function(f,p){for(var c=0;c<this._sections.length;c++){var u=this._sections[c],o=u.consumer.sourceContentFor(f,!0);if(o)return o}if(p)return null;throw new Error('"'+f+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(f){for(var p=0;p<this._sections.length;p++){var c=this._sections[p];if(c.consumer._findSourceIndex(t.getArg(f,"source"))!==-1){var u=c.consumer.generatedPositionFor(f);if(u){var o={line:u.line+(c.generatedOffset.generatedLine-1),column:u.column+(c.generatedOffset.generatedLine===u.line?c.generatedOffset.generatedColumn-1:0)};return o}}}return{line:null,column:null}},h.prototype._parseMappings=function(f,p){this.__generatedMappings=[],this.__originalMappings=[];for(var c=0;c<this._sections.length;c++)for(var u=this._sections[c],o=u.consumer._generatedMappings,g=0;g<o.length;g++){var m=o[g],b=u.consumer._sources.at(m.source);b=t.computeSourceURL(u.consumer.sourceRoot,b,this._sourceMapURL),this._sources.add(b),b=this._sources.indexOf(b);var v=null;m.name&&(v=u.consumer._names.at(m.name),this._names.add(v),v=this._names.indexOf(v));var w={source:b,generatedLine:m.generatedLine+(u.generatedOffset.generatedLine-1),generatedColumn:m.generatedColumn+(u.generatedOffset.generatedLine===m.generatedLine?u.generatedOffset.generatedColumn-1:0),originalLine:m.originalLine,originalColumn:m.originalColumn,name:v};this.__generatedMappings.push(w),typeof w.originalLine=="number"&&this.__originalMappings.push(w)}i(this.__generatedMappings,t.compareByGeneratedPositionsDeflated),i(this.__originalMappings,t.compareByOriginalPositions)},vt.IndexedSourceMapConsumer=h,vt}var cn={},co;function fy(){if(co)return cn;co=1;var t=ju().SourceMapGenerator,e=Tt(),r=/(\r?\n)/,n=10,i="$$$isSourceNode$$$";function s(a,l,h,d,f){this.children=[],this.sourceContents={},this.line=a??null,this.column=l??null,this.source=h??null,this.name=f??null,this[i]=!0,d!=null&&this.add(d)}return s.fromStringWithSourceMap=function(l,h,d){var f=new s,p=l.split(r),c=0,u=function(){var v=y(),w=y()||"";return v+w;function y(){return c<p.length?p[c++]:void 0}},o=1,g=0,m=null;return h.eachMapping(function(v){if(m!==null)if(o<v.generatedLine)b(m,u()),o++,g=0;else{var w=p[c]||"",y=w.substr(0,v.generatedColumn-g);p[c]=w.substr(v.generatedColumn-g),g=v.generatedColumn,b(m,y),m=v;return}for(;o<v.generatedLine;)f.add(u()),o++;if(g<v.generatedColumn){var w=p[c]||"";f.add(w.substr(0,v.generatedColumn)),p[c]=w.substr(v.generatedColumn),g=v.generatedColumn}m=v},this),c<p.length&&(m&&b(m,u()),f.add(p.splice(c).join(""))),h.sources.forEach(function(v){var w=h.sourceContentFor(v);w!=null&&(d!=null&&(v=e.join(d,v)),f.setSourceContent(v,w))}),f;function b(v,w){if(v===null||v.source===void 0)f.add(w);else{var y=d?e.join(d,v.source):v.source;f.add(new s(v.originalLine,v.originalColumn,y,w,v.name))}}},s.prototype.add=function(l){if(Array.isArray(l))l.forEach(function(h){this.add(h)},this);else if(l[i]||typeof l=="string")l&&this.children.push(l);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+l);return this},s.prototype.prepend=function(l){if(Array.isArray(l))for(var h=l.length-1;h>=0;h--)this.prepend(l[h]);else if(l[i]||typeof l=="string")this.children.unshift(l);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+l);return this},s.prototype.walk=function(l){for(var h,d=0,f=this.children.length;d<f;d++)h=this.children[d],h[i]?h.walk(l):h!==""&&l(h,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(l){var h,d,f=this.children.length;if(f>0){for(h=[],d=0;d<f-1;d++)h.push(this.children[d]),h.push(l);h.push(this.children[d]),this.children=h}return this},s.prototype.replaceRight=function(l,h){var d=this.children[this.children.length-1];return d[i]?d.replaceRight(l,h):typeof d=="string"?this.children[this.children.length-1]=d.replace(l,h):this.children.push("".replace(l,h)),this},s.prototype.setSourceContent=function(l,h){this.sourceContents[e.toSetString(l)]=h},s.prototype.walkSourceContents=function(l){for(var h=0,d=this.children.length;h<d;h++)this.children[h][i]&&this.children[h].walkSourceContents(l);for(var f=Object.keys(this.sourceContents),h=0,d=f.length;h<d;h++)l(e.fromSetString(f[h]),this.sourceContents[f[h]])},s.prototype.toString=function(){var l="";return this.walk(function(h){l+=h}),l},s.prototype.toStringWithSourceMap=function(l){var h={code:"",line:1,column:0},d=new t(l),f=!1,p=null,c=null,u=null,o=null;return this.walk(function(g,m){h.code+=g,m.source!==null&&m.line!==null&&m.column!==null?((p!==m.source||c!==m.line||u!==m.column||o!==m.name)&&d.addMapping({source:m.source,original:{line:m.line,column:m.column},generated:{line:h.line,column:h.column},name:m.name}),p=m.source,c=m.line,u=m.column,o=m.name,f=!0):f&&(d.addMapping({generated:{line:h.line,column:h.column}}),p=null,f=!1);for(var b=0,v=g.length;b<v;b++)g.charCodeAt(b)===n?(h.line++,h.column=0,b+1===v?(p=null,f=!1):f&&d.addMapping({source:m.source,original:{line:m.line,column:m.column},generated:{line:h.line,column:h.column},name:m.name})):h.column++}),this.walkSourceContents(function(g,m){d.setSourceContent(g,m)}),{code:h.code,map:d}},cn.SourceNode=s,cn}var ho;function py(){return ho||(ho=1,bt.SourceMapGenerator=ju().SourceMapGenerator,bt.SourceMapConsumer=hy().SourceMapConsumer,bt.SourceNode=fy().SourceNode),bt}var fo;function my(){return fo||(fo=1,(function(t,e){e.__esModule=!0;var r=de(),n=void 0;try{var i=py();n=i.SourceNode}catch{}n||(n=function(l,h,d,f){this.src="",f&&this.add(f)},n.prototype={add:function(h){r.isArray(h)&&(h=h.join("")),this.src+=h},prepend:function(h){r.isArray(h)&&(h=h.join("")),this.src=h+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function s(l,h,d){if(r.isArray(l)){for(var f=[],p=0,c=l.length;p<c;p++)f.push(h.wrap(l[p],d));return f}else if(typeof l=="boolean"||typeof l=="number")return l+"";return l}function a(l){this.srcFile=l,this.source=[]}a.prototype={isEmpty:function(){return!this.source.length},prepend:function(h,d){this.source.unshift(this.wrap(h,d))},push:function(h,d){this.source.push(this.wrap(h,d))},merge:function(){var h=this.empty();return this.each(function(d){h.add(["  ",d,`
`])}),h},each:function(h){for(var d=0,f=this.source.length;d<f;d++)h(this.source[d])},empty:function(){var h=this.currentLocation||{start:{}};return new n(h.start.line,h.start.column,this.srcFile)},wrap:function(h){var d=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return h instanceof n?h:(h=s(h,this,d),new n(d.start.line,d.start.column,this.srcFile,h))},functionCall:function(h,d,f){return f=this.generateList(f),this.wrap([h,d?"."+d+"(":"(",f,")"])},quotedString:function(h){return'"'+(h+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(h){var d=this,f=[];Object.keys(h).forEach(function(c){var u=s(h[c],d);u!=="undefined"&&f.push([d.quotedString(c),":",u])});var p=this.generateList(f);return p.prepend("{"),p.add("}"),p},generateList:function(h){for(var d=this.empty(),f=0,p=h.length;f<p;f++)f&&d.add(","),d.add(s(h[f],this));return d},generateArray:function(h){var d=this.generateList(h);return d.prepend("["),d.add("]"),d}},e.default=a,t.exports=e.default})(lr,lr.exports)),lr.exports}var po;function gy(){return po||(po=1,(function(t,e){e.__esModule=!0;function r(c){return c&&c.__esModule?c:{default:c}}var n=pi(),i=ve(),s=r(i),a=de(),l=my(),h=r(l);function d(c){this.value=c}function f(){}f.prototype={nameLookup:function(u,o){return this.internalNameLookup(u,o)},depthedLookup:function(u){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(u),")"]},compilerInfo:function(){var u=n.COMPILER_REVISION,o=n.REVISION_CHANGES[u];return[u,o]},appendToBuffer:function(u,o,g){return a.isArray(u)||(u=[u]),u=this.source.wrap(u,o),this.environment.isSimple?["return ",u,";"]:g?["buffer += ",u,";"]:(u.appendToBuffer=!0,u)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(u,o){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",u,",",JSON.stringify(o),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(u,o,g,m){this.environment=u,this.options=o,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!m,this.name=this.environment.name,this.isChild=!!g,this.context=g||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(u,o),this.useDepths=this.useDepths||u.useDepths||u.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||u.useBlockParams;var b=u.opcodes,v=void 0,w=void 0,y=void 0,x=void 0;for(y=0,x=b.length;y<x;y++)v=b[y],this.source.currentLocation=v.loc,w=w||v.loc,this[v.opcode].apply(this,v.args);if(this.source.currentLocation=w,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new s.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),m?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var k=this.createFunctionContext(m);if(this.isChild)return k;var S={compiler:this.compilerInfo(),main:k};this.decorators&&(S.main_d=this.decorators,S.useDecorators=!0);var O=this.context,L=O.programs,C=O.decorators;for(y=0,x=L.length;y<x;y++)L[y]&&(S[y]=L[y],C[y]&&(S[y+"_d"]=C[y],S.useDecorators=!0));return this.environment.usePartial&&(S.usePartial=!0),this.options.data&&(S.useData=!0),this.useDepths&&(S.useDepths=!0),this.useBlockParams&&(S.useBlockParams=!0),this.options.compat&&(S.compat=!0),m?S.compilerOptions=this.options:(S.compiler=JSON.stringify(S.compiler),this.source.currentLocation={start:{line:1,column:0}},S=this.objectLiteral(S),o.srcName?(S=S.toStringWithSourceMap({file:o.destName}),S.map=S.map&&S.map.toString()):S=S.toString()),S},preamble:function(){this.lastContext=0,this.source=new h.default(this.options.srcName),this.decorators=new h.default(this.options.srcName)},createFunctionContext:function(u){var o=this,g="",m=this.stackVars.concat(this.registers.list);m.length>0&&(g+=", "+m.join(", "));var b=0;Object.keys(this.aliases).forEach(function(y){var x=o.aliases[y];x.children&&x.referenceCount>1&&(g+=", alias"+ ++b+"="+y,x.children[0]="alias"+b)}),this.lookupPropertyFunctionIsUsed&&(g+=", "+this.lookupPropertyFunctionVarDeclaration());var v=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&v.push("blockParams"),this.useDepths&&v.push("depths");var w=this.mergeSource(g);return u?(v.push(w),Function.apply(this,v)):this.source.wrap(["function(",v.join(","),`) {
  `,w,"}"])},mergeSource:function(u){var o=this.environment.isSimple,g=!this.forceBuffer,m=void 0,b=void 0,v=void 0,w=void 0;return this.source.each(function(y){y.appendToBuffer?(v?y.prepend("  + "):v=y,w=y):(v&&(b?v.prepend("buffer += "):m=!0,w.add(";"),v=w=void 0),b=!0,o||(g=!1))}),g?v?(v.prepend("return "),w.add(";")):b||this.source.push('return "";'):(u+=", buffer = "+(m?"":this.initializeBuffer()),v?(v.prepend("return buffer + "),w.add(";")):this.source.push("return buffer;")),u&&this.source.prepend("var "+u.substring(2)+(m?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(u){var o=this.aliasable("container.hooks.blockHelperMissing"),g=[this.contextName(0)];this.setupHelperArgs(u,0,g);var m=this.popStack();g.splice(1,0,m),this.push(this.source.functionCall(o,"call",g))},ambiguousBlockValue:function(){var u=this.aliasable("container.hooks.blockHelperMissing"),o=[this.contextName(0)];this.setupHelperArgs("",0,o,!0),this.flushInline();var g=this.topStack();o.splice(1,0,g),this.pushSource(["if (!",this.lastHelper,") { ",g," = ",this.source.functionCall(u,"call",o),"}"])},appendContent:function(u){this.pendingContent?u=this.pendingContent+u:this.pendingLocation=this.source.currentLocation,this.pendingContent=u},append:function(){if(this.isInline())this.replaceStack(function(o){return[" != null ? ",o,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var u=this.popStack();this.pushSource(["if (",u," != null) { ",this.appendToBuffer(u,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(u){this.lastContext=u},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(u,o,g,m){var b=0;!m&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(u[b++])):this.pushContext(),this.resolvePath("context",u,b,o,g)},lookupBlockParam:function(u,o){this.useBlockParams=!0,this.push(["blockParams[",u[0],"][",u[1],"]"]),this.resolvePath("context",o,1)},lookupData:function(u,o,g){u?this.pushStackLiteral("container.data(data, "+u+")"):this.pushStackLiteral("data"),this.resolvePath("data",o,0,!0,g)},resolvePath:function(u,o,g,m,b){var v=this;if(this.options.strict||this.options.assumeObjects){this.push(p(this.options.strict&&b,this,o,g,u));return}for(var w=o.length;g<w;g++)this.replaceStack(function(y){var x=v.nameLookup(y,o[g],u);return m?[" && ",x]:[" != null ? ",x," : ",y]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(u,o){this.pushContext(),this.pushString(o),o!=="SubExpression"&&(typeof u=="string"?this.pushString(u):this.pushStackLiteral(u))},emptyHash:function(u){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(u?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var u=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(u.ids)),this.stringParams&&(this.push(this.objectLiteral(u.contexts)),this.push(this.objectLiteral(u.types))),this.push(this.objectLiteral(u.values))},pushString:function(u){this.pushStackLiteral(this.quotedString(u))},pushLiteral:function(u){this.pushStackLiteral(u)},pushProgram:function(u){u!=null?this.pushStackLiteral(this.programExpression(u)):this.pushStackLiteral(null)},registerDecorator:function(u,o){var g=this.nameLookup("decorators",o,"decorator"),m=this.setupHelperArgs(o,u);this.decorators.push(["fn = ",this.decorators.functionCall(g,"",["fn","props","container",m])," || fn;"])},invokeHelper:function(u,o,g){var m=this.popStack(),b=this.setupHelper(u,o),v=[];g&&v.push(b.name),v.push(m),this.options.strict||v.push(this.aliasable("container.hooks.helperMissing"));var w=["(",this.itemsSeparatedBy(v,"||"),")"],y=this.source.functionCall(w,"call",b.callParams);this.push(y)},itemsSeparatedBy:function(u,o){var g=[];g.push(u[0]);for(var m=1;m<u.length;m++)g.push(o,u[m]);return g},invokeKnownHelper:function(u,o){var g=this.setupHelper(u,o);this.push(this.source.functionCall(g.name,"call",g.callParams))},invokeAmbiguous:function(u,o){this.useRegister("helper");var g=this.popStack();this.emptyHash();var m=this.setupHelper(0,u,o),b=this.lastHelper=this.nameLookup("helpers",u,"helper"),v=["(","(helper = ",b," || ",g,")"];this.options.strict||(v[0]="(helper = ",v.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",v,m.paramsInit?["),(",m.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",m.callParams)," : helper))"])},invokePartial:function(u,o,g){var m=[],b=this.setupParams(o,1,m);u&&(o=this.popStack(),delete b.name),g&&(b.indent=JSON.stringify(g)),b.helpers="helpers",b.partials="partials",b.decorators="container.decorators",u?m.unshift(o):m.unshift(this.nameLookup("partials",o,"partial")),this.options.compat&&(b.depths="depths"),b=this.objectLiteral(b),m.push(b),this.push(this.source.functionCall("container.invokePartial","",m))},assignToHash:function(u){var o=this.popStack(),g=void 0,m=void 0,b=void 0;this.trackIds&&(b=this.popStack()),this.stringParams&&(m=this.popStack(),g=this.popStack());var v=this.hash;g&&(v.contexts[u]=g),m&&(v.types[u]=m),b&&(v.ids[u]=b),v.values[u]=o},pushId:function(u,o,g){u==="BlockParam"?this.pushStackLiteral("blockParams["+o[0]+"].path["+o[1]+"]"+(g?" + "+JSON.stringify("."+g):"")):u==="PathExpression"?this.pushString(o):u==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:f,compileChildren:function(u,o){for(var g=u.children,m=void 0,b=void 0,v=0,w=g.length;v<w;v++){m=g[v],b=new this.compiler;var y=this.matchExistingProgram(m);if(y==null){this.context.programs.push("");var x=this.context.programs.length;m.index=x,m.name="program"+x,this.context.programs[x]=b.compile(m,o,this.context,!this.precompile),this.context.decorators[x]=b.decorators,this.context.environments[x]=m,this.useDepths=this.useDepths||b.useDepths,this.useBlockParams=this.useBlockParams||b.useBlockParams,m.useDepths=this.useDepths,m.useBlockParams=this.useBlockParams}else m.index=y.index,m.name="program"+y.index,this.useDepths=this.useDepths||y.useDepths,this.useBlockParams=this.useBlockParams||y.useBlockParams}},matchExistingProgram:function(u){for(var o=0,g=this.context.environments.length;o<g;o++){var m=this.context.environments[o];if(m&&m.equals(u))return m}},programExpression:function(u){var o=this.environment.children[u],g=[o.index,"data",o.blockParams];return(this.useBlockParams||this.useDepths)&&g.push("blockParams"),this.useDepths&&g.push("depths"),"container.program("+g.join(", ")+")"},useRegister:function(u){this.registers[u]||(this.registers[u]=!0,this.registers.list.push(u))},push:function(u){return u instanceof d||(u=this.source.wrap(u)),this.inlineStack.push(u),u},pushStackLiteral:function(u){this.push(new d(u))},pushSource:function(u){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),u&&this.source.push(u)},replaceStack:function(u){var o=["("],g=void 0,m=void 0,b=void 0;if(!this.isInline())throw new s.default("replaceStack on non-inline");var v=this.popStack(!0);if(v instanceof d)g=[v.value],o=["(",g],b=!0;else{m=!0;var w=this.incrStack();o=["((",this.push(w)," = ",v,")"],g=this.topStack()}var y=u.call(this,g);b||this.popStack(),m&&this.stackSlot--,this.push(o.concat(y,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var u=this.inlineStack;this.inlineStack=[];for(var o=0,g=u.length;o<g;o++){var m=u[o];if(m instanceof d)this.compileStack.push(m);else{var b=this.incrStack();this.pushSource([b," = ",m,";"]),this.compileStack.push(b)}}},isInline:function(){return this.inlineStack.length},popStack:function(u){var o=this.isInline(),g=(o?this.inlineStack:this.compileStack).pop();if(!u&&g instanceof d)return g.value;if(!o){if(!this.stackSlot)throw new s.default("Invalid stack pop");this.stackSlot--}return g},topStack:function(){var u=this.isInline()?this.inlineStack:this.compileStack,o=u[u.length-1];return o instanceof d?o.value:o},contextName:function(u){return this.useDepths&&u?"depths["+u+"]":"depth"+u},quotedString:function(u){return this.source.quotedString(u)},objectLiteral:function(u){return this.source.objectLiteral(u)},aliasable:function(u){var o=this.aliases[u];return o?(o.referenceCount++,o):(o=this.aliases[u]=this.source.wrap(u),o.aliasable=!0,o.referenceCount=1,o)},setupHelper:function(u,o,g){var m=[],b=this.setupHelperArgs(o,u,m,g),v=this.nameLookup("helpers",o,"helper"),w=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:m,paramsInit:b,name:v,callParams:[w].concat(m)}},setupParams:function(u,o,g){var m={},b=[],v=[],w=[],y=!g,x=void 0;y&&(g=[]),m.name=this.quotedString(u),m.hash=this.popStack(),this.trackIds&&(m.hashIds=this.popStack()),this.stringParams&&(m.hashTypes=this.popStack(),m.hashContexts=this.popStack());var k=this.popStack(),S=this.popStack();(S||k)&&(m.fn=S||"container.noop",m.inverse=k||"container.noop");for(var O=o;O--;)x=this.popStack(),g[O]=x,this.trackIds&&(w[O]=this.popStack()),this.stringParams&&(v[O]=this.popStack(),b[O]=this.popStack());return y&&(m.args=this.source.generateArray(g)),this.trackIds&&(m.ids=this.source.generateArray(w)),this.stringParams&&(m.types=this.source.generateArray(v),m.contexts=this.source.generateArray(b)),this.options.data&&(m.data="data"),this.useBlockParams&&(m.blockParams="blockParams"),m},setupHelperArgs:function(u,o,g,m){var b=this.setupParams(u,o,g);return b.loc=JSON.stringify(this.source.currentLocation),b=this.objectLiteral(b),m?(this.useRegister("options"),g.push("options"),["options=",b]):g?(g.push(b),""):b}},(function(){for(var c="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),u=f.RESERVED_WORDS={},o=0,g=c.length;o<g;o++)u[c[o]]=!0})(),f.isValidJavaScriptVariableName=function(c){return!f.RESERVED_WORDS[c]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(c)};function p(c,u,o,g,m){var b=u.popStack(),v=o.length;for(c&&v--;g<v;g++)b=u.nameLookup(b,o[g],m);return c?[u.aliasable("container.strict"),"(",b,", ",u.quotedString(o[g]),", ",JSON.stringify(u.source.currentLocation)," )"]:b}e.default=f,t.exports=e.default})(ur,ur.exports)),ur.exports}var mo;function yy(){return mo||(mo=1,(function(t,e){e.__esModule=!0;function r(v){return v&&v.__esModule?v:{default:v}}var n=ry(),i=r(n),s=Bu(),a=r(s),l=oy(),h=ay(),d=gy(),f=r(d),p=qu(),c=r(p),u=Tu(),o=r(u),g=i.default.create;function m(){var v=g();return v.compile=function(w,y){return h.compile(w,y,v)},v.precompile=function(w,y){return h.precompile(w,y,v)},v.AST=a.default,v.Compiler=h.Compiler,v.JavaScriptCompiler=f.default,v.Parser=l.parser,v.parse=l.parse,v.parseWithoutProcessing=l.parseWithoutProcessing,v}var b=m();b.create=m,o.default(b),b.Visitor=c.default,b.default=b,e.default=b,t.exports=e.default})(Kt,Kt.exports)),Kt.exports}var by=yy();const Uu=wl(by),Tn=_({"[string]":{value:[_.or("null",ce.boolean,ce.integer,ce.float,ce.string,"string.date.iso",ce.location,ce.boundingbox),"@","Valeur de la métadonnée"],"valueLabel?":["string","@","Label de la valeur de la métadonnée. Existe pour les métadonnées de type enum, contient dans ce cas le label associé à la clé de l'option de l'enum choisie"],confidence:["number","@","Confiance dans la valeur de la métadonnée, entre 0 et 1"],manuallyModified:["boolean","@","La valeur de la métadonnée a été modifiée manuellement"],alternatives:_({"[string]":["number","@","Confiance dans cette valeur alternative de la métadonnée, entre 0 et 1."]}).describe("Autres valeurs possibles. Les clés de l'objet sont les autres valeurs possibles pour cette métadonnée (converties en texte via JSON), les valeurs de l'objet sont les confiances associées à ces alternatives.")}}),Bn=_({id:["string","@","ID de l'image"],fileId:["string | null","@","ID du fichier source de l'image"],filename:["string","@","Nom du fichier utilisé pour cette image"],contentType:["string","@","Type de contenu de l'image, au format MIME (exemple: image/jpeg)"],sequence:["number > 0","@","Numéro de séquence de l'image dans l'archive .zip. Unique à l'entièreté de l'export"],numberInObservation:["number > 0","@","Numéro de l'image dans l'observation"],metadata:Tn,exportedAs:_({original:["string","@","Chemin vers l'image originale"],cropped:["string","@","Chemin vers l'image recadrée"]}).describe("Chemins dans l'archive .zip vers l'image exportée")}),vy=_({number:["number > 0","@","Numéro de l'observation dans l'export"],label:["string","@","Label de l'observation"],images:Bn.array(),metadata:Tn,protocolMetadata:Tn.describe("Métadonnées définies par le protocole. Les clés de l'objet sont les identifiants des métadonnées, sans le préfixe qui identifie leur protocole de provenance")}),xy={cx:{help:"Coordonée X du point central"},cy:{help:"Coordonée Y du point central"},sy:{help:"Coordonée Y du point supérieur gauche"},sx:{help:"Coordonée X du point supérieur gauche"},ex:{help:"Coordonée X du point inférieur droit"},ey:{help:"Coordonée Y du point inférieur droit"},w:{help:"Largeur de la boîte englobante"},h:{help:"Hauteur de la boîte englobante"},score:{help:"Score de confiance de cette boîte, entre 0 et 1"},_:{help:"Autre valeur (ignorée par CIGALE)"}},zu=_.or(...ol(xy).map(([t,{help:e}])=>_(`"${t}"`).describe(e,"self"))).array(),wy={suffix:{documentation:"Ajoute un suffixe à un nom de fichier, avant l'extension",usage:"{{ suffix 'filename.jpeg' '_example' }} -> 'filename_example.jpeg'",implementation:(t,e)=>{const[r,n]=bi(t);return`${r}${e}.${n}`}},extension:{documentation:"Récupère l’extension d’un nom de fichier",usage:"{{ extension 'filename.jpeg' }} -> 'jpeg'",implementation:t=>bi(t)[1]},fallback:{documentation:"Fournit une valeur de repli si la première est indéfinie",usage:"{{ fallback obj.does_not_exist 'Unknown' }} -> 'Unknown'",implementation:(t,e)=>t??e}};for(const[t,{implementation:e}]of Object.entries(wy))Uu.registerHelper(t,e);const Hu=t=>_.string.pipe(e=>{try{const r=Uu.compile(e,{noEscape:!0,assumeObjects:!0,knownHelpersOnly:!0,knownHelpers:{suffix:!0,extension:!0,fallback:!0}});return{toJSON:()=>e,render:n=>r(t.assert(n))}}catch(r){throw new Error(`Invalid template ${al(e)}: ${r}`)}}),go=Hu(_({observation:vy.omit("images"),image:Bn.omit("exportedAs")}).and(Bn.pick("sequence","numberInObservation"))).pipe(({render:t,toJSON:e})=>({toJSON:e,render:r=>t(r).replaceAll("\\","/")})),yo="analysis.json",Vu=_({id:z.describe("Identifiant unique pour le protocole. On conseille de mettre une partie qui vous identifie dans cet identifiant, car il doit être globalement unique. Par exemple, mon-organisation.mon-protocole"),dirty:_("boolean").describe("Si le protocole a été modifié depuis sa dernière exportation").default(!1),metadata:Pr.describe("Toutes les métadonnées du protocole (qu'elles soient associées aux sessions ou aux observations/images)"),sessionMetadata:Pr.describe("Métadonnées associées à la session entière").default(()=>[]),name:["string","@","Nom du protocole"],description:["string","@","Description du protocole"],"learnMore?":Ve.describe("Lien vers un site où l'on peut se renseigner sur ce protocole. Cela peut aussi être simplement un lien de téléchargement direct de ce fichier"),"version?":["number","@","Version actuelle du protocole"],updates:_.enumerated("automatic","manual").describe("Mode de mise à jour du protocole").default("manual"),"source?":Ir.describe(`Requête ou URL devant mener à un fichier JSON contenant la version la plus récente du protocole. Permet de proposer des mises à jour.
		
		Si le champ "version" n'existe pas (que ce soit dans le protocole local ou distant), aucune mise à jour ne sera proposée.`),authors:_({"email?":["string.email","@","Adresse email"],name:["string","@","Prénom Nom"]}).array().describe("Les auteurices ayant participé à l'élaboration du protocole"),"metadataOrder?":_(z.array()).describe("L'ordre dans lequel les métadonnées doivent être présentées dans l'interface utilisateur. Les métadonnées non listées ici seront affichées après toutes celles listées ici"),"observations?":{"defaultLabel?":Hu(_({images:Du.array(),observation:Eu})).describe("Label par défaut pour les observations. Template Handlebars, recevant une liste des images de l'observation à crééer (clé images) et l'observation elle-même (clé observation)")},crop:_({metadata:[z,"@","Métadonnée associée à la boîte englobante"],"confirmationMetadata?":[z,"@","Métadonnée associée au fait que la boîte englobante a été (humainement) confirmée"],padding:_(/^\d+(%|px)$/).describe("Pixels de marge à rajouter autour de la boîte englobante au moment d'exporter les images recadrées. Nombre suivi de 'px' pour un nombre de pixels fixe, ou de '%' pour un pourcentage des dimensions de chaque image.").default("0px"),"classifyUncropped?":["boolean","@","Lancer la classification des images qui n'ont pas de boîte englobante"],"infer?":_({"name?":["string","@","Nom du réseau à afficher dans l'interface. Particulièrement utile si il y a plusieurs réseaux"],model:Ir.describe("Lien vers le modèle de détection utilisé pour inférer les boîtes englobantes. Au format ONNX (.onnx) seulement, pour le moment."),input:li.describe("Configuration de l'entrée du modèle"),output:_({"name?":["string","@","Nom de l'output du modèle à utiliser. output0 par défaut"],normalized:["boolean","@","Si les coordonnées des boîtes englobantes sont normalisées par rapport aux dimensions de l'image"],shape:zu.describe("Forme de sortie de chaque boîte englobante. Nécéssite obligatoirement d'avoir 'score'; 2 parmi 'cx', 'sx', 'ex', 'w'; et 2 parmi 'cy', 'sy', 'ey', 'h'. Si les boîtes contiennent d'autre valeurs, bien les mentionner avec '_', même quand c'est à la fin de la liste: cela permet de savoir quand on passe à la boîte suivante. Par exemple, [cx, cy, w, h, score, _] correspond à un modèle YOLO11 COCO")}).describe("Forme de la sortie du modèle de classification. Par exemple, shape: [cx, cy, w, h, score, _] et normalized: true correspond à un modèle YOLO11 COCO")}).array().describe("Configuration de l'inférence des boîtes englobantes")}).describe("Configuration de la partie recadrage"),exports:_({images:_({cropped:go.describe("Chemins des images recadrées"),original:go.describe("Chemins des images originales"),"mtime?":["string","@","Métadonnée à utiliser pour la date de modification des fichiers exportés"]}).describe(`Chemins où sauvegarder les images. Vous pouvez utiliser {{observation.metadata.identifiant.value}} pour insérer la valeur d'une métadonnée, {{image.filename}} pour le nom de fichier, {{observation.label}} pour le label (nom) de l'observation, et {{sequence}} pour un numéro d'image, commençant à 1. {{observation.metadata.identifiant.valueLabel}} peut être pratique pour obtenir le label associé au choix d'une métadonnée de type 'enum'. Enfin, il est possible de faire {{suffix image.filename "_exemple"}} pour ajouter "_exemple" à la fin d'un nom de fichier, mais avant son extension (par exemple: {{suffix image.filename "_cropped"}} donnera "IMG_1245_cropped.JPEG" si l'image avait pour nom de fichier "IMG_12345.JPEG"); Vous pouvez faire {{extension image.filename}} pour avoir l'extension d'un fichier, et {{fallback image.metadata.exemple "(Inconnnu)"}} pour utiliser "(Inconnu)" si image.metadata.example n'existe pas. Ce sont enfait des templates Handlebars, en savoir plus: https://handlebarsjs.com/guide/`),metadata:{json:_(`"${yo}"`).describe("Chemin du fichier JSON complet. Il n'est pas possible de le modifier, car CIGALE doit connaître son emplacement dans un .zip pour pouvoir importer des analyses.").default(yo),csv:_.string.describe("Chemin du fichier CSV contenant les résultats de l'analyse").pipe(t=>t.replaceAll("\\","/"))}}).describe("La structure du fichier .zip d'export pour ce protocole.").optional()}),rb=Vu.omit("metadata","sessionMetadata","dirty").in.and({metadata:{"[string]":$n.omit("id").describe("Métadonnées associées aux observations/imagess")},"sessionMetadata?":{"[string]":$n.omit("id").describe("Métadonnées associées à la session entière")}}).pipe(t=>({...t,metadata:Object.fromEntries(Object.entries(t.metadata).map(([e,r])=>[Rn(t.id,e),r])),sessionMetadata:Object.fromEntries(Object.entries(t.sessionMetadata??{}).map(([e,r])=>[Rn(t.id,e),r]))})),Gu={metadataValue:{label:"Métadonnée…",needsMetadata:!0},metadataConfidence:{label:"Confiance en…",needsMetadata:!0},id:{label:"ID",needsMetadata:!1},name:{label:"Nom",needsMetadata:!1}},Wu={metadataValue:{label:"Métadonnée…",needsMetadata:!0},metadataPresence:{label:"Présence de…",needsMetadata:!0},metadataConfidence:{label:"Confiance en…",needsMetadata:!0},none:{label:"Aucun regroupement",needsMetadata:!1}};function nb(t,e){switch(t){case"sort":return Gu[e].needsMetadata;case"group":return Wu[e].needsMetadata}}const hr=_({field:_.enumerated(...jn(Gu)),"metadata?":z,direction:_.enumerated("asc","desc")}),fr=_({field:_.enumerated(...jn(Wu)),"metadata?":z}),ky=_({id:z,name:"string",createdAt:"string.date.iso",openedAt:"string.date.iso",description:"string",protocol:z,metadata:fi,sort:_({global:hr,"import?":hr,"crop?":hr,"classify?":hr}).default(()=>({global:{field:"id",direction:"asc"}})),group:_({global:fr,"import?":fr,"crop?":fr,"classify?":fr}).default(()=>({global:{field:"none"}})),inferenceModels:qr({ID:z}).type({"[ID]":"number.integer >= -1"}).describe("Maps metadata IDs to selected model indices").default(()=>({}))});function Sy(t){return t.slice(0,1).toLowerCase()+Math.random().toString(36).slice(2,9)}const _y=Le(["id","sessionId"],_({id:z,bytes:"ArrayBuffer",filename:"string",contentType:/\w+\/\w+/,dimensions:ci,sessionId:z})),Py=Le(["id","sessionId"],_({id:z,bytes:"ArrayBuffer",filename:"string",contentType:/\w+\/\w+/,dimensions:ci,sessionId:z})),Iy=Le(["id","addedAt","sessionId"],Du),Cy=Le(["id","addedAt","sessionId"],Eu),Oy=Le(["id"],ky),My=Le("id",$n.omit("options")),Ay=Le(["id"],Nu.and({id:[/\w+:\w+/,"@","ID of the form metadata_id:key"],metadataId:z})),Ny=Le("id",Vu),Ju=Le("id",_({id:'"defaults" | "user"',protocols:Pr,theme:_.enumerated("dark","light","auto"),gridSize:_.number.pipe(t=>t===10?1:vo(t,.5,2)),notifications:"boolean | null = null",language:_.enumerated("fr","en").default(()=>{try{const t=localStorage.getItem("PARAGLIDE_LOCALE");if(t==="fr"||t==="en")return localStorage.removeItem("PARAGLIDE_LOCALE"),t}catch(t){t instanceof ReferenceError||console.warn("Error migrating from PARAGLIDE_LOCALE ",t)}try{return Em()}catch(t){return console.warn("Error getting navigator.language, defaulting to fr",t),"fr"}}),showInputHints:"boolean",showTechnicalMetadata:"boolean",cropAutoNext:"boolean = false",parallelism:_("number").default(()=>{try{return Math.ceil(navigator.hardwareConcurrency/3)}catch(t){return console.warn("Couldn't get navigator.hardwareConcurrency, defaulting to 1",t),1}}),gallerySort:_({direction:_.enumerated("asc","desc"),key:_.enumerated("filename","date")}).configure({deprecated:!0}).default(()=>({direction:"asc",key:"date"})),autoUpdateProtocols:_("Record<string, boolean>").default(()=>({}))})),ib={ModelInput:li,ModelDetectionOutputShape:zu,MetadataTypeSchema:Ln,Settings:Ju},Dy=["ImageFile","ImagePreviewFile","MetadataOption"],Ey=["Image","Observation"];function Or(t){return Dy.every(e=>e!==t)}function bo(t){return Ey.some(e=>e===t)}const ge={Image:Iy,ImageFile:_y,ImagePreviewFile:Py,Observation:Cy,Session:Oy,Metadata:My,MetadataOption:Ay,Protocol:Ny,Settings:Ju};function Le(t,e){const r=Array.isArray(t)?t.map(n=>n):[t];return e.configure({table:{indexes:r}})}const It=(t,e)=>typeof t=="object"&&"id"in t||typeof e=="object"&&"id"in e?It(t.id,e.id):typeof t=="number"&&typeof e=="number"?t-e:typeof t=="number"?-1:typeof e=="number"?1:/^\d+$/.test(t)&&/^\d+$/.test(e)?Number(t)-Number(e):t.localeCompare(e),Yu=1115,mi=`previews/pr-${Yu}`,Qu=5,qn=Object.keys(ge),te=nl({Image:[],Metadata:[],Observation:[],Protocol:[],Settings:[],Session:[]}),Kr={...Object.fromEntries(qn.filter(Or).map(t=>[t,Ly(t)])),async initialize(t){for(const e of qn)Or(e)&&await Kr[e].refresh(t)}};function Ly(t){return{get state(){return te[t]},async refresh(e){!e&&bo(t)?(console.debug(`refresh ${t} without session: clearing state`),te[t]=[]):e&&bo(t)?(console.debug(`refresh ${t} for session ${e}`),te[t]=await this.list("sessionId",e)):(console.debug(`refresh ${t}`),te[t]=await this.list())},get:async e=>Kn(t,e),getOrThrow:async e=>{const r=await Kn(t,e);if(!r)throw new Error(`Item not found in ${t} with key ${e}`);return r},getFromState:e=>te[t].find(r=>r.id===e),async set(e){await Fn(t,e);const r=ge[t].assert(e),n=te[t].findIndex(i=>i.id===e.id);return n!==-1?te[t][n]=r:(te[t].push(r),te[t].sort(It)),r},async update(e,r,n){const i=`upd ${t} ${e} ${typeof r=="string"?r:"<Symbol>"} = ${n}`,s=await this.raw.get(e);if(!s)return console.error(`${i}: item not found`),!1;s[r]=n,await Fn(t,s);const a=te[t].findIndex(l=>l.id===e);return a===-1?(console.debug(`${i}: item not found in reactive state, refetching entire list`),te[t]=await this.list()):(console.debug(`${i}: updating state @ ${t}[${a}]`),te[t][a]=ge[t].assert(s)),!0},async add(e){return this.set({...e,id:Sy(t)})},async clear(){await Xu(t),te[t]=[]},async remove(e){await el(t,e);const r=te[t].findIndex(n=>n.id===e);r!==-1?(console.warn(`del ${t} ${e}: not found in reactive state, re-fetching`),te[t]=await this.list()):delete te[t][r]},async do(e){const r=`do ${t} #${Co()}`;console.debug(r),await rl([t],{mode:"readwrite"},async n=>{await e(n.objectStore(t))})},list:async(e,r)=>e&&r?Zu(t,e,r):gi(t),all:()=>tl(t),count:async()=>await(await pe()).count(t),raw:{async set(e){return await(await pe()).put(t,e)},async get(e){return await(await pe()).get(t,e)},async list(){return await(await pe()).getAll(t)}}}}async function Fn(t,e){const r=await pe();return ge[t].assert(e),await r.put(t,e).then(i=>i)}async function Xu(t){await(await pe()).clear(t).then(r=>r)}async function Kn(t,e){const r=await pe(),n=ge[t];return await r.get(t,e).then(i=>i?n.assert(i):void 0)}async function gi(t,e=void 0){const r=await pe(),n=ge[t];return await r.getAll(t,e).then(i=>i.map(s=>n.assert(s)).sort(It)).then(i=>i)}async function Zu(t,e,r=void 0){const n=await pe(),i=ge[t];return await n.getAllFromIndex(t,e,typeof r=="string"?IDBKeyRange.only(r):r).then(s=>s.map(a=>i.assert(a)).sort(It)).then(s=>s)}async function el(t,e){return await(await pe()).delete(t,e).then(()=>gi(t)).then(n=>{console.debug(`delete ${t} ${e}: objects are now ${n.map(i=>i.id).join(", ")}`)})}async function*tl(t,e=void 0){const r=await pe(),n=ge[t],i=r.transaction(t).store,s=e?i.index(e).iterate():i.iterate();for await(const a of s)yield n.assert(a.value)}function $y(t,e,...r){return["idb:/",t,e,...r].filter(Boolean).join("/")}async function rl(t,{mode:e,session:r},n){e??="readwrite",r??=localStorage.getItem("currentSessionId")||"";const i=Co(8);console.debug(`txn open ${i} tables ${t} mode ${e}`);const a=(await pe()).transaction(t,e);a.id=i,await n(a),console.debug(`txn commit ${i} `),await a.done;for(const l of t.filter(Or))await Kr[l].refresh(r)}function Ry(){if(!Se)throw new Error("Database not initialized. Call openDatabase() first.");return Se}async function pe(){if(Se)return Se;const t=Object.entries(ge);return Se=await Ol(mi,Qu,{upgrade(e,r,n,i){const s=(l,h)=>{if(!h.meta.table)return;const d=h.meta.table.indexes[0];if(e.objectStoreNames.contains(l)){console.warn(`Table ${l} already exists, skipping creation`);return}const f=e.createObjectStore(l,{keyPath:d});for(const p of h.meta.table.indexes.slice(1))f.createIndex(p,p)},a=async l=>{const h=ge[l];if(!h.meta.table)return;const d=i.objectStore(l);for(const f of d.indexNames)d.deleteIndex(f);for(const f of h.meta.table.indexes.slice(1))d.createIndex(f,f)};if(r===1)for(const l of e.objectStoreNames)e.deleteObjectStore(l);if(r===2){s("ImagePreviewFile",ge.ImagePreviewFile);return}r===3&&s("Session",ge.Session),r===4&&(a("ImageFile"),a("ImagePreviewFile"));for(const[l,h]of t)s(l,h)}}),window.devalue={stringify:xl,parse:bl},window.DB=Se,window.refreshDB=()=>{const e=localStorage.getItem("currentSessionId")||void 0;if(!e){console.warn("No current session ID set, cannot refresh reactive tables");return}for(const r of qn)Or(r)&&Kr[r].refresh(e??"")},Se}function Ty(){Se&&(Se.close(),Se=void 0),indexedDB.deleteDatabase(mi)}let Se;const sb=Object.freeze(Object.defineProperty({__proto__:null,_tablesState:te,clear:Xu,databaseHandle:Ry,databaseName:mi,databaseRevision:Qu,dependencyURI:$y,drop:el,get:Kn,iterator:tl,list:gi,listByIndex:Zu,nukeDatabase:Ty,openDatabase:pe,openTransaction:rl,previewingPrNumber:Yu,set:Fn,tables:Kr},Symbol.toStringTag,{value:"Module"}));export{Zy as $,qe as A,Qe as B,Xy as C,$m as D,E0 as E,Co as F,wl as G,wy as H,z as I,tb as J,re as K,Rt as L,ce as M,xg as N,_u as O,Yy as P,Jy as Q,Wy as R,wg as S,Sg as T,Bm as U,Pu as V,Km as W,Ps as X,Mg as Y,Og as Z,Is as _,Nm as a,j0 as a0,It as a1,Qy as a2,tn as a3,mt as a4,gt as a5,og as a6,ib as a7,Em as a8,Qu as a9,mi as aa,xy as ab,zc as ac,Vu as ad,jy as ae,B0 as af,ky as ag,Tn as ah,vy as ai,yo as aj,C0 as ak,Yu as al,Gu as am,nb as an,Wu as ao,rb as ap,sb as aq,_ as b,ie as c,$y as d,Dm as e,Ty as f,Sy as g,eb as h,F0 as i,T0 as j,Gy as k,gi as l,el as m,Rn as n,rl as o,Uy as p,Hy as q,K0 as r,Fn as s,Kr as t,Kn as u,Ry as v,Vy as w,$e as x,Zu as y,zy as z};
