import"../chunks/DsnmJJEf.js";import{p as R,I as w,H as k,a as y,b as L,ai as T,ak as _,g as i,u as m,J as B,K as b,D as V,F as W}from"../chunks/Dt6m180S.js";import{d as X,e as S,s as H}from"../chunks/BqMK6M8M.js";import{p as Z,i as A}from"../chunks/cmrSGx3m.js";import{a as $,f as ee}from"../chunks/DM93I2Od.js";import{c as J,b as K,s as te}from"../chunks/CoW7fDOc.js";import{A as ae}from"../chunks/CcbyKDVt.js";import{C as re}from"../chunks/ChS1jMTj.js";import{C as se}from"../chunks/BXclFgBD.js";import{s as ie}from"../chunks/BEu91mT_.js";import{p as ne}from"../chunks/BgPK52sz.js";import{t as j}from"../chunks/h9n_zjAt.js";import{d as z}from"../chunks/CXutPItK.js";import{i as E,A as M,b as O}from"../chunks/62CSzXnv.js";import{L as oe}from"../chunks/DJljq93Y.js";import{d as le}from"../chunks/Z9u04OLA.js";import{u as c}from"../chunks/fpNj8U5y.js";import{u as me}from"../chunks/C0SiBqD8.js";var fe=w('<input type="file" multiple class="svelte-1n47qnw"/>'),ue=w('<section role="form"><!> <div class="dragging-overlay svelte-1n47qnw"><p> </p></div> <!></section>');function de(C,r){R(r,!0);const F=m(()=>K("main"));let f=Z(r,"dragging",15,!1);function I(e){if(f(!1),!e.dataTransfer)return;e.preventDefault();let a=[];if(e.dataTransfer.items?a=[...e.dataTransfer.items].map(t=>{if(t.kind==="file")return t.getAsFile()}).filter(t=>!!t):a=[...e.dataTransfer.files],r.filetypes&&r.filetypes.length>0&&a.some(t=>!r.filetypes.includes(t.type))){r.onunacceptable?.(a);return}r.onfiles?.({event:e,files:a})}var s=ue();let o;var u=_(s);ie(u,()=>r.children??B);var l=T(u,2),d=_(l),p=_(d,!0);b(d),b(l);var q=T(l,2);{var x=e=>{var a=fe();a.__input=t=>{t.currentTarget.files&&r.onfiles?.({event:t,files:[...t.currentTarget.files]})},k(t=>te(a,"accept",t),[()=>r.filetypes?.join(",")]),y(e,a)};A(q,e=>{r.clickable&&e(x)})}b(s),k(e=>{o=J(s,1,"dropzone svelte-1n47qnw",null,o,{dragging:f(),clickable:r.clickable}),H(p,e)},[()=>i(F)(78)]),S("dragover",s,e=>{e.dataTransfer&&(e.preventDefault(),f(!0))}),S("drop",s,I),y(C,s),L()}X(["input"]);var ce=w('<div class="empty-state svelte-1urkjm2"><!> <p> </p></div>'),pe=w("<section><!> <!></section>");function je(C,r){R(r,!0);const F=m(()=>K("main")),f=m(()=>[...me(j.Image.state.map(({filename:s,id:o,addedAt:u,fileId:l,sessionId:d,metadata:p})=>({id:l??o,addedAt:u,sessionId:d,metadata:p,name:s,virtual:!1,data:j.Image.getFromState(o)})),s=>s.id),...c.processing.files.map(({name:s,id:o,addedAt:u})=>({id:o,sessionId:c.currentSessionId,addedAt:u,name:s,metadata:{},virtual:!0,data:null}))]),I=m(()=>i(f).length===0);{let s=m(()=>i(f).length===0);de(C,{get filetypes(){return M},get clickable(){return i(s)},onfiles:({files:o})=>E(o),children:(o,u)=>{var l=pe();let d;var p=_(l);ae(p,{get items(){return i(f)},zone:"import",onemptyclick:async()=>{c.selection.length>0||E(await ne({accept:M,multiple:!0}))},item:(a,t=B,g)=>{let n=()=>g?.().id,D=()=>g?.().name;var P=V(),Y=W(P);{var G=v=>{{let h=m(()=>({...t(),fileId:t().fileId}));re(v,{boxes:"none",get image(){return i(h)},ondelete:async()=>{O(n(),"Cancelled by user"),c.processing.removeFile(n()),await z(n())}})}},N=v=>{const h=m(()=>c.erroredImages.get(n())),Q=m(()=>c.queuedImages.has(n()));{let U=m(()=>i(h)?"errored":i(Q)?"queued":"loading");se(v,{get id(){return n()},get title(){return D()},get status(){return i(U)},get tooltip(){return i(h)},image:void 0,ondelete:async()=>{O(n(),"Cancelled by user"),c.processing.removeFile(n()),await le(n()),await z(n())}})}};A(Y,v=>{t()&&t().fileId?v(G):v(N,!1)})}y(a,P)},$$slots:{item:!0}});var q=T(p,2);{var x=e=>{var a=ce(),t=_(a);oe(t,{variant:"empty"});var g=T(t,2),n=_(g,!0);b(g),b(a),k(D=>H(n,D),[()=>i(F)(65)]),y(e,a)};A(q,e=>{i(I)&&e(x)})}b(l),k(()=>d=J(l,1,"observations svelte-1urkjm2",null,d,{empty:i(I)})),$(1,l,()=>ee,()=>({duration:100})),y(o,l)},$$slots:{default:!0}})}L()}export{je as component};
