import"../chunks/DsnmJJEf.js";import{p as D,D as C,F as M,a as u,b as E,al as y,aj as L,g as t,u as P,I,ak as i,ai as A,K as c,H as k}from"../chunks/Dt6m180S.js";import{s as z}from"../chunks/BqMK6M8M.js";import{s as F}from"../chunks/BEu91mT_.js";import{i as R}from"../chunks/cmrSGx3m.js";import{t as H,a as K,f as U}from"../chunks/DM93I2Od.js";import{b as G,s as J}from"../chunks/CoW7fDOc.js";import{w as N}from"../chunks/C02cds9o.js";import{l as O}from"../chunks/yErRaHIP.js";import{L as Q}from"../chunks/DJljq93Y.js";import{P as T}from"../chunks/1LLQNKI6.js";import{u as o}from"../chunks/fpNj8U5y.js";import{i as V}from"../chunks/C0SiBqD8.js";const W=g=>{var n=C(),v=M(n);{var d=a=>{const m=P(()=>{const{model:f}=o.cropModels[o.selectedCropModel];return{model:f}}),p=P(()=>new URL(typeof t(m).model=="string"?t(m).model:t(m).model?.url));var s=X(),_=i(s),b=i(_,!0);c(_),c(s),k((f,r)=>{J(s,"href",f),z(b,r)},[()=>t(p).toString(),()=>t(p).pathname.split("/").at(-1)]),u(a,s)};R(v,a=>{o.cropInferenceAvailable&&a(d)})}u(g,n)};var X=I('<a target="_blank"><code> </code></a>'),Y=I('<section class="loading svelte-9zb7ys"><!> <p> </p> <p class="source svelte-9zb7ys"><!></p> <div class="progressbar svelte-9zb7ys"><!></div></section>');function mr(g,n){D(n,!0);let v=L(0),d=L(!1),a=new AbortController;async function m(r){if(!o.currentProtocol||!o.cropInferenceAvailable)return;const e=o.currentProtocol.crop.infer?.[r]?.model;e&&(a.abort(),a=new AbortController,await O(n.data.swarpc,"detection",{abortSignal:a.signal,protocolId:o.currentProtocol.id,requests:{model:e,classmapping:void 0},onProgress(l){y(v,l,!0)}}))}const p=P(()=>G("main"));N(()=>o.selectedCropModel,()=>{y(d,!1),m(o.selectedCropModel).catch(r=>{V(r)||(console.error(r),H.error(t(p)(90)))}).then(()=>{y(d,!0)})});var s=C(),_=M(s);{var b=r=>{var e=Y(),l=i(e);Q(l,{loading:!0});var h=A(l,2),S=i(h,!0);c(h);var w=A(h,2),j=i(w);W(j),c(w);var x=A(w,2),q=i(x);T(q,{percentage:!0,alwaysActive:!0,get progress(){return t(v)}}),c(x),c(e),k(B=>z(S,B),[()=>t(p)(56)]),K(1,e,()=>U,()=>({duration:100})),u(r,e)},f=r=>{var e=C(),l=M(e);F(l,()=>n.children),u(r,e)};R(_,r=>{t(d)?r(f,!1):r(b)})}u(g,s),E()}export{mr as component};
