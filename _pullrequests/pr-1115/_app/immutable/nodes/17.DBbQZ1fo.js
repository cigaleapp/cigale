import"../chunks/DsnmJJEf.js";import{f as pe,a as h,p as te,an as fe,b as re,I as F,F as E,ai as w,g as e,u as a,G as Y,H,am as Z,D as ee,J as de,ak as u,K as i,aj as W,al as L}from"../chunks/Dt6m180S.js";import{s as C}from"../chunks/BqMK6M8M.js";import{r as ge,p as ue,i as G,s as he}from"../chunks/cmrSGx3m.js";import{e as we}from"../chunks/Bmx3KKup.js";import{t as T,a as xe,f as Pe}from"../chunks/DM93I2Od.js";import{a as be,b as oe}from"../chunks/CoW7fDOc.js";import{D as ke}from"../chunks/Cku3ZTO-.js";import{B as Q}from"../chunks/BWvVnymT.js";import{t as N,n as ye,e as $e,I as Me,v as Be,p as Ie}from"../chunks/h9n_zjAt.js";import{e as Se,b as De}from"../chunks/BgPK52sz.js";import{B as Re}from"../chunks/CSftjQJd.js";import{F as ae}from"../chunks/DwPLocwb.js";import{I as se}from"../chunks/DRBqBfVL.js";import{M as Ue}from"../chunks/DgZz-4De.js";import{g as ve,r as Ae}from"../chunks/CoCzgeuV.js";import{R as j}from"../chunks/CH5FdpMr.js";import{S as Ce,M as Fe}from"../chunks/CfbReYZC.js";import{A as He}from"../chunks/ChO_7ts8.js";import{D as qe}from"../chunks/C0se_-sl.js";import{P as Oe}from"../chunks/D6Oa7EoC.js";import{B as Te}from"../chunks/DZd6ULkr.js";import{B as ne}from"../chunks/BAG1AaOD.js";import{B as le}from"../chunks/BLmbeBA7.js";import{O as je}from"../chunks/CMjWo4lL.js";import{a as ie,s as ze}from"../chunks/JZH0u_ZA.js";import{u as ce}from"../chunks/fpNj8U5y.js";import{S as Ee}from"../chunks/BOHcG-kb.js";var Ge=pe('<svg><path fill="currentColor" d="M11 11V7h2v4h4v2h-4v4h-2v-4H7v-2zm1 11C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m0-2a8 8 0 1 0 0-16a8 8 0 0 0 0 16"></path></svg>');function Je(q,t){const o=ge(t,["$$slots","$$events","$$legacy"]);var I=Ge();be(I,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...o})),h(q,I)}var Ke=F("<!> <!>",1),Ve=F("<p> </p>"),Le=F("<code>.</code>"),Ne=F("<code>_</code>"),Qe=F("<em> </em>"),We=F("<!> <!>",1);function Xe(q,t){te(t,!0);const o=a(()=>oe("main"));let I=ue(t,"open",15),x=fe({name:"",id:""});{const R=(k,U)=>{let y=()=>U?.().close;var $=Ke(),M=E($);Q(M,{onclick:()=>y()?.(),children:(p,v)=>{Z();var c=Y();H(f=>C(c,f),[()=>e(o)(30)]),h(p,c)},$$slots:{default:!0}});var B=w(M,2);Re(B,{onclick:async()=>{T.clear();const p=v=>ye(x.id,v);try{await N.Metadata.set({id:p("crop"),description:"",label:"",mergeMethod:"union",type:"boundingbox",required:!1}),await N.Metadata.set({id:p("crop_confirmation"),description:"",label:"",mergeMethod:"none",type:"boolean",required:!1}),await N.Protocol.set({id:x.id,name:x.name,metadata:["crop","crop_confirmation"].map(p),description:"",authors:[],crop:{metadata:p("crop"),confirmationMetadata:p("crop_confirmation")}}),await ve("/(app)/protocols/[id]/infos",{id:x.id})}catch(v){T.error($e(v))}},children:(p,v)=>{Z();var c=Y();H(f=>C(c,f),[()=>e(o)(212)]),h(p,c)},$$slots:{default:!0}}),h(k,$)};let S=a(()=>e(o)(72));Ue(q,{key:"modal_create_protocol",get title(){return e(S)},toasts:"protocolcreator",get open(){return I()},set open(k){I(k)},footer:R,children:(k,U)=>{var y=We(),$=E(y);{let B=a(()=>e(o)(209));ae($,{get label(){return e(B)},children:(p,v)=>{se(p,{label:"",value:"",onblur:c=>{x.name=c}})}})}var M=w($,2);ae(M,{label:v=>{const c=(f,D=de)=>{var l=Ve(),d=u(l,!0);i(l),H(m=>C(d,m),[()=>e(o).x(D())]),h(f,l)};{let f=a(()=>[c]),D=a(()=>e(o).c(210));j(v,{get t(){return e(f)},get x(){return e(D)}})}},error:v=>{const c=a(()=>N.Protocol.getFromState(x.id));var f=ee(),D=E(f);{var l=m=>{const n=b=>{var g=Le();h(b,g)},P=b=>{var g=Ne();h(b,g)};{let b=a(()=>[n,P]),g=a(()=>e(o).c(346));j(m,{get t(){return e(b)},get x(){return e(g)}})}},d=m=>{var n=ee(),P=E(n);{var b=g=>{const J=r=>{var s=Qe(),_=u(s,!0);i(s),H(()=>C(_,e(c).name)),h(r,s)};{let r=a(()=>[J]),s=a(()=>e(o).c(211));j(g,{get t(){return e(r)},get x(){return e(s)}})}};G(P,g=>{e(c)&&g(b)},!0)}h(m,n)};G(D,m=>{x.id&&!Me.allows(x.id)?m(l):m(d,!1)})}h(v,f)},children:(v,c)=>{se(v,{label:"",value:"",get onerror(){return T.error},onblur:f=>{x.id=f}})}}),h(k,y)},$$slots:{footer:!0,default:!0}})}re()}var Ye=F('<label class="auto-updates svelte-1aw9mnt"><!> <div class="text svelte-1aw9mnt"><p> </p> <p class="via svelte-1aw9mnt"><!></p></div></label>'),Ze=F('<li class="svelte-1aw9mnt"><details class="svelte-1aw9mnt"><summary class="svelte-1aw9mnt"><section class="text"><h3> </h3> <small><code> </code></small></section> <section class="actions svelte-1aw9mnt"><!> <!></section></summary> <!> <div class="more-actions svelte-1aw9mnt"><!> <!> <!></div></details></li>');function et(q,t){te(t,!0);const o=a(()=>oe("main"));let I=ue(t,"expanded",11,!1);const x=a(()=>{const r=ie().autoUpdateProtocols;return t.id in r?r[t.id]:t.updates==="automatic"});var R=Ze(),S=u(R),k=u(S),U=u(k),y=u(U),$=u(y,!0);i(y);var M=w(y,2),B=u(M),p=u(B,!0);i(B),i(M),i(U);var v=w(U,2),c=u(v);{let r=a(()=>e(o)(91));ne(c,{get help(){return e(r)},onclick:async()=>{await Se(Be(),Ae("/"),t.id).catch(s=>T.error(s))},children:(s,_)=>{Ce(s,{})},$$slots:{default:!0}})}var f=w(c,2);{var D=r=>{le(r,{compact:!0,get version(){return t.version},get source(){return t.source},get id(){return t.id}})},l=r=>{{let s=a(()=>e(o)(49));ne(r,{crossout:!0,onclick:()=>{},get help(){return e(s)},children:(_,O)=>{He(_,{})},$$slots:{default:!0}})}};G(f,r=>{t.version&&t.source?r(D):r(l,!1)})}i(v),i(k);var d=w(k,2);{var m=r=>{var s=Ye(),_=u(s);{let V=a(()=>e(o)(427));Ee(_,{get value(){return e(x)},get label(){return e(V)},onchange:async me=>{const _e=ie().autoUpdateProtocols;await ze("autoUpdateProtocols",{..._e,[t.id]:me})}})}var O=w(_,2),A=u(O),z=u(A,!0);i(A);var K=w(A,2),X=u(K);{let V=a(()=>e(o)(429,[t.source]));je(X,{get text(){return e(V)}})}i(K),i(O),i(s),H(V=>C(z,V),[()=>e(o)(428)]),h(r,s)};G(d,r=>{t.version&&t.source&&r(m)})}var n=w(d,2),P=u(n);{const r=_=>{qe(_,{})};let s=a(()=>t.id===ce.currentProtocolId&&ce.processing.total>0);Q(P,{danger:!0,get disabled(){return e(s)},onclick:()=>{t.ondelete()},_w_snippet_0:r,children:(_,O)=>{{let A=a(()=>[r]),z=a(()=>e(o).c(15));j(_,{get t(){return e(A)},get x(){return e(z)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}var b=w(P,2);{const r=_=>{Oe(_,{})},s=(_,O=de)=>{Te(_,{children:(A,z)=>{Z();var K=Y();H(X=>C(K,X),[()=>e(o).x(O())]),h(A,K)}})};Q(b,{onclick:()=>ve("/(app)/protocols/[id]/infos",{id:t.id}),_w_snippet_1:r,_w_snippet_2:s,children:(_,O)=>{{let A=a(()=>[r,s]),z=a(()=>e(o).c(430));j(_,{get t(){return e(A)},get x(){return e(z)}})}},$$slots:{_w_snippet_1:!0,_w_snippet_2:!0,default:!0}})}var g=w(b,2);{var J=r=>{le(r,{get version(){return t.version},get source(){return t.source},get id(){return t.id}})};G(g,r=>{t.version&&t.source&&r(J)})}i(n),i(S),i(R),H(()=>{S.open=I(),C($,t.name),C(p,t.id)}),h(q,R),re()}var tt=F('<!> <!> <div class="page svelte-1fvkkcr"><header class="svelte-1fvkkcr"><h1 class="svelte-1fvkkcr"> </h1> <section class="actions svelte-1fvkkcr"><!> <!></section></header> <ul class="protocols svelte-1fvkkcr"></ul></div>',1);function Dt(q,t){te(t,!0);const o=a(()=>oe("main"));let I=W(""),x=W(void 0),R=W(void 0),S=W("");var k=tt(),U=E(k);Fe(U,{get id(){return e(I)},get open(){return e(x)},set open(l){L(x,l,!0)}});var y=w(U,2);Xe(y,{get open(){return e(R)},set open(l){L(R,l,!0)}});var $=w(y,2),M=u($),B=u(M),p=u(B,!0);i(B);var v=w(B,2),c=u(v);Q(c,{loading:!0,onclick:async(d,m)=>{await De({allowMultiple:!0,onInput:m.loadingStarted,importProtocol:t.data.swarpc.importProtocol}).catch(n=>T.error(n)).then(n=>{!n||typeof n=="string"||n.length===0||(n.length===1?T.success(e(o)(134,[n[0].name])):T.success(Ie(n.length,e(o).p(195),e(o)._.p)))})},children:(d,m)=>{let n=()=>m?.().loading;const P=b=>{var g=ee(),J=E(g);{var r=s=>{ke(s,{})};G(J,s=>{n()||s(r)})}h(b,g)};{let b=a(()=>[P]),g=a(()=>e(o).c(5));j(d,{get t(){return e(b)},get x(){return e(g)}})}},$$slots:{default:!0}});var f=w(c,2);{const l=d=>{Je(d,{})};Q(f,{onclick:()=>e(R)?.(),_w_snippet_1:l,children:(d,m)=>{{let n=a(()=>[l]),P=a(()=>e(o).c(3));j(d,{get t(){return e(n)},get x(){return e(P)}})}},$$slots:{_w_snippet_1:!0,default:!0}})}i(v),i(M);var D=w(M,2);we(D,21,()=>N.Protocol.state,l=>l.id,(l,d)=>{var m=()=>e(S)===e(d).id,n=P=>{P?L(S,e(d).id,!0):e(S)===e(d).id&&L(S,"")};et(l,he(()=>e(d),{get expanded(){return m()},set expanded(P){n(P)},ondelete:()=>{L(I,e(d).id,!0),e(x)?.()}}))}),i(D),i($),H(l=>C(p,l),[()=>e(o)(135)]),xe(1,$,()=>Pe,()=>({duration:100})),h(q,k),re()}export{Dt as component};
