import"./DsnmJJEf.js";import{f as me,a as s,e as q,d as B,g as t,u,n as De,p as Re,c as x,b as He,az as h,ay as c,r as n,s as ne,i as ve,q as Oe,aa as j,a9 as de}from"./Bn_ZbADV.js";import{d as je,a as N}from"./C0Q0tU0C.js";import{r as be,p as C,i as f}from"./dHQvgpC_.js";import{c as Fe}from"./Ceb8Mi8c.js";import{e as Ge,i as Je}from"./WunZNVQx.js";import{a as ee,t as te}from"./DiOkT0aq.js";import{a as ae,C as he,b as Ke,s as ce,c as Ne,_ as Qe,g as Ue}from"./ByTqR5TD.js";import{b as Ve}from"./DqeZ7boJ.js";import{b as Xe}from"./CoBO7ZM6.js";import{R as fe}from"./DHI2XP9K.js";import{D as Ye}from"./tQ5xpUhk.js";import{I as Ze}from"./DccYDYZA.js";import"./69_IOA4Y.js";import{B as _e}from"./BNxh-1nu.js";import{s as $e}from"./D9gih6mG.js";import{e as et}from"./UkrbtdNH.js";import{C as tt}from"./DwcGzKiu.js";import{L as ue}from"./Db2b552w.js";import{L as at}from"./i04FUm_M.js";var st=me('<svg><path fill="currentColor" d="M8 7v4L2 6l6-5v4h5a8 8 0 1 1 0 16H4v-2h9a6 6 0 0 0 0-12z"></path></svg>');function rt(z,e){const b=be(e,["$$slots","$$events","$$legacy"]);var L=st();ae(L,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...b})),s(z,L)}var it=me('<svg width="1.2em" height="1.2em" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 8L5.5 11.5L13 4" stroke="currentColor" stroke-linecap="round"></path></svg>');function ot(z){var e=it();s(z,e)}function ge(z,e){const b=C(e,"children",3,void 0),L=C(e,"tag",3,"article"),I=u(()=>!!e.onclick);var o=q(),M=B(o);et(M,L,!1,(W,A)=>{ae(W,()=>({class:"card",onclick:e.onclick,tabindex:t(I)?0:void 0,[he]:{clickable:t(I)}}),void 0,void 0,"svelte-2gevwt");var F=q(),G=B(F);$e(G,()=>b()??De),s(A,F)}),s(z,o)}var lt=x('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),nt=x('<section class="errored-actions svelte-pa7bo1"><!> <!></section>'),vt=x('<div class="loading-overlay svelte-pa7bo1"><!> <span class="text smol svelte-pa7bo1"><!></span> <!></div>'),dt=x('<img class="svelte-pa7bo1"/>'),ct=x('<div class="img-placeholder svelte-pa7bo1"><!></div>'),ft=x('<div data-testid="card-observation-bounding-box" class="bb svelte-pa7bo1"></div>'),_t=x('<div class="inner svelte-pa7bo1"><!> <div><!> <!></div> <footer class="svelte-pa7bo1"><div class="check-icon svelte-pa7bo1"><!></div> <h2 class="svelte-pa7bo1"> </h2> <button class="stack-count svelte-pa7bo1"> </button></footer></div>'),ut=x('<div class="stack-background-card svelte-pa7bo1"><!></div>'),gt=x('<article><div class="main-card svelte-pa7bo1"><!></div> <!></article>');function Pt(z,e){Re(e,!0);const b=u(()=>Qe(Ue("main")));let L=C(e,"selected",3,!1),I=C(e,"selectable",3,!0),o=C(e,"status",7),M=C(e,"loadingStatusText",7),W=C(e,"stacksize",3,1),A=C(e,"boundingBoxes",19,()=>[]),F=be(e,["$$slots","$$events","$$legacy","onclick","onstacksizeclick","ondelete","onretry","title","image","selected","selectable","highlighted","status","statusText","loadingStatusText","stacksize","boundingBoxes","boxes","tooltip","id"]);const G=u(()=>W()>1),J=u(()=>o()==="loading"||o()==="queued"),xe=u(()=>o()==="errored"),ke=u(()=>o()==="loading"?t(b).t(59):o()==="queued"?t(b).t(85):o()==="errored"?t(b).t(87):"");let Q=ne(void 0),se=ne(0),pe=u(()=>t(se)<t(Q)?.scrollWidth);var E=gt();ae(E,()=>({class:"observation","data-selectable":I()?"":void 0,"data-id":e.id,...F,[he]:{selected:L(),selectable:I(),highlighted:e.highlighted,loading:t(J),stacked:t(G)}}),void 0,void 0,"svelte-pa7bo1");var U=c(E),we=c(U);ge(we,{tag:"div",onclick:g=>{t(J)||t(xe)||g instanceof MouseEvent&&e.onclick?.(g,_=>{_.status&&o(_.status),_.loadingStatusText&&M(_.loadingStatusText)})},children:(g,_)=>{var P=_t(),re=c(P);{var ze=a=>{var r=vt(),k=c(r);{var R=i=>{var l=lt(),w=B(l);Fe(w,()=>({"--size":"1.5em"})),at(w.lastChild,{variant:"error"}),n(w),s(i,l)},p=i=>{var l=q(),w=B(l);{var X=y=>{ue(y,{})},Y=y=>{var m=q(),S=B(m);{var d=O=>{ue(O,{waiting:!0})};f(S,O=>{o()==="queued"&&O(d)},!0)}s(y,m)};f(w,y=>{o()==="loading"?y(X):y(Y,!1)},!0)}s(i,l)};f(k,i=>{o()==="errored"?i(R):i(p,!1)})}var v=h(k,2),H=c(v);{var We=i=>{var l=de();j(()=>N(l,M())),s(i,l)},Ae=i=>{var l=de();j(()=>N(l,e.statusText||t(ke))),s(i,l)};f(H,i=>{o()==="loading"&&M()?i(We):i(Ae,!1)})}n(v);var Ee=h(v,2);{var Pe=i=>{var l=nt(),w=c(l);{var X=m=>{{const S=d=>{Ye(d,{})};_e(m,{dangerous:!0,onclick:d=>{d.stopPropagation(),e.ondelete()},_w_snippet_0:S,children:(d,O)=>{{let Z=u(()=>[S]),$=u(()=>t(b).cx(15));fe(d,{get t(){return t(Z)},get x(){return t($)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}};f(w,m=>{e.ondelete&&m(X)})}var Y=h(w,2);{var y=m=>{{const S=d=>{rt(d,{})};_e(m,{onclick:d=>{d.stopPropagation(),e.onretry()},_w_snippet_1:S,children:(d,O)=>{{let Z=u(()=>[S]),$=u(()=>t(b).cx(14));fe(d,{get t(){return t(Z)},get x(){return t($)}})}},$$slots:{_w_snippet_1:!0,default:!0}})}};f(Y,m=>{!t(J)&&e.onretry&&m(y)})}n(l),s(i,l)};f(Ee,i=>{(e.ondelete||e.onretry)&&i(Pe)})}n(r),s(a,r)};f(re,a=>{o()!=="ok"&&a(ze)})}var K=h(re,2);let ie;var oe=c(K);{var Se=a=>{var r=q(),k=B(r);{var R=v=>{tt(v,{blurfill:!0,get src(){return e.image},get alt(){return e.title},get box(){return A()[0]}})},p=v=>{var H=dt();j(()=>{ce(H,"src",e.image),ce(H,"alt",e.title)}),s(v,H)};f(k,v=>{e.boxes==="apply-first"&&A().length>0?v(R):v(p,!1)})}s(a,r)},Be=a=>{var r=ct(),k=c(r);Ze(k,{}),n(r),s(a,r)};f(oe,a=>{e.image?a(Se):a(Be,!1)})}var Le=h(oe,2);{var Te=a=>{var r=q(),k=B(r);Ge(k,17,A,Je,(R,p)=>{var v=ft();j(()=>Ne(v,`left: ${t(p).x*100}%; top: ${t(p).y*80}%; width: ${t(p).width*100}%; height: ${80*t(p).height}%;`)),s(R,v)}),s(a,r)};f(Le,a=>{e.boxes==="show-all"&&a(Te)})}n(K);var le=h(K,2),V=c(le),qe=c(V);ot(qe),n(V);var T=h(V,2),Ie=c(T,!0);n(T),Xe(T,a=>ve(Q,a),()=>t(Q)),Oe(()=>Ve(T,"offsetWidth",a=>ve(se,a))),ee(T,(a,r)=>te?.(a,r),()=>t(pe)?e.title:void 0);var D=h(T,2);D.__click=a=>{a.stopPropagation(),e.onstacksizeclick?.()};var Me=c(D,!0);n(D),ee(D,(a,r)=>te?.(a,r),()=>`Cette observation regroupe ${W()} images. Cliquez pour les voir toutes.`),n(le),n(P),j(()=>{ie=Ke(K,1,"boundingboxes-wrapper svelte-pa7bo1",null,ie,{"has-boxes":e.boxes==="show-all"}),N(Ie,e.title),D.disabled=t(J),N(Me,W())}),s(g,P)},$$slots:{default:!0}}),n(U);var ye=h(U,2);{var Ce=g=>{var _=ut(),P=c(_);ge(P,{tag:"div"}),n(_),s(g,_)};f(ye,g=>{t(G)&&g(Ce)})}n(E),ee(E,(g,_)=>te?.(g,_),()=>e.tooltip),s(z,E),He()}je(["click"]);export{Pt as C};
