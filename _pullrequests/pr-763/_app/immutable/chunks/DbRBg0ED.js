import"./DsnmJJEf.js";import{o as tn,a as rn}from"./CNplBLUs.js";import{j as nn,p as he,k as $e,b as ge,e as N,d as C,c as R,ay as y,r as w,az as P,aa as K,g as r,u as m,a as _,aY as St,t as on,n as ce,a3 as sn,s as re,h as Ut,i as O,bD as an,a9 as fe,aA as Ee,a8 as ln,f as ot,aX as cn,a6 as un}from"./Bn_ZbADV.js";import{c as dn,a as E,m as fn,u as vn,o as ct,d as Bt,e as pn,k as hn}from"./C0Q0tU0C.js";import{p as H,i as G,r as Ie,s as ut}from"./dHQvgpC_.js";import{e as nt}from"./WunZNVQx.js";import{s as ve}from"./D9gih6mG.js";import{_ as Ve,g as Xe,a as we,s as ye,b as mt,c as yr,C as gn,r as mn}from"./ByTqR5TD.js";import{w as xr}from"./CwN-qvm4.js";import{S as Mr}from"./DP2HZFad.js";import{b as _n,g as at,a as it,r as or}from"./wr4YUA__.js";import{p as We}from"./CAILCW9-.js";import{G as bn,v as bt,Q as wn,R as yn,J as sr,ad as ar,ae as xt,af as Ue,a as xn,t as je,q as Mn,z as kn}from"./GdErsj6s.js";import{o as ht,f as zt}from"./RrsJoApQ.js";import{c as wt}from"./Ceb8Mi8c.js";import{K as Pn,a as kr,t as Pr}from"./DiOkT0aq.js";import{h as ir,a as Ot,b as Sn,t as Cn,M as $n,T as In}from"./BTwBtcBS.js";import{i as Ct,s as ze,a as Ht}from"./KMAftsCj.js";import{e as lr,c as Sr,n as Kt,x as On,p as An}from"./DvdFYW7d.js";import{g as Pt,e as Tn,h as En}from"./CMRT31L6.js";import{u as B}from"./C6TF2dQr.js";import{t as Ae}from"./CM1wOxol.js";import{b as cr}from"./DqeZ7boJ.js";import{R as Le}from"./DHI2XP9K.js";import{j as $t,o as Wt,l as Vt,k as yt,c as J,U as Cr,a0 as $r,Q as Ir,w as Ze,n as He,O as Dn,R as Fn,E as Or,S as Xt,a1 as Ar,i as qt,a2 as dt,a3 as Yt,a4 as Rn,a5 as Tr,a6 as Nn,a7 as Ln,C as ft,a8 as zn,u as vt,g as Er,V as Dr,a as Hn,a9 as Kn,Z as rt,T as qn,aa as Gn,ab as jn,ac as Un,m as Ge,ad as Bn,ae as Wn,b as st,f as Vn,P as Xn,d as Yn,e as ur,F as Jn,A as Qn}from"./B3UxJwIc.js";import{A as Ft}from"./BoC_Jw-8.js";import{C as Fr}from"./DCQ6EIJ0.js";import{B as lt}from"./DDqzxxyE.js";import{B as Be}from"./Bg7L1dYG.js";import{c as Ne}from"./C-HhNZ1M.js";import{s as Qe}from"./hWH8XGqh.js";import{k as Zn,B as eo}from"./CFIEvhui.js";import{L as to}from"./i04FUm_M.js";import{P as Jt}from"./BbqYytGl.js";import{a as tt}from"./BgDQWD78.js";import{n as Qt,k as ro}from"./DqO7cyx5.js";import{D as no}from"./BtdpP2ae.js";import{d as oo}from"./CqvX9GtU.js";import{I as Rr,a as so}from"./DhJZr4Fe.js";import{L as Nr}from"./Db2b552w.js";import{R as ao}from"./DoWc1nNm.js";import{e as io}from"./UkrbtdNH.js";import{A as lo}from"./62pvB83o.js";import{b as co}from"./CoBO7ZM6.js";import{A as uo}from"./DiOs4Ftk.js";import{C as fo}from"./D6Cki-wO.js";import{L as vo}from"./BlzppQ7h.js";import{S as dr}from"./tWmjtN3U.js";import{B as fr}from"./DxiPMQpi.js";import{m as vr}from"./CgGYYexj.js";import{e as po,s as ho,g as go,f as mo}from"./BnUFKmkQ.js";function _o(t){let e;const n=dn(s=>{let f=!1;const a=t.subscribe(i=>{e=i,f&&s()});return f=!0,a});function o(){return nn()?(n(),e):po(t)}return"set"in t?{get current(){return o()},set current(s){t.set(s)}}:{get current(){return o()}}}function bo(t){return bn(t,Date.now())}function wo(t,e,n){const[o,s]=Qt(n?.in,t,e),f=o.getFullYear()-s.getFullYear(),a=o.getMonth()-s.getMonth();return f*12+a}function yo(t){return e=>{const o=(t?Math[t]:Math.trunc)(e);return o===0?0:o}}function xo(t,e){return+bt(t)-+bt(e)}function Mo(t,e){const n=bt(t,e?.in);return n.setHours(23,59,59,999),n}function ko(t,e){const n=bt(t,e?.in),o=n.getMonth();return n.setFullYear(n.getFullYear(),o+1,0),n.setHours(23,59,59,999),n}function Po(t,e){const n=bt(t,e?.in);return+Mo(n,e)==+ko(n,e)}function So(t,e,n){const[o,s,f]=Qt(n?.in,t,t,e),a=Pt(s,f),i=Math.abs(wo(s,f));if(i<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*i);let d=Pt(s,f)===-a;Po(o)&&i===1&&Pt(o,f)===1&&(d=!1);const v=a*(i-+d);return v===0?0:v}function Co(t,e,n){const o=xo(t,e)/1e3;return yo(n?.roundingMethod)(o)}function $o(t,e,n){const o=wn(),s=n?.locale??o.locale??yn,f=2520,a=Pt(t,e);if(isNaN(a))throw new RangeError("Invalid time value");const i=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:a}),[d,v]=Qt(n?.in,...a>0?[e,t]:[t,e]),u=Co(v,d),c=(sr(v)-sr(d))/1e3,p=Math.round((u-c)/60);let h;if(p<2)return n?.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,i):u<10?s.formatDistance("lessThanXSeconds",10,i):u<20?s.formatDistance("lessThanXSeconds",20,i):u<40?s.formatDistance("halfAMinute",0,i):u<60?s.formatDistance("lessThanXMinutes",1,i):s.formatDistance("xMinutes",1,i):p===0?s.formatDistance("lessThanXMinutes",1,i):s.formatDistance("xMinutes",p,i);if(p<45)return s.formatDistance("xMinutes",p,i);if(p<90)return s.formatDistance("aboutXHours",1,i);if(p<ar){const l=Math.round(p/60);return s.formatDistance("aboutXHours",l,i)}else{if(p<f)return s.formatDistance("xDays",1,i);if(p<xt){const l=Math.round(p/ar);return s.formatDistance("xDays",l,i)}else if(p<xt*2)return h=Math.round(p/xt),s.formatDistance("aboutXMonths",h,i)}if(h=So(v,d),h<12){const l=Math.round(p/xt);return s.formatDistance("xMonths",l,i)}else{const l=h%12,g=Math.trunc(h/12);return l<3?s.formatDistance("aboutXYears",g,i):l<9?s.formatDistance("overXYears",g,i):s.formatDistance("almostXYears",g+1,i)}}function Io(t,e){return $o(t,bo(t),e)}var Oo=["Shift","Meta","Alt","Control"],Lr=typeof navigator=="object"?navigator.platform:"",zr=/Mac|iPod|iPhone|iPad/.test(Lr),Ao=zr?"Meta":"Control",To=Lr==="Win32"?["Control","Alt"]:zr?["Alt"]:[];function Gt(t,e){return typeof t.getModifierState=="function"&&(t.getModifierState(e)||To.includes(e)&&t.getModifierState("AltGraph"))}function Eo(t){return t.trim().split(" ").map(function(e){var n=e.split(/\b\+/),o=n.pop(),s=o.match(/^\((.+)\)$/);return s&&(o=new RegExp("^"+s[1]+"$")),[n=n.map(function(f){return f==="$mod"?Ao:f}),o]})}function Do(t,e){var n=e[0],o=e[1];return!((o instanceof RegExp?!o.test(t.key)&&!o.test(t.code):o.toUpperCase()!==t.key.toUpperCase()&&o!==t.code)||n.find(function(s){return!Gt(t,s)})||Oo.find(function(s){return!n.includes(s)&&o!==s&&Gt(t,s)}))}function Fo(t,e){var n;e===void 0&&(e={});var o=(n=e.timeout)!=null?n:1e3,s=Object.keys(t).map(function(i){return[Eo(i),t[i]]}),f=new Map,a=null;return function(i){i instanceof KeyboardEvent&&(s.forEach(function(d){var v=d[0],u=d[1],c=f.get(v)||v;Do(i,c[0])?c.length>1?f.set(v,c.slice(1)):(f.delete(v),u(i)):Gt(i,i.key)||f.delete(v)}),a&&clearTimeout(a),a=setTimeout(f.clear.bind(f),o))}}function Ro(t,e,n){var o={},s=o.event,f=s===void 0?"keydown":s,a=o.capture,i=Fo(e,{timeout:o.timeout});return t.addEventListener(f,i,a),function(){t.removeEventListener(f,i,a)}}var No=R('<h2 class="svelte-6wpiuz"> </h2>'),Lo=R('<dt class="svelte-6wpiuz"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></dt> <dd class="svelte-6wpiuz"> </dd>',1),zo=R('<!> <dl class="svelte-6wpiuz"></dl>',1),Ho=R('<dl class="svelte-6wpiuz"><div class="empty svelte-6wpiuz"><div class="sad svelte-6wpiuz"> </div> <p> </p></div></dl>');function Ko(t,e){he(e,!0);const n=m(()=>Ve(Xe("main")));let o=H(e,"openHelp",15),s=H(e,"preventDefault",3,!1);const f=d=>(d instanceof KeyboardEvent||d instanceof MouseEvent)&&(d.target instanceof HTMLInputElement||d.target instanceof HTMLTextAreaElement);$e(()=>Ro(window,Object.fromEntries(Object.entries(e.binds).flatMap(([d,v])=>{if(d.startsWith("Digit")&&!d.includes(" ")){const u=d.replace("Digit","");return[[d,v],[u,v],[`Shift+${u}`,v]]}return[[d,v]]}).map(([d,v])=>[d,async u=>{if(!v?.allowInModals&&ir(We)){console.warn(`a modal is open, ignoring keybinding ${d}`,We.state);return}if(f(u)&&!d.startsWith("$mod+")){console.warn(`in input, ignoring keybinding ${d}`,u.target);return}v.when&&!v.when(u)||v.debug&&!Ct()||(s()&&u.preventDefault(),await v.do(u))}]))));const a=["Recadrage","Observations","Général","Navigation","Debug mode"],i=m(()=>lr(lr(e.binds).reduce((d,[v,u])=>{if(u.hidden||u.debug&&!Ct())return d;const c=u.group??"Général";return d[c]||(d[c]=[]),d[c].push([v,u]),d},{})).toSorted(([d],[v])=>a.indexOf(d)-a.indexOf(v)));$e(()=>{const d=v=>{v.key==="?"&&!f(v)&&!ir(We)&&o()?.()};return window.addEventListener("keyup",d),()=>window.removeEventListener("keyup",d)});{let d=m(()=>r(n).t(153));Ot(t,{key:"modal_keyboard_shortcuts_help",get title(){return r(d)},get open(){return o()},set open(v){o(v)},children:(v,u)=>{var c=N(),p=C(c);nt(p,17,()=>r(i),([h,l])=>h,(h,l,g,b)=>{var M=m(()=>St(r(l),2));let $=()=>r(M)[0],F=()=>r(M)[1];var I=zo(),S=C(I);{var x=T=>{var D=No(),L=y(D,!0);w(D),K(()=>E(L,$())),_(T,D)};G(S,T=>{r(i).length>=2&&T(x)})}var k=P(S,2);nt(k,21,F,([T,{help:D}])=>T,(T,D)=>{var L=m(()=>St(r(D),2));let U=()=>r(L)[0],X=()=>r(L)[1].help;var q=Lo(),z=C(q),V=y(z);wt(V,()=>({"--size":"1.2em"})),Pn(V.lastChild,{get shortcut(){return U()},get help(){return X()}}),w(V),w(z);var ee=P(z,2),se=y(ee,!0);w(ee),K(()=>E(se,X())),_(T,q)}),w(k),_(h,I)},h=>{var l=Ho(),g=y(l),b=y(g),M=y(b,!0);w(b);var $=P(b,2),F=y($,!0);w($),w(g),w(l),K((I,S)=>{E(M,I),E(F,S)},[()=>r(n).t(204),()=>r(n).t(36)]),_(h,l)}),_(v,c)},$$slots:{default:!0}})}ge()}function qo(t){$e(()=>on(()=>t()))}function Go(t){return window.getComputedStyle(t).getPropertyValue("direction")}function jo(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?Vt:Wt,vertical:yt}[e]}function Uo(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?Wt:Vt,vertical:$t}[e]}function Bo(t="ltr",e="horizontal"){return["ltr","rtl"].includes(t)||(t="ltr"),["horizontal","vertical"].includes(e)||(e="horizontal"),{nextKey:jo(t,e),prevKey:Uo(t,e)}}function Wo(t){const e=J(null);function n(){if(!$r)return[];const a=document.getElementById(t.rootNodeId.current);return a?t.candidateSelector?Array.from(a.querySelectorAll(t.candidateSelector)):t.candidateAttr?Array.from(a.querySelectorAll(`[${t.candidateAttr}]:not([data-disabled])`)):[]:[]}function o(){const a=n();a.length&&a[0]?.focus()}function s(a,i,d=!1){const v=document.getElementById(t.rootNodeId.current);if(!v||!a)return;const u=n();if(!u.length)return;const c=u.indexOf(a),p=Go(v),{nextKey:h,prevKey:l}=Bo(p,t.orientation.current),g=t.loop.current,b={[h]:c+1,[l]:c-1,[Ir]:0,[Cr]:u.length-1};if(d){const F=h===yt?Wt:yt,I=l===$t?Vt:$t;b[F]=c+1,b[I]=c-1}let M=b[i.key];if(M===void 0)return;i.preventDefault(),M<0&&g?M=u.length-1:M===u.length&&g&&(M=0);const $=u[M];if($)return $.focus(),e.current=$.id,t.onCandidateFocus?.($),$}function f(a){const i=n(),d=e.current!==null;return a&&!d&&i[0]===a?(e.current=a.id,0):a?.id===e.current?0:-1}return{setCurrentTabStopId(a){e.current=a},getTabIndex:f,handleKeydown:s,focusFirstCandidate:o,currentTabStopId:e}}function Vo(t,e){var n=N(),o=C(n);Zn(o,()=>e.children,s=>{var f=N(),a=C(f);ve(a,()=>e.children??ce),_(s,f)}),_(t,n)}function Xo(t,e){he(e,!0);let n=H(e,"to",3,"body");const o=sn();let s=m(f);function f(){if(!$r||e.disabled)return null;let c=null;return typeof n()=="string"?c=document.querySelector(n()):(n()instanceof HTMLElement||n()instanceof DocumentFragment)&&(c=n()),c}let a;function i(){a&&(vn(a),a=null)}Ze([()=>r(s),()=>e.disabled],([c,p])=>{if(!c||p){i();return}return a=fn(Vo,{target:c,props:{children:e.children},context:o}),()=>{i()}});var d=N(),v=C(d);{var u=c=>{var p=N(),h=C(p);ve(h,()=>e.children??ce),_(c,p)};G(v,c=>{e.disabled&&c(u)})}_(t,d),ge()}function wl(t,e,n=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===t.length-1?n?t[0]:void 0:t[e+1]}function yl(t,e,n=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===0?n?t[t.length-1]:void 0:t[e-1]}function xl(t,e,n,o=!0){if(t.length===0||e<0||e>=t.length)return;let s=e+n;return o?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Ml(t,e,n,o=!0){if(t.length===0||e<0||e>=t.length)return;let s=e-n;return o?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Hr(t,e,n){const o=e.toLowerCase();if(o.endsWith(" ")){const c=o.slice(0,-1);if(t.filter(g=>g.toLowerCase().startsWith(c)).length<=1)return Hr(t,c,n);const h=n?.toLowerCase();if(h&&h.startsWith(c)&&h.charAt(c.length)===" "&&e.trim()===c)return n;const l=t.filter(g=>g.toLowerCase().startsWith(o));if(l.length>0){const g=n?t.indexOf(n):-1;return pr(l,Math.max(g,0)).find($=>$!==n)||n}}const f=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,a=f.toLowerCase(),i=n?t.indexOf(n):-1;let d=pr(t,Math.max(i,0));f.length===1&&(d=d.filter(c=>c!==n));const u=d.find(c=>c?.toLowerCase().startsWith(a));return u!==n?u:void 0}function pr(t,e){return t.map((n,o)=>t[(e+o)%t.length])}function Kr(t,e=1e4,n=He){let o=null,s=re(Ut(t));function f(){return window.setTimeout(()=>{O(s,t,!0),n(t)},e)}return $e(()=>()=>{o&&clearTimeout(o)}),J.with(()=>r(s),a=>{O(s,a,!0),n(a),o&&clearTimeout(o),o=f()})}function Yo(t){const e=Kr("",1e3),n=(a=>a.focus()),o=(()=>document.activeElement);function s(a,i){if(!i.length)return;e.current=e.current+a;const d=o(),v=i.find(h=>h===d)?.textContent?.trim()??"",u=i.map(h=>h.textContent?.trim()??""),c=Hr(u,e.current,v),p=i.find(h=>h.textContent?.trim()===c);return p&&n(p),p}function f(){e.current=""}return{search:e,handleTypeaheadSearch:s,resetTypeahead:f}}function hr(t,e){he(e,!0);let n=H(e,"mounted",15,!1),o=H(e,"onMountedChange",3,He);qo(()=>(n(!0),o()(!0),()=>{n(!1),o()(!1)})),ge()}const Jo=[Or,Xt],Qo=[yt,Dn,Ir],qr=[$t,Fn,Cr],Zo=[...Qo,...qr];function es(t){return t==="indeterminate"}function ts(t){return es(t)?"indeterminate":t?"checked":"unchecked"}function gr(t){return t.pointerType==="mouse"}function rs(t){const e=m(()=>t.enabled()),n=Kr(!1,t.transitTimeout??300,a=>{r(e)&&t.setIsPointerInTransit?.(a)});let o=re(null);function s(){O(o,null),n.current=!1}function f(a,i){const d=a.currentTarget;if(!dt(d))return;const v={x:a.clientX,y:a.clientY},u=ns(v,d.getBoundingClientRect()),c=os(v,u),p=ss(i.getBoundingClientRect()),h=is([...c,...p]);O(o,h,!0),n.current=!0}return Ze([t.triggerNode,t.contentNode,t.enabled],([a,i,d])=>{if(!a||!i||!d)return;const v=c=>{f(c,i)},u=c=>{f(c,a)};return Ar(ct(a,"pointerleave",v),ct(i,"pointerleave",u))}),Ze(()=>r(o),()=>ct(document,"pointermove",i=>{if(!r(o))return;const d=i.target;if(!qt(d))return;const v={x:i.clientX,y:i.clientY},u=t.triggerNode()?.contains(d)||t.contentNode()?.contains(d),c=!as(v,r(o));u?s():c&&(s(),t.onPointerExit())})),{isPointerInTransit:n}}function ns(t,e){const n=Math.abs(e.top-t.y),o=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),f=Math.abs(e.left-t.x);switch(Math.min(n,o,s,f)){case f:return"left";case s:return"right";case n:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function os(t,e,n=5){const o=n*1.5;switch(e){case"top":return[{x:t.x-n,y:t.y+n},{x:t.x,y:t.y-o},{x:t.x+n,y:t.y+n}];case"bottom":return[{x:t.x-n,y:t.y-n},{x:t.x,y:t.y+o},{x:t.x+n,y:t.y-n}];case"left":return[{x:t.x+n,y:t.y-n},{x:t.x-o,y:t.y},{x:t.x+n,y:t.y+n}];case"right":return[{x:t.x-n,y:t.y-n},{x:t.x+o,y:t.y},{x:t.x-n,y:t.y+n}]}}function ss(t){const{top:e,right:n,bottom:o,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:o},{x:s,y:o}]}function as(t,e){const{x:n,y:o}=t;let s=!1;for(let f=0,a=e.length-1;f<e.length;a=f++){const i=e[f].x,d=e[f].y,v=e[a].x,u=e[a].y;d>o!=u>o&&n<(v-i)*(o-d)/(u-d)+i&&(s=!s)}return s}function is(t){const e=t.slice();return e.sort((n,o)=>n.x<o.x?-1:n.x>o.x?1:n.y<o.y?-1:n.y>o.y?1:0),ls(e)}function ls(t){if(t.length<=1)return t.slice();const e=[];for(let o=0;o<t.length;o++){const s=t[o];for(;e.length>=2;){const f=e[e.length-1],a=e[e.length-2];if((f.x-a.x)*(s.y-a.y)>=(f.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let o=t.length-1;o>=0;o--){const s=t[o];for(;n.length>=2;){const f=n[n.length-1],a=n[n.length-2];if((f.x-a.x)*(s.y-a.y)>=(f.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}function _t(){return{getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"}}function cs(t,e){if(!Yt(t,_t()))return us(t,e);const n=Rn(Tr(t).body,_t());e==="prev"&&n.reverse();const o=n.indexOf(t);return o===-1?document.body:n.slice(o+1)[0]}function us(t,e){if(!Nn(t,_t()))return document.body;const n=Ln(Tr(t).body,_t());e==="prev"&&n.reverse();const o=n.indexOf(t);return o===-1?document.body:n.slice(o+1).find(f=>Yt(f,_t()))??document.body}const Gr=new ft("Menu.Root"),Zt=new ft("Menu.Root | Menu.Sub"),At=new ft("Menu.Content"),jr=new ft("Menu.Group | Menu.RadioGroup"),ds=new ft("Menu.RadioGroup"),er=new ft("Menu.CheckboxGroup"),fs=new Kn("bitsmenuopen",{bubbles:!1,cancelable:!0});class vs{opts;isUsingKeyboard=new Je;#e=re(!1);get ignoreCloseAutoFocus(){return r(this.#e)}set ignoreCloseAutoFocus(e){O(this.#e,e,!0)}#t=re(!1);get isPointerInTransit(){return r(this.#t)}set isPointerInTransit(e){O(this.#t,e,!0)}constructor(e){this.opts=e}getAttr(e){return`data-${this.opts.variant.current}-${e}`}}class ps{opts;root;parentMenu;contentId=J.with(()=>"");#e=re(null);get contentNode(){return r(this.#e)}set contentNode(e){O(this.#e,e,!0)}#t=re(null);get triggerNode(){return r(this.#t)}set triggerNode(e){O(this.#t,e,!0)}constructor(e,n,o){this.opts=e,this.root=n,this.parentMenu=o,o&&Ze(()=>o.opts.open.current,()=>{o.opts.open.current||(this.opts.open.current=!1)})}toggleOpen(){this.opts.open.current=!this.opts.open.current}onOpen(){this.opts.open.current=!0}onClose(){this.opts.open.current=!1}}class hs{opts;parentMenu;#e=re("");get search(){return r(this.#e)}set search(e){O(this.#e,e,!0)}#t=0;#r;rovingFocusGroup;#o=re(!1);get mounted(){return r(this.#o)}set mounted(e){O(this.#o,e,!0)}#s;constructor(e,n){this.opts=e,this.parentMenu=n,n.contentId=e.id,this.#s=e.isSub??!1,this.onkeydown=this.onkeydown.bind(this),this.onblur=this.onblur.bind(this),this.onfocus=this.onfocus.bind(this),this.handleInteractOutside=this.handleInteractOutside.bind(this),vt({...e,deps:()=>this.parentMenu.opts.open.current,onRefChange:o=>{this.parentMenu.contentNode!==o&&(this.parentMenu.contentNode=o)}}),rs({contentNode:()=>this.parentMenu.contentNode,triggerNode:()=>this.parentMenu.triggerNode,enabled:()=>this.parentMenu.opts.open.current&&!!this.parentMenu.triggerNode?.hasAttribute(this.parentMenu.root.getAttr("sub-trigger")),onPointerExit:()=>{this.parentMenu.opts.open.current=!1},setIsPointerInTransit:o=>{this.parentMenu.root.isPointerInTransit=o}}),this.#r=Yo().handleTypeaheadSearch,this.rovingFocusGroup=Wo({rootNodeId:this.parentMenu.contentId,candidateAttr:this.parentMenu.root.getAttr("item"),loop:this.opts.loop,orientation:J.with(()=>"vertical")}),Ze(()=>this.parentMenu.contentNode,o=>{if(!o)return;const s=()=>{rt(()=>{this.parentMenu.root.isUsingKeyboard.current&&this.rovingFocusGroup.focusFirstCandidate()})};return fs.listen(o,s)}),$e(()=>{this.parentMenu.opts.open.current||window.clearTimeout(this.#t)})}#l(){const e=this.parentMenu.contentNode;return e?Array.from(e.querySelectorAll(`[${this.parentMenu.root.getAttr("item")}]:not([data-disabled])`)):[]}#n(){return this.parentMenu.root.isPointerInTransit}onCloseAutoFocus=e=>{this.opts.onCloseAutoFocus.current(e),!(e.defaultPrevented||this.#s)&&this.parentMenu.triggerNode&&Yt(this.parentMenu.triggerNode)&&this.parentMenu.triggerNode.focus()};handleTabKeyDown(e){let n=this.parentMenu;for(;n.parentMenu!==null;)n=n.parentMenu;if(!n.triggerNode)return;e.preventDefault();const o=cs(n.triggerNode,e.shiftKey?"prev":"next");o?(this.parentMenu.root.ignoreCloseAutoFocus=!0,n.onClose(),rt(()=>{o.focus(),rt(()=>{this.parentMenu.root.ignoreCloseAutoFocus=!1})})):document.body.focus()}onkeydown(e){if(e.defaultPrevented)return;if(e.key===qn){this.handleTabKeyDown(e);return}const n=e.target,o=e.currentTarget;if(!dt(n)||!dt(o))return;const s=n.closest(`[${this.parentMenu.root.getAttr("content")}]`)?.id===this.parentMenu.contentId.current,f=e.ctrlKey||e.altKey||e.metaKey,a=e.key.length===1;if(this.rovingFocusGroup.handleKeydown(n,e)||e.code==="Space")return;const d=this.#l();s&&!f&&a&&this.#r(e.key,d),e.target?.id===this.parentMenu.contentId.current&&Zo.includes(e.key)&&(e.preventDefault(),qr.includes(e.key)&&d.reverse(),Gn(d))}onblur(e){qt(e.currentTarget)&&qt(e.target)&&(e.currentTarget.contains?.(e.target)||(window.clearTimeout(this.#t),this.search=""))}onfocus(e){this.parentMenu.root.isUsingKeyboard.current&&rt(()=>this.rovingFocusGroup.focusFirstCandidate())}onItemEnter(){return this.#n()}onItemLeave(e){if(e.currentTarget.hasAttribute(this.parentMenu.root.getAttr("sub-trigger"))||this.#n()||this.parentMenu.root.isUsingKeyboard.current)return;this.parentMenu.contentNode?.focus(),this.rovingFocusGroup.setCurrentTabStopId("")}onTriggerLeave(){return!!this.#n()}onOpenAutoFocus=e=>{if(e.defaultPrevented)return;e.preventDefault(),this.parentMenu.contentNode?.focus()};handleInteractOutside(e){if(!jn(e.target))return;const n=this.parentMenu.triggerNode?.id;if(e.target.id===n){e.preventDefault();return}e.target.closest(`#${n}`)&&e.preventDefault()}#a=m(()=>({open:this.parentMenu.opts.open.current}));get snippetProps(){return r(this.#a)}set snippetProps(e){O(this.#a,e)}#i=m(()=>({id:this.opts.id.current,role:"menu","aria-orientation":Un("vertical"),[this.parentMenu.root.getAttr("content")]:"","data-state":Er(this.parentMenu.opts.open.current),onkeydown:this.onkeydown,onblur:this.onblur,onfocus:this.onfocus,dir:this.parentMenu.root.opts.dir.current,style:{pointerEvents:"auto"}}));get props(){return r(this.#i)}set props(e){O(this.#i,e)}popperProps={onCloseAutoFocus:e=>this.onCloseAutoFocus(e)}}class Ur{opts;content;#e=re(!1);constructor(e,n){this.opts=e,this.content=n,this.onpointermove=this.onpointermove.bind(this),this.onpointerleave=this.onpointerleave.bind(this),this.onfocus=this.onfocus.bind(this),this.onblur=this.onblur.bind(this),vt({...e,deps:()=>this.content.mounted})}onpointermove(e){if(!e.defaultPrevented&&gr(e))if(this.opts.disabled.current)this.content.onItemLeave(e);else{if(this.content.onItemEnter())return;const o=e.currentTarget;if(!dt(o))return;o.focus()}}onpointerleave(e){e.defaultPrevented||gr(e)&&this.content.onItemLeave(e)}onfocus(e){rt(()=>{e.defaultPrevented||this.opts.disabled.current||O(this.#e,!0)})}onblur(e){rt(()=>{e.defaultPrevented||O(this.#e,!1)})}#t=m(()=>({id:this.opts.id.current,tabindex:-1,role:"menuitem","aria-disabled":Bn(this.opts.disabled.current),"data-disabled":Dr(this.opts.disabled.current),"data-highlighted":r(this.#e)?"":void 0,[this.content.parentMenu.root.getAttr("item")]:"",onpointermove:this.onpointermove,onpointerleave:this.onpointerleave,onfocus:this.onfocus,onblur:this.onblur}));get props(){return r(this.#t)}set props(e){O(this.#t,e)}}class Br{opts;item;#e=!1;root;constructor(e,n){this.opts=e,this.item=n,this.root=n.content.parentMenu.root,this.onkeydown=this.onkeydown.bind(this),this.onclick=this.onclick.bind(this),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this)}#t(){if(this.item.opts.disabled.current)return;const e=new CustomEvent("menuitemselect",{bubbles:!0,cancelable:!0});this.opts.onSelect.current(e),rt(()=>{if(e.defaultPrevented){this.item.content.parentMenu.root.isUsingKeyboard.current=!1;return}this.opts.closeOnSelect.current&&this.item.content.parentMenu.root.opts.onClose()})}onkeydown(e){const n=this.item.content.search!=="";if(!(this.item.opts.disabled.current||n&&e.key===Xt)&&Jo.includes(e.key)){if(!dt(e.currentTarget))return;e.currentTarget.click(),e.preventDefault()}}onclick(e){this.item.opts.disabled.current||this.#t()}onpointerup(e){if(!e.defaultPrevented&&!this.#e){if(!dt(e.currentTarget))return;e.currentTarget?.click()}}onpointerdown(e){this.#e=!0}#r=m(()=>Ge(this.item.props,{onclick:this.onclick,onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return r(this.#r)}set props(e){O(this.#r,e)}}class gs{opts;item;group;constructor(e,n,o=null){this.opts=e,this.item=n,this.group=o,this.group&&(Ze(()=>this.group.opts.value.current,s=>{this.opts.checked.current=s.includes(this.opts.value.current)}),Ze(()=>this.opts.checked.current,s=>{s?this.group.addValue(this.opts.value.current):this.group.removeValue(this.opts.value.current)}))}toggleChecked(){this.opts.indeterminate.current?(this.opts.indeterminate.current=!1,this.opts.checked.current=!0):this.opts.checked.current=!this.opts.checked.current}#e=m(()=>({checked:this.opts.checked.current,indeterminate:this.opts.indeterminate.current}));get snippetProps(){return r(this.#e)}set snippetProps(e){O(this.#e,e)}#t=m(()=>({...this.item.props,role:"menuitemcheckbox","aria-checked":Wn(this.opts.checked.current,this.opts.indeterminate.current),"data-state":ts(this.opts.checked.current),[this.item.root.getAttr("checkbox-item")]:""}));get props(){return r(this.#t)}set props(e){O(this.#t,e)}}class ms{opts;root;#e=re(void 0);get groupHeadingId(){return r(this.#e)}set groupHeadingId(e){O(this.#e,e,!0)}constructor(e,n){this.opts=e,this.root=n,vt(this.opts)}#t=m(()=>({id:this.opts.id.current,role:"group","aria-labelledby":this.groupHeadingId,[this.root.getAttr("group")]:""}));get props(){return r(this.#t)}set props(e){O(this.#t,e)}}class Rt{opts;group;constructor(e,n){this.opts=e,this.group=n,vt({...e,onRefChange:o=>{this.group.groupHeadingId=o?.id}})}#e=m(()=>({id:this.opts.id.current,role:"group",[this.group.root.getAttr("group-heading")]:""}));get props(){return r(this.#e)}set props(e){O(this.#e,e)}}class _s{opts;parentMenu;constructor(e,n){this.opts=e,this.parentMenu=n,this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onkeydown=this.onkeydown.bind(this),vt({...e,onRefChange:o=>{this.parentMenu.triggerNode=o}})}onpointerdown(e){if(!this.opts.disabled.current){if(e.pointerType==="touch")return e.preventDefault();e.button===0&&e.ctrlKey===!1&&(this.parentMenu.toggleOpen(),this.parentMenu.opts.open.current||e.preventDefault())}}onpointerup(e){this.opts.disabled.current||e.pointerType==="touch"&&(e.preventDefault(),this.parentMenu.toggleOpen())}onkeydown(e){if(!this.opts.disabled.current){if(e.key===Xt||e.key===Or){this.parentMenu.toggleOpen(),e.preventDefault();return}e.key===yt&&(this.parentMenu.onOpen(),e.preventDefault())}}#e=m(()=>{if(this.parentMenu.opts.open.current&&this.parentMenu.contentId.current)return this.parentMenu.contentId.current});#t=m(()=>({id:this.opts.id.current,disabled:this.opts.disabled.current,"aria-haspopup":"menu","aria-expanded":Hn(this.parentMenu.opts.open.current),"aria-controls":r(this.#e),"data-disabled":Dr(this.opts.disabled.current),"data-state":Er(this.parentMenu.opts.open.current),[this.parentMenu.root.getAttr("trigger")]:"",onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return r(this.#t)}set props(e){O(this.#t,e)}}class bs{opts;content;#e=re(null);get groupHeadingId(){return r(this.#e)}set groupHeadingId(e){O(this.#e,e,!0)}root;constructor(e,n){this.opts=e,this.content=n,this.root=n.parentMenu.root,vt(e)}addValue(e){if(e&&!this.opts.value.current.includes(e)){const n=[...Qe(this.opts.value.current),e];this.opts.value.current=n,this.opts.onValueChange.current(n)}}removeValue(e){if(!e||this.opts.value.current.indexOf(e)===-1)return;const o=this.opts.value.current.filter(s=>s!==e);this.opts.value.current=o,this.opts.onValueChange.current(o)}#t=m(()=>({id:this.opts.id.current,[this.root.getAttr("checkbox-group")]:"",role:"group","aria-labelledby":this.groupHeadingId}));get props(){return r(this.#t)}set props(e){O(this.#t,e)}}function ws(t){const e=new vs(t);return zn.set({get ignoreCloseAutoFocus(){return e.ignoreCloseAutoFocus}}),Gr.set(e)}function ys(t,e){return Zt.set(new ps(e,t,null))}function xs(t){return new _s(t,Zt.get())}function Ms(t){return At.set(new hs(t,Zt.get()))}function ks(t){const e=new Ur(t,At.get());return new Br(t,e)}function Ps(t,e){const n=new Br(t,new Ur(t,At.get()));return new gs(t,n,e)}function Ss(t){return jr.set(new ms(t,Gr.get()))}function Cs(t){const e=er.getOr(null);if(e)return new Rt(t,e);const n=ds.getOr(null);return n?new Rt(t,n):new Rt(t,jr.get())}function $s(t){return er.set(new bs(t,At.get()))}var Is=R("<div><!></div>");function Os(t,e){he(e,!0);let n=H(e,"ref",15,null),o=H(e,"id",19,st),s=H(e,"disabled",3,!1),f=H(e,"onSelect",3,He),a=H(e,"closeOnSelect",3,!0),i=Ie(e,["$$slots","$$events","$$legacy","child","children","ref","id","disabled","onSelect","closeOnSelect"]);const d=ks({id:J.with(()=>o()),disabled:J.with(()=>s()),onSelect:J.with(()=>f()),ref:J.with(()=>n(),l=>n(l)),closeOnSelect:J.with(()=>a())}),v=m(()=>Ge(i,d.props));var u=N(),c=C(u);{var p=l=>{var g=N(),b=C(g);ve(b,()=>e.child,()=>({props:r(v)})),_(l,g)},h=l=>{var g=Is();we(g,()=>({...r(v)}));var b=y(g);ve(b,()=>e.children??ce),w(g),_(l,g)};G(c,l=>{e.child?l(p):l(h,!1)})}_(t,u),ge()}var As=R("<div><!></div>");function Ts(t,e){he(e,!0);let n=H(e,"ref",15,null),o=H(e,"id",19,st),s=Ie(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const f=Ss({id:J.with(()=>o()),ref:J.with(()=>n(),c=>n(c))}),a=m(()=>Ge(s,f.props));var i=N(),d=C(i);{var v=c=>{var p=N(),h=C(p);ve(h,()=>e.child,()=>({props:r(a)})),_(c,p)},u=c=>{var p=As();we(p,()=>({...r(a)}));var h=y(p);ve(h,()=>e.children??ce),w(p),_(c,p)};G(d,c=>{e.child?c(v):c(u,!1)})}_(t,i),ge()}var Es=R("<div><!></div>");function mr(t,e){he(e,!0);let n=H(e,"ref",15,null),o=H(e,"id",19,st),s=Ie(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const f=Cs({id:J.with(()=>o()),ref:J.with(()=>n(),c=>n(c))}),a=m(()=>Ge(s,f.props));var i=N(),d=C(i);{var v=c=>{var p=N(),h=C(p);ve(h,()=>e.child,()=>({props:r(a)})),_(c,p)},u=c=>{var p=Es();we(p,()=>({...r(a)}));var h=y(p);ve(h,()=>e.children??ce),w(p),_(c,p)};G(d,c=>{e.child?c(v):c(u,!1)})}_(t,i),ge()}var Ds=R("<div><!></div>");function Fs(t,e){he(e,!0);let n=H(e,"ref",15,null),o=H(e,"checked",15,!1),s=H(e,"id",19,st),f=H(e,"onCheckedChange",3,He),a=H(e,"disabled",3,!1),i=H(e,"onSelect",3,He),d=H(e,"closeOnSelect",3,!0),v=H(e,"indeterminate",15,!1),u=H(e,"onIndeterminateChange",3,He),c=H(e,"value",3,""),p=Ie(e,["$$slots","$$events","$$legacy","child","children","ref","checked","id","onCheckedChange","disabled","onSelect","closeOnSelect","indeterminate","onIndeterminateChange","value"]);const h=er.getOr(null);h&&c()&&(h.opts.value.current.includes(c())?o(!0):o(!1)),Ze.pre(()=>c(),()=>{h&&c()&&(h.opts.value.current.includes(c())?o(!0):o(!1))});const l=Ps({checked:J.with(()=>o(),S=>{o(S),f()(S)}),id:J.with(()=>s()),disabled:J.with(()=>a()),onSelect:J.with(()=>g),ref:J.with(()=>n(),S=>n(S)),closeOnSelect:J.with(()=>d()),indeterminate:J.with(()=>v(),S=>{v(S),u()(S)}),value:J.with(()=>c())},h);function g(S){i()(S),!S.defaultPrevented&&l.toggleChecked()}const b=m(()=>Ge(p,l.props));var M=N(),$=C(M);{var F=S=>{var x=N(),k=C(x);{let T=m(()=>({props:r(b),...l.snippetProps}));ve(k,()=>e.child,()=>r(T))}_(S,x)},I=S=>{var x=Ds();we(x,()=>({...r(b)}));var k=y(x);ve(k,()=>e.children??ce,()=>l.snippetProps),w(x),_(S,x)};G($,S=>{e.child?S(F):S(I,!1)})}_(t,M),ge()}var Rs=R("<div><!></div>");function Ns(t,e){he(e,!0);let n=H(e,"id",19,st),o=H(e,"ref",15,null),s=H(e,"value",31,()=>Ut([])),f=H(e,"onValueChange",3,He),a=Ie(e,["$$slots","$$events","$$legacy","id","children","child","ref","value","onValueChange"]);const i=$s({value:J.with(()=>Qe(s()),h=>{s(Qe(h)),f()(h)}),onValueChange:J.with(()=>f()),ref:J.with(()=>o(),h=>o(h)),id:J.with(()=>n())}),d=m(()=>Ge(a,i.props));var v=N(),u=C(v);{var c=h=>{var l=N(),g=C(l);ve(g,()=>e.child,()=>({props:r(d)})),_(h,l)},p=h=>{var l=Rs();we(l,()=>({...r(d)}));var g=y(l);ve(g,()=>e.children??ce),w(l),_(h,l)};G(u,h=>{e.child?h(c):h(p,!1)})}_(t,v),ge()}function Ls(t,e){he(e,!0);let n=H(e,"open",15,!1),o=H(e,"dir",3,"ltr"),s=H(e,"onOpenChange",3,He),f=H(e,"_internal_variant",3,"dropdown-menu");const a=ws({variant:J.with(()=>f()),dir:J.with(()=>o()),onClose:()=>{n(!1),s()(!1)}});ys(a,{open:J.with(()=>n(),i=>{n(i),s()(i)})}),Vn(t,{children:(i,d)=>{var v=N(),u=C(v);ve(u,()=>e.children??ce),_(i,v)},$$slots:{default:!0}}),ge()}var zs=R("<div><div><!></div></div>"),Hs=R("<!> <!>",1),Ks=R("<div><div><!></div></div>"),qs=R("<!> <!>",1);function Gs(t,e){he(e,!0);let n=H(e,"id",19,st),o=H(e,"ref",15,null),s=H(e,"loop",3,!0),f=H(e,"onInteractOutside",3,He),a=H(e,"onEscapeKeydown",3,He),i=H(e,"onCloseAutoFocus",3,He),d=H(e,"forceMount",3,!1),v=Ie(e,["$$slots","$$events","$$legacy","id","child","children","ref","loop","onInteractOutside","onEscapeKeydown","onCloseAutoFocus","forceMount"]);const u=Ms({id:J.with(()=>n()),loop:J.with(()=>s()),ref:J.with(()=>o(),$=>o($)),onCloseAutoFocus:J.with(()=>i())}),c=m(()=>Ge(v,u.props));function p($){u.handleInteractOutside($),!$.defaultPrevented&&(f()($),!$.defaultPrevented&&u.parentMenu.onClose())}function h($){a()($),!$.defaultPrevented&&u.parentMenu.onClose()}var l=N(),g=C(l);{var b=$=>{Xn($,ut(()=>r(c),()=>u.popperProps,{get enabled(){return u.parentMenu.opts.open.current},onInteractOutside:p,onEscapeKeydown:h,trapFocus:!0,get loop(){return s()},forceMount:!0,get id(){return n()},popper:(I,S)=>{let x=()=>S?.().props,k=()=>S?.().wrapperProps;const T=m(()=>Ge(x(),{style:ur("dropdown-menu")}));var D=Hs(),L=C(D);{var U=z=>{var V=N(),ee=C(V);{let se=m(()=>({props:r(T),wrapperProps:k(),...u.snippetProps}));ve(ee,()=>e.child,()=>r(se))}_(z,V)},X=z=>{var V=zs();we(V,()=>({...k()}));var ee=y(V);we(ee,()=>({...r(T)}));var se=y(ee);ve(se,()=>e.children??ce),w(ee),w(V),_(z,V)};G(L,z=>{e.child?z(U):z(X,!1)})}var q=P(L,2);hr(q,{get mounted(){return u.mounted},set mounted(z){u.mounted=z}}),_(I,D)},$$slots:{popper:!0}}))},M=$=>{var F=N(),I=C(F);{var S=x=>{Yn(x,ut(()=>r(c),()=>u.popperProps,{get present(){return u.parentMenu.opts.open.current},onInteractOutside:p,onEscapeKeydown:h,trapFocus:!0,get loop(){return s()},forceMount:!1,get id(){return n()},popper:(T,D)=>{let L=()=>D?.().props,U=()=>D?.().wrapperProps;const X=m(()=>Ge(L(),{style:ur("dropdown-menu")}));var q=qs(),z=C(q);{var V=ae=>{var ue=N(),de=C(ue);{let pe=m(()=>({props:r(X),wrapperProps:U(),...u.snippetProps}));ve(de,()=>e.child,()=>r(pe))}_(ae,ue)},ee=ae=>{var ue=Ks();we(ue,()=>({...U()}));var de=y(ue);we(de,()=>({...r(X)}));var pe=y(de);ve(pe,()=>e.children??ce),w(de),w(ue),_(ae,ue)};G(z,ae=>{e.child?ae(V):ae(ee,!1)})}var se=P(z,2);hr(se,{get mounted(){return u.mounted},set mounted(ae){u.mounted=ae}}),_(T,q)},$$slots:{popper:!0}}))};G(I,x=>{d()||x(S)},!0)}_($,F)};G(g,$=>{d()?$(b):$(M,!1)})}_(t,l),ge()}var js=R("<button><!></button>");function Us(t,e){he(e,!0);let n=H(e,"id",19,st),o=H(e,"ref",15,null),s=H(e,"disabled",3,!1),f=H(e,"type",3,"button"),a=Ie(e,["$$slots","$$events","$$legacy","id","ref","child","children","disabled","type"]);const i=xs({id:J.with(()=>n()),disabled:J.with(()=>s()??!1),ref:J.with(()=>o(),v=>o(v))}),d=m(()=>Ge(a,i.props,{type:f()}));Jn(t,{get id(){return n()},children:(v,u)=>{var c=N(),p=C(c);{var h=g=>{var b=N(),M=C(b);ve(M,()=>e.child,()=>({props:r(d)})),_(g,b)},l=g=>{var b=js();we(b,()=>({...r(d)}));var M=y(b);ve(M,()=>e.children??ce),w(b),_(g,b)};G(p,g=>{e.child?g(h):g(l,!1)})}_(v,c)},$$slots:{default:!0}}),ge()}let gt=re(!1);class Je{static _refs=0;static _cleanup;constructor(){$e(()=>(Je._refs===0&&(Je._cleanup=an(()=>{const e=[],n=s=>{O(gt,!1)},o=s=>{O(gt,!0)};return e.push(ct(document,"pointerdown",n,{capture:!0}),ct(document,"pointermove",n,{capture:!0}),ct(document,"keydown",o,{capture:!0})),Ar(...e)})),Je._refs++,()=>{Je._refs--,Je._refs===0&&(O(gt,!1),Je._cleanup?.())}))}get current(){return r(gt)}set current(e){O(gt,e,!0)}}var Bs=R("<!> <!>",1),Ws=R("<!> <!>",1),Vs=R("<!> <!>",1),Xs=R("<!> <!>",1);function Wr(t,e){he(e,!0);const n=H(e,"selectableItems",19,()=>[]),o=H(e,"help",3,""),s=Ie(e,["$$slots","$$events","$$legacy","items","item","selectableItems","trigger","testid","help"]),f=m(()=>({trigger:e.testid?`${e.testid}-open`:void 0,content:e.testid?`${e.testid}-options`:void 0}));let a=re(!1);var i=N(),d=C(i);Ne(d,()=>Ls,(v,u)=>{u(v,{get open(){return r(a)},children:(c,p)=>{var h=Xs(),l=C(h);{const b=(M,$)=>{let F=()=>$?.().props;var I=N(),S=C(I);{let x=m(()=>({...F(),onclick:()=>{O(a,!r(a))}}));ve(S,()=>e.trigger,()=>r(x))}_(M,I)};Ne(l,()=>Us,(M,$)=>{$(M,ut(()=>s,{get"data-testid"(){return r(f).trigger},child:b,$$slots:{child:!0}}))})}var g=P(l,2);Ne(g,()=>Xo,(b,M)=>{M(b,{children:($,F)=>{var I=N(),S=C(I);Ne(S,()=>Gs,(x,k)=>{k(x,{get"data-testid"(){return r(f).content},children:(T,D)=>{var L=Vs(),U=C(L);{let q=m(()=>n().filter(z=>z.selected).map(z=>z.key.toString()));Ne(U,()=>Ns,(z,V)=>{V(z,{get value(){return r(q)},children:(ee,se)=>{var ae=Bs(),ue=C(ae);{var de=Q=>{var Y=N(),_e=C(Y);Ne(_e,()=>mr,(ie,le)=>{le(ie,{children:(xe,ke)=>{Ee();var Pe=fe();K(()=>E(Pe,o())),_(xe,Pe)},$$slots:{default:!0}})}),_(Q,Y)};G(ue,Q=>{o()&&Q(de)})}var pe=P(ue,2);nt(pe,17,n,Q=>Q.label,(Q,Y)=>{var _e=N(),ie=C(_e);{let le=m(()=>r(Y).key.toString());Ne(ie,()=>Fs,(xe,ke)=>{ke(xe,{get checked(){return r(Y).selected},get onSelect(){return r(Y).onclick},get value(){return r(le)},get textValue(){return r(Y).label},get"aria-label"(){return r(Y).label},children:(Pe,Ke)=>{var qe=N(),Re=C(qe);{var Se=Te=>{var De=N(),j=C(De);ve(j,()=>e.item,()=>r(Y)),_(Te,De)},Me=Te=>{var De=fe();K(()=>E(De,r(Y).label)),_(Te,De)};G(Re,Te=>{e.item?Te(Se):Te(Me,!1)})}_(Pe,qe)},$$slots:{default:!0}})})}_(Q,_e)}),_(ee,ae)},$$slots:{default:!0}})})}var X=P(U,2);Ne(X,()=>Ts,(q,z)=>{z(q,{children:(V,ee)=>{var se=Ws(),ae=C(se);{var ue=pe=>{var Q=N(),Y=C(Q);Ne(Y,()=>mr,(_e,ie)=>{ie(_e,{children:(le,xe)=>{Ee();var ke=fe();K(()=>E(ke,o())),_(le,ke)},$$slots:{default:!0}})}),_(pe,Q)};G(ae,pe=>{o()&&!n().length&&pe(ue)})}var de=P(ae,2);nt(de,17,()=>e.items,pe=>pe.label,(pe,Q)=>{var Y=N(),_e=C(Y);Ne(_e,()=>Os,(ie,le)=>{le(ie,{get textValue(){return r(Q).label},get onSelect(){return r(Q).onclick},get"aria-label"(){return r(Q).label},children:(xe,ke)=>{var Pe=N(),Ke=C(Pe);{var qe=Se=>{var Me=N(),Te=C(Me);ve(Te,()=>e.item,()=>r(Q)),_(Se,Me)},Re=Se=>{var Me=fe();K(()=>E(Me,r(Q).label)),_(Se,Me)};G(Ke,Se=>{e.item?Se(qe):Se(Re,!1)})}_(xe,Pe)},$$slots:{default:!0}})}),_(pe,Y)}),_(V,se)},$$slots:{default:!0}})}),_(T,L)},$$slots:{default:!0}})}),_($,I)},$$slots:{default:!0}})}),_(c,h)},$$slots:{default:!0}})}),_(t,i),ge()}var Ys=R("<time><!></time>");function Js(t,e){he(e,!0);const n=H(e,"show",3,"absolute"),o=Ie(e,["$$slots","$$events","$$legacy","value","show"]),s=m(()=>typeof e.value=="string"?new Date(e.value):e.value),f=m(()=>ro(r(s),"PPpp")),a=m(()=>Io(r(s),{addSuffix:!0}));var i=Ys();we(i,c=>({...o,datetime:c}),[()=>r(s).toISOString()]);var d=y(i);{var v=c=>{var p=fe();K(()=>E(p,r(f))),_(c,p)},u=c=>{var p=N(),h=C(p);{var l=b=>{var M=fe();K(()=>E(M,r(a))),_(b,M)},g=b=>{var M=fe();K(()=>E(M,`${r(f)??""} (${r(a)??""})`)),_(b,M)};G(h,b=>{n()=="relative"?b(l):b(g,!1)},!0)}_(c,p)};G(d,c=>{n()==="absolute"?c(v):c(u,!1)})}w(i),_(t,i),ge()}var Qs=R('<a class="github-user svelte-yvr6h4"><img class="svelte-yvr6h4"/> <!></a>'),Zs=R("<!> <!> <!> <!> <!>",1),ea=R('<span class="build-date"> </span>'),ta=R(" <a> </a> <!>",1),ra=R('<li class="svelte-yvr6h4"><!></li>'),na=R('<!> <p class="svelte-yvr6h4"> </p> <ul><li class="svelte-yvr6h4"> <a> </a> <!></li> <!> <br/></ul> <p class="svelte-yvr6h4"> </p>',1),oa=R("<a><!></a>"),sa=R('<p class="svelte-yvr6h4"><!></p>');function aa(t,e){he(e,!0);const n=(d,v=ce)=>{var u=Qs(),c=y(u),p=P(c,2);tt(p,()=>fetch(v().url).then(h=>h.json()),h=>{var l=fe();K(()=>E(l,v().login)),_(h,l)},(h,l)=>{var g=m(()=>{var{name:$}=r(l);return{name:$}}),b=m(()=>r(g).name),M=fe();K(()=>E(M,r(b)||v().login)),_(h,M)},(h,l)=>{var g=fe();K(()=>E(g,v().login)),_(h,g)}),w(u),K(h=>{ye(u,"href",v().html_url),ye(u,"title",`@${v().login}`),ye(c,"src",v().avatar_url),ye(c,"alt",h)},[()=>r(o).t(41,[v().login])]),_(d,u)},o=m(()=>Ve(Xe("main"))),s="65f4744d020f83c6e31467a9ed0fd11ddb22dde6";let f=H(e,"open",15);function a(d){return`https://cigaleapp.github.io/cigale/${d}/pr-${Ue}`}async function i(d){return fetch(a(d),{method:"HEAD"}).then(v=>v.ok).catch(()=>!1)}{const d=(u,c)=>{let p=()=>c?.().close;const h=m(()=>I=>()=>{window.open(I),p()?.()});var l=Zs(),g=C(l);{let I=m(()=>r(o).t(169));Be(g,{get help(){return r(I)},onclick:()=>{xn(),window.location.reload()},children:(S,x)=>{Ee();var k=fe();K(T=>E(k,T),[()=>r(o).t(136)]),_(S,k)},$$slots:{default:!0}})}var b=P(g,2);{let I=m(()=>r(h)(`https://github.com/cigaleapp/cigale/pull/${Ue}`));Be(b,{get onclick(){return r(I)},children:(S,x)=>{Ee();var k=fe();K(T=>E(k,T),[()=>r(o).t(192)]),_(S,k)},$$slots:{default:!0}})}var M=P(b,2);tt(M,()=>i("_playwright"),null,(I,S)=>{var x=N(),k=C(x);{var T=D=>{{let L=m(()=>r(h)(a("_playwright")));Be(D,{get onclick(){return r(L)},children:(U,X)=>{Ee();var q=fe();K(z=>E(q,z),[()=>r(o).t(182)]),_(U,q)},$$slots:{default:!0}})}};G(k,D=>{r(S)&&D(T)})}_(I,x)});var $=P(M,2);tt($,()=>i("_vitest"),null,(I,S)=>{var x=N(),k=C(x);{var T=D=>{{let L=m(()=>r(h)(a("_vitest")));Be(D,{get onclick(){return r(L)},children:(U,X)=>{Ee();var q=fe();K(z=>E(q,z),[()=>r(o).t(183)]),_(U,q)},$$slots:{default:!0}})}};G(k,D=>{r(S)&&D(T)})}_(I,x)});var F=P($,2);tt(F,()=>i("_coverage"),null,(I,S)=>{var x=N(),k=C(x);{var T=D=>{{let L=m(()=>r(h)(a("_coverage")));Be(D,{get onclick(){return r(L)},children:(U,X)=>{Ee();var q=fe();K(z=>E(q,z),[()=>r(o).t(73)]),_(U,q)},$$slots:{default:!0}})}};G(k,D=>{r(S)&&D(T)})}_(I,x)}),_(u,l)};let v=m(()=>r(o).t(79,[Ue]));Ot(t,{key:"modal_preview_pr",get title(){return r(v)},get open(){return f()},set open(u){f(u)},footer:d,children:(u,c)=>{const p=m(()=>`https://github.com/cigaleapp/cigale/pull/${Ue}`);var h=N(),l=C(h);tt(l,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/pulls/${Ue}`).then(g=>g.json()),g=>{var b=sa();{const $=(F,I=ce)=>{var S=oa(),x=y(S);{let k=m(()=>[Ue]);Le(x,{get x(){return I()},n:!0,get a(){return r(k)}})}w(S),K(()=>ye(S,"href",r(p))),_(F,S)};var M=y(b);{let F=m(()=>[$]),I=m(()=>r(o).cx(78));Le(M,{get t(){return r(F)},get x(){return r(I)}})}w(b)}_(g,b)},(g,b)=>{var M=m(()=>{var{title:Q,user:Y,body:_e}=r(b);return{title:Q,user:Y,body:_e}}),$=m(()=>r(M).title),F=m(()=>r(M).user),I=m(()=>r(M).body);const S=m(()=>/(Closes|Fixes) #(\d+)/i.exec(r(I))?.[2]);var x=na(),k=C(x);{var T=Q=>{var Y=N(),_e=C(Y);tt(_e,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/commits/${s}`).then(ie=>ie.json()),ie=>{var le=ea(),xe=y(le,!0);w(le),K(ke=>E(xe,ke),[()=>r(o).t(59)]),_(ie,le)},(ie,le)=>{var xe=m(()=>{var{commit:{committer:{date:Pe}}}=r(le);return{date:Pe}}),ke=m(()=>r(xe).date);Js(ie,{get value(){return r(ke)},show:"both"})}),_(Q,Y)};G(k,Q=>{Q(T)})}var D=P(k,2),L=y(D,!0);w(D);var U=P(D,2),X=y(U),q=y(X),z=P(q),V=y(z);w(z);var ee=P(z),se=P(ee);n(se,()=>r(F)),w(X);var ae=P(X,2);{var ue=Q=>{var Y=ra(),_e=y(Y);tt(_e,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/issues/${r(S)}`).then(ie=>ie.json()),null,(ie,le)=>{var xe=m(()=>{var{title:te,number:oe,user:me,html_url:Fe}=r(le);return{title:te,number:oe,user:me,html_url:Fe}}),ke=m(()=>r(xe).title),Pe=m(()=>r(xe).number),Ke=m(()=>r(xe).user),qe=m(()=>r(xe).html_url),Re=ta(),Se=C(Re),Me=P(Se),Te=y(Me);w(Me);var De=P(Me),j=P(De);n(j,()=>r(Ke)),K((te,oe)=>{E(Se,`${te??""} `),ye(Me,"href",r(qe)),E(Te,`#${r(Pe)??""} ${r(ke)??""}`),E(De,` ${oe??""} `)},[()=>r(o).t(199),()=>r(o).t(196)]),_(ie,Re)}),w(Y),_(Q,Y)};G(ae,Q=>{r(S)&&Q(ue)})}Ee(2),w(U);var de=P(U,2),pe=y(de,!0);w(de),K((Q,Y,_e)=>{E(L,Q),E(q,`${Y??""} `),ye(z,"href",r(p)),E(V,`#${Ue} ${r($)??""}`),E(ee,` ${_e??""} `),E(pe,r(I))},[()=>r(o).t(52),()=>r(o).t(200),()=>r(o).t(196)]),_(g,x)},(g,b)=>{var M=fe();K(()=>E(M,`#${Ue}`)),_(g,M)}),_(u,h)},$$slots:{footer:!0,default:!0}})}ge()}var ia=R('<button role="radio" class="option svelte-13njdm8"> </button>'),la=R("<div></div>");function jt(t,e){he(e,!0);let n=H(e,"value",15),o=Ie(e,["$$slots","$$events","$$legacy","options","labels","value","customOption","clickable-custom-options","onchange"]);var s=la();we(s,()=>({class:"segmented-group",role:"radiogroup",...o}),void 0,void 0,"svelte-13njdm8"),nt(s,20,()=>e.options,f=>f,(f,a)=>{var i=N(),d=C(i);{var v=c=>{var p=ia();p.__click=()=>{n(a),e.onchange?.(a)};var h=y(p,!0);w(p),K(()=>{ye(p,"aria-checked",a===n()),E(h,e.labels?.[a]??a)}),_(c,p)},u=c=>{var p=N(),h=C(p);io(h,()=>e["clickable-custom-options"]?"button":"div",!1,(l,g)=>{var b=()=>{e["clickable-custom-options"]&&(n(a),e.onchange?.(a))};we(l,()=>({role:"radio","aria-checked":a===n(),class:"option",onclick:b}),void 0,void 0,"svelte-13njdm8");var M=N(),$=C(M);ve($,()=>e.customOption,()=>a),_(g,M)}),_(c,p)};G(d,c=>{!e.customOption||e.labels?.[a]?c(v):c(u,!1)})}_(f,i)}),w(s),_(t,s),ge()}Bt(["click"]);var ca=R('<!> <section class="progress svelte-1h3fgf1"><!></section> <!>',1),ua=R('<div class="numeric svelte-1h3fgf1"><!> </div>'),da=R('<div class="include svelte-1h3fgf1"><!></div> <section><div class="label svelte-1h3fgf1"> </div> <!> <p class="fineprint svelte-1h3fgf1"> </p></section>',1),fa=R('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function va(t,e){he(e,!0);const n=m(()=>Ve(Xe("main")));let o=H(e,"open",15);const s=m(()=>B.processing.progress);let f=re(!1),a=re("croppedonly"),i=m(()=>ht(B.currentProtocol?.crop.padding??"0px")),d=m(()=>r(i).unitless===0?"none":r(i).unit==="px"?"customPixels":r(i).unitless===5?"small":r(i).unitless===10?"medium":"customPercent");$e(()=>{switch(r(d)){case"none":O(i,ht("0px"));break;case"small":O(i,ht("5%"));break;case"medium":O(i,ht("10%"));break}});async function v(){await Ae.clear("exporter"),B.processing.reset(),O(f,!0);const p=je.Protocol.state.find(h=>h.id===B.currentProtocolId);if(!p){Ae.error(r(n).t(35)),O(f,!1);return}try{await Tn(),B.processing.task="export",B.processing.total=1,B.processing.done=0;const h=await e.swarpc.generateResultsZip({include:r(a),protocolId:p.id,cropPadding:r(i).withUnit,jsonSchemaURL:new URL(_n("/results.schema.json"),We.url.origin).toString()},({warning:l,progress:g})=>{if(l){const[b,{filename:M}]=l;switch(b){case"exif-write-error":Ae.warn(`Impossible d'ajouter les métadonnées EXIF à l'image ${M}`);break}}g&&(B.processing.done=g)});oo(h,"results.zip","application/zip")}catch(h){console.error(h),Ae.error(`Erreur lors de l'exportation des résultats: ${h}`)}finally{O(f,!1)}}var u=fa(),c=C(u);{const p=l=>{var g=ca(),b=C(g);Sn(b,{pool:"exporter"});var M=P(b,2),$=y(M);Jt($,{percentage:!0,alwaysActive:!0,get progress(){return r(s)}}),w(M);var F=P(M,2);{const I=S=>{var x=N(),k=C(x);{var T=L=>{Nr(L,{})},D=L=>{no(L,{})};G(k,L=>{r(f)?L(T):L(D,!1)})}_(S,x)};Be(F,{onclick:v,_w_snippet_0:I,children:(S,x)=>{{let k=m(()=>[I]),T=m(()=>r(n).cx(21));Le(S,{get t(){return r(k)},get x(){return r(T)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}_(l,g)};let h=m(()=>r(n).t(95));wt(c,()=>({"--footer-direction":"column"})),Ot(c.lastChild,{key:"modal_export_results",get title(){return r(h)},onopen:()=>{Ae.setCurrentPool("exporter")},onclose:()=>{Ae.setCurrentPool("default"),B.processing.reset()},get open(){return o()},set open(l){o(l)},footer:p,children:(l,g)=>{var b=da(),M=C(b),$=y(M);ao($,{options:[{key:"metadataonly",label:"Métadonnées seulement"},{key:"croppedonly",label:"Métadonnées et images recadrées"},{key:"full",label:"Métadonnées, images recadrées et images originales",subtext:"Permet de ré-importer les résultats ultérieurement"}],get value(){return r(a)},set value(L){O(a,L,!0)}}),w(M);var F=P(M,2);let I;var S=y(F),x=y(S,!0);w(S);var k=P(S,2);jt(k,{options:["none","small","medium","customPercent","customPixels"],labels:{none:"Aucune",small:"5%",medium:"10%"},get value(){return r(d)},set value(U){O(d,U)},customOption:(U,X=ce)=>{const q=m(()=>X()==="customPercent"?"%":"px");var z=ua();let V;var ee=y(z);{let ae=m(()=>X()==="customPercent"?"en pourcentage des dimensions de l'image":"en pixels"),ue=m(()=>r(i).unitless===0?"0":r(i).unit===r(q)?r(i).unitless.toString():"?");Rr(ee,{get label(){return r(ae)},get value(){return r(ue)},onblur:async de=>{await ln();const pe=Number.parseInt(de,10);!isNaN(pe)&&pe>0&&(O(i,ht(pe+r(q))),O(d,X()))}})}var se=P(ee);w(z),K(()=>{V=yr(z,"",V,{"--width":r(q)==="%"?"3ch":"4ch"}),E(se,` ${r(q)??""}`)}),_(U,z)},$$slots:{customOption:!0}});var T=P(k,2),D=y(T,!0);w(T),w(F),K((L,U)=>{I=mt(F,1,"crop-padding svelte-1h3fgf1",null,I,{irrelevant:r(a)==="metadataonly"}),E(x,L),E(D,U)},[()=>r(n).t(126),()=>r(n).t(190)]),_(l,b)},$$slots:{footer:!0,default:!0}}),w(c)}_(t,u),ge()}var pa=ot('<svg><path fill="currentColor" d="M18.207 9.043L12 2.836L5.793 9.043l1.414 1.414L12 5.664l4.793 4.793zM5.793 14.957L12 21.164l6.207-6.207l-1.414-1.414L12 18.336l-4.793-4.793z"></path></svg>');function ha(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=pa();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var ga=R("<button><!> <!></button>"),ma=R('<code class="svelte-1b302ru"> </code>'),_a=R("<!> <!>",1),ba=R('<div class="item svelte-1b302ru"><div class="label svelte-1b302ru"><div class="icon svelte-1b302ru"><!></div> </div> <div class="version svelte-1b302ru"><!></div></div>');function wa(t,e){he(e,!0);const n=m(()=>Ve(Xe("main")));{const o=(a,i=ce)=>{var d=ga();we(d,()=>({class:"trigger",...i(),[gn]:{"none-selected":!B.currentProtocol}}),void 0,void 0,"svelte-1b302ru");var v=y(d);{var u=h=>{var l=fe();K(()=>E(l,B.currentProtocol?.name)),_(h,l)},c=h=>{var l=fe();K(g=>E(l,g),[()=>r(n).t(35)]),_(h,l)};G(v,h=>{B.currentProtocol?h(u):h(c,!1)})}var p=P(v,2);ha(p,{}),w(d),_(a,d)},s=(a,i)=>{let d=()=>i?.().label,v=()=>i?.().protocol;var u=ba(),c=y(u),p=y(c),h=y(p);{var l=I=>{Fr(I,{})},g=I=>{var S=N(),x=C(S);{var k=T=>{lo(T,{})};G(x,T=>{v()||T(k)},!0)}_(I,S)};G(h,I=>{B.currentProtocolId===v()?.id?I(l):I(g,!1)})}w(p);var b=P(p);w(c);var M=P(c,2),$=y(M);{var F=I=>{var S=_a(),x=C(S);{var k=D=>{var L=ma(),U=y(L);w(L),kr(L,(X,q)=>Pr?.(X,q),()=>"Version du protocole"),K(()=>E(U,`v${v().version??""}`)),_(D,L)};G(x,D=>{v().version&&D(k)})}var T=P(x,2);eo(T,ut({compact:!0},v)),_(I,S)};G($,I=>{v()&&I(F)})}w(M),w(u),K(()=>E(b,` ${d()??""}`)),_(a,u)};let f=m(()=>je.Protocol.state.map(a=>({protocol:a,key:a.id,label:a.name,selected:B.currentProtocolId===a.id,onclick(){B.setCurrentProtocolId(a.id)}})));Wr(t,{testid:"protocol-switcher",items:[{protocol:null,label:"Gérer les protocoles",onclick(){at("/protocols")}}],get selectableItems(){return r(f)},trigger:o,item:s,$$slots:{trigger:!0,item:!0}})}ge()}var ya=ot('<svg><path fill="currentColor" d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2h.1A6.98 6.98 0 0 0 10 7m-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938A8 8 0 0 0 4 12"></path></svg>');function xa(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=ya();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ma=ot('<svg><path fill="currentColor" d="M3.34 17a10 10 0 0 1-.979-2.326a3 3 0 0 0 .003-5.347a10 10 0 0 1 2.5-4.337a3 3 0 0 0 4.632-2.674a10 10 0 0 1 5.007.003a3 3 0 0 0 4.632 2.671a10.06 10.06 0 0 1 2.503 4.336a3 3 0 0 0-.002 5.347a10 10 0 0 1-2.501 4.337a3 3 0 0 0-4.632 2.674a10 10 0 0 1-5.007-.002a3 3 0 0 0-4.631-2.672A10 10 0 0 1 3.339 17m5.66.196a5 5 0 0 1 2.25 2.77q.75.07 1.499.002a5 5 0 0 1 2.25-2.772a5 5 0 0 1 3.526-.564q.435-.614.748-1.298A5 5 0 0 1 18 12c0-1.26.47-2.437 1.273-3.334a8 8 0 0 0-.75-1.298A5 5 0 0 1 15 6.804a5 5 0 0 1-2.25-2.77q-.75-.071-1.5-.001A5 5 0 0 1 9 6.804a5 5 0 0 1-3.526.564q-.436.614-.747 1.298A5 5 0 0 1 6 12c0 1.26-.471 2.437-1.273 3.334a8 8 0 0 0 .75 1.298A5 5 0 0 1 9 17.196M12 15a3 3 0 1 1 0-6a3 3 0 0 1 0 6m0-2a1 1 0 1 0 0-2a1 1 0 0 0 0 2"></path></svg>');function ka(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=Ma();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Pa=ot('<svg><path fill="currentColor" d="m19 3l4 5h-3v12h-2V8h-3zm-5 15v2H3v-2zm0-7v2H3v-2zm-2-7v2H3V4z"></path></svg>');function Sa(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=Pa();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ca=ot('<svg><path fill="currentColor" d="M20 4v12h3l-4 5l-4-5h3V4zm-8 14v2H3v-2zm2-7v2H3v-2zm0-7v2H3V4z"></path></svg>');function $a(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=Ca();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ia=ot('<svg><path fill="currentColor" d="M5 11v2h14v-2z"></path></svg>');function Oa(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=Ia();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Aa=ot('<svg><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12a6 6 0 0 1 0 12m0-2a4 4 0 1 0 0-8a4 4 0 0 0 0 8M11 1h2v3h-2zm0 19h2v3h-2zM3.515 4.929l1.414-1.414L7.05 5.636L5.636 7.05zM16.95 18.364l1.414-1.414l2.121 2.121l-1.414 1.414zm2.121-14.85l1.414 1.415l-2.121 2.121l-1.414-1.414zM5.636 16.95l1.414 1.414l-2.121 2.121l-1.414-1.414zM23 11v2h-3v-2zM4 11v2H1v-2z"></path></svg>');function Ta(t,e){const n=Ie(e,["$$slots","$$events","$$legacy"]);var o=Aa();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ea=R('<p class="details svelte-qprabs"> </p>'),Da=R("<a> </a>"),Fa=R("<a> </a>"),Ra=R('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <dialog class="container svelte-qprabs" data-testid="app-settings"><header class="svelte-qprabs"> </header> <div class="listParam svelte-qprabs"><div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><input type="range" min="0.5" max="2" step="0.01" list="gridsize-marks"/> <datalist id="gridsize-marks"><option></option></datalist></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!> <div class="number-input svelte-qprabs"><!></div> <!></div></div> <section class="actions svelte-qprabs"><!> <!></section> <footer class="svelte-qprabs"><!></footer></dialog>',1);function Na(t,e){he(e,!0);const n=m(()=>Ve(Xe("main")));let o=re(!1),s=re(void 0);$e(()=>{window.addEventListener("mouseup",({target:A})=>{A!==r(s)&&(r(s)?.contains(A)||O(o,!1))})});const f=m(Ht),a=m(()=>r(f).theme),i=m(()=>r(f).showTechnicalMetadata),d=m(()=>r(f).gallerySort),v=m(()=>r(f).gridSize),u=m(()=>r(f).language),c=m(()=>r(f).parallelism);let p=re(!0);$e(()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",A=>{O(p,!A.matches)})});const h=m(()=>{const A=Ht().theme;return A==="auto"?r(p)?"light":"dark":A});xr(()=>r(h),A=>{window.nativeWindow?.setControlsColor(getComputedStyle(document.documentElement).getPropertyValue(`--${A}__fg-primary`))});var l=Ra(),g=C(l);{let A=m(()=>r(o)?"Fermer":"Réglages");wt(g,()=>({"--fg":"var(--trigger-fg)","--bg":"var(--trigger-bg)","--hover-fg":"var(--trigger-hover-fg)","--hover-bg":"var(--trigger-hover-bg)"})),lt(g.lastChild,{"data-testid":"settings-button",get help(){return r(A)},onclick:()=>{O(o,!r(o))},children:(W,ne)=>{var Z=N(),be=C(Z);{var Oe=Ce=>{fo(Ce,{})},et=Ce=>{ka(Ce,{})};G(be,Ce=>{r(o)?Ce(Oe):Ce(et,!1)})}_(W,Z)},$$slots:{default:!0}}),w(g)}var b=P(g,2),M=y(b),$=y(M,!0);w(M);var F=P(M,2),I=y(F),S=y(I,!0);w(I);var x=P(I,2),k=y(x);{let A=m(()=>r(a)==="auto"?r(p):r(a)==="light"),W=m(()=>({on:Ta,off:xa}));dr(k,{get value(){return r(A)},onchange:async ne=>{await ze("theme",ne?"light":"dark")},get icons(){return r(W)}})}var T=P(k,2);{let A=m(()=>r(a)==="auto"),W=m(()=>r(n).t(176));lt(T,{get disabled(){return r(A)},onclick:async()=>await ze("theme","auto"),get help(){return r(W)},children:(ne,Z)=>{vo(ne,{})},$$slots:{default:!0}})}w(x);var D=P(x,2),L=y(D,!0);w(D);var U=P(D,2),X=y(U);dr(X,{"data-testid":"debug-mode",get value(){return r(i)},onchange:async A=>{await ze("showTechnicalMetadata",A)}}),w(U);var q=P(U,2),z=y(q,!0);w(q);var V=P(q,2),ee=y(V),se=()=>r(d).key,ae=A=>ze("gallerySort",{...r(d),key:A});{let A=m(()=>r(n).t(144));jt(ee,{get"aria-label"(){return r(A)},options:["filename","date"],get value(){return se()},set value(W){ae(W)},labels:{filename:"Fichier",date:"Date"}})}var ue=P(ee,2);{let A=m(()=>r(d).direction==="asc"?"Trier par ordre décroissant":"Trier par ordre croissant");lt(ue,{"data-testid":"toggle-sort-direction",onclick:async()=>await ze("gallerySort",{...r(d),direction:r(d).direction==="asc"?"desc":"asc"}),get help(){return r(A)},children:(W,ne)=>{var Z=N(),be=C(Z);{var Oe=Ce=>{Sa(Ce,{})},et=Ce=>{$a(Ce,{})};G(be,Ce=>{r(d).direction==="asc"?Ce(Oe):Ce(et,!1)})}_(W,Z)},$$slots:{default:!0}})}w(V);var de=P(V,2),pe=y(de,!0);w(de);var Q=P(de,2),Y=y(Q);mn(Y);var _e=P(Y,2),ie=y(_e);ie.value=ie.__value="1",w(_e),w(Q);var le=P(Q,2),xe=y(le,!0);w(le);var ke=P(le,2),Pe=y(ke);{const A=(ne,Z=ce)=>{const be=m(()=>({en:"English",fr:"Français",ja:"日本語"}));Ee();var Oe=fe();K(()=>E(Oe,r(be)[Z()]||Z())),_(ne,Oe)};let W=m(()=>r(n).t(122));jt(Pe,{"data-testid":"language-selection",get"aria-label"(){return r(W)},"clickable-custom-options":!0,options:["en","fr"],get value(){return r(u)},onchange:async ne=>{await ze("language",ne),window.location.reload()},customOption:A,$$slots:{customOption:!0}})}w(ke);var Ke=P(ke,2);{const A=(W,ne=ce)=>{var Z=Ea(),be=y(Z,!0);w(Z),K(Oe=>E(be,Oe),[()=>r(n).tx(ne())]),_(W,Z)};var qe=y(Ke);{let W=m(()=>[A]),ne=m(()=>r(n).cx(372));Le(qe,{get t(){return r(W)},get x(){return r(ne)}})}w(Ke)}var Re=P(Ke,2),Se=y(Re);{let A=m(()=>r(n).t(373));lt(Se,{get help(){return r(A)},onclick:async()=>{await ze("parallelism",Math.max(1,r(c)-1))},children:(W,ne)=>{Oa(W,{})},$$slots:{default:!0}})}var Me=P(Se,2),Te=y(Me);{let A=m(()=>r(n).t(374));Rr(Te,{get label(){return r(A)},get value(){return r(c)},onblur:async W=>{await ze("parallelism",Number.parseInt(W))}})}w(Me);var De=P(Me,2);{let A=m(()=>r(n).t(375));lt(De,{get help(){return r(A)},onclick:async()=>{await ze("parallelism",r(c)+1)},children:(W,ne)=>{uo(W,{})},$$slots:{default:!0}})}w(Re),w(F);var j=P(F,2),te=y(j);Be(te,{onclick:()=>{e.openKeyboardShortcuts?.()},children:(A,W)=>{Ee();var ne=fe();K(Z=>E(ne,Z),[()=>r(n).t(153)]),_(A,ne)},$$slots:{default:!0}});var oe=P(te,2);{let A=m(()=>r(n).t(189));Be(oe,{get help(){return r(A)},onclick:()=>{e.openPrepareForOfflineUse?.()},children:(W,ne)=>{Ee();var Z=fe();K(be=>E(Z,be),[()=>r(n).t(151)]),_(W,Z)},$$slots:{default:!0}})}w(j);var me=P(j,2);{const A=ne=>{var Z=Da(),be=y(Z,!0);w(Z),K(Oe=>{ye(Z,"href","https://github.com/cigaleapp/cigale/tree/65f4744d020f83c6e31467a9ed0fd11ddb22dde6"),E(be,Oe)},[()=>"65f4744d020f83c6e31467a9ed0fd11ddb22dde6".slice(0,7)]),_(ne,Z)},W=(ne,Z=ce)=>{var be=Fa();be.__click=()=>{O(o,!1)};var Oe=y(be,!0);w(be),K((et,Ce)=>{ye(be,"href",et),E(Oe,Ce)},[()=>it("/about"),()=>r(n).tx(Z())]),_(ne,be)};var Fe=y(me);{let ne=m(()=>[A,W]),Z=m(()=>r(n).cx(46));Le(Fe,{get t(){return r(ne)},get x(){return r(Z)}})}w(me)}w(b),co(b,A=>O(s,A),()=>r(s)),K((A,W,ne,Z,be,Oe)=>{ye(b,"data-theme",r(a)),b.open=r(o)?!0:void 0,E($,A),E(S,W),E(L,ne),E(z,Z),E(pe,be),E(xe,Oe)},[()=>r(n).t(163),()=>r(n).t(184),()=>r(n).t(133),()=>r(n).t(187),()=>r(n).t(181),()=>r(n).t(121)]),pn("blur",Y,async()=>ze("gridSize",r(v))),so(Y,()=>r(v),A=>{const W=je.Settings.state;W[W.findIndex(ne=>ne.id==="user")].gridSize=A}),_(t,l),ge()}Bt(["click"]);var La=R('<div class="selected-model-indicator svelte-1nmekgl"><!></div> ',1),za=R('<div class="inference svelte-1nmekgl"><!></div>'),Ha=R('<button class="pr-number svelte-1nmekgl"><!></button>'),Ka=R('<div class="line svelte-1nmekgl"></div>'),qa=R('<div class="line svelte-1nmekgl"></div>'),Ga=R('<div class="line svelte-1nmekgl"></div>'),ja=R('<!> <!> <header><div class="progressbar svelte-1nmekgl"><!></div> <nav data-testid="app-nav"><div class="logo svelte-1nmekgl"><a class="svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></a> <!></div> <div class="steps svelte-1nmekgl"><a data-testid="goto-import" class="svelte-1nmekgl"><!></a> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-crop" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-classify" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <!></div> <aside><!> <div class="settings svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div></aside></nav></header>',1);function Ua(t,e){he(e,!0);const n=(j,te=ce,oe=ce,me=ce,Fe=ce)=>{var A=za(),W=y(A);{var ne=Z=>{{const be=(pt,Ye=ce)=>{lt(pt,ut({help:""},Ye,{children:(Tt,rr)=>{Qn(Tt,{})},$$slots:{default:!0}}))},Oe=(pt,Ye)=>{let Tt=()=>Ye?.().label,rr=()=>Ye?.().key;var nr=La(),Et=C(nr),Qr=y(Et);{var Zr=Dt=>{Fr(Dt,{})};G(Qr,Dt=>{rr()===me()&&Dt(Zr)})}w(Et);var en=P(Et);K(()=>E(en,` ${Tt()??""}`)),_(pt,nr)};let et=m(()=>r(o).t(134)),Ce=m(()=>[{key:-1,label:"Aucune inférence",selected:me()===-1,onclick:()=>Fe()(-1)},...oe().map((pt,Ye)=>({key:Ye,label:pt.name??"",onclick:()=>Fe()(Ye),selected:me()===Ye}))]);Wr(Z,{get testid(){return`${te()??""}-models`},get help(){return r(et)},items:[],get selectableItems(){return r(Ce)},trigger:be,item:Oe,$$slots:{trigger:!0,item:!0}})}};G(W,Z=>{B.currentProtocol&&Z(ne)})}w(A),_(j,A)},o=m(()=>Ve(Xe("main")));let s=H(e,"progress",3,0),f=H(e,"floating",3,!1);const a=m(()=>We.url.hash.replace(/^#/,"")),i=m(()=>je.Image.state.length>0);let d=re(void 0),v=re(void 0),u=re(void 0),c=re(void 0),p=re(!0),h=re(!1),l=re(!1);$e(()=>{O(l,"nativeWindow"in window)}),$e(()=>{r(v)&&window.nativeWindow?.setControlsHeight(r(v))}),$e(()=>{window.nativeWindow?.setProgress(Sr(s(),0,1)),s()>=1&&window.nativeWindow?.startCallingAttention()}),$e(()=>{if(r(l))return;const j=document.title.replace(/^(⏳ \d+% ·|🆗) /,"");s()>=1||r(h)?document.title=`🆗 ${j}`:s()===0?document.title=j:document.title=`⏳ ${Mn(s())} · ${j}`}),$e(()=>{document.addEventListener("processing-queue-drained",()=>{r(p)||O(h,!0)}),window.addEventListener("focus",()=>{O(h,!1),O(p,!0)}),window.addEventListener("blur",()=>{O(p,!1)})}),zt("navigation",{"g p":{do:()=>at("/"),help:r(o).t(61)},"g i":{do:()=>at("/import"),help:r(o).t(110)},"g r":{do:()=>at("/crop"),help:r(o).t(156)},"g n":{do:()=>at("/classify"),help:r(o).t(66)},"g x":{do:()=>r(u)(),help:r(o).t(95)},"g m":{do:()=>at("/protocols/"),help:r(o).t(101)}});var g=ja(),b=C(g);va(b,{get swarpc(){return e.swarpc},get open(){return r(u)},set open(j){O(u,j,!0)}});var M=P(b,2);{var $=j=>{aa(j,{get open(){return r(c)},set open(te){O(c,te,!0)}})};G(M,j=>{j($)})}var F=P(M,2);let I;var S=y(F),x=y(S);{let j=m(()=>B.processing.task==="export"?0:s());Jt(x,{get progress(){return r(j)}})}w(S);var k=P(S,2);let T;var D=y(k),L=y(D),U=y(L);wt(U,()=>({"--stroke-width":"75","--size":"2rem","--fill":"transparent"})),to(U.lastChild,{}),w(U),w(L);var X=P(L,2);{var q=j=>{var te=Ha();te.__click=function(...me){r(c)?.apply(this,me)};var oe=y(te);{let me=m(()=>r(o).cx(147)),Fe=m(()=>[Ue]);Le(oe,{get x(){return r(me)},get a(){return r(Fe)}})}w(te),_(j,te)};G(X,j=>{j(q)})}w(D);var z=P(D,2),V=y(z);{const j=te=>{var oe=N(),me=C(oe);{var Fe=A=>{var W=Ka();_(A,W)};G(me,A=>{r(a)=="/import"&&A(Fe)})}_(te,oe)};var ee=y(V);{let te=m(()=>[j]),oe=m(()=>r(o).cx(109));Le(ee,{get t(){return r(te)},get x(){return r(oe)}})}w(V)}var se=P(V,2),ae=y(se);Ft(ae,{}),w(se);var ue=P(se,2),de=y(ue);{const j=te=>{var oe=N(),me=C(oe);{var Fe=A=>{var W=qa();_(A,W)};G(me,A=>{r(a).startsWith("/crop")&&A(Fe)})}_(te,oe)};var pe=y(de);{let te=m(()=>[j]),oe=m(()=>r(o).cx(155));Le(pe,{get t(){return r(te)},get x(){return r(oe)}})}w(de)}var Q=P(de,2);n(Q,()=>"crop",()=>B.cropModels,()=>B.selectedCropModel,()=>j=>B.setModelSelections({crop:j})),w(ue);var Y=P(ue,2),_e=y(Y);Ft(_e,{}),w(Y);var ie=P(Y,2),le=y(ie);{const j=te=>{var oe=N(),me=C(oe);{var Fe=A=>{var W=Ga();_(A,W)};G(me,A=>{r(a)=="/classify"&&A(Fe)})}_(te,oe)};var xe=y(le);{let te=m(()=>[j]),oe=m(()=>r(o).cx(65));Le(xe,{get t(){return r(te)},get x(){return r(oe)}})}w(le)}var ke=P(le,2);n(ke,()=>"classify",()=>B.classificationModels,()=>B.selectedClassificationModel,()=>j=>B.setModelSelections({classification:j})),w(ie),kr(ie,(j,te)=>Pr?.(j,te),()=>B.processing.task==="detection"&&B.processing.progress<1?"Veuillez attendre la fin de l'analyse des images avant de les classifier":void 0);var Pe=P(ie,2),Ke=y(Pe);Ft(Ke,{}),w(Pe);var qe=P(Pe,2);Be(qe,{testid:"export-results-button",tight:!0,get onclick(){return r(u)},children:(j,te)=>{Ee();var oe=fe();K(me=>E(oe,me),[()=>r(o).t(13)]),_(j,oe)},$$slots:{default:!0}}),w(z);var Re=P(z,2);let Se;var Me=y(Re);wa(Me,{});var Te=P(Me,2),De=y(Te);wt(De,()=>({"--navbar-height":`${r(d)??""}px`})),Na(De.lastChild,{get openPrepareForOfflineUse(){return e.openPrepareForOfflineUse},get openKeyboardShortcuts(){return e.openKeyboardShortcuts}}),w(De),w(Te),w(Re),w(k),w(F),K((j,te,oe,me)=>{I=mt(F,1,"svelte-1nmekgl",null,I,{"native-window":r(l)}),T=mt(k,1,"svelte-1nmekgl",null,T,{floating:f()}),ye(L,"href",j),ye(V,"href",te),ye(V,"aria-disabled",!B.currentProtocol),ye(de,"href",oe),ye(de,"aria-disabled",!B.currentProtocol||!r(i)),ye(le,"href",me),ye(le,"aria-disabled",!B.currentProtocol||!r(i)||B.processing.task==="detection"&&B.processing.progress<1),Se=mt(Re,1,"svelte-1nmekgl",null,Se,{native:r(l)})},[()=>it("/"),()=>it("/import"),()=>We.route.id!=="/(app)/(sidepanel)/crop/[image]"&&B.imageOpenedInCropper?it("/(app)/(sidepanel)/crop/[image]",{image:B.imageOpenedInCropper}):it("/crop"),()=>it("/classify")]),cr(k,"clientHeight",j=>O(v,j)),cr(F,"clientHeight",j=>O(d,j)),_(t,g),ge()}Bt(["click"]);async function Ba(t,e){const n=je.Protocol.state.filter(f=>t.includes(f.id));if(n.length<t.length)throw new Error(`Some protocols not found in ${t.join(", ")}`);const o=[...n.flatMap(f=>f.crop.infer?.map(a=>a.model)??[]),...n.flatMap(f=>f.metadata.map(a=>je.Metadata.getFromState(a)).filter(Kt).flatMap(({infer:a})=>a&&"neural"in a?a.neural.map(({model:i})=>i):[]))],s=await Promise.allSettled(o.map((f,a)=>On(f,{cacheAs:"model",onProgress({total:i,transferred:d}){e?.({done:d,total:i,modelNo:a,modelURL:vr(f)})}})));if(s.some(f=>f.status==="rejected"))throw new Error("Could not download all models: "+s.map((f,a)=>{if(f.status!=="fulfilled")return`${vr(o[a])}: ${f.reason}`}).filter(Kt).join("; "))}var Wa=R('<li class="svelte-au9nsu"><span class="url svelte-au9nsu"> </span> <!></li>'),Va=R("<!> ",1),Xa=R('<p> </p> <ul class="bars svelte-au9nsu"></ul> <section class="state svelte-au9nsu"><!></section>',1);function Ya(t,e){he(e,!0);const n=m(()=>Ve(Xe("main")));let o=H(e,"open",15),s=re(void 0),f=re(void 0);async function a(){await Ba(je.Protocol.state.map(u=>u.id),({modelNo:u,...c})=>{i.set(u,c)}).catch(u=>{O(s,u,!0)})}$e(()=>{r(d)&&i.values().every(u=>u.done>=u.total)&&O(s,!0)});let i=new Mr;const d=m(()=>i.size>0),v=m(()=>Cn(r(s)===!0?"success":"error"));{const u=(p,h)=>{let l=()=>h?.().close;var g=N(),b=C(g);{var M=F=>{fr(F,{get loading(){return r(d)},onclick:a,children:(I,S)=>{Ee();var x=fe();K(k=>E(x,k),[()=>r(n).t(77)]),_(I,x)},$$slots:{default:!0}})},$=F=>{fr(F,{onclick:()=>{i.clear(),O(s,void 0),l()?.()},children:(I,S)=>{Ee();var x=fe();K(k=>E(x,k),[()=>r(n).t(96)]),_(I,x)},$$slots:{default:!0}})};G(b,F=>{r(s)!==!0?F(M):F($,!1)})}_(p,g)};let c=m(()=>r(n).t(151));Ot(t,{key:"modal_prepare_for_offline",get title(){return r(c)},get open(){return o()},set open(p){o(p)},get close(){return r(f)},set close(p){O(f,p,!0)},footer:u,children:(p,h)=>{var l=Xa(),g=C(l),b=y(g,!0);w(g);var M=P(g,2);nt(M,21,()=>i,([k,{done:T,total:D,modelURL:L}])=>k,(k,T)=>{var D=m(()=>St(r(T),2));let L=()=>r(D)[1].done,U=()=>r(D)[1].total,X=()=>r(D)[1].modelURL;var q=Wa(),z=y(q),V=y(z,!0);w(z);var ee=P(z,2);{let se=m(()=>Sr(L()/U(),0,1));Jt(ee,{alwaysActive:!0,get progress(){return r(se)}})}w(q),K(()=>E(V,X())),_(k,q)}),w(M);var $=P(M,2);let F;var I=y($);{var S=k=>{const T=D=>{var L=N(),U=C(L);Ne(U,()=>r(v),(X,q)=>{q(X,{})}),_(D,L)};{let D=m(()=>[T]),L=m(()=>r(n).cx(8));Le(k,{get t(){return r(D)},get x(){return r(L)}})}},x=k=>{var T=N(),D=C(T);{var L=X=>{var q=Va(),z=C(q);Ne(z,()=>r(v),(ee,se)=>{se(ee,{})});var V=P(z);K(()=>E(V,` ${r(s)??""}`)),_(X,q)},U=X=>{var q=N(),z=C(q);{var V=ee=>{const se=ae=>{Nr(ae,{})};{let ae=m(()=>[se]),ue=m(()=>r(n).cx(2));Le(ee,{get t(){return r(ae)},get x(){return r(ue)}})}};G(z,ee=>{i.size>0&&ee(V)},!0)}_(X,q)};G(D,X=>{r(s)!==void 0?X(L):X(U,!1)},!0)}_(k,T)};G(I,k=>{r(s)===!0?k(S):k(x,!1)})}w($),K(k=>{E(b,k),F=yr($,"",F,{color:`var(--fg-${r(s)===!0?"success":r(d)?"secondary":"error"})`})},[()=>r(n).t(188)]),_(p,l)},$$slots:{footer:!0,default:!0}})}ge()}function Ja(t){const e={encode:o=>JSON.stringify(o),decode:o=>{if(o===null)return null;try{return JSON.parse(o)}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}function Qa(t){const e={encode:o=>JSON.stringify(o),decode:o=>{if(o===null)return null;try{return JSON.parse(o)}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}let Mt=String.fromCharCode,Vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",kt={};function Za(t,e){if(!kt[t]){kt[t]={};for(let n=0;n<t.length;n++)kt[t][t.charAt(n)]=n}return kt[t][e]}function ei(t){return t==null?"":ri(t,6,function(e){return Vr.charAt(e)})}function ti(t){return t==null?"":t==""?null:ni((t=t.replace(/ /g,"+")).length,32,function(e){return Za(Vr,t.charAt(e))})}function ri(t,e,n){if(t==null)return"";let o,s,f={},a={},i="",d="",v="",u=2,c=3,p=2,h=[],l=0,g=0,b;for(b=0;b<t.length;b+=1)if(i=t.charAt(b),Object.prototype.hasOwnProperty.call(f,i)||(f[i]=c++,a[i]=!0),d=v+i,Object.prototype.hasOwnProperty.call(f,d))v=d;else{if(Object.prototype.hasOwnProperty.call(a,v)){if(256>v.charCodeAt(0)){for(o=0;o<p;o++)l<<=1,g==e-1?(g=0,h.push(n(l)),l=0):g++;for(o=0,s=v.charCodeAt(0);o<8;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1}else{for(o=0,s=1;o<p;o++)l=l<<1|s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s=0;for(o=0,s=v.charCodeAt(0);o<16;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1}--u==0&&(u=Math.pow(2,p),p++),delete a[v]}else for(o=0,s=f[v];o<p;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1;--u==0&&(u=Math.pow(2,p),p++),f[d]=c++,v=String(i)}if(v!==""){if(Object.prototype.hasOwnProperty.call(a,v)){if(256>v.charCodeAt(0)){for(o=0;o<p;o++)l<<=1,g==e-1?(g=0,h.push(n(l)),l=0):g++;for(o=0,s=v.charCodeAt(0);o<8;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1}else{for(o=0,s=1;o<p;o++)l=l<<1|s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s=0;for(o=0,s=v.charCodeAt(0);o<16;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1}--u==0&&(u=Math.pow(2,p),p++),delete a[v]}else for(o=0,s=f[v];o<p;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1;--u==0&&(u=Math.pow(2,p),p++)}for(o=0,s=2;o<p;o++)l=l<<1|1&s,g==e-1?(g=0,h.push(n(l)),l=0):g++,s>>=1;for(;;){if(l<<=1,g==e-1){h.push(n(l));break}g++}return h.join("")}function ni(t,e,n){let o=[],s=4,f=4,a=3,i="",d=[],v,u,c,p,h,l,g,b={val:n(0),position:e,index:1};for(v=0;v<3;v+=1)o[v]=v;for(c=0,h=4,l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;switch(c){case 0:for(c=0,h=256,l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;g=Mt(c);break;case 1:for(c=0,h=65536,l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;g=Mt(c);break;case 2:return""}for(o[3]=g,u=g,d.push(g);;){if(b.index>t)return"";for(c=0,h=Math.pow(2,a),l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;switch(g=c){case 0:for(c=0,h=256,l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;o[f++]=Mt(c),g=f-1,s--;break;case 1:for(c=0,h=65536,l=1;l!=h;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;o[f++]=Mt(c),g=f-1,s--;break;case 2:return d.join("")}if(s==0&&(s=Math.pow(2,a),a++),o[g])i=o[g];else{if(g!==f)return null;i=u+u.charAt(0)}d.push(i),o[f++]=u+i.charAt(0),s--,u=i,s==0&&(s=Math.pow(2,a),a++)}}function oi(t){const e={encode:o=>ei(JSON.stringify(o)),decode:o=>{if(!o)return null;try{return JSON.parse(ti(o)??"")}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}function Nt({encode:t,decode:e}){function n(o){return{encode:t,decode:e,defaultValue:o}}return n}const si={number:Nt({encode:t=>t.toString(),decode:t=>t?parseFloat(t):null}),boolean:Nt({encode:t=>t+"",decode:t=>t!==null&&t!=="false"}),string:Nt({encode:t=>t??"",decode:t=>t}),object:Ja,array:Qa,lz:oi},ai=()=>{const t=ho;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},ii={subscribe(t){return ai().page.subscribe(t)}};let Xr;Xr=ii;function li(t,e,n=(o,s)=>JSON.stringify(o)===JSON.stringify(s)){return typeof t=="object"&&typeof e=="object"&&n(t,e)}const ci={keepFocus:!0,noScroll:!0,replaceState:!0},ui={keepFocus:!0,noScroll:!0,replaceState:!1},Lt=new Set;let _r;const br=new Map,Yr=_o(Xr),It={encode:t=>t.toString(),decode:t=>t?t.toString():null},wr=Symbol("raw");function tr(t,e,n,o,s){o[t]=e;const{debounceHistory:f=0,pushHistory:a=!0,sort:i=!0}=s,d=window.location.hash,v=c=>{if(e==null)c.delete(t);else{const p=(n.get(t)??It.encode)(e);p==null?c.delete(t):c.set(t,p)}};Lt.add(v),clearTimeout(_r);const u=new URLSearchParams(window.location.search);_r=setTimeout(async()=>{Lt.forEach(c=>{c(u)}),clearTimeout(br.get(t));{async function c(){i&&u.sort(),await go(`?${u}${d}`,a?ui:ci),o[t]=void 0}f===0?c():br.set(t,setTimeout(c,f))}Lt.clear()})}function di(t,e,n,o){return(s,f,a)=>{const i=[...s],d=i.shift(),v=structuredClone(Qe(n[d])??t);let u=v;for(const c of i)u=u[c];u[f]=a,tr(d,Array.isArray(v)&&f==="length"?structuredClone(v):v,e,n,o)}}function Jr(t,e,n,o,s,f,a,i=[],d){return new Proxy(t,{get(v,u){if(u===wr)return v;const c=Reflect.get(v,u);if(typeof u=="symbol"||i.length!==0)return c;if(c)return Reflect.get(e,u);if(u==="toJSON")return()=>{const h=Qe(e),l=new URLSearchParams(window.location.search);for(const[g,b]of l.entries())g in e||(h[g]=b);return h};const p=e[u]??(n.get(u)??It.decode)(Yr.current.url.searchParams.get(u));return p!=null&&typeof p=="object"?Jr(p,e,n,o,s,f,a,[...i,u],d??di(p,o,s,a)):p},set(v,u,c){return typeof u=="symbol"?Reflect.set(v,u,c):d?(d(i,u,c),!0):(tr(u,c,o,s,a),!0)},has(v,u){return u===wr?!0:Reflect.has(v,u)}})}function fi(t,e,n,o,s,f,a){return t==null&&typeof n!="boolean"&&n.defaultValue!=null?(o&&tr(e,n.defaultValue,s,f,a),!0):!1}function vi(t,e={}){const{showDefaults:n=!0}=e,o={},s=new Map,f=new Map,a=new Map,i=Ut({});for(const d in t){const v=typeof t?.[d]=="boolean"?It.decode:t?.[d].decode,u=typeof t?.[d]=="boolean"?It.encode:t?.[d].encode;s.set(d,v),f.set(d,u);const c=m(()=>{const p=i[d]??v(Yr.current.url.searchParams.get(d)),h=a.get(d)??null;return li(Qe(p),Qe(h),typeof t[d]=="boolean"?void 0:t[d].equalityFn)?h:(a.set(d,Qe(p)),p)});cn(()=>{fi(r(c),d,t[d],n,f,i,e)&&(i[d]=t[d].defaultValue)}),Object.defineProperty(o,d,{get(){return r(c)},enumerable:!0})}return Jr({},o,s,f,i,a,e)}var pi=R(" <strong> </strong> ",1),hi=R("<a><!></a>");function gi(t,e){he(e,!0);const n=p=>{Ee();var h=pi(),l=C(h,!0),g=P(l),b=y(g,!0);w(g);var M=P(g,1,!0);K(()=>{E(l,r(a)),E(b,r(o)),E(M,r(i))}),_(p,h)},o=m(()=>URL.canParse(e.url)?new URL(e.url).hostname:""),s=m(()=>e.url.split(r(o),2)),f=m(()=>St(r(s),2)),a=m(()=>r(f)[0]),i=m(()=>r(f)[1]);var d=N(),v=C(d);{var u=p=>{var h=hi(),l=y(h);n(l),w(h),K(()=>ye(h,"href",e.url)),_(p,h)},c=p=>{n(p)};G(v,p=>{e.linkify?p(u):p(c,!1)})}_(t,d),ge()}var mi=R("<p> </p>"),_i=R('<section class="modal-import-loading svelte-1qpv17f"><!></section>');function bi(t,e){he(e,!0);const n=m(()=>Ve(Xe("main"))),o=m(()=>We.data),s=m(()=>r(o).swarpc);let f=re(!1);const a={encode:u=>u===null?void 0:(Number(u)+1).toString(),decode:u=>u===null?null:Number(u)-1},i=vi({protocol:si.string(),classificationModel:a,cropModel:a});let d=re(void 0);const v=m(()=>!!(i.protocol?.startsWith("https:")&&URL.canParse(i.protocol)));mo(()=>{r(v)&&r(d)&&!r(f)&&r(d)()}),$e(()=>{r(v)||(i.protocol&&(B.setCurrentProtocolId(i.protocol),i.protocol=null),B.setModelSelections({classification:i.classificationModel,crop:i.cropModel}).then(()=>{i.classificationModel!==null&&(i.classificationModel=null),i.cropModel!==null&&(i.cropModel=null)}))});{const u=l=>{var g=N(),b=C(g);{var M=$=>{gi($,{linkify:!0,get url(){return i.protocol}})};G(b,$=>{i.protocol&&r(v)&&$(M)})}_(l,g)},c=(l,g=ce)=>{var b=_i(),M=y(b);{var $=F=>{var I=mi(),S=y(I,!0);w(I),K(x=>E(S,x),[()=>r(n).t(385)]),_(F,I)};G(M,F=>{r(f)&&F($)})}w(b),_(l,b)};let p=m(()=>r(n).t(111)),h=m(()=>r(n).t(108));$n(t,{get title(){return r(p)},key:"modal_import_remote_protocol",get confirm(){return r(h)},oncancel:()=>{i.protocol=null},onconfirm:async()=>{if(!i.protocol)return;O(f,!0);const l=await fetch(i.protocol).then(g=>g.text()).catch(g=>(Ae.error(r(n).t(90,[g])),null));if(l)try{const{id:g}=await r(s).importProtocol({contents:l});await je.Protocol.refresh(),await je.Metadata.refresh(),B.setCurrentProtocolId(g),i.protocol=null}catch(g){Ae.error(`Erreur lors de l'import du protocole distant: ${g}`)}finally{O(f,!1)}},get open(){return r(d)},set open(l){O(d,l,!0)},_w_snippet_0:u,_w_snippet_1:c,children:(l,g)=>{{let b=m(()=>[u,c]),M=m(()=>r(n).cx(48));Le(l,{get t(){return r(b)},get x(){return r(M)}})}},$$slots:{_w_snippet_0:!0,_w_snippet_1:!0,default:!0}})}ge()}const wi=new Mr;var yi=R("<base/>"),xi=R('<!> <!> <!> <!> <section class="toasts svelte-1v2axqk" data-testid="toasts-area"></section> <div><!></div>',1);function kl(t,e){he(e,!0);const n=m(()=>Ve(Xe("main"))),o=m(()=>e.data.swarpc),s=m(()=>e.data.parallelism);let f=re("full");un("setNavbarAppearance",x=>{tn(()=>{O(f,x,!0)}),rn(()=>{O(f,"full")})}),En({swarpc:r(o),cancellers:wi,parallelism:r(s)});const a={capture(){return An(B,"currentProtocolId")},restore({currentProtocolId:x}){B.setCurrentProtocolId(x)}},i=m(()=>je.Image.state.map(x=>x.fileId).filter(Kt));xr(()=>r(i),x=>{for(const k of x)(async()=>{if(B.hasPreviewURL(k))return;const T=await kn("ImagePreviewFile",k);if(!T)return;const D=new Blob([T.bytes],{type:T.contentType});B.setPreviewURL(k,URL.createObjectURL(D))})()}),zt("general",{"$mod+s":{help:"",hidden:!0,do:()=>Ae.info(r(n).t(146))},"i d e v":{help:r(n).t(26),do:async()=>{await ze("showTechnicalMetadata",!Ct())}}}),zt("debugmode",Object.fromEntries(["warn","error","info","debug","success"].map(x=>{const k={warn:()=>Ae.warn("Example warning toast"),error:()=>Ae.error("Example error toast"),info:()=>Ae.info("Example info toast"),debug:()=>Ae.add("debug","Example debug toast"),success:()=>Ae.success("Example success toast")};return[`t t ${x.charAt(0)}`,{help:`Summon a ${x} toast`,debug:!0,allowInModals:!0,when:Ct,do:k[x]}]})));const d=m(Ht);$e(()=>{document.documentElement.dataset.theme=r(d).theme});let v=re(void 0),u=re(void 0);var c={snapshot:a},p=xi();hn(x=>{var k=yi();K(T=>ye(k,"href",T),[()=>or("/")==="/"?"":or("/")+"index.html"]),_(x,k)});var h=C(p);Ko(h,{preventDefault:!0,get binds(){return B.keybinds},get openHelp(){return r(v)},set openHelp(x){O(v,x,!0)}});var l=P(h,2);Ya(l,{get open(){return r(u)},set open(x){O(u,x,!0)}});var g=P(l,2);bi(g,{});var b=P(g,2);{var M=x=>{{let k=m(()=>r(f)==="floating");Ua(x,{get swarpc(){return r(o)},get openKeyboardShortcuts(){return r(v)},get openPrepareForOfflineUse(){return r(u)},get floating(){return r(k)},get progress(){return B.processing.progress}})}};G(b,x=>{r(f)!=="hidden"&&x(M)})}var $=P(b,2);nt($,21,()=>Ae.items("default"),x=>x.id,(x,k)=>{In(x,ut(()=>r(k),{get action(){return r(k).labels.action},get dismiss(){return r(k).labels.close},onaction:()=>{r(k).callbacks?.action?.(r(k))},ondismiss:()=>{Ae.remove(r(k).id)}}))}),w($);var F=P($,2);let I;var S=y(F);return ve(S,()=>e.children??ce),w(F),K(x=>I=mt(F,1,"contents svelte-1v2axqk",null,I,x),[()=>({padded:!We.route.id?.includes("/(sidepanel)")&&!We.route.id?.includes("protocols/[id]/")})]),_(t,p),ge(c)}export{hr as M,Xo as P,Oa as S,kl as _,Ml as b,wi as c,xl as f,wl as n,yl as p};
