import"./DsnmJJEf.js";import{o as on,a as sn}from"./CNplBLUs.js";import{j as an,p as ge,k as Te,b as me,e as L,d as C,c as R,ay as y,r as w,az as k,aa as z,g as r,u as m,a as _,aY as $t,t as ln,n as le,a3 as cn,s as se,h as Xt,i as T,bD as un,a9 as ue,aA as Ae,a8 as dn,f as st,aX as fn,a6 as vn}from"./Bn_ZbADV.js";import{c as pn,a as E,m as hn,u as gn,o as dt,d as Yt,e as mn,k as _n}from"./C0Q0tU0C.js";import{p as q,i as G,r as Ee,s as ft}from"./dHQvgpC_.js";import{e as ot}from"./WunZNVQx.js";import{s as pe}from"./D9gih6mG.js";import{_ as Ye,g as Je,a as we,s as Me,b as _t,c as Mr,C as bn,r as wn}from"./gEdK1vYj.js";import{t as yn,s as xn}from"./D4q3eRn6.js";import{R as Le}from"./DHI2XP9K.js";import{w as kr}from"./CwN-qvm4.js";import{S as Pr}from"./DP2HZFad.js";import{b as Mn,g as lt,a as ct,r as ar}from"./froF7yrv.js";import{p as Xe}from"./Bls8_OGj.js";import{B as ir}from"./2eCTIWiG.js";import{G as kn,v as yt,Q as Pn,R as Sn,J as lr,ad as cr,ae as kt,af as We,a as Cn,t as Ue,q as $n,z as In}from"./BZvTGrCn.js";import{o as gt,f as Gt}from"./CHjfjsK1.js";import{c as xt}from"./Ceb8Mi8c.js";import{K as On,a as Sr,t as Cr}from"./DnFSS6M7.js";import{h as ur,a as Tt,b as An,t as Tn,M as En,T as Dn}from"./Dd0_OyW6.js";import{i as It,s as Fe,a as bt}from"./CgPNSYEV.js";import{e as dr,c as $r,n as jt,x as Fn,p as Rn}from"./DvdFYW7d.js";import{g as Ct,e as Nn,h as Ir,j as Ut,k as Ln}from"./CvtFKgdo.js";import{u as W}from"./C-_QJLm4.js";import{t as De}from"./CAsIlwrN.js";import{b as fr}from"./DqeZ7boJ.js";import{j as Ot,o as Jt,l as Qt,k as Mt,c as Z,U as Or,a0 as Ar,Q as Tr,w as tt,n as Ke,O as zn,R as Hn,E as Er,S as Zt,a1 as Dr,i as Bt,a2 as vt,a3 as er,a4 as qn,a5 as Fr,a6 as Kn,a7 as Gn,C as pt,a8 as jn,u as ht,g as Rr,V as Nr,a as Un,a9 as Bn,Z as nt,T as Wn,aa as Vn,ab as Xn,ac as Yn,m as je,ad as Jn,ae as Qn,b as at,f as Zn,P as eo,d as to,e as vr,F as ro,A as no}from"./DzadhpZZ.js";import{A as Lt}from"./DPvrpMyM.js";import{C as Lr}from"./Dcos7Psx.js";import{B as ut}from"./gkDaaAm_.js";import{B as Ve}from"./qfe7ntnt.js";import{c as qe}from"./C-HhNZ1M.js";import{s as et}from"./hWH8XGqh.js";import{k as oo,B as so}from"./DoAdyMXq.js";import{L as ao}from"./CvTMilvj.js";import{P as tr}from"./Cavvmz3r.js";import{a as rt}from"./BgDQWD78.js";import{n as rr,k as io}from"./BYsr5R_O.js";import{D as lo}from"./BV3dUZjU.js";import{d as co}from"./B9qchcKe.js";import{I as zr,a as uo}from"./BKosrIVA.js";import{L as Hr}from"./CCpSuPOa.js";import{R as fo}from"./DOfcC_Rr.js";import{e as vo}from"./UkrbtdNH.js";import{A as po}from"./BZLUp2mH.js";import{b as ho}from"./CoBO7ZM6.js";import{A as go}from"./ir7Z2S6w.js";import{C as mo}from"./e6Mv4YwE.js";import{L as _o}from"./CG1E-9Vg.js";import{S as zt}from"./DrYhbhJH.js";import{B as pr}from"./CggZrLAK.js";import{m as hr}from"./DmH6iQKy.js";import{e as bo,s as wo,g as yo,f as xo}from"./DcwTdUGT.js";function Mo(t){let e;const n=pn(s=>{let h=!1;const a=t.subscribe(i=>{e=i,h&&s()});return h=!0,a});function o(){return an()?(n(),e):bo(t)}return"set"in t?{get current(){return o()},set current(s){t.set(s)}}:{get current(){return o()}}}function ko(t){return kn(t,Date.now())}function Po(t,e,n){const[o,s]=rr(n?.in,t,e),h=o.getFullYear()-s.getFullYear(),a=o.getMonth()-s.getMonth();return h*12+a}function So(t){return e=>{const o=(t?Math[t]:Math.trunc)(e);return o===0?0:o}}function Co(t,e){return+yt(t)-+yt(e)}function $o(t,e){const n=yt(t,e?.in);return n.setHours(23,59,59,999),n}function Io(t,e){const n=yt(t,e?.in),o=n.getMonth();return n.setFullYear(n.getFullYear(),o+1,0),n.setHours(23,59,59,999),n}function Oo(t,e){const n=yt(t,e?.in);return+$o(n,e)==+Io(n,e)}function Ao(t,e,n){const[o,s,h]=rr(n?.in,t,t,e),a=Ct(s,h),i=Math.abs(Po(s,h));if(i<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*i);let d=Ct(s,h)===-a;Oo(o)&&i===1&&Ct(o,h)===1&&(d=!1);const f=a*(i-+d);return f===0?0:f}function To(t,e,n){const o=Co(t,e)/1e3;return So(n?.roundingMethod)(o)}function Eo(t,e,n){const o=Pn(),s=n?.locale??o.locale??Sn,h=2520,a=Ct(t,e);if(isNaN(a))throw new RangeError("Invalid time value");const i=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:a}),[d,f]=rr(n?.in,...a>0?[e,t]:[t,e]),u=To(f,d),c=(lr(f)-lr(d))/1e3,p=Math.round((u-c)/60);let v;if(p<2)return n?.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,i):u<10?s.formatDistance("lessThanXSeconds",10,i):u<20?s.formatDistance("lessThanXSeconds",20,i):u<40?s.formatDistance("halfAMinute",0,i):u<60?s.formatDistance("lessThanXMinutes",1,i):s.formatDistance("xMinutes",1,i):p===0?s.formatDistance("lessThanXMinutes",1,i):s.formatDistance("xMinutes",p,i);if(p<45)return s.formatDistance("xMinutes",p,i);if(p<90)return s.formatDistance("aboutXHours",1,i);if(p<cr){const l=Math.round(p/60);return s.formatDistance("aboutXHours",l,i)}else{if(p<h)return s.formatDistance("xDays",1,i);if(p<kt){const l=Math.round(p/cr);return s.formatDistance("xDays",l,i)}else if(p<kt*2)return v=Math.round(p/kt),s.formatDistance("aboutXMonths",v,i)}if(v=Ao(f,d),v<12){const l=Math.round(p/kt);return s.formatDistance("xMonths",l,i)}else{const l=v%12,g=Math.trunc(v/12);return l<3?s.formatDistance("aboutXYears",g,i):l<9?s.formatDistance("overXYears",g,i):s.formatDistance("almostXYears",g+1,i)}}function Do(t,e){return Eo(t,ko(t),e)}var Fo=["Shift","Meta","Alt","Control"],qr=typeof navigator=="object"?navigator.platform:"",Kr=/Mac|iPod|iPhone|iPad/.test(qr),Ro=Kr?"Meta":"Control",No=qr==="Win32"?["Control","Alt"]:Kr?["Alt"]:[];function Wt(t,e){return typeof t.getModifierState=="function"&&(t.getModifierState(e)||No.includes(e)&&t.getModifierState("AltGraph"))}function Lo(t){return t.trim().split(" ").map(function(e){var n=e.split(/\b\+/),o=n.pop(),s=o.match(/^\((.+)\)$/);return s&&(o=new RegExp("^"+s[1]+"$")),[n=n.map(function(h){return h==="$mod"?Ro:h}),o]})}function zo(t,e){var n=e[0],o=e[1];return!((o instanceof RegExp?!o.test(t.key)&&!o.test(t.code):o.toUpperCase()!==t.key.toUpperCase()&&o!==t.code)||n.find(function(s){return!Wt(t,s)})||Fo.find(function(s){return!n.includes(s)&&o!==s&&Wt(t,s)}))}function Ho(t,e){var n;e===void 0&&(e={});var o=(n=e.timeout)!=null?n:1e3,s=Object.keys(t).map(function(i){return[Lo(i),t[i]]}),h=new Map,a=null;return function(i){i instanceof KeyboardEvent&&(s.forEach(function(d){var f=d[0],u=d[1],c=h.get(f)||f;zo(i,c[0])?c.length>1?h.set(f,c.slice(1)):(h.delete(f),u(i)):Wt(i,i.key)||h.delete(f)}),a&&clearTimeout(a),a=setTimeout(h.clear.bind(h),o))}}function qo(t,e,n){var o={},s=o.event,h=s===void 0?"keydown":s,a=o.capture,i=Ho(e,{timeout:o.timeout});return t.addEventListener(h,i,a),function(){t.removeEventListener(h,i,a)}}var Ko=R('<h2 class="svelte-6wpiuz"> </h2>'),Go=R('<dt class="svelte-6wpiuz"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></dt> <dd class="svelte-6wpiuz"> </dd>',1),jo=R('<!> <dl class="svelte-6wpiuz"></dl>',1),Uo=R('<dl class="svelte-6wpiuz"><div class="empty svelte-6wpiuz"><div class="sad svelte-6wpiuz"> </div> <p> </p></div></dl>');function Bo(t,e){ge(e,!0);const n=m(()=>Ye(Je("main")));let o=q(e,"openHelp",15),s=q(e,"preventDefault",3,!1);const h=d=>(d instanceof KeyboardEvent||d instanceof MouseEvent)&&(d.target instanceof HTMLInputElement||d.target instanceof HTMLTextAreaElement);Te(()=>qo(window,Object.fromEntries(Object.entries(e.binds).flatMap(([d,f])=>{if(d.startsWith("Digit")&&!d.includes(" ")){const u=d.replace("Digit","");return[[d,f],[u,f],[`Shift+${u}`,f]]}return[[d,f]]}).map(([d,f])=>[d,async u=>{if(!f?.allowInModals&&ur(Xe)){console.warn(`a modal is open, ignoring keybinding ${d}`,Xe.state);return}if(h(u)&&!d.startsWith("$mod+")){console.warn(`in input, ignoring keybinding ${d}`,u.target);return}f.when&&!f.when(u)||f.debug&&!It()||(s()&&u.preventDefault(),await f.do(u))}]))));const a=["Recadrage","Observations","Général","Navigation","Debug mode"],i=m(()=>dr(dr(e.binds).reduce((d,[f,u])=>{if(u.hidden||u.debug&&!It())return d;const c=u.group??"Général";return d[c]||(d[c]=[]),d[c].push([f,u]),d},{})).toSorted(([d],[f])=>a.indexOf(d)-a.indexOf(f)));Te(()=>{const d=f=>{f.key==="?"&&!h(f)&&!ur(Xe)&&o()?.()};return window.addEventListener("keyup",d),()=>window.removeEventListener("keyup",d)});{let d=m(()=>r(n).t(153));Tt(t,{key:"modal_keyboard_shortcuts_help",get title(){return r(d)},get open(){return o()},set open(f){o(f)},children:(f,u)=>{var c=L(),p=C(c);ot(p,17,()=>r(i),([v,l])=>v,(v,l,g,b)=>{var x=m(()=>$t(r(l),2));let $=()=>r(x)[0],N=()=>r(x)[1];var I=jo(),P=C(I);{var D=M=>{var S=Ko(),A=y(S,!0);w(S),z(()=>E(A,$())),_(M,S)};G(P,M=>{r(i).length>=2&&M(D)})}var O=k(P,2);ot(O,21,N,([M,{help:S}])=>M,(M,S)=>{var A=m(()=>$t(r(S),2));let U=()=>r(A)[0],B=()=>r(A)[1].help;var H=Go(),F=C(H),V=y(F);xt(V,()=>({"--size":"1.2em"})),On(V.lastChild,{get shortcut(){return U()},get help(){return B()}}),w(V),w(F);var J=k(F,2),ee=y(J,!0);w(J),z(()=>E(ee,B())),_(M,H)}),w(O),_(v,I)},v=>{var l=Uo(),g=y(l),b=y(g),x=y(b,!0);w(b);var $=k(b,2),N=y($,!0);w($),w(g),w(l),z((I,P)=>{E(x,I),E(N,P)},[()=>r(n).t(204),()=>r(n).t(36)]),_(v,l)}),_(f,c)},$$slots:{default:!0}})}me()}function Wo(t){Te(()=>ln(()=>t()))}function Vo(t){return window.getComputedStyle(t).getPropertyValue("direction")}function Xo(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?Qt:Jt,vertical:Mt}[e]}function Yo(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?Jt:Qt,vertical:Ot}[e]}function Jo(t="ltr",e="horizontal"){return["ltr","rtl"].includes(t)||(t="ltr"),["horizontal","vertical"].includes(e)||(e="horizontal"),{nextKey:Xo(t,e),prevKey:Yo(t,e)}}function Qo(t){const e=Z(null);function n(){if(!Ar)return[];const a=document.getElementById(t.rootNodeId.current);return a?t.candidateSelector?Array.from(a.querySelectorAll(t.candidateSelector)):t.candidateAttr?Array.from(a.querySelectorAll(`[${t.candidateAttr}]:not([data-disabled])`)):[]:[]}function o(){const a=n();a.length&&a[0]?.focus()}function s(a,i,d=!1){const f=document.getElementById(t.rootNodeId.current);if(!f||!a)return;const u=n();if(!u.length)return;const c=u.indexOf(a),p=Vo(f),{nextKey:v,prevKey:l}=Jo(p,t.orientation.current),g=t.loop.current,b={[v]:c+1,[l]:c-1,[Tr]:0,[Or]:u.length-1};if(d){const N=v===Mt?Jt:Mt,I=l===Ot?Qt:Ot;b[N]=c+1,b[I]=c-1}let x=b[i.key];if(x===void 0)return;i.preventDefault(),x<0&&g?x=u.length-1:x===u.length&&g&&(x=0);const $=u[x];if($)return $.focus(),e.current=$.id,t.onCandidateFocus?.($),$}function h(a){const i=n(),d=e.current!==null;return a&&!d&&i[0]===a?(e.current=a.id,0):a?.id===e.current?0:-1}return{setCurrentTabStopId(a){e.current=a},getTabIndex:h,handleKeydown:s,focusFirstCandidate:o,currentTabStopId:e}}function Zo(t,e){var n=L(),o=C(n);oo(o,()=>e.children,s=>{var h=L(),a=C(h);pe(a,()=>e.children??le),_(s,h)}),_(t,n)}function es(t,e){ge(e,!0);let n=q(e,"to",3,"body");const o=cn();let s=m(h);function h(){if(!Ar||e.disabled)return null;let c=null;return typeof n()=="string"?c=document.querySelector(n()):(n()instanceof HTMLElement||n()instanceof DocumentFragment)&&(c=n()),c}let a;function i(){a&&(gn(a),a=null)}tt([()=>r(s),()=>e.disabled],([c,p])=>{if(!c||p){i();return}return a=hn(Zo,{target:c,props:{children:e.children},context:o}),()=>{i()}});var d=L(),f=C(d);{var u=c=>{var p=L(),v=C(p);pe(v,()=>e.children??le),_(c,p)};G(f,c=>{e.disabled&&c(u)})}_(t,d),me()}function Il(t,e,n=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===t.length-1?n?t[0]:void 0:t[e+1]}function Ol(t,e,n=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===0?n?t[t.length-1]:void 0:t[e-1]}function Al(t,e,n,o=!0){if(t.length===0||e<0||e>=t.length)return;let s=e+n;return o?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Tl(t,e,n,o=!0){if(t.length===0||e<0||e>=t.length)return;let s=e-n;return o?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Gr(t,e,n){const o=e.toLowerCase();if(o.endsWith(" ")){const c=o.slice(0,-1);if(t.filter(g=>g.toLowerCase().startsWith(c)).length<=1)return Gr(t,c,n);const v=n?.toLowerCase();if(v&&v.startsWith(c)&&v.charAt(c.length)===" "&&e.trim()===c)return n;const l=t.filter(g=>g.toLowerCase().startsWith(o));if(l.length>0){const g=n?t.indexOf(n):-1;return gr(l,Math.max(g,0)).find($=>$!==n)||n}}const h=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,a=h.toLowerCase(),i=n?t.indexOf(n):-1;let d=gr(t,Math.max(i,0));h.length===1&&(d=d.filter(c=>c!==n));const u=d.find(c=>c?.toLowerCase().startsWith(a));return u!==n?u:void 0}function gr(t,e){return t.map((n,o)=>t[(e+o)%t.length])}function jr(t,e=1e4,n=Ke){let o=null,s=se(Xt(t));function h(){return window.setTimeout(()=>{T(s,t,!0),n(t)},e)}return Te(()=>()=>{o&&clearTimeout(o)}),Z.with(()=>r(s),a=>{T(s,a,!0),n(a),o&&clearTimeout(o),o=h()})}function ts(t){const e=jr("",1e3),n=(a=>a.focus()),o=(()=>document.activeElement);function s(a,i){if(!i.length)return;e.current=e.current+a;const d=o(),f=i.find(v=>v===d)?.textContent?.trim()??"",u=i.map(v=>v.textContent?.trim()??""),c=Gr(u,e.current,f),p=i.find(v=>v.textContent?.trim()===c);return p&&n(p),p}function h(){e.current=""}return{search:e,handleTypeaheadSearch:s,resetTypeahead:h}}function mr(t,e){ge(e,!0);let n=q(e,"mounted",15,!1),o=q(e,"onMountedChange",3,Ke);Wo(()=>(n(!0),o()(!0),()=>{n(!1),o()(!1)})),me()}const rs=[Er,Zt],ns=[Mt,zn,Tr],Ur=[Ot,Hn,Or],os=[...ns,...Ur];function ss(t){return t==="indeterminate"}function as(t){return ss(t)?"indeterminate":t?"checked":"unchecked"}function _r(t){return t.pointerType==="mouse"}function is(t){const e=m(()=>t.enabled()),n=jr(!1,t.transitTimeout??300,a=>{r(e)&&t.setIsPointerInTransit?.(a)});let o=se(null);function s(){T(o,null),n.current=!1}function h(a,i){const d=a.currentTarget;if(!vt(d))return;const f={x:a.clientX,y:a.clientY},u=ls(f,d.getBoundingClientRect()),c=cs(f,u),p=us(i.getBoundingClientRect()),v=fs([...c,...p]);T(o,v,!0),n.current=!0}return tt([t.triggerNode,t.contentNode,t.enabled],([a,i,d])=>{if(!a||!i||!d)return;const f=c=>{h(c,i)},u=c=>{h(c,a)};return Dr(dt(a,"pointerleave",f),dt(i,"pointerleave",u))}),tt(()=>r(o),()=>dt(document,"pointermove",i=>{if(!r(o))return;const d=i.target;if(!Bt(d))return;const f={x:i.clientX,y:i.clientY},u=t.triggerNode()?.contains(d)||t.contentNode()?.contains(d),c=!ds(f,r(o));u?s():c&&(s(),t.onPointerExit())})),{isPointerInTransit:n}}function ls(t,e){const n=Math.abs(e.top-t.y),o=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),h=Math.abs(e.left-t.x);switch(Math.min(n,o,s,h)){case h:return"left";case s:return"right";case n:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function cs(t,e,n=5){const o=n*1.5;switch(e){case"top":return[{x:t.x-n,y:t.y+n},{x:t.x,y:t.y-o},{x:t.x+n,y:t.y+n}];case"bottom":return[{x:t.x-n,y:t.y-n},{x:t.x,y:t.y+o},{x:t.x+n,y:t.y-n}];case"left":return[{x:t.x+n,y:t.y-n},{x:t.x-o,y:t.y},{x:t.x+n,y:t.y+n}];case"right":return[{x:t.x-n,y:t.y-n},{x:t.x+o,y:t.y},{x:t.x-n,y:t.y+n}]}}function us(t){const{top:e,right:n,bottom:o,left:s}=t;return[{x:s,y:e},{x:n,y:e},{x:n,y:o},{x:s,y:o}]}function ds(t,e){const{x:n,y:o}=t;let s=!1;for(let h=0,a=e.length-1;h<e.length;a=h++){const i=e[h].x,d=e[h].y,f=e[a].x,u=e[a].y;d>o!=u>o&&n<(f-i)*(o-d)/(u-d)+i&&(s=!s)}return s}function fs(t){const e=t.slice();return e.sort((n,o)=>n.x<o.x?-1:n.x>o.x?1:n.y<o.y?-1:n.y>o.y?1:0),vs(e)}function vs(t){if(t.length<=1)return t.slice();const e=[];for(let o=0;o<t.length;o++){const s=t[o];for(;e.length>=2;){const h=e[e.length-1],a=e[e.length-2];if((h.x-a.x)*(s.y-a.y)>=(h.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const n=[];for(let o=t.length-1;o>=0;o--){const s=t[o];for(;n.length>=2;){const h=n[n.length-1],a=n[n.length-2];if((h.x-a.x)*(s.y-a.y)>=(h.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}function wt(){return{getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"}}function ps(t,e){if(!er(t,wt()))return hs(t,e);const n=qn(Fr(t).body,wt());e==="prev"&&n.reverse();const o=n.indexOf(t);return o===-1?document.body:n.slice(o+1)[0]}function hs(t,e){if(!Kn(t,wt()))return document.body;const n=Gn(Fr(t).body,wt());e==="prev"&&n.reverse();const o=n.indexOf(t);return o===-1?document.body:n.slice(o+1).find(h=>er(h,wt()))??document.body}const Br=new pt("Menu.Root"),nr=new pt("Menu.Root | Menu.Sub"),Et=new pt("Menu.Content"),Wr=new pt("Menu.Group | Menu.RadioGroup"),gs=new pt("Menu.RadioGroup"),or=new pt("Menu.CheckboxGroup"),ms=new Bn("bitsmenuopen",{bubbles:!1,cancelable:!0});class _s{opts;isUsingKeyboard=new Ze;#e=se(!1);get ignoreCloseAutoFocus(){return r(this.#e)}set ignoreCloseAutoFocus(e){T(this.#e,e,!0)}#t=se(!1);get isPointerInTransit(){return r(this.#t)}set isPointerInTransit(e){T(this.#t,e,!0)}constructor(e){this.opts=e}getAttr(e){return`data-${this.opts.variant.current}-${e}`}}class bs{opts;root;parentMenu;contentId=Z.with(()=>"");#e=se(null);get contentNode(){return r(this.#e)}set contentNode(e){T(this.#e,e,!0)}#t=se(null);get triggerNode(){return r(this.#t)}set triggerNode(e){T(this.#t,e,!0)}constructor(e,n,o){this.opts=e,this.root=n,this.parentMenu=o,o&&tt(()=>o.opts.open.current,()=>{o.opts.open.current||(this.opts.open.current=!1)})}toggleOpen(){this.opts.open.current=!this.opts.open.current}onOpen(){this.opts.open.current=!0}onClose(){this.opts.open.current=!1}}class ws{opts;parentMenu;#e=se("");get search(){return r(this.#e)}set search(e){T(this.#e,e,!0)}#t=0;#r;rovingFocusGroup;#o=se(!1);get mounted(){return r(this.#o)}set mounted(e){T(this.#o,e,!0)}#s;constructor(e,n){this.opts=e,this.parentMenu=n,n.contentId=e.id,this.#s=e.isSub??!1,this.onkeydown=this.onkeydown.bind(this),this.onblur=this.onblur.bind(this),this.onfocus=this.onfocus.bind(this),this.handleInteractOutside=this.handleInteractOutside.bind(this),ht({...e,deps:()=>this.parentMenu.opts.open.current,onRefChange:o=>{this.parentMenu.contentNode!==o&&(this.parentMenu.contentNode=o)}}),is({contentNode:()=>this.parentMenu.contentNode,triggerNode:()=>this.parentMenu.triggerNode,enabled:()=>this.parentMenu.opts.open.current&&!!this.parentMenu.triggerNode?.hasAttribute(this.parentMenu.root.getAttr("sub-trigger")),onPointerExit:()=>{this.parentMenu.opts.open.current=!1},setIsPointerInTransit:o=>{this.parentMenu.root.isPointerInTransit=o}}),this.#r=ts().handleTypeaheadSearch,this.rovingFocusGroup=Qo({rootNodeId:this.parentMenu.contentId,candidateAttr:this.parentMenu.root.getAttr("item"),loop:this.opts.loop,orientation:Z.with(()=>"vertical")}),tt(()=>this.parentMenu.contentNode,o=>{if(!o)return;const s=()=>{nt(()=>{this.parentMenu.root.isUsingKeyboard.current&&this.rovingFocusGroup.focusFirstCandidate()})};return ms.listen(o,s)}),Te(()=>{this.parentMenu.opts.open.current||window.clearTimeout(this.#t)})}#l(){const e=this.parentMenu.contentNode;return e?Array.from(e.querySelectorAll(`[${this.parentMenu.root.getAttr("item")}]:not([data-disabled])`)):[]}#n(){return this.parentMenu.root.isPointerInTransit}onCloseAutoFocus=e=>{this.opts.onCloseAutoFocus.current(e),!(e.defaultPrevented||this.#s)&&this.parentMenu.triggerNode&&er(this.parentMenu.triggerNode)&&this.parentMenu.triggerNode.focus()};handleTabKeyDown(e){let n=this.parentMenu;for(;n.parentMenu!==null;)n=n.parentMenu;if(!n.triggerNode)return;e.preventDefault();const o=ps(n.triggerNode,e.shiftKey?"prev":"next");o?(this.parentMenu.root.ignoreCloseAutoFocus=!0,n.onClose(),nt(()=>{o.focus(),nt(()=>{this.parentMenu.root.ignoreCloseAutoFocus=!1})})):document.body.focus()}onkeydown(e){if(e.defaultPrevented)return;if(e.key===Wn){this.handleTabKeyDown(e);return}const n=e.target,o=e.currentTarget;if(!vt(n)||!vt(o))return;const s=n.closest(`[${this.parentMenu.root.getAttr("content")}]`)?.id===this.parentMenu.contentId.current,h=e.ctrlKey||e.altKey||e.metaKey,a=e.key.length===1;if(this.rovingFocusGroup.handleKeydown(n,e)||e.code==="Space")return;const d=this.#l();s&&!h&&a&&this.#r(e.key,d),e.target?.id===this.parentMenu.contentId.current&&os.includes(e.key)&&(e.preventDefault(),Ur.includes(e.key)&&d.reverse(),Vn(d))}onblur(e){Bt(e.currentTarget)&&Bt(e.target)&&(e.currentTarget.contains?.(e.target)||(window.clearTimeout(this.#t),this.search=""))}onfocus(e){this.parentMenu.root.isUsingKeyboard.current&&nt(()=>this.rovingFocusGroup.focusFirstCandidate())}onItemEnter(){return this.#n()}onItemLeave(e){if(e.currentTarget.hasAttribute(this.parentMenu.root.getAttr("sub-trigger"))||this.#n()||this.parentMenu.root.isUsingKeyboard.current)return;this.parentMenu.contentNode?.focus(),this.rovingFocusGroup.setCurrentTabStopId("")}onTriggerLeave(){return!!this.#n()}onOpenAutoFocus=e=>{if(e.defaultPrevented)return;e.preventDefault(),this.parentMenu.contentNode?.focus()};handleInteractOutside(e){if(!Xn(e.target))return;const n=this.parentMenu.triggerNode?.id;if(e.target.id===n){e.preventDefault();return}e.target.closest(`#${n}`)&&e.preventDefault()}#a=m(()=>({open:this.parentMenu.opts.open.current}));get snippetProps(){return r(this.#a)}set snippetProps(e){T(this.#a,e)}#i=m(()=>({id:this.opts.id.current,role:"menu","aria-orientation":Yn("vertical"),[this.parentMenu.root.getAttr("content")]:"","data-state":Rr(this.parentMenu.opts.open.current),onkeydown:this.onkeydown,onblur:this.onblur,onfocus:this.onfocus,dir:this.parentMenu.root.opts.dir.current,style:{pointerEvents:"auto"}}));get props(){return r(this.#i)}set props(e){T(this.#i,e)}popperProps={onCloseAutoFocus:e=>this.onCloseAutoFocus(e)}}class Vr{opts;content;#e=se(!1);constructor(e,n){this.opts=e,this.content=n,this.onpointermove=this.onpointermove.bind(this),this.onpointerleave=this.onpointerleave.bind(this),this.onfocus=this.onfocus.bind(this),this.onblur=this.onblur.bind(this),ht({...e,deps:()=>this.content.mounted})}onpointermove(e){if(!e.defaultPrevented&&_r(e))if(this.opts.disabled.current)this.content.onItemLeave(e);else{if(this.content.onItemEnter())return;const o=e.currentTarget;if(!vt(o))return;o.focus()}}onpointerleave(e){e.defaultPrevented||_r(e)&&this.content.onItemLeave(e)}onfocus(e){nt(()=>{e.defaultPrevented||this.opts.disabled.current||T(this.#e,!0)})}onblur(e){nt(()=>{e.defaultPrevented||T(this.#e,!1)})}#t=m(()=>({id:this.opts.id.current,tabindex:-1,role:"menuitem","aria-disabled":Jn(this.opts.disabled.current),"data-disabled":Nr(this.opts.disabled.current),"data-highlighted":r(this.#e)?"":void 0,[this.content.parentMenu.root.getAttr("item")]:"",onpointermove:this.onpointermove,onpointerleave:this.onpointerleave,onfocus:this.onfocus,onblur:this.onblur}));get props(){return r(this.#t)}set props(e){T(this.#t,e)}}class Xr{opts;item;#e=!1;root;constructor(e,n){this.opts=e,this.item=n,this.root=n.content.parentMenu.root,this.onkeydown=this.onkeydown.bind(this),this.onclick=this.onclick.bind(this),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this)}#t(){if(this.item.opts.disabled.current)return;const e=new CustomEvent("menuitemselect",{bubbles:!0,cancelable:!0});this.opts.onSelect.current(e),nt(()=>{if(e.defaultPrevented){this.item.content.parentMenu.root.isUsingKeyboard.current=!1;return}this.opts.closeOnSelect.current&&this.item.content.parentMenu.root.opts.onClose()})}onkeydown(e){const n=this.item.content.search!=="";if(!(this.item.opts.disabled.current||n&&e.key===Zt)&&rs.includes(e.key)){if(!vt(e.currentTarget))return;e.currentTarget.click(),e.preventDefault()}}onclick(e){this.item.opts.disabled.current||this.#t()}onpointerup(e){if(!e.defaultPrevented&&!this.#e){if(!vt(e.currentTarget))return;e.currentTarget?.click()}}onpointerdown(e){this.#e=!0}#r=m(()=>je(this.item.props,{onclick:this.onclick,onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return r(this.#r)}set props(e){T(this.#r,e)}}class ys{opts;item;group;constructor(e,n,o=null){this.opts=e,this.item=n,this.group=o,this.group&&(tt(()=>this.group.opts.value.current,s=>{this.opts.checked.current=s.includes(this.opts.value.current)}),tt(()=>this.opts.checked.current,s=>{s?this.group.addValue(this.opts.value.current):this.group.removeValue(this.opts.value.current)}))}toggleChecked(){this.opts.indeterminate.current?(this.opts.indeterminate.current=!1,this.opts.checked.current=!0):this.opts.checked.current=!this.opts.checked.current}#e=m(()=>({checked:this.opts.checked.current,indeterminate:this.opts.indeterminate.current}));get snippetProps(){return r(this.#e)}set snippetProps(e){T(this.#e,e)}#t=m(()=>({...this.item.props,role:"menuitemcheckbox","aria-checked":Qn(this.opts.checked.current,this.opts.indeterminate.current),"data-state":as(this.opts.checked.current),[this.item.root.getAttr("checkbox-item")]:""}));get props(){return r(this.#t)}set props(e){T(this.#t,e)}}class xs{opts;root;#e=se(void 0);get groupHeadingId(){return r(this.#e)}set groupHeadingId(e){T(this.#e,e,!0)}constructor(e,n){this.opts=e,this.root=n,ht(this.opts)}#t=m(()=>({id:this.opts.id.current,role:"group","aria-labelledby":this.groupHeadingId,[this.root.getAttr("group")]:""}));get props(){return r(this.#t)}set props(e){T(this.#t,e)}}class Ht{opts;group;constructor(e,n){this.opts=e,this.group=n,ht({...e,onRefChange:o=>{this.group.groupHeadingId=o?.id}})}#e=m(()=>({id:this.opts.id.current,role:"group",[this.group.root.getAttr("group-heading")]:""}));get props(){return r(this.#e)}set props(e){T(this.#e,e)}}class Ms{opts;parentMenu;constructor(e,n){this.opts=e,this.parentMenu=n,this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onkeydown=this.onkeydown.bind(this),ht({...e,onRefChange:o=>{this.parentMenu.triggerNode=o}})}onpointerdown(e){if(!this.opts.disabled.current){if(e.pointerType==="touch")return e.preventDefault();e.button===0&&e.ctrlKey===!1&&(this.parentMenu.toggleOpen(),this.parentMenu.opts.open.current||e.preventDefault())}}onpointerup(e){this.opts.disabled.current||e.pointerType==="touch"&&(e.preventDefault(),this.parentMenu.toggleOpen())}onkeydown(e){if(!this.opts.disabled.current){if(e.key===Zt||e.key===Er){this.parentMenu.toggleOpen(),e.preventDefault();return}e.key===Mt&&(this.parentMenu.onOpen(),e.preventDefault())}}#e=m(()=>{if(this.parentMenu.opts.open.current&&this.parentMenu.contentId.current)return this.parentMenu.contentId.current});#t=m(()=>({id:this.opts.id.current,disabled:this.opts.disabled.current,"aria-haspopup":"menu","aria-expanded":Un(this.parentMenu.opts.open.current),"aria-controls":r(this.#e),"data-disabled":Nr(this.opts.disabled.current),"data-state":Rr(this.parentMenu.opts.open.current),[this.parentMenu.root.getAttr("trigger")]:"",onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return r(this.#t)}set props(e){T(this.#t,e)}}class ks{opts;content;#e=se(null);get groupHeadingId(){return r(this.#e)}set groupHeadingId(e){T(this.#e,e,!0)}root;constructor(e,n){this.opts=e,this.content=n,this.root=n.parentMenu.root,ht(e)}addValue(e){if(e&&!this.opts.value.current.includes(e)){const n=[...et(this.opts.value.current),e];this.opts.value.current=n,this.opts.onValueChange.current(n)}}removeValue(e){if(!e||this.opts.value.current.indexOf(e)===-1)return;const o=this.opts.value.current.filter(s=>s!==e);this.opts.value.current=o,this.opts.onValueChange.current(o)}#t=m(()=>({id:this.opts.id.current,[this.root.getAttr("checkbox-group")]:"",role:"group","aria-labelledby":this.groupHeadingId}));get props(){return r(this.#t)}set props(e){T(this.#t,e)}}function Ps(t){const e=new _s(t);return jn.set({get ignoreCloseAutoFocus(){return e.ignoreCloseAutoFocus}}),Br.set(e)}function Ss(t,e){return nr.set(new bs(e,t,null))}function Cs(t){return new Ms(t,nr.get())}function $s(t){return Et.set(new ws(t,nr.get()))}function Is(t){const e=new Vr(t,Et.get());return new Xr(t,e)}function Os(t,e){const n=new Xr(t,new Vr(t,Et.get()));return new ys(t,n,e)}function As(t){return Wr.set(new xs(t,Br.get()))}function Ts(t){const e=or.getOr(null);if(e)return new Ht(t,e);const n=gs.getOr(null);return n?new Ht(t,n):new Ht(t,Wr.get())}function Es(t){return or.set(new ks(t,Et.get()))}var Ds=R("<div><!></div>");function Fs(t,e){ge(e,!0);let n=q(e,"ref",15,null),o=q(e,"id",19,at),s=q(e,"disabled",3,!1),h=q(e,"onSelect",3,Ke),a=q(e,"closeOnSelect",3,!0),i=Ee(e,["$$slots","$$events","$$legacy","child","children","ref","id","disabled","onSelect","closeOnSelect"]);const d=Is({id:Z.with(()=>o()),disabled:Z.with(()=>s()),onSelect:Z.with(()=>h()),ref:Z.with(()=>n(),l=>n(l)),closeOnSelect:Z.with(()=>a())}),f=m(()=>je(i,d.props));var u=L(),c=C(u);{var p=l=>{var g=L(),b=C(g);pe(b,()=>e.child,()=>({props:r(f)})),_(l,g)},v=l=>{var g=Ds();we(g,()=>({...r(f)}));var b=y(g);pe(b,()=>e.children??le),w(g),_(l,g)};G(c,l=>{e.child?l(p):l(v,!1)})}_(t,u),me()}var Rs=R("<div><!></div>");function Ns(t,e){ge(e,!0);let n=q(e,"ref",15,null),o=q(e,"id",19,at),s=Ee(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const h=As({id:Z.with(()=>o()),ref:Z.with(()=>n(),c=>n(c))}),a=m(()=>je(s,h.props));var i=L(),d=C(i);{var f=c=>{var p=L(),v=C(p);pe(v,()=>e.child,()=>({props:r(a)})),_(c,p)},u=c=>{var p=Rs();we(p,()=>({...r(a)}));var v=y(p);pe(v,()=>e.children??le),w(p),_(c,p)};G(d,c=>{e.child?c(f):c(u,!1)})}_(t,i),me()}var Ls=R("<div><!></div>");function br(t,e){ge(e,!0);let n=q(e,"ref",15,null),o=q(e,"id",19,at),s=Ee(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const h=Ts({id:Z.with(()=>o()),ref:Z.with(()=>n(),c=>n(c))}),a=m(()=>je(s,h.props));var i=L(),d=C(i);{var f=c=>{var p=L(),v=C(p);pe(v,()=>e.child,()=>({props:r(a)})),_(c,p)},u=c=>{var p=Ls();we(p,()=>({...r(a)}));var v=y(p);pe(v,()=>e.children??le),w(p),_(c,p)};G(d,c=>{e.child?c(f):c(u,!1)})}_(t,i),me()}var zs=R("<div><!></div>");function Hs(t,e){ge(e,!0);let n=q(e,"ref",15,null),o=q(e,"checked",15,!1),s=q(e,"id",19,at),h=q(e,"onCheckedChange",3,Ke),a=q(e,"disabled",3,!1),i=q(e,"onSelect",3,Ke),d=q(e,"closeOnSelect",3,!0),f=q(e,"indeterminate",15,!1),u=q(e,"onIndeterminateChange",3,Ke),c=q(e,"value",3,""),p=Ee(e,["$$slots","$$events","$$legacy","child","children","ref","checked","id","onCheckedChange","disabled","onSelect","closeOnSelect","indeterminate","onIndeterminateChange","value"]);const v=or.getOr(null);v&&c()&&(v.opts.value.current.includes(c())?o(!0):o(!1)),tt.pre(()=>c(),()=>{v&&c()&&(v.opts.value.current.includes(c())?o(!0):o(!1))});const l=Os({checked:Z.with(()=>o(),P=>{o(P),h()(P)}),id:Z.with(()=>s()),disabled:Z.with(()=>a()),onSelect:Z.with(()=>g),ref:Z.with(()=>n(),P=>n(P)),closeOnSelect:Z.with(()=>d()),indeterminate:Z.with(()=>f(),P=>{f(P),u()(P)}),value:Z.with(()=>c())},v);function g(P){i()(P),!P.defaultPrevented&&l.toggleChecked()}const b=m(()=>je(p,l.props));var x=L(),$=C(x);{var N=P=>{var D=L(),O=C(D);{let M=m(()=>({props:r(b),...l.snippetProps}));pe(O,()=>e.child,()=>r(M))}_(P,D)},I=P=>{var D=zs();we(D,()=>({...r(b)}));var O=y(D);pe(O,()=>e.children??le,()=>l.snippetProps),w(D),_(P,D)};G($,P=>{e.child?P(N):P(I,!1)})}_(t,x),me()}var qs=R("<div><!></div>");function Ks(t,e){ge(e,!0);let n=q(e,"id",19,at),o=q(e,"ref",15,null),s=q(e,"value",31,()=>Xt([])),h=q(e,"onValueChange",3,Ke),a=Ee(e,["$$slots","$$events","$$legacy","id","children","child","ref","value","onValueChange"]);const i=Es({value:Z.with(()=>et(s()),v=>{s(et(v)),h()(v)}),onValueChange:Z.with(()=>h()),ref:Z.with(()=>o(),v=>o(v)),id:Z.with(()=>n())}),d=m(()=>je(a,i.props));var f=L(),u=C(f);{var c=v=>{var l=L(),g=C(l);pe(g,()=>e.child,()=>({props:r(d)})),_(v,l)},p=v=>{var l=qs();we(l,()=>({...r(d)}));var g=y(l);pe(g,()=>e.children??le),w(l),_(v,l)};G(u,v=>{e.child?v(c):v(p,!1)})}_(t,f),me()}function Gs(t,e){ge(e,!0);let n=q(e,"open",15,!1),o=q(e,"dir",3,"ltr"),s=q(e,"onOpenChange",3,Ke),h=q(e,"_internal_variant",3,"dropdown-menu");const a=Ps({variant:Z.with(()=>h()),dir:Z.with(()=>o()),onClose:()=>{n(!1),s()(!1)}});Ss(a,{open:Z.with(()=>n(),i=>{n(i),s()(i)})}),Zn(t,{children:(i,d)=>{var f=L(),u=C(f);pe(u,()=>e.children??le),_(i,f)},$$slots:{default:!0}}),me()}var js=R("<div><div><!></div></div>"),Us=R("<!> <!>",1),Bs=R("<div><div><!></div></div>"),Ws=R("<!> <!>",1);function Vs(t,e){ge(e,!0);let n=q(e,"id",19,at),o=q(e,"ref",15,null),s=q(e,"loop",3,!0),h=q(e,"onInteractOutside",3,Ke),a=q(e,"onEscapeKeydown",3,Ke),i=q(e,"onCloseAutoFocus",3,Ke),d=q(e,"forceMount",3,!1),f=Ee(e,["$$slots","$$events","$$legacy","id","child","children","ref","loop","onInteractOutside","onEscapeKeydown","onCloseAutoFocus","forceMount"]);const u=$s({id:Z.with(()=>n()),loop:Z.with(()=>s()),ref:Z.with(()=>o(),$=>o($)),onCloseAutoFocus:Z.with(()=>i())}),c=m(()=>je(f,u.props));function p($){u.handleInteractOutside($),!$.defaultPrevented&&(h()($),!$.defaultPrevented&&u.parentMenu.onClose())}function v($){a()($),!$.defaultPrevented&&u.parentMenu.onClose()}var l=L(),g=C(l);{var b=$=>{eo($,ft(()=>r(c),()=>u.popperProps,{get enabled(){return u.parentMenu.opts.open.current},onInteractOutside:p,onEscapeKeydown:v,trapFocus:!0,get loop(){return s()},forceMount:!0,get id(){return n()},popper:(I,P)=>{let D=()=>P?.().props,O=()=>P?.().wrapperProps;const M=m(()=>je(D(),{style:vr("dropdown-menu")}));var S=Us(),A=C(S);{var U=F=>{var V=L(),J=C(V);{let ee=m(()=>({props:r(M),wrapperProps:O(),...u.snippetProps}));pe(J,()=>e.child,()=>r(ee))}_(F,V)},B=F=>{var V=js();we(V,()=>({...O()}));var J=y(V);we(J,()=>({...r(M)}));var ee=y(J);pe(ee,()=>e.children??le),w(J),w(V),_(F,V)};G(A,F=>{e.child?F(U):F(B,!1)})}var H=k(A,2);mr(H,{get mounted(){return u.mounted},set mounted(F){u.mounted=F}}),_(I,S)},$$slots:{popper:!0}}))},x=$=>{var N=L(),I=C(N);{var P=D=>{to(D,ft(()=>r(c),()=>u.popperProps,{get present(){return u.parentMenu.opts.open.current},onInteractOutside:p,onEscapeKeydown:v,trapFocus:!0,get loop(){return s()},forceMount:!1,get id(){return n()},popper:(M,S)=>{let A=()=>S?.().props,U=()=>S?.().wrapperProps;const B=m(()=>je(A(),{style:vr("dropdown-menu")}));var H=Ws(),F=C(H);{var V=te=>{var de=L(),fe=C(de);{let ve=m(()=>({props:r(B),wrapperProps:U(),...u.snippetProps}));pe(fe,()=>e.child,()=>r(ve))}_(te,de)},J=te=>{var de=Bs();we(de,()=>({...U()}));var fe=y(de);we(fe,()=>({...r(B)}));var ve=y(fe);pe(ve,()=>e.children??le),w(fe),w(de),_(te,de)};G(F,te=>{e.child?te(V):te(J,!1)})}var ee=k(F,2);mr(ee,{get mounted(){return u.mounted},set mounted(te){u.mounted=te}}),_(M,H)},$$slots:{popper:!0}}))};G(I,D=>{d()||D(P)},!0)}_($,N)};G(g,$=>{d()?$(b):$(x,!1)})}_(t,l),me()}var Xs=R("<button><!></button>");function Ys(t,e){ge(e,!0);let n=q(e,"id",19,at),o=q(e,"ref",15,null),s=q(e,"disabled",3,!1),h=q(e,"type",3,"button"),a=Ee(e,["$$slots","$$events","$$legacy","id","ref","child","children","disabled","type"]);const i=Cs({id:Z.with(()=>n()),disabled:Z.with(()=>s()??!1),ref:Z.with(()=>o(),f=>o(f))}),d=m(()=>je(a,i.props,{type:h()}));ro(t,{get id(){return n()},children:(f,u)=>{var c=L(),p=C(c);{var v=g=>{var b=L(),x=C(b);pe(x,()=>e.child,()=>({props:r(d)})),_(g,b)},l=g=>{var b=Xs();we(b,()=>({...r(d)}));var x=y(b);pe(x,()=>e.children??le),w(b),_(g,b)};G(p,g=>{e.child?g(v):g(l,!1)})}_(f,c)},$$slots:{default:!0}}),me()}let mt=se(!1);class Ze{static _refs=0;static _cleanup;constructor(){Te(()=>(Ze._refs===0&&(Ze._cleanup=un(()=>{const e=[],n=s=>{T(mt,!1)},o=s=>{T(mt,!0)};return e.push(dt(document,"pointerdown",n,{capture:!0}),dt(document,"pointermove",n,{capture:!0}),dt(document,"keydown",o,{capture:!0})),Dr(...e)})),Ze._refs++,()=>{Ze._refs--,Ze._refs===0&&(T(mt,!1),Ze._cleanup?.())}))}get current(){return r(mt)}set current(e){T(mt,e,!0)}}var Js=R("<!> <!>",1),Qs=R("<!> <!>",1),Zs=R("<!> <!>",1),ea=R("<!> <!>",1);function Yr(t,e){ge(e,!0);const n=q(e,"selectableItems",19,()=>[]),o=q(e,"help",3,""),s=Ee(e,["$$slots","$$events","$$legacy","items","item","selectableItems","trigger","testid","help"]),h=m(()=>({trigger:e.testid?`${e.testid}-open`:void 0,content:e.testid?`${e.testid}-options`:void 0}));let a=se(!1);var i=L(),d=C(i);qe(d,()=>Gs,(f,u)=>{u(f,{get open(){return r(a)},children:(c,p)=>{var v=ea(),l=C(v);{const b=(x,$)=>{let N=()=>$?.().props;var I=L(),P=C(I);{let D=m(()=>({...N(),onclick:()=>{T(a,!r(a))}}));pe(P,()=>e.trigger,()=>r(D))}_(x,I)};qe(l,()=>Ys,(x,$)=>{$(x,ft(()=>s,{get"data-testid"(){return r(h).trigger},child:b,$$slots:{child:!0}}))})}var g=k(l,2);qe(g,()=>es,(b,x)=>{x(b,{children:($,N)=>{var I=L(),P=C(I);qe(P,()=>Vs,(D,O)=>{O(D,{get"data-testid"(){return r(h).content},children:(M,S)=>{var A=Zs(),U=C(A);{let H=m(()=>n().filter(F=>F.selected).map(F=>F.key.toString()));qe(U,()=>Ks,(F,V)=>{V(F,{get value(){return r(H)},children:(J,ee)=>{var te=Js(),de=C(te);{var fe=re=>{var ne=L(),ye=C(ne);qe(ye,()=>br,(ce,he)=>{he(ce,{children:(_e,ke)=>{Ae();var Se=ue();z(()=>E(Se,o())),_(_e,Se)},$$slots:{default:!0}})}),_(re,ne)};G(de,re=>{o()&&re(fe)})}var ve=k(de,2);ot(ve,17,n,re=>re.label,(re,ne)=>{var ye=L(),ce=C(ye);{let he=m(()=>r(ne).key.toString());qe(ce,()=>Hs,(_e,ke)=>{ke(_e,{get checked(){return r(ne).selected},get onSelect(){return r(ne).onclick},get value(){return r(he)},get textValue(){return r(ne).label},get"aria-label"(){return r(ne).label},children:(Se,Be)=>{var ze=L(),He=C(ze);{var Ce=Oe=>{var Re=L(),j=C(Re);pe(j,()=>e.item,()=>r(ne)),_(Oe,Re)},Ie=Oe=>{var Re=ue();z(()=>E(Re,r(ne).label)),_(Oe,Re)};G(He,Oe=>{e.item?Oe(Ce):Oe(Ie,!1)})}_(Se,ze)},$$slots:{default:!0}})})}_(re,ye)}),_(J,te)},$$slots:{default:!0}})})}var B=k(U,2);qe(B,()=>Ns,(H,F)=>{F(H,{children:(V,J)=>{var ee=Qs(),te=C(ee);{var de=ve=>{var re=L(),ne=C(re);qe(ne,()=>br,(ye,ce)=>{ce(ye,{children:(he,_e)=>{Ae();var ke=ue();z(()=>E(ke,o())),_(he,ke)},$$slots:{default:!0}})}),_(ve,re)};G(te,ve=>{o()&&!n().length&&ve(de)})}var fe=k(te,2);ot(fe,17,()=>e.items,ve=>ve.label,(ve,re)=>{var ne=L(),ye=C(ne);qe(ye,()=>Fs,(ce,he)=>{he(ce,{get textValue(){return r(re).label},get onSelect(){return r(re).onclick},get"aria-label"(){return r(re).label},children:(_e,ke)=>{var Se=L(),Be=C(Se);{var ze=Ce=>{var Ie=L(),Oe=C(Ie);pe(Oe,()=>e.item,()=>r(re)),_(Ce,Ie)},He=Ce=>{var Ie=ue();z(()=>E(Ie,r(re).label)),_(Ce,Ie)};G(Be,Ce=>{e.item?Ce(ze):Ce(He,!1)})}_(_e,Se)},$$slots:{default:!0}})}),_(ve,ne)}),_(V,ee)},$$slots:{default:!0}})}),_(M,A)},$$slots:{default:!0}})}),_($,I)},$$slots:{default:!0}})}),_(c,v)},$$slots:{default:!0}})}),_(t,i),me()}var ta=R("<time><!></time>");function ra(t,e){ge(e,!0);const n=q(e,"show",3,"absolute"),o=Ee(e,["$$slots","$$events","$$legacy","value","show"]),s=m(()=>typeof e.value=="string"?new Date(e.value):e.value),h=m(()=>io(r(s),"PPpp")),a=m(()=>Do(r(s),{addSuffix:!0}));var i=ta();we(i,c=>({...o,datetime:c}),[()=>r(s).toISOString()]);var d=y(i);{var f=c=>{var p=ue();z(()=>E(p,r(h))),_(c,p)},u=c=>{var p=L(),v=C(p);{var l=b=>{var x=ue();z(()=>E(x,r(a))),_(b,x)},g=b=>{var x=ue();z(()=>E(x,`${r(h)??""} (${r(a)??""})`)),_(b,x)};G(v,b=>{n()=="relative"?b(l):b(g,!1)},!0)}_(c,p)};G(d,c=>{n()==="absolute"?c(f):c(u,!1)})}w(i),_(t,i),me()}var na=R('<a class="github-user svelte-yvr6h4"><img class="svelte-yvr6h4"/> <!></a>'),oa=R("<!> <!> <!> <!> <!>",1),sa=R('<span class="build-date"> </span>'),aa=R(" <a> </a> <!>",1),ia=R('<li class="svelte-yvr6h4"><!></li>'),la=R('<!> <p class="svelte-yvr6h4"> </p> <ul><li class="svelte-yvr6h4"> <a> </a> <!></li> <!> <br/></ul> <p class="svelte-yvr6h4"> </p>',1),ca=R("<a><!></a>"),ua=R('<p class="svelte-yvr6h4"><!></p>');function da(t,e){ge(e,!0);const n=(d,f=le)=>{var u=na(),c=y(u),p=k(c,2);rt(p,()=>fetch(f().url).then(v=>v.json()),v=>{var l=ue();z(()=>E(l,f().login)),_(v,l)},(v,l)=>{var g=m(()=>{var{name:$}=r(l);return{name:$}}),b=m(()=>r(g).name),x=ue();z(()=>E(x,r(b)||f().login)),_(v,x)},(v,l)=>{var g=ue();z(()=>E(g,f().login)),_(v,g)}),w(u),z(v=>{Me(u,"href",f().html_url),Me(u,"title",`@${f().login}`),Me(c,"src",f().avatar_url),Me(c,"alt",v)},[()=>r(o).t(41,[f().login])]),_(d,u)},o=m(()=>Ye(Je("main"))),s="06298c514f2980d10efe886d32c7fe2d7555b94e";let h=q(e,"open",15);function a(d){return`https://cigaleapp.github.io/cigale/${d}/pr-${We}`}async function i(d){return fetch(a(d),{method:"HEAD"}).then(f=>f.ok).catch(()=>!1)}{const d=(u,c)=>{let p=()=>c?.().close;const v=m(()=>I=>()=>{window.open(I),p()?.()});var l=oa(),g=C(l);{let I=m(()=>r(o).t(169));Ve(g,{get help(){return r(I)},onclick:()=>{Cn(),window.location.reload()},children:(P,D)=>{Ae();var O=ue();z(M=>E(O,M),[()=>r(o).t(136)]),_(P,O)},$$slots:{default:!0}})}var b=k(g,2);{let I=m(()=>r(v)(`https://github.com/cigaleapp/cigale/pull/${We}`));Ve(b,{get onclick(){return r(I)},children:(P,D)=>{Ae();var O=ue();z(M=>E(O,M),[()=>r(o).t(192)]),_(P,O)},$$slots:{default:!0}})}var x=k(b,2);rt(x,()=>i("_playwright"),null,(I,P)=>{var D=L(),O=C(D);{var M=S=>{{let A=m(()=>r(v)(a("_playwright")));Ve(S,{get onclick(){return r(A)},children:(U,B)=>{Ae();var H=ue();z(F=>E(H,F),[()=>r(o).t(182)]),_(U,H)},$$slots:{default:!0}})}};G(O,S=>{r(P)&&S(M)})}_(I,D)});var $=k(x,2);rt($,()=>i("_vitest"),null,(I,P)=>{var D=L(),O=C(D);{var M=S=>{{let A=m(()=>r(v)(a("_vitest")));Ve(S,{get onclick(){return r(A)},children:(U,B)=>{Ae();var H=ue();z(F=>E(H,F),[()=>r(o).t(183)]),_(U,H)},$$slots:{default:!0}})}};G(O,S=>{r(P)&&S(M)})}_(I,D)});var N=k($,2);rt(N,()=>i("_coverage"),null,(I,P)=>{var D=L(),O=C(D);{var M=S=>{{let A=m(()=>r(v)(a("_coverage")));Ve(S,{get onclick(){return r(A)},children:(U,B)=>{Ae();var H=ue();z(F=>E(H,F),[()=>r(o).t(73)]),_(U,H)},$$slots:{default:!0}})}};G(O,S=>{r(P)&&S(M)})}_(I,D)}),_(u,l)};let f=m(()=>r(o).t(79,[We]));Tt(t,{key:"modal_preview_pr",get title(){return r(f)},get open(){return h()},set open(u){h(u)},footer:d,children:(u,c)=>{const p=m(()=>`https://github.com/cigaleapp/cigale/pull/${We}`);var v=L(),l=C(v);rt(l,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/pulls/${We}`).then(g=>g.json()),g=>{var b=ua();{const $=(N,I=le)=>{var P=ca(),D=y(P);{let O=m(()=>[We]);Le(D,{get x(){return I()},n:!0,get a(){return r(O)}})}w(P),z(()=>Me(P,"href",r(p))),_(N,P)};var x=y(b);{let N=m(()=>[$]),I=m(()=>r(o).cx(78));Le(x,{get t(){return r(N)},get x(){return r(I)}})}w(b)}_(g,b)},(g,b)=>{var x=m(()=>{var{title:re,user:ne,body:ye}=r(b);return{title:re,user:ne,body:ye}}),$=m(()=>r(x).title),N=m(()=>r(x).user),I=m(()=>r(x).body);const P=m(()=>/(Closes|Fixes) #(\d+)/i.exec(r(I))?.[2]);var D=la(),O=C(D);{var M=re=>{var ne=L(),ye=C(ne);rt(ye,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/commits/${s}`).then(ce=>ce.json()),ce=>{var he=sa(),_e=y(he,!0);w(he),z(ke=>E(_e,ke),[()=>r(o).t(59)]),_(ce,he)},(ce,he)=>{var _e=m(()=>{var{commit:{committer:{date:Se}}}=r(he);return{date:Se}}),ke=m(()=>r(_e).date);ra(ce,{get value(){return r(ke)},show:"both"})}),_(re,ne)};G(O,re=>{re(M)})}var S=k(O,2),A=y(S,!0);w(S);var U=k(S,2),B=y(U),H=y(B),F=k(H),V=y(F);w(F);var J=k(F),ee=k(J);n(ee,()=>r(N)),w(B);var te=k(B,2);{var de=re=>{var ne=ia(),ye=y(ne);rt(ye,()=>fetch(`https://api.github.com/repos/cigaleapp/cigale/issues/${r(P)}`).then(ce=>ce.json()),null,(ce,he)=>{var _e=m(()=>{var{title:oe,number:ae,user:be,html_url:Ne}=r(he);return{title:oe,number:ae,user:be,html_url:Ne}}),ke=m(()=>r(_e).title),Se=m(()=>r(_e).number),Be=m(()=>r(_e).user),ze=m(()=>r(_e).html_url),He=aa(),Ce=C(He),Ie=k(Ce),Oe=y(Ie);w(Ie);var Re=k(Ie),j=k(Re);n(j,()=>r(Be)),z((oe,ae)=>{E(Ce,`${oe??""} `),Me(Ie,"href",r(ze)),E(Oe,`#${r(Se)??""} ${r(ke)??""}`),E(Re,` ${ae??""} `)},[()=>r(o).t(199),()=>r(o).t(196)]),_(ce,He)}),w(ne),_(re,ne)};G(te,re=>{r(P)&&re(de)})}Ae(2),w(U);var fe=k(U,2),ve=y(fe,!0);w(fe),z((re,ne,ye)=>{E(A,re),E(H,`${ne??""} `),Me(F,"href",r(p)),E(V,`#${We} ${r($)??""}`),E(J,` ${ye??""} `),E(ve,r(I))},[()=>r(o).t(52),()=>r(o).t(200),()=>r(o).t(196)]),_(g,D)},(g,b)=>{var x=ue();z(()=>E(x,`#${We}`)),_(g,x)}),_(u,v)},$$slots:{footer:!0,default:!0}})}me()}var fa=R('<button role="radio" class="option svelte-13njdm8"> </button>'),va=R("<div></div>");function Vt(t,e){ge(e,!0);let n=q(e,"value",15),o=Ee(e,["$$slots","$$events","$$legacy","options","labels","value","customOption","clickable-custom-options","onchange"]);var s=va();we(s,()=>({class:"segmented-group",role:"radiogroup",...o}),void 0,void 0,"svelte-13njdm8"),ot(s,20,()=>e.options,h=>h,(h,a)=>{var i=L(),d=C(i);{var f=c=>{var p=fa();p.__click=()=>{n(a),e.onchange?.(a)};var v=y(p,!0);w(p),z(()=>{Me(p,"aria-checked",a===n()),E(v,e.labels?.[a]??a)}),_(c,p)},u=c=>{var p=L(),v=C(p);vo(v,()=>e["clickable-custom-options"]?"button":"div",!1,(l,g)=>{var b=()=>{e["clickable-custom-options"]&&(n(a),e.onchange?.(a))};we(l,()=>({role:"radio","aria-checked":a===n(),class:"option",onclick:b}),void 0,void 0,"svelte-13njdm8");var x=L(),$=C(x);pe($,()=>e.customOption,()=>a),_(g,x)}),_(c,p)};G(d,c=>{!e.customOption||e.labels?.[a]?c(f):c(u,!1)})}_(h,i)}),w(s),_(t,s),me()}Yt(["click"]);var pa=R('<!> <section class="progress svelte-1h3fgf1"><!></section> <!>',1),ha=R('<div class="numeric svelte-1h3fgf1"><!> </div>'),ga=R('<div class="include svelte-1h3fgf1"><!></div> <section><div class="label svelte-1h3fgf1"> </div> <!> <p class="fineprint svelte-1h3fgf1"> </p></section>',1),ma=R('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function _a(t,e){ge(e,!0);const n=m(()=>Ye(Je("main")));let o=q(e,"open",15);const s=m(()=>W.processing.progress);let h=se(!1),a=se("croppedonly"),i=m(()=>gt(W.currentProtocol?.crop.padding??"0px")),d=m(()=>r(i).unitless===0?"none":r(i).unit==="px"?"customPixels":r(i).unitless===5?"small":r(i).unitless===10?"medium":"customPercent");Te(()=>{switch(r(d)){case"none":T(i,gt("0px"));break;case"small":T(i,gt("5%"));break;case"medium":T(i,gt("10%"));break}});async function f(){await De.clear("exporter"),W.processing.reset(),T(h,!0);const p=Ue.Protocol.state.find(v=>v.id===W.currentProtocolId);if(!p){De.error(r(n).t(35)),T(h,!1);return}try{await Nn(),W.processing.task="export",W.processing.total=1,W.processing.done=0;const v=await e.swarpc.generateResultsZip({include:r(a),protocolId:p.id,cropPadding:r(i).withUnit,jsonSchemaURL:new URL(Mn("/results.schema.json"),Xe.url.origin).toString()},({warning:l,progress:g})=>{if(l){const[b,{filename:x}]=l;switch(b){case"exif-write-error":De.warn(`Impossible d'ajouter les métadonnées EXIF à l'image ${x}`);break}}g&&(W.processing.done=g)});co(v,"results.zip","application/zip")}catch(v){console.error(v),De.error(`Erreur lors de l'exportation des résultats: ${v}`)}finally{T(h,!1)}}var u=ma(),c=C(u);{const p=l=>{var g=pa(),b=C(g);An(b,{pool:"exporter"});var x=k(b,2),$=y(x);tr($,{percentage:!0,alwaysActive:!0,get progress(){return r(s)}}),w(x);var N=k(x,2);{const I=P=>{var D=L(),O=C(D);{var M=A=>{Hr(A,{})},S=A=>{lo(A,{})};G(O,A=>{r(h)?A(M):A(S,!1)})}_(P,D)};Ve(N,{onclick:f,_w_snippet_0:I,children:(P,D)=>{{let O=m(()=>[I]),M=m(()=>r(n).cx(21));Le(P,{get t(){return r(O)},get x(){return r(M)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}_(l,g)};let v=m(()=>r(n).t(95));xt(c,()=>({"--footer-direction":"column"})),Tt(c.lastChild,{key:"modal_export_results",get title(){return r(v)},onopen:()=>{De.setCurrentPool("exporter")},onclose:()=>{De.setCurrentPool("default"),W.processing.reset()},get open(){return o()},set open(l){o(l)},footer:p,children:(l,g)=>{var b=ga(),x=C(b),$=y(x);fo($,{options:[{key:"metadataonly",label:"Métadonnées seulement"},{key:"croppedonly",label:"Métadonnées et images recadrées"},{key:"full",label:"Métadonnées, images recadrées et images originales",subtext:"Permet de ré-importer les résultats ultérieurement"}],get value(){return r(a)},set value(A){T(a,A,!0)}}),w(x);var N=k(x,2);let I;var P=y(N),D=y(P,!0);w(P);var O=k(P,2);Vt(O,{options:["none","small","medium","customPercent","customPixels"],labels:{none:"Aucune",small:"5%",medium:"10%"},get value(){return r(d)},set value(U){T(d,U)},customOption:(U,B=le)=>{const H=m(()=>B()==="customPercent"?"%":"px");var F=ha();let V;var J=y(F);{let te=m(()=>B()==="customPercent"?"en pourcentage des dimensions de l'image":"en pixels"),de=m(()=>r(i).unitless===0?"0":r(i).unit===r(H)?r(i).unitless.toString():"?");zr(J,{get label(){return r(te)},get value(){return r(de)},onblur:async fe=>{await dn();const ve=Number.parseInt(fe,10);!isNaN(ve)&&ve>0&&(T(i,gt(ve+r(H))),T(d,B()))}})}var ee=k(J);w(F),z(()=>{V=Mr(F,"",V,{"--width":r(H)==="%"?"3ch":"4ch"}),E(ee,` ${r(H)??""}`)}),_(U,F)},$$slots:{customOption:!0}});var M=k(O,2),S=y(M,!0);w(M),w(N),z((A,U)=>{I=_t(N,1,"crop-padding svelte-1h3fgf1",null,I,{irrelevant:r(a)==="metadataonly"}),E(D,A),E(S,U)},[()=>r(n).t(126),()=>r(n).t(190)]),_(l,b)},$$slots:{footer:!0,default:!0}}),w(c)}_(t,u),me()}var ba=st('<svg><path fill="currentColor" d="M18.207 9.043L12 2.836L5.793 9.043l1.414 1.414L12 5.664l4.793 4.793zM5.793 14.957L12 21.164l6.207-6.207l-1.414-1.414L12 18.336l-4.793-4.793z"></path></svg>');function wa(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=ba();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var ya=R("<button><!> <!></button>"),xa=R('<code class="svelte-1b302ru"> </code>'),Ma=R("<!> <!>",1),ka=R('<div class="item svelte-1b302ru"><div class="label svelte-1b302ru"><div class="icon svelte-1b302ru"><!></div> </div> <div class="version svelte-1b302ru"><!></div></div>');function Pa(t,e){ge(e,!0);const n=m(()=>Ye(Je("main")));{const o=(a,i=le)=>{var d=ya();we(d,()=>({class:"trigger",...i(),[bn]:{"none-selected":!W.currentProtocol}}),void 0,void 0,"svelte-1b302ru");var f=y(d);{var u=v=>{var l=ue();z(()=>E(l,W.currentProtocol?.name)),_(v,l)},c=v=>{var l=ue();z(g=>E(l,g),[()=>r(n).t(35)]),_(v,l)};G(f,v=>{W.currentProtocol?v(u):v(c,!1)})}var p=k(f,2);wa(p,{}),w(d),_(a,d)},s=(a,i)=>{let d=()=>i?.().label,f=()=>i?.().protocol;var u=ka(),c=y(u),p=y(c),v=y(p);{var l=I=>{Lr(I,{})},g=I=>{var P=L(),D=C(P);{var O=M=>{po(M,{})};G(D,M=>{f()||M(O)},!0)}_(I,P)};G(v,I=>{W.currentProtocolId===f()?.id?I(l):I(g,!1)})}w(p);var b=k(p);w(c);var x=k(c,2),$=y(x);{var N=I=>{var P=Ma(),D=C(P);{var O=S=>{var A=xa(),U=y(A);w(A),Sr(A,(B,H)=>Cr?.(B,H),()=>"Version du protocole"),z(()=>E(U,`v${f().version??""}`)),_(S,A)};G(D,S=>{f().version&&S(O)})}var M=k(D,2);so(M,ft({compact:!0},f)),_(I,P)};G($,I=>{f()&&I(N)})}w(x),w(u),z(()=>E(b,` ${d()??""}`)),_(a,u)};let h=m(()=>Ue.Protocol.state.map(a=>({protocol:a,key:a.id,label:a.name,selected:W.currentProtocolId===a.id,onclick(){W.setCurrentProtocolId(a.id)}})));Yr(t,{testid:"protocol-switcher",items:[{protocol:null,label:"Gérer les protocoles",onclick(){lt("/protocols")}}],get selectableItems(){return r(h)},trigger:o,item:s,$$slots:{trigger:!0,item:!0}})}me()}var Sa=st('<svg><path fill="currentColor" d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2h.1A6.98 6.98 0 0 0 10 7m-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938A8 8 0 0 0 4 12"></path></svg>');function Ca(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=Sa();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var $a=st('<svg><path fill="currentColor" d="M3.34 17a10 10 0 0 1-.979-2.326a3 3 0 0 0 .003-5.347a10 10 0 0 1 2.5-4.337a3 3 0 0 0 4.632-2.674a10 10 0 0 1 5.007.003a3 3 0 0 0 4.632 2.671a10.06 10.06 0 0 1 2.503 4.336a3 3 0 0 0-.002 5.347a10 10 0 0 1-2.501 4.337a3 3 0 0 0-4.632 2.674a10 10 0 0 1-5.007-.002a3 3 0 0 0-4.631-2.672A10 10 0 0 1 3.339 17m5.66.196a5 5 0 0 1 2.25 2.77q.75.07 1.499.002a5 5 0 0 1 2.25-2.772a5 5 0 0 1 3.526-.564q.435-.614.748-1.298A5 5 0 0 1 18 12c0-1.26.47-2.437 1.273-3.334a8 8 0 0 0-.75-1.298A5 5 0 0 1 15 6.804a5 5 0 0 1-2.25-2.77q-.75-.071-1.5-.001A5 5 0 0 1 9 6.804a5 5 0 0 1-3.526.564q-.436.614-.747 1.298A5 5 0 0 1 6 12c0 1.26-.471 2.437-1.273 3.334a8 8 0 0 0 .75 1.298A5 5 0 0 1 9 17.196M12 15a3 3 0 1 1 0-6a3 3 0 0 1 0 6m0-2a1 1 0 1 0 0-2a1 1 0 0 0 0 2"></path></svg>');function Ia(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=$a();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Oa=st('<svg><path fill="currentColor" d="m19 3l4 5h-3v12h-2V8h-3zm-5 15v2H3v-2zm0-7v2H3v-2zm-2-7v2H3V4z"></path></svg>');function Aa(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=Oa();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ta=st('<svg><path fill="currentColor" d="M20 4v12h3l-4 5l-4-5h3V4zm-8 14v2H3v-2zm2-7v2H3v-2zm0-7v2H3V4z"></path></svg>');function Ea(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=Ta();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Da=st('<svg><path fill="currentColor" d="M5 11v2h14v-2z"></path></svg>');function Fa(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=Da();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var Ra=st('<svg><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12a6 6 0 0 1 0 12m0-2a4 4 0 1 0 0-8a4 4 0 0 0 0 8M11 1h2v3h-2zm0 19h2v3h-2zM3.515 4.929l1.414-1.414L7.05 5.636L5.636 7.05zM16.95 18.364l1.414-1.414l2.121 2.121l-1.414 1.414zm2.121-14.85l1.414 1.415l-2.121 2.121l-1.414-1.414zM5.636 16.95l1.414 1.414l-2.121 2.121l-1.414-1.414zM23 11v2h-3v-2zM4 11v2H1v-2z"></path></svg>');function Na(t,e){const n=Ee(e,["$$slots","$$events","$$legacy"]);var o=Ra();we(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...n})),_(t,o)}var La=R('<p class="details svelte-qprabs"> </p>'),za=R('<p class="details svelte-qprabs"> </p>'),Ha=R("<a> </a>"),qa=R("<a> </a>"),Ka=R('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <dialog class="container svelte-qprabs" data-testid="app-settings"><header class="svelte-qprabs"> </header> <div class="listParam svelte-qprabs"><div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><input type="range" min="0.5" max="2" step="0.01" list="gridsize-marks"/> <datalist id="gridsize-marks"><option></option></datalist></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!> <div class="number-input svelte-qprabs"><!></div> <!></div></div> <section class="actions svelte-qprabs"><!> <!></section> <footer class="svelte-qprabs"><!></footer></dialog>',1);function Ga(t,e){ge(e,!0);const n=m(()=>Ye(Je("main")));let o=se(!1),s=se(void 0);const h=m(()=>Ut()&&bt().notifications);Te(()=>{window.addEventListener("mouseup",({target:K})=>{K!==r(s)&&(r(s)?.contains(K)||T(o,!1))})});const a=m(bt),i=m(()=>r(a).theme),d=m(()=>r(a).showTechnicalMetadata),f=m(()=>r(a).gallerySort),u=m(()=>r(a).gridSize),c=m(()=>r(a).language),p=m(()=>r(a).parallelism);let v=se(!0);Te(()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",K=>{T(v,!K.matches)})});const l=m(()=>{const K=bt().theme;return K==="auto"?r(v)?"light":"dark":K});kr(()=>r(l),K=>{window.nativeWindow?.setControlsColor(getComputedStyle(document.documentElement).getPropertyValue(`--${K}__fg-primary`))});var g=Ka(),b=C(g);{let K=m(()=>r(o)?"Fermer":"Réglages");xt(b,()=>({"--fg":"var(--trigger-fg)","--bg":"var(--trigger-bg)","--hover-fg":"var(--trigger-hover-fg)","--hover-bg":"var(--trigger-hover-bg)"})),ut(b.lastChild,{"data-testid":"settings-button",get help(){return r(K)},onclick:()=>{T(o,!r(o))},children:(Y,Q)=>{var X=L(),ie=C(X);{var xe=$e=>{mo($e,{})},Qe=$e=>{Ia($e,{})};G(ie,$e=>{r(o)?$e(xe):$e(Qe,!1)})}_(Y,X)},$$slots:{default:!0}}),w(b)}var x=k(b,2),$=y(x),N=y($,!0);w($);var I=k($,2),P=y(I),D=y(P,!0);w(P);var O=k(P,2),M=y(O);{let K=m(()=>r(i)==="auto"?r(v):r(i)==="light"),Y=m(()=>({on:Na,off:Ca}));zt(M,{get value(){return r(K)},onchange:async Q=>{await Fe("theme",Q?"light":"dark")},get icons(){return r(Y)}})}var S=k(M,2);{let K=m(()=>r(i)==="auto"),Y=m(()=>r(n).t(176));ut(S,{get disabled(){return r(K)},onclick:async()=>await Fe("theme","auto"),get help(){return r(Y)},children:(Q,X)=>{_o(Q,{})},$$slots:{default:!0}})}w(O);var A=k(O,2);{const K=(Y,Q=le)=>{var X=La(),ie=y(X,!0);w(X),z(xe=>E(ie,xe),[()=>r(n).tx(Q())]),_(Y,X)};var U=y(A);{let Y=m(()=>[K]),Q=m(()=>r(n).cx(387));Le(U,{get t(){return r(Y)},get x(){return r(Q)}})}w(A)}var B=k(A,2),H=y(B);zt(H,{"data-testid":"notifications",get value(){return r(h)},onchange:async K=>{K?(await Ir(),Fe("notifications",Ut())):Fe("notifications",!1)}}),w(B);var F=k(B,2),V=y(F,!0);w(F);var J=k(F,2),ee=y(J);zt(ee,{"data-testid":"debug-mode",get value(){return r(d)},onchange:async K=>{await Fe("showTechnicalMetadata",K)}}),w(J);var te=k(J,2),de=y(te,!0);w(te);var fe=k(te,2),ve=y(fe),re=()=>r(f).key,ne=K=>Fe("gallerySort",{...r(f),key:K});{let K=m(()=>r(n).t(144));Vt(ve,{get"aria-label"(){return r(K)},options:["filename","date"],get value(){return re()},set value(Y){ne(Y)},labels:{filename:"Fichier",date:"Date"}})}var ye=k(ve,2);{let K=m(()=>r(f).direction==="asc"?"Trier par ordre décroissant":"Trier par ordre croissant");ut(ye,{"data-testid":"toggle-sort-direction",onclick:async()=>await Fe("gallerySort",{...r(f),direction:r(f).direction==="asc"?"desc":"asc"}),get help(){return r(K)},children:(Y,Q)=>{var X=L(),ie=C(X);{var xe=$e=>{Aa($e,{})},Qe=$e=>{Ea($e,{})};G(ie,$e=>{r(f).direction==="asc"?$e(xe):$e(Qe,!1)})}_(Y,X)},$$slots:{default:!0}})}w(fe);var ce=k(fe,2),he=y(ce,!0);w(ce);var _e=k(ce,2),ke=y(_e);wn(ke);var Se=k(ke,2),Be=y(Se);Be.value=Be.__value="1",w(Se),w(_e);var ze=k(_e,2),He=y(ze,!0);w(ze);var Ce=k(ze,2),Ie=y(Ce);{const K=(Q,X=le)=>{const ie=m(()=>({en:"English",fr:"Français",ja:"日本語"}));Ae();var xe=ue();z(()=>E(xe,r(ie)[X()]||X())),_(Q,xe)};let Y=m(()=>r(n).t(122));Vt(Ie,{"data-testid":"language-selection",get"aria-label"(){return r(Y)},"clickable-custom-options":!0,options:["en","fr"],get value(){return r(c)},onchange:async Q=>{await Fe("language",Q),window.location.reload()},customOption:K,$$slots:{customOption:!0}})}w(Ce);var Oe=k(Ce,2);{const K=(Y,Q=le)=>{var X=za(),ie=y(X,!0);w(X),z(xe=>E(ie,xe),[()=>r(n).tx(Q())]),_(Y,X)};var Re=y(Oe);{let Y=m(()=>[K]),Q=m(()=>r(n).cx(372));Le(Re,{get t(){return r(Y)},get x(){return r(Q)}})}w(Oe)}var j=k(Oe,2),oe=y(j);{let K=m(()=>r(n).t(373));ut(oe,{get help(){return r(K)},onclick:async()=>{await Fe("parallelism",Math.max(1,r(p)-1))},children:(Y,Q)=>{Fa(Y,{})},$$slots:{default:!0}})}var ae=k(oe,2),be=y(ae);{let K=m(()=>r(n).t(374));zr(be,{get label(){return r(K)},get value(){return r(p)},onblur:async Y=>{await Fe("parallelism",Number.parseInt(Y))}})}w(ae);var Ne=k(ae,2);{let K=m(()=>r(n).t(375));ut(Ne,{get help(){return r(K)},onclick:async()=>{await Fe("parallelism",r(p)+1)},children:(Y,Q)=>{go(Y,{})},$$slots:{default:!0}})}w(j),w(I);var Pe=k(I,2),Ge=y(Pe);Ve(Ge,{onclick:()=>{e.openKeyboardShortcuts?.()},children:(K,Y)=>{Ae();var Q=ue();z(X=>E(Q,X),[()=>r(n).t(153)]),_(K,Q)},$$slots:{default:!0}});var Dt=k(Ge,2);{let K=m(()=>r(n).t(189));Ve(Dt,{get help(){return r(K)},onclick:()=>{e.openPrepareForOfflineUse?.()},children:(Y,Q)=>{Ae();var X=ue();z(ie=>E(X,ie),[()=>r(n).t(151)]),_(Y,X)},$$slots:{default:!0}})}w(Pe);var it=k(Pe,2);{const K=Q=>{var X=Ha(),ie=y(X,!0);w(X),z(xe=>{Me(X,"href","https://github.com/cigaleapp/cigale/tree/06298c514f2980d10efe886d32c7fe2d7555b94e"),E(ie,xe)},[()=>"06298c514f2980d10efe886d32c7fe2d7555b94e".slice(0,7)]),_(Q,X)},Y=(Q,X=le)=>{var ie=qa();ie.__click=()=>{T(o,!1)};var xe=y(ie,!0);w(ie),z((Qe,$e)=>{Me(ie,"href",Qe),E(xe,$e)},[()=>ct("/about"),()=>r(n).tx(X())]),_(Q,ie)};var Ft=y(it);{let Q=m(()=>[K,Y]),X=m(()=>r(n).cx(46));Le(Ft,{get t(){return r(Q)},get x(){return r(X)}})}w(it)}w(x),ho(x,K=>T(s,K),()=>r(s)),z((K,Y,Q,X,ie,xe)=>{Me(x,"data-theme",r(i)),x.open=r(o)?!0:void 0,E(N,K),E(D,Y),E(V,Q),E(de,X),E(he,ie),E(He,xe)},[()=>r(n).t(163),()=>r(n).t(184),()=>r(n).t(133),()=>r(n).t(187),()=>r(n).t(181),()=>r(n).t(121)]),mn("blur",ke,async()=>Fe("gridSize",r(u))),uo(ke,()=>r(u),K=>{const Y=Ue.Settings.state;Y[Y.findIndex(Q=>Q.id==="user")].gridSize=K}),_(t,g),me()}Yt(["click"]);var ja=R('<div class="selected-model-indicator svelte-1nmekgl"><!></div> ',1),Ua=R('<div class="inference svelte-1nmekgl"><!></div>'),Ba=R('<button class="pr-number svelte-1nmekgl"><!></button>'),Wa=R('<div class="line svelte-1nmekgl"></div>'),Va=R('<div class="line svelte-1nmekgl"></div>'),Xa=R('<div class="line svelte-1nmekgl"></div>'),Ya=R('<!> <!> <header><div class="progressbar svelte-1nmekgl"><!></div> <nav data-testid="app-nav"><div class="logo svelte-1nmekgl"><a class="svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></a> <!></div> <div class="steps svelte-1nmekgl"><a data-testid="goto-import" class="svelte-1nmekgl"><!></a> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-crop" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-classify" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <!></div> <aside><!> <div class="settings svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div></aside></nav></header>',1);function Ja(t,e){ge(e,!0);const n=(j,oe=le,ae=le,be=le,Ne=le)=>{var Pe=Ua(),Ge=y(Pe);{var Dt=it=>{{const Ft=(X,ie=le)=>{ut(X,ft({help:""},ie,{children:(xe,Qe)=>{no(xe,{})},$$slots:{default:!0}}))},K=(X,ie)=>{let xe=()=>ie?.().label,Qe=()=>ie?.().key;var $e=ja(),Rt=C($e),tn=y(Rt);{var rn=Nt=>{Lr(Nt,{})};G(tn,Nt=>{Qe()===be()&&Nt(rn)})}w(Rt);var nn=k(Rt);z(()=>E(nn,` ${xe()??""}`)),_(X,$e)};let Y=m(()=>r(o).t(134)),Q=m(()=>[{key:-1,label:"Aucune inférence",selected:be()===-1,onclick:()=>Ne()(-1)},...ae().map((X,ie)=>({key:ie,label:X.name??"",onclick:()=>Ne()(ie),selected:be()===ie}))]);Yr(it,{get testid(){return`${oe()??""}-models`},get help(){return r(Y)},items:[],get selectableItems(){return r(Q)},trigger:Ft,item:K,$$slots:{trigger:!0,item:!0}})}};G(Ge,it=>{W.currentProtocol&&it(Dt)})}w(Pe),_(j,Pe)},o=m(()=>Ye(Je("main")));let s=q(e,"progress",3,0),h=q(e,"floating",3,!1);const a=m(()=>Xe.url.hash.replace(/^#/,"")),i=m(()=>Ue.Image.state.length>0);let d=se(void 0),f=se(void 0),u=se(void 0),c=se(void 0),p=se(!0),v=se(!1),l=se(!1);Te(()=>{T(l,"nativeWindow"in window)}),Te(()=>{r(f)&&window.nativeWindow?.setControlsHeight(r(f))}),Te(()=>{window.nativeWindow?.setProgress($r(s(),0,1)),s()>=1&&window.nativeWindow?.startCallingAttention()}),Te(()=>{if(r(l))return;const j=document.title.replace(/^(⏳ \d+% ·|🆗) /,"");s()>=1||r(v)?document.title=`🆗 ${j}`:s()===0?document.title=j:document.title=`⏳ ${$n(s())} · ${j}`}),Te(()=>{document.addEventListener("processing-queue-drained",()=>{r(p)||T(v,!0)}),window.addEventListener("focus",()=>{T(v,!1),T(p,!0)}),window.addEventListener("blur",()=>{T(p,!1)})}),Gt("navigation",{"g p":{do:()=>lt("/"),help:r(o).t(61)},"g i":{do:()=>lt("/import"),help:r(o).t(110)},"g r":{do:()=>lt("/crop"),help:r(o).t(156)},"g n":{do:()=>lt("/classify"),help:r(o).t(66)},"g x":{do:()=>r(u)(),help:r(o).t(95)},"g m":{do:()=>lt("/protocols/"),help:r(o).t(101)}});var g=Ya(),b=C(g);_a(b,{get swarpc(){return e.swarpc},get open(){return r(u)},set open(j){T(u,j,!0)}});var x=k(b,2);{var $=j=>{da(j,{get open(){return r(c)},set open(oe){T(c,oe,!0)}})};G(x,j=>{j($)})}var N=k(x,2);let I;var P=y(N),D=y(P);{let j=m(()=>W.processing.task==="export"?0:s());tr(D,{get progress(){return r(j)}})}w(P);var O=k(P,2);let M;var S=y(O),A=y(S),U=y(A);xt(U,()=>({"--stroke-width":"75","--size":"2rem","--fill":"transparent"})),ao(U.lastChild,{}),w(U),w(A);var B=k(A,2);{var H=j=>{var oe=Ba();oe.__click=function(...be){r(c)?.apply(this,be)};var ae=y(oe);{let be=m(()=>r(o).cx(147)),Ne=m(()=>[We]);Le(ae,{get x(){return r(be)},get a(){return r(Ne)}})}w(oe),_(j,oe)};G(B,j=>{j(H)})}w(S);var F=k(S,2),V=y(F);{const j=oe=>{var ae=L(),be=C(ae);{var Ne=Pe=>{var Ge=Wa();_(Pe,Ge)};G(be,Pe=>{r(a)=="/import"&&Pe(Ne)})}_(oe,ae)};var J=y(V);{let oe=m(()=>[j]),ae=m(()=>r(o).cx(109));Le(J,{get t(){return r(oe)},get x(){return r(ae)}})}w(V)}var ee=k(V,2),te=y(ee);Lt(te,{}),w(ee);var de=k(ee,2),fe=y(de);{const j=oe=>{var ae=L(),be=C(ae);{var Ne=Pe=>{var Ge=Va();_(Pe,Ge)};G(be,Pe=>{r(a).startsWith("/crop")&&Pe(Ne)})}_(oe,ae)};var ve=y(fe);{let oe=m(()=>[j]),ae=m(()=>r(o).cx(155));Le(ve,{get t(){return r(oe)},get x(){return r(ae)}})}w(fe)}var re=k(fe,2);n(re,()=>"crop",()=>W.cropModels,()=>W.selectedCropModel,()=>j=>W.setModelSelections({crop:j})),w(de);var ne=k(de,2),ye=y(ne);Lt(ye,{}),w(ne);var ce=k(ne,2),he=y(ce);{const j=oe=>{var ae=L(),be=C(ae);{var Ne=Pe=>{var Ge=Xa();_(Pe,Ge)};G(be,Pe=>{r(a)=="/classify"&&Pe(Ne)})}_(oe,ae)};var _e=y(he);{let oe=m(()=>[j]),ae=m(()=>r(o).cx(65));Le(_e,{get t(){return r(oe)},get x(){return r(ae)}})}w(he)}var ke=k(he,2);n(ke,()=>"classify",()=>W.classificationModels,()=>W.selectedClassificationModel,()=>j=>W.setModelSelections({classification:j})),w(ce),Sr(ce,(j,oe)=>Cr?.(j,oe),()=>W.processing.task==="detection"&&W.processing.progress<1?"Veuillez attendre la fin de l'analyse des images avant de les classifier":void 0);var Se=k(ce,2),Be=y(Se);Lt(Be,{}),w(Se);var ze=k(Se,2);Ve(ze,{testid:"export-results-button",tight:!0,get onclick(){return r(u)},children:(j,oe)=>{Ae();var ae=ue();z(be=>E(ae,be),[()=>r(o).t(13)]),_(j,ae)},$$slots:{default:!0}}),w(F);var He=k(F,2);let Ce;var Ie=y(He);Pa(Ie,{});var Oe=k(Ie,2),Re=y(Oe);xt(Re,()=>({"--navbar-height":`${r(d)??""}px`})),Ga(Re.lastChild,{get openPrepareForOfflineUse(){return e.openPrepareForOfflineUse},get openKeyboardShortcuts(){return e.openKeyboardShortcuts}}),w(Re),w(Oe),w(He),w(O),w(N),z((j,oe,ae,be)=>{I=_t(N,1,"svelte-1nmekgl",null,I,{"native-window":r(l)}),M=_t(O,1,"svelte-1nmekgl",null,M,{floating:h()}),Me(A,"href",j),Me(V,"href",oe),Me(V,"aria-disabled",!W.currentProtocol),Me(fe,"href",ae),Me(fe,"aria-disabled",!W.currentProtocol||!r(i)),Me(he,"href",be),Me(he,"aria-disabled",!W.currentProtocol||!r(i)||W.processing.task==="detection"&&W.processing.progress<1),Ce=_t(He,1,"svelte-1nmekgl",null,Ce,{native:r(l)})},[()=>ct("/"),()=>ct("/import"),()=>Xe.route.id!=="/(app)/(sidepanel)/crop/[image]"&&W.imageOpenedInCropper?ct("/(app)/(sidepanel)/crop/[image]",{image:W.imageOpenedInCropper}):ct("/crop"),()=>ct("/classify")]),fr(O,"clientHeight",j=>T(f,j)),fr(N,"clientHeight",j=>T(d,j)),_(t,g),me()}Yt(["click"]);async function Qa(t,e){const n=Ue.Protocol.state.filter(h=>t.includes(h.id));if(n.length<t.length)throw new Error(`Some protocols not found in ${t.join(", ")}`);const o=[...n.flatMap(h=>h.crop.infer?.map(a=>a.model)??[]),...n.flatMap(h=>h.metadata.map(a=>Ue.Metadata.getFromState(a)).filter(jt).flatMap(({infer:a})=>a&&"neural"in a?a.neural.map(({model:i})=>i):[]))],s=await Promise.allSettled(o.map((h,a)=>Fn(h,{cacheAs:"model",onProgress({total:i,transferred:d}){e?.({done:d,total:i,modelNo:a,modelURL:hr(h)})}})));if(s.some(h=>h.status==="rejected"))throw new Error("Could not download all models: "+s.map((h,a)=>{if(h.status!=="fulfilled")return`${hr(o[a])}: ${h.reason}`}).filter(jt).join("; "))}var Za=R('<li class="svelte-au9nsu"><span class="url svelte-au9nsu"> </span> <!></li>'),ei=R("<!> ",1),ti=R('<p> </p> <ul class="bars svelte-au9nsu"></ul> <section class="state svelte-au9nsu"><!></section>',1);function ri(t,e){ge(e,!0);const n=m(()=>Ye(Je("main")));let o=q(e,"open",15),s=se(void 0),h=se(void 0);async function a(){await Qa(Ue.Protocol.state.map(u=>u.id),({modelNo:u,...c})=>{i.set(u,c)}).catch(u=>{T(s,u,!0)})}Te(()=>{r(d)&&i.values().every(u=>u.done>=u.total)&&T(s,!0)});let i=new Pr;const d=m(()=>i.size>0),f=m(()=>Tn(r(s)===!0?"success":"error"));{const u=(p,v)=>{let l=()=>v?.().close;var g=L(),b=C(g);{var x=N=>{pr(N,{get loading(){return r(d)},onclick:a,children:(I,P)=>{Ae();var D=ue();z(O=>E(D,O),[()=>r(n).t(77)]),_(I,D)},$$slots:{default:!0}})},$=N=>{pr(N,{onclick:()=>{i.clear(),T(s,void 0),l()?.()},children:(I,P)=>{Ae();var D=ue();z(O=>E(D,O),[()=>r(n).t(96)]),_(I,D)},$$slots:{default:!0}})};G(b,N=>{r(s)!==!0?N(x):N($,!1)})}_(p,g)};let c=m(()=>r(n).t(151));Tt(t,{key:"modal_prepare_for_offline",get title(){return r(c)},get open(){return o()},set open(p){o(p)},get close(){return r(h)},set close(p){T(h,p,!0)},footer:u,children:(p,v)=>{var l=ti(),g=C(l),b=y(g,!0);w(g);var x=k(g,2);ot(x,21,()=>i,([O,{done:M,total:S,modelURL:A}])=>O,(O,M)=>{var S=m(()=>$t(r(M),2));let A=()=>r(S)[1].done,U=()=>r(S)[1].total,B=()=>r(S)[1].modelURL;var H=Za(),F=y(H),V=y(F,!0);w(F);var J=k(F,2);{let ee=m(()=>$r(A()/U(),0,1));tr(J,{alwaysActive:!0,get progress(){return r(ee)}})}w(H),z(()=>E(V,B())),_(O,H)}),w(x);var $=k(x,2);let N;var I=y($);{var P=O=>{const M=S=>{var A=L(),U=C(A);qe(U,()=>r(f),(B,H)=>{H(B,{})}),_(S,A)};{let S=m(()=>[M]),A=m(()=>r(n).cx(8));Le(O,{get t(){return r(S)},get x(){return r(A)}})}},D=O=>{var M=L(),S=C(M);{var A=B=>{var H=ei(),F=C(H);qe(F,()=>r(f),(J,ee)=>{ee(J,{})});var V=k(F);z(()=>E(V,` ${r(s)??""}`)),_(B,H)},U=B=>{var H=L(),F=C(H);{var V=J=>{const ee=te=>{Hr(te,{})};{let te=m(()=>[ee]),de=m(()=>r(n).cx(2));Le(J,{get t(){return r(te)},get x(){return r(de)}})}};G(F,J=>{i.size>0&&J(V)},!0)}_(B,H)};G(S,B=>{r(s)!==void 0?B(A):B(U,!1)},!0)}_(O,M)};G(I,O=>{r(s)===!0?O(P):O(D,!1)})}w($),z(O=>{E(b,O),N=Mr($,"",N,{color:`var(--fg-${r(s)===!0?"success":r(d)?"secondary":"error"})`})},[()=>r(n).t(188)]),_(p,l)},$$slots:{footer:!0,default:!0}})}me()}function ni(t){const e={encode:o=>JSON.stringify(o),decode:o=>{if(o===null)return null;try{return JSON.parse(o)}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}function oi(t){const e={encode:o=>JSON.stringify(o),decode:o=>{if(o===null)return null;try{return JSON.parse(o)}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}let Pt=String.fromCharCode,Jr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",St={};function si(t,e){if(!St[t]){St[t]={};for(let n=0;n<t.length;n++)St[t][t.charAt(n)]=n}return St[t][e]}function ai(t){return t==null?"":li(t,6,function(e){return Jr.charAt(e)})}function ii(t){return t==null?"":t==""?null:ci((t=t.replace(/ /g,"+")).length,32,function(e){return si(Jr,t.charAt(e))})}function li(t,e,n){if(t==null)return"";let o,s,h={},a={},i="",d="",f="",u=2,c=3,p=2,v=[],l=0,g=0,b;for(b=0;b<t.length;b+=1)if(i=t.charAt(b),Object.prototype.hasOwnProperty.call(h,i)||(h[i]=c++,a[i]=!0),d=f+i,Object.prototype.hasOwnProperty.call(h,d))f=d;else{if(Object.prototype.hasOwnProperty.call(a,f)){if(256>f.charCodeAt(0)){for(o=0;o<p;o++)l<<=1,g==e-1?(g=0,v.push(n(l)),l=0):g++;for(o=0,s=f.charCodeAt(0);o<8;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1}else{for(o=0,s=1;o<p;o++)l=l<<1|s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s=0;for(o=0,s=f.charCodeAt(0);o<16;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1}--u==0&&(u=Math.pow(2,p),p++),delete a[f]}else for(o=0,s=h[f];o<p;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1;--u==0&&(u=Math.pow(2,p),p++),h[d]=c++,f=String(i)}if(f!==""){if(Object.prototype.hasOwnProperty.call(a,f)){if(256>f.charCodeAt(0)){for(o=0;o<p;o++)l<<=1,g==e-1?(g=0,v.push(n(l)),l=0):g++;for(o=0,s=f.charCodeAt(0);o<8;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1}else{for(o=0,s=1;o<p;o++)l=l<<1|s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s=0;for(o=0,s=f.charCodeAt(0);o<16;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1}--u==0&&(u=Math.pow(2,p),p++),delete a[f]}else for(o=0,s=h[f];o<p;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1;--u==0&&(u=Math.pow(2,p),p++)}for(o=0,s=2;o<p;o++)l=l<<1|1&s,g==e-1?(g=0,v.push(n(l)),l=0):g++,s>>=1;for(;;){if(l<<=1,g==e-1){v.push(n(l));break}g++}return v.join("")}function ci(t,e,n){let o=[],s=4,h=4,a=3,i="",d=[],f,u,c,p,v,l,g,b={val:n(0),position:e,index:1};for(f=0;f<3;f+=1)o[f]=f;for(c=0,v=4,l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;switch(c){case 0:for(c=0,v=256,l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;g=Pt(c);break;case 1:for(c=0,v=65536,l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;g=Pt(c);break;case 2:return""}for(o[3]=g,u=g,d.push(g);;){if(b.index>t)return"";for(c=0,v=Math.pow(2,a),l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;switch(g=c){case 0:for(c=0,v=256,l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;o[h++]=Pt(c),g=h-1,s--;break;case 1:for(c=0,v=65536,l=1;l!=v;)p=b.val&b.position,b.position>>=1,b.position==0&&(b.position=e,b.val=n(b.index++)),c|=(p>0?1:0)*l,l<<=1;o[h++]=Pt(c),g=h-1,s--;break;case 2:return d.join("")}if(s==0&&(s=Math.pow(2,a),a++),o[g])i=o[g];else{if(g!==h)return null;i=u+u.charAt(0)}d.push(i),o[h++]=u+i.charAt(0),s--,u=i,s==0&&(s=Math.pow(2,a),a++)}}function ui(t){const e={encode:o=>ai(JSON.stringify(o)),decode:o=>{if(!o)return null;try{return JSON.parse(ii(o)??"")}catch{return null}},defaultValue:t};function n(o){return{...e,equalityFn:o}}return Object.assign(n,e)}function qt({encode:t,decode:e}){function n(o){return{encode:t,decode:e,defaultValue:o}}return n}const di={number:qt({encode:t=>t.toString(),decode:t=>t?parseFloat(t):null}),boolean:qt({encode:t=>t+"",decode:t=>t!==null&&t!=="false"}),string:qt({encode:t=>t??"",decode:t=>t}),object:ni,array:oi,lz:ui},fi=()=>{const t=wo;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},vi={subscribe(t){return fi().page.subscribe(t)}};let Qr;Qr=vi;function pi(t,e,n=(o,s)=>JSON.stringify(o)===JSON.stringify(s)){return typeof t=="object"&&typeof e=="object"&&n(t,e)}const hi={keepFocus:!0,noScroll:!0,replaceState:!0},gi={keepFocus:!0,noScroll:!0,replaceState:!1},Kt=new Set;let wr;const yr=new Map,Zr=Mo(Qr),At={encode:t=>t.toString(),decode:t=>t?t.toString():null},xr=Symbol("raw");function sr(t,e,n,o,s){o[t]=e;const{debounceHistory:h=0,pushHistory:a=!0,sort:i=!0}=s,d=window.location.hash,f=c=>{if(e==null)c.delete(t);else{const p=(n.get(t)??At.encode)(e);p==null?c.delete(t):c.set(t,p)}};Kt.add(f),clearTimeout(wr);const u=new URLSearchParams(window.location.search);wr=setTimeout(async()=>{Kt.forEach(c=>{c(u)}),clearTimeout(yr.get(t));{async function c(){i&&u.sort(),await yo(`?${u}${d}`,a?gi:hi),o[t]=void 0}h===0?c():yr.set(t,setTimeout(c,h))}Kt.clear()})}function mi(t,e,n,o){return(s,h,a)=>{const i=[...s],d=i.shift(),f=structuredClone(et(n[d])??t);let u=f;for(const c of i)u=u[c];u[h]=a,sr(d,Array.isArray(f)&&h==="length"?structuredClone(f):f,e,n,o)}}function en(t,e,n,o,s,h,a,i=[],d){return new Proxy(t,{get(f,u){if(u===xr)return f;const c=Reflect.get(f,u);if(typeof u=="symbol"||i.length!==0)return c;if(c)return Reflect.get(e,u);if(u==="toJSON")return()=>{const v=et(e),l=new URLSearchParams(window.location.search);for(const[g,b]of l.entries())g in e||(v[g]=b);return v};const p=e[u]??(n.get(u)??At.decode)(Zr.current.url.searchParams.get(u));return p!=null&&typeof p=="object"?en(p,e,n,o,s,h,a,[...i,u],d??mi(p,o,s,a)):p},set(f,u,c){return typeof u=="symbol"?Reflect.set(f,u,c):d?(d(i,u,c),!0):(sr(u,c,o,s,a),!0)},has(f,u){return u===xr?!0:Reflect.has(f,u)}})}function _i(t,e,n,o,s,h,a){return t==null&&typeof n!="boolean"&&n.defaultValue!=null?(o&&sr(e,n.defaultValue,s,h,a),!0):!1}function bi(t,e={}){const{showDefaults:n=!0}=e,o={},s=new Map,h=new Map,a=new Map,i=Xt({});for(const d in t){const f=typeof t?.[d]=="boolean"?At.decode:t?.[d].decode,u=typeof t?.[d]=="boolean"?At.encode:t?.[d].encode;s.set(d,f),h.set(d,u);const c=m(()=>{const p=i[d]??f(Zr.current.url.searchParams.get(d)),v=a.get(d)??null;return pi(et(p),et(v),typeof t[d]=="boolean"?void 0:t[d].equalityFn)?v:(a.set(d,et(p)),p)});fn(()=>{_i(r(c),d,t[d],n,h,i,e)&&(i[d]=t[d].defaultValue)}),Object.defineProperty(o,d,{get(){return r(c)},enumerable:!0})}return en({},o,s,h,i,a,e)}var wi=R(" <strong> </strong> ",1),yi=R("<a><!></a>");function xi(t,e){ge(e,!0);const n=p=>{Ae();var v=wi(),l=C(v,!0),g=k(l),b=y(g,!0);w(g);var x=k(g,1,!0);z(()=>{E(l,r(a)),E(b,r(o)),E(x,r(i))}),_(p,v)},o=m(()=>URL.canParse(e.url)?new URL(e.url).hostname:""),s=m(()=>e.url.split(r(o),2)),h=m(()=>$t(r(s),2)),a=m(()=>r(h)[0]),i=m(()=>r(h)[1]);var d=L(),f=C(d);{var u=p=>{var v=yi(),l=y(v);n(l),w(v),z(()=>Me(v,"href",e.url)),_(p,v)},c=p=>{n(p)};G(f,p=>{e.linkify?p(u):p(c,!1)})}_(t,d),me()}var Mi=R("<p> </p>"),ki=R('<section class="modal-import-loading svelte-1qpv17f"><!></section>');function Pi(t,e){ge(e,!0);const n=m(()=>Ye(Je("main"))),o=m(()=>Xe.data),s=m(()=>r(o).swarpc);let h=se(!1);const a={encode:u=>u===null?void 0:(Number(u)+1).toString(),decode:u=>u===null?null:Number(u)-1},i=bi({protocol:di.string(),classificationModel:a,cropModel:a});let d=se(void 0);const f=m(()=>!!(i.protocol?.startsWith("https:")&&URL.canParse(i.protocol)));xo(()=>{r(f)&&r(d)&&!r(h)&&r(d)()}),Te(()=>{r(f)||(i.protocol&&(W.setCurrentProtocolId(i.protocol),i.protocol=null),W.setModelSelections({classification:i.classificationModel,crop:i.cropModel}).then(()=>{i.classificationModel!==null&&(i.classificationModel=null),i.cropModel!==null&&(i.cropModel=null)}))});{const u=l=>{var g=L(),b=C(g);{var x=$=>{xi($,{linkify:!0,get url(){return i.protocol}})};G(b,$=>{i.protocol&&r(f)&&$(x)})}_(l,g)},c=(l,g=le)=>{var b=ki(),x=y(b);{var $=N=>{var I=Mi(),P=y(I,!0);w(I),z(D=>E(P,D),[()=>r(n).t(388)]),_(N,I)};G(x,N=>{r(h)&&N($)})}w(b),_(l,b)};let p=m(()=>r(n).t(111)),v=m(()=>r(n).t(108));En(t,{get title(){return r(p)},key:"modal_import_remote_protocol",get confirm(){return r(v)},oncancel:()=>{i.protocol=null},onconfirm:async()=>{if(!i.protocol)return;T(h,!0);const l=await fetch(i.protocol).then(g=>g.text()).catch(g=>(De.error(r(n).t(90,[g])),null));if(l)try{const{id:g}=await r(s).importProtocol({contents:l});await Ue.Protocol.refresh(),await Ue.Metadata.refresh(),W.setCurrentProtocolId(g),i.protocol=null}catch(g){De.error(`Erreur lors de l'import du protocole distant: ${g}`)}finally{T(h,!1)}},get open(){return r(d)},set open(l){T(d,l,!0)},_w_snippet_0:u,_w_snippet_1:c,children:(l,g)=>{{let b=m(()=>[u,c]),x=m(()=>r(n).cx(48));Le(l,{get t(){return r(b)},get x(){return r(x)}})}},$$slots:{_w_snippet_0:!0,_w_snippet_1:!0,default:!0}})}me()}const Si=new Pr;var Ci=R("<base/>"),$i=R('<div class="nagbar svelte-1v2axqk"><!></div>'),Ii=R('<!> <!> <!> <!> <section class="toasts svelte-1v2axqk" data-testid="toasts-area"></section> <div><!></div> <!>',1);function El(t,e){ge(e,!0);const n=m(()=>Ye(Je("main"))),o=m(()=>e.data.swarpc),s=m(()=>e.data.parallelism);let h=se("full");vn("setNavbarAppearance",M=>{on(()=>{T(h,M,!0)}),sn(()=>{T(h,"full")})}),Ln({swarpc:r(o),cancellers:Si,parallelism:r(s)});const a={capture(){return Rn(W,"currentProtocolId")},restore({currentProtocolId:M}){W.setCurrentProtocolId(M)}},i=m(()=>Ue.Image.state.map(M=>M.fileId).filter(jt));kr(()=>r(i),M=>{for(const S of M)(async()=>{if(W.hasPreviewURL(S))return;const A=await In("ImagePreviewFile",S);if(!A)return;const U=new Blob([A.bytes],{type:A.contentType});W.setPreviewURL(S,URL.createObjectURL(U))})()}),Gt("general",{"$mod+s":{help:"",hidden:!0,do:()=>De.info(r(n).t(146))},"i d e v":{help:r(n).t(26),do:async()=>{await Fe("showTechnicalMetadata",!It())}}}),Gt("debugmode",Object.fromEntries(["warn","error","info","debug","success"].map(M=>{const S={warn:()=>De.warn("Example warning toast"),error:()=>De.error("Example error toast"),info:()=>De.info("Example info toast"),debug:()=>De.add("debug","Example debug toast"),success:()=>De.success("Example success toast")};return[`t t ${M.charAt(0)}`,{help:`Summon a ${M} toast`,debug:!0,allowInModals:!0,when:It,do:S[M]}]})));const d=m(bt);Te(()=>{document.documentElement.dataset.theme=r(d).theme});let f=se(void 0),u=se(void 0);var c={snapshot:a},p=Ii();_n(M=>{var S=Ci();z(A=>Me(S,"href",A),[()=>ar("/")==="/"?"":ar("/")+"index.html"]),_(M,S)});var v=C(p);Bo(v,{preventDefault:!0,get binds(){return W.keybinds},get openHelp(){return r(f)},set openHelp(M){T(f,M,!0)}});var l=k(v,2);ri(l,{get open(){return r(u)},set open(M){T(u,M,!0)}});var g=k(l,2);Pi(g,{});var b=k(g,2);{var x=M=>{{let S=m(()=>r(h)==="floating");Ja(M,{get swarpc(){return r(o)},get openKeyboardShortcuts(){return r(f)},get openPrepareForOfflineUse(){return r(u)},get floating(){return r(S)},get progress(){return W.processing.progress}})}};G(b,M=>{r(h)!=="hidden"&&M(x)})}var $=k(b,2);ot($,21,()=>De.items("default"),M=>M.id,(M,S)=>{Dn(M,ft(()=>r(S),{get action(){return r(S).labels.action},get dismiss(){return r(S).labels.close},onaction:()=>{r(S).callbacks?.action?.(r(S))},ondismiss:()=>{De.remove(r(S).id)}}))}),w($);var N=k($,2);let I;var P=y(N);pe(P,()=>e.children??le),w(N);var D=k(N,2);{var O=M=>{var S=$i();{const U=(H,F=le)=>{ir(H,{onclick:async()=>{await Ir(),Fe("notifications",Ut())},children:(V,J)=>{Ae();var ee=ue();z(te=>E(ee,te),[()=>r(n).tx(F())]),_(V,ee)},$$slots:{default:!0}})},B=(H,F=le)=>{ir(H,{onclick:()=>Fe("notifications",!1),children:(V,J)=>{Ae();var ee=ue();z(te=>E(ee,te),[()=>r(n).tx(F())]),_(V,ee)},$$slots:{default:!0}})};var A=y(S);{let H=m(()=>[U,B]),F=m(()=>r(n).cx(385));Le(A,{get t(){return r(H)},get x(){return r(F)}})}w(S),yn(3,S,()=>xn,()=>({axis:"y",duration:100}))}_(M,S)};G(D,M=>{bt().notifications===null&&M(O)})}return z(M=>I=_t(N,1,"contents svelte-1v2axqk",null,I,M),[()=>({padded:!Xe.route.id?.includes("/(sidepanel)")&&!Xe.route.id?.includes("protocols/[id]/")})]),_(t,p),me(c)}export{mr as M,es as P,Fa as S,El as _,Tl as b,Si as c,Al as f,Il as n,Ol as p};
