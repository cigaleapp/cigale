import"../chunks/DsnmJJEf.js";import{o as ct}from"../chunks/CKEs0Y6B.js";import{f as ot,a as p,p as N,h as dt,b as O,c as L,d as H,aA as h,g as t,u as n,aa as Y,ab as R,aB as Z,e as J,n as j,az as f,r as _,s as E,i as G}from"../chunks/CKFr55HY.js";import{a as F}from"../chunks/BSJa-gCr.js";import{r as at,p as st,i as T,s as vt}from"../chunks/BnINZmlg.js";import{e as mt}from"../chunks/BfRwOU-Q.js";import{t as ut,f as pt}from"../chunks/CQ7DZjSk.js";import{a as nt,_ as Q,g as X}from"../chunks/B0sfP6zc.js";import{R as U}from"../chunks/PUfmrO2I.js";import{D as _t}from"../chunks/CbFuusXn.js";import{B as K}from"../chunks/B0qXVrpE.js";import{t as V,n as ft,e as gt,I as ht,k as $t,x as xt}from"../chunks/BfjK8oC1.js";import{e as wt,A as Pt,p as kt}from"../chunks/Y12U1EUt.js";import{t as q}from"../chunks/C4Cali0V.js";import{B as bt}from"../chunks/BMdCOrlL.js";import{F as tt}from"../chunks/DsdZIrN8.js";import{I as et}from"../chunks/D4mJ-AV5.js";import{a as yt}from"../chunks/D8CcyO4e.js";import{g as lt,r as Mt}from"../chunks/bCylyxMO.js";import{S as It,M as Bt}from"../chunks/CHXrxthL.js";import{D as St}from"../chunks/C9aioxm5.js";import{P as Dt}from"../chunks/CliTAt7n.js";import{B as W}from"../chunks/EISLmZ-s.js";import{B as At}from"../chunks/DV4fPt-7.js";import{u as rt}from"../chunks/CzznUtHs.js";import{a as Ct,t as Ft}from"../chunks/fs5VanAl.js";var Lt=ot('<svg><path fill="currentColor" d="M11 11V7h2v4h4v2h-4v4h-2v-4H7v-2zm1 11C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10s-4.477 10-10 10m0-2a8 8 0 1 0 0-16a8 8 0 0 0 0 16"></path></svg>');function Rt(w,o){const r=at(o,["$$slots","$$events","$$legacy"]);var l=Lt();nt(l,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),p(w,l)}var zt=L("<!> <!>",1),Vt=L("<p> </p>"),qt=L("<code> </code>"),Ht=L("<code> </code>"),Ut=L("<em> </em>"),Tt=L("<!> <!>",1);function Wt(w,o){N(o,!0);const r=n(()=>Q(X("main")));let l=st(o,"open",15),i=dt({name:"",id:""});{const P=(I,z)=>{let k=()=>z?.().close;var $=zt(),B=H($);K(B,{onclick:()=>k()?.(),children:(d,v)=>{Z();var m=Y();R(u=>F(m,u),[()=>t(r).t(31)]),p(d,m)},$$slots:{default:!0}});var D=h(B,2);bt(D,{onclick:async()=>{q.clear();const d=v=>ft(i.id,v);try{await V.Metadata.set({id:d("crop"),description:"",label:"",mergeMethod:"union",type:"boundingbox",required:!1}),await V.Metadata.set({id:d("crop_confirmation"),description:"",label:"",mergeMethod:"none",type:"boolean",required:!1}),await V.Protocol.set({id:i.id,name:i.name,metadata:["crop","crop_confirmation"].map(d),description:"",authors:[],crop:{metadata:d("crop"),confirmationMetadata:d("crop_confirmation")}}),await lt("/(app)/protocols/[id]/infos",{id:i.id})}catch(v){q.error(gt(v))}},children:(d,v)=>{Z();var m=Y();R(u=>F(m,u),[()=>t(r).t(236)]),p(d,m)},$$slots:{default:!0}}),p(I,$)};let S=n(()=>t(r).t(74));yt(w,{key:"modal_create_protocol",get title(){return t(S)},toasts:"protocolcreator",get open(){return l()},set open(I){l(I)},footer:P,children:(I,z)=>{var k=Tt(),$=H(k);{let D=n(()=>t(r).t(232));tt($,{get label(){return t(D)},children:(d,v)=>{et(d,{label:"",value:"",onblur:m=>{i.name=m}})}})}var B=h($,2);tt(B,{label:v=>{const m=(u,s=j)=>{var c=Vt(),a=f(c,!0);_(c),R(e=>F(a,e),[()=>t(r).tx(s())]),p(u,c)};{let u=n(()=>[m]),s=n(()=>t(r).cx(233));U(v,{get t(){return t(u)},get x(){return t(s)}})}},error:v=>{const m=n(()=>V.Protocol.getFromState(i.id));var u=J(),s=H(u);{var c=e=>{const g=(x,b=j)=>{var y=qt(),M=f(y,!0);_(y),R(C=>F(M,C),[()=>t(r).tx(b())]),p(x,y)},A=(x,b=j)=>{var y=Ht(),M=f(y,!0);_(y),R(C=>F(M,C),[()=>t(r).tx(b())]),p(x,y)};{let x=n(()=>[g,A]),b=n(()=>t(r).cx(234));U(e,{get t(){return t(x)},get x(){return t(b)}})}},a=e=>{var g=J(),A=H(g);{var x=b=>{const y=M=>{var C=Ut(),it=f(C,!0);_(C),R(()=>F(it,t(m).name)),p(M,C)};{let M=n(()=>[y]),C=n(()=>t(r).cx(235));U(b,{get t(){return t(M)},get x(){return t(C)}})}};T(A,b=>{t(m)&&b(x)},!0)}p(e,g)};T(s,e=>{i.id&&!ht.allows(i.id)?e(c):e(a,!1)})}p(v,u)},children:(v,m)=>{et(v,{label:"",value:"",get onerror(){return q.error},onblur:u=>{i.id=u}})}}),p(I,k)},$$slots:{footer:!0,default:!0}})}O()}var jt=ot('<svg><path fill="currentColor" d="M13 3v7.267l6.294-3.633l1 1.732l-6.293 3.633l6.293 3.635l-1 1.732L13 13.732V21h-2v-7.268l-6.294 3.634l-1-1.732L9.999 12L3.706 8.366l1-1.732L11 10.267V3z"></path></svg>');function Et(w,o){const r=at(o,["$$slots","$$events","$$legacy"]);var l=jt();nt(l,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),p(w,l)}var Gt=L('<div class="unsaved-changes-indicator svelte-1m2ik9f"><!></div>');function Jt(w,o){const r=st(o,"help",3,"Modifications non enregistrÃ©es");var l=Gt(),i=f(l);Et(i,{}),_(l),Ct(l,(P,S)=>Ft?.(P,S),r),p(w,l)}var Kt=L('<li class="svelte-1aw9mnt"><section class="text"><h3><!> </h3> <small><code> </code></small></section> <section class="actions svelte-1aw9mnt"><!> <!> <!> <!></section></li>');function Nt(w,o){N(o,!0);const r=n(()=>Q(X("main")));var l=Kt(),i=f(l),P=f(i),S=f(P);{var I=a=>{{let e=n(()=>t(r).t(237));Jt(a,{get help(){return t(e)}})}};T(S,a=>{o.dirty&&a(I)})}var z=h(S);_(P);var k=h(P,2),$=f(k),B=f($,!0);_($),_(k),_(i);var D=h(i,2),d=f(D);{let a=n(()=>t(r).t(170)),e=n(()=>o.id===rt.currentProtocolId&&rt.processing.total>0);W(d,{dangerous:!0,get help(){return t(a)},get disabled(){return t(e)},onclick:()=>{o.ondelete()},children:(g,A)=>{St(g,{})},$$slots:{default:!0}})}var v=h(d,2);{let a=n(()=>t(r).t(238));W(v,{get help(){return t(a)},onclick:()=>lt("/(app)/protocols/[id]/infos",{id:o.id}),children:(e,g)=>{Dt(e,{})},$$slots:{default:!0}})}var m=h(v,2);{let a=n(()=>t(r).t(94));W(m,{get help(){return t(a)},onclick:async()=>{await wt($t(),Mt("/"),o.id).catch(e=>q.error(e))},children:(e,g)=>{It(e,{})},$$slots:{default:!0}})}var u=h(m,2);{var s=a=>{At(a,{compact:!0,get version(){return o.version},get source(){return o.source},get id(){return o.id}})},c=a=>{{let e=n(()=>t(r).t(50));W(a,{crossout:!0,onclick:()=>{},get help(){return t(e)},children:(g,A)=>{Pt(g,{})},$$slots:{default:!0}})}};T(u,a=>{o.version&&o.source?a(s):a(c,!1)})}_(D),_(l),R(()=>{F(z,` ${o.name??""}`),F(B,o.id)}),p(w,l),O()}var Ot=L('<!> <!> <div class="page svelte-1fvkkcr"><header class="svelte-1fvkkcr"><h1 class="svelte-1fvkkcr"> </h1> <section class="actions svelte-1fvkkcr"><!> <!></section></header> <ul class="protocols svelte-1fvkkcr"></ul></div>',1);function Pe(w,o){N(o,!0);const r=n(()=>Q(X("main")));let l=E(""),i=E(void 0),P=E(void 0);ct(async()=>{for(const{id:s}of V.Protocol.state){const c=await o.data.swarpc.diffProtocolWithRemote({protocolId:s});V.Protocol.getFromState(s).dirty=c}});var S=Ot(),I=H(S);Bt(I,{get id(){return t(l)},get open(){return t(i)},set open(s){G(i,s,!0)}});var z=h(I,2);Wt(z,{get open(){return t(P)},set open(s){G(P,s,!0)}});var k=h(z,2),$=f(k),B=f($),D=f(B,!0);_(B);var d=h(B,2),v=f(d);K(v,{loading:!0,onclick:async(c,a)=>{await kt({allowMultiple:!0,onInput:a.loadingStarted,importProtocol:o.data.swarpc.importProtocol}).catch(e=>q.error(e)).then(e=>{!e||typeof e=="string"||e.length===0||(e.length===1?q.success(t(r).t(149,[e[0].name])):q.success(xt(e.length,t(r).tp(216),t(r)._.p)))})},children:(c,a)=>{let e=()=>a?.().loading;const g=A=>{var x=J(),b=H(x);{var y=M=>{_t(M,{})};T(b,M=>{e()||M(y)})}p(A,x)};{let A=n(()=>[g]),x=n(()=>t(r).cx(5));U(c,{get t(){return t(A)},get x(){return t(x)}})}},$$slots:{default:!0}});var m=h(v,2);{const s=c=>{Rt(c,{})};K(m,{onclick:()=>t(P)?.(),_w_snippet_1:s,children:(c,a)=>{{let e=n(()=>[s]),g=n(()=>t(r).cx(3));U(c,{get t(){return t(e)},get x(){return t(g)}})}},$$slots:{_w_snippet_1:!0,default:!0}})}_(d),_($);var u=h($,2);mt(u,21,()=>V.Protocol.state,s=>s.id,(s,c)=>{Nt(s,vt(()=>t(c),{ondelete:()=>{G(l,t(c).id,!0),t(i)?.()}}))}),_(u),_(k),R(s=>F(D,s),[()=>t(r).t(150)]),ut(1,k,()=>pt,()=>({duration:100})),p(w,S),O()}export{Pe as component};
