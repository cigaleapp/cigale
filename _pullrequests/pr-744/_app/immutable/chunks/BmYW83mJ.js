var o=1,p=65535,f=4,O=function(){o=o+1&p},d=setInterval(O,1e3/f|0);d.unref&&d.unref();function R(t){var e=f*t,r=[0],n=1,s=o-1&p;return function(i){var a=o-s&p;for(a>e&&(a=e),s=o;a--;)n===e&&(n=0),r[n]=r[n===0?e-1:n-1],n++;i&&(r[n-1]+=i);var c=r[n-1],u=r.length<e?0:r[n===e?0:n];return r.length<f?c:(c-u)*f/r.length}}class B{constructor(e,r=1e3){this.length=parseInt(e,10)||0,this.transferred=0,this.speed=0,this.streamSpeed=R(this.speed||5e3),this.initial=!1,this.emitDelay=r,this.eventStart=0,this.percentage=0}getRemainingBytes(){return parseInt(this.length,10)-parseInt(this.transferred,10)}getEta(){return this.length>=this.transferred?this.getRemainingBytes()/this.speed*1e9:0}flow(e,r){const n=e.length;if(this.transferred+=n,this.speed=this.streamSpeed(n),this.percentage=Math.round(this.transferred/this.length*100),this.initial||(this.eventStart=Date.now(),this.initial=!0),this.length>=this.transferred||Date.now()-this.eventStart>this.emitDelay){this.eventStart=Date.now();const s={total:this.length,transferred:this.transferred,speed:this.speed,eta:this.getEta()};this.length&&(s.remaining=this.getRemainingBytes(),s.percentage=this.percentage),r(s)}}}function A(){return typeof Response<"u"&&typeof ReadableStream<"u"}function M({defaultSize:t=0,emitDelay:e=10,onProgress:r=()=>null,onComplete:n=()=>null,onError:s=()=>null}){return function(a){if(!A())return a;const{body:c,headers:u,status:y}=a,b=u.get("content-length")||t,S=new B(b,e),w=c.getReader(),v=new ReadableStream({start(g){function m(){w.read().then(({done:l,value:h})=>{if(l){n({}),g.close();return}h&&S.flow(h,r),g.enqueue(h),m()}).catch(l=>{s(l)})}m()}});return new Response(v,{headers:u,status:y})}}function j(t,e){return Object.fromEntries(Object.entries(t).map(([r,n])=>[r,e(n)]))}function z(t){return Object.keys(t)}function _(t){return Object.fromEntries(t)}function $(t){return Object.entries(t)}function k(t,e){return e.includes(t)}function D(t,...e){const r={};for(const n of e)r[n]=t[n];return r}function L(t,...e){return _($(t).filter(([r])=>!k(r,e)))}function I(t){try{return JSON.parse(t?.toString()??"")}catch{return}}function N(t){try{return JSON.stringify(t)}catch{return}}function P(t){return Math.sign(t)}function U(t,e,r){return Math.max(e,Math.min(r,t))}function J(t,e=r=>r){const r=new Set;return t.filter(n=>{const s=e(n);return r.has(s)?!1:(r.add(s),!0)})}function F(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function H(t){const e=t.match(/^([^.]+)\.(.+)$/);return e?[e[1],e[2]]:[t,""]}function K(t){return(e,r)=>{const n=t(e),s=t(r);return n===s?0:typeof n=="string"&&typeof s=="string"?n.localeCompare(s):typeof n=="number"&&typeof s=="number"?n-s:n.toString().localeCompare(s.toString())}}function T(t){const e=new URL(t);return e.searchParams.set("v",Date.now().toString()),typeof t=="string"?e.toString():e}function q(t,e=void 0){return e===void 0?Array.from({length:t},(r,n)=>n):Array.from({length:e-t},(r,n)=>n+t)}async function G(t,{cacheAs:e="",onProgress:r}={}){let n=new URL(typeof t=="string"?t:t.url);const s=typeof t=="string"?{headers:{}}:t;return e&&n.searchParams.set("x-cigale-cache-as",e),r?fetch(n,s).then(M({onProgress:r})):fetch(n,s)}function x(t){return[...t].reduce((e,r)=>e+r,0)}function V(t){return x(t)/t.length}function C(t){return t!=null}function E(t,e=0){if(e<0)throw new Error("decimals must be non-negative");const r=Math.pow(10,e);return Math.round(t*r)/r}function W({offsetX:t,offsetY:e},r,n=0){return t>=-n&&t<=r.width+n&&e>=-n&&e<=r.height+n}function Z(t){return t==="application/zip"||t==="application/x-zip-compressed"||t==="application/x-zip"}function Q(t){const e=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\w\s-]/g,"").trim().replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"").toLowerCase();if(!e)throw new Error(`Cannot slugify "${t}" (result is empty)`);return e}function X(t,e,r){if("groupBy"in Map&&!r)return Map.groupBy(t,e);const n=new Map;for(const s of t){const i=e(s);n.has(i)||n.set(i,[]),n.get(i).push(r?r(s):s)}return n}function Y(t,...e){if(t>=1)return`var(--${e.at(-1)})`;if(t<=0)return`var(--${e[0]})`;const r=e.length-1,n=Math.floor(t*r);return`color-mix(
		in lab,
		var(--${e[n+1]})
		${E((t*r-n)*100,2)}%,
		var(--${e[n]})
	)`.replaceAll(`
`,"").replaceAll(/\s+/g," ").replaceAll("( ","(").replaceAll(" )",")")}function tt(t,e){return C(e)?{[t]:e}:{}}function et(t,e,{firstTimeDuration:r}={}){const n=!localStorage.getItem("app_started_before");localStorage.setItem("app_started_before","true"),n&&(e=r??e);const s=document.querySelector(t);if(!(s instanceof HTMLElement)){s?.remove();return}s.style.transition=`opacity ${e}ms linear`,s.style.opacity="0",setTimeout(()=>{s.remove()},e)}async function nt(t){const e=await crypto.subtle.digest("SHA-1",t);try{return new Uint8Array(e).toBase64()}catch{return console.warn("Could not base64-encode the SHA1 digest, probably because browser is too old, see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array/toBase64#browser_compatibility"),null}}export{G as A,N as B,H as C,V as a,Q as b,U as c,Y as d,$ as e,et as f,X as g,K as h,W as i,D as j,z as k,P as l,j as m,C as n,L as o,tt as p,_ as q,q as r,x as s,nt as t,J as u,I as v,F as w,Z as x,E as y,T as z};
