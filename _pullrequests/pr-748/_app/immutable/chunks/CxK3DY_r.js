import"./DsnmJJEf.js";import{h as me,i as a,A as _e,J as P,G as b,B as he,g as s,D as L,I as Me,F as c,aB as h,aA as v,K as l,aC as le,aD as ne,a2 as De,t as G,aF as ve,aE as de}from"./DLg_PPZ_.js";import{d as Fe,s as R}from"./9TbOa8jV.js";import{r as be,p as I,i as d}from"./D67Hg_eN.js";import{a as $,t as ee,c as Ge,B as ce}from"./Cmdet9fQ.js";import{e as Je,i as Ke}from"./C4hQLFL9.js";import{a as te,C as ke,b as Oe,s as ue,c as Re}from"./BNnFn6yw.js";import{e as Ve,b as je}from"./eMcr3I6C.js";import{b as Ne}from"./BEYaBP-8.js";import{I as Qe}from"./C3T_LJvL.js";import{T as Ue}from"./Di2wCwy7.js";import"./K-UyIQrW.js";import{s as Xe}from"./USdlu_3B.js";import{C as Ye}from"./CK85Hv2l.js";import{L as fe}from"./jGhSvLm_.js";import{L as Ze}from"./Bx3yqWKm.js";var pe=me('<svg><path fill="currentColor" d="M224 128a96 96 0 0 1-94.71 96H128a95.38 95.38 0 0 1-65.9-26.2a8 8 0 0 1 11-11.63a80 80 0 1 0-1.67-114.78a3 3 0 0 1-.26.25L44.59 96H72a8 8 0 0 1 0 16H24a8 8 0 0 1-8-8V56a8 8 0 0 1 16 0v29.8L60.25 60A96 96 0 0 1 224 128"></path></svg>');function $e(f,e){const q=be(e,["$$slots","$$events","$$legacy"]);var C=pe();te(C,()=>({class:"icon",viewBox:"0 0 256 256",width:"1.2em",height:"1.2em",...q})),a(f,C)}var et=me('<svg width="1.2em" height="1.2em" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 8L5.5 11.5L13 4" stroke="currentColor" stroke-linecap="round"></path></svg>');function tt(f){var e=et();a(f,e)}function ge(f,e){_e(e,!0);const q=I(e,"children",3,void 0),C=I(e,"tag",3,"article"),z=L(()=>!!e.onclick);var S=P(),V=b(S);Ve(V,C,!1,(J,T)=>{var j=A=>{A.key==="Enter"&&e.onclick?.()};te(J,A=>({class:"card",onclick:e.onclick,tabindex:s(z)?0:void 0,onkeypress:j,[ke]:A}),[()=>({clickable:s(z)})],void 0,"svelte-2gevwt");var K=P(),W=b(K);Xe(W,()=>q()??Me),a(T,K)}),a(f,S),he()}var at=c('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),st=c("<!> Supprimer",1),rt=c("<!> Rééssayer",1),ot=c('<section class="errored-actions svelte-pa7bo1"><!> <!></section>'),it=c('<div class="loading-overlay svelte-pa7bo1"><!> <span class="text smol svelte-pa7bo1"><!></span> <!></div>'),lt=c('<img class="svelte-pa7bo1"/>'),nt=c('<div class="img-placeholder svelte-pa7bo1"><!></div>'),vt=c('<div data-testid="card-observation-bounding-box" class="bb svelte-pa7bo1"></div>'),dt=(f,e)=>{f.stopPropagation(),e.onstacksizeclick?.()},ct=c('<div class="inner svelte-pa7bo1"><!> <div><!> <!></div> <footer class="svelte-pa7bo1"><div class="check-icon svelte-pa7bo1"><!></div> <h2 class="svelte-pa7bo1"> </h2> <button class="stack-count svelte-pa7bo1"> </button></footer></div>'),ut=c('<div class="stack-background-card svelte-pa7bo1"><!></div>'),ft=c('<article><div class="main-card svelte-pa7bo1"><!></div> <!></article>');function Et(f,e){_e(e,!0);const q=I(e,"selected",3,!1),C=I(e,"selectable",3,!0),z=I(e,"stacksize",3,1),S=I(e,"boundingBoxes",19,()=>[]),V=be(e,["$$slots","$$events","$$legacy","onclick","onstacksizeclick","ondelete","onretry","title","image","selected","selectable","highlighted","status","statusText","loadingStatusText","stacksize","boundingBoxes","boxes","tooltip","id"]),J=L(()=>z()>1),T=L(()=>e.status==="loading"||e.status==="queued"),j=L(()=>e.status==="errored"),K=L(()=>e.status==="loading"?"Chargement…":e.status==="queued"?"En attente":e.status==="errored"?"Erreur":"");let W=le(void 0),A=le(0),xe=L(()=>s(A)<s(W)?.scrollWidth);var H=ft();te(H,g=>({class:"observation","data-selectable":C()?"":void 0,"data-id":e.id,...V,[ke]:g}),[()=>({selected:q(),selectable:C(),highlighted:e.highlighted,loading:s(T),stacked:s(J)})],void 0,"svelte-pa7bo1");var N=v(H),we=v(N);{let g=L(()=>e.onclick&&!s(T)&&!s(j)?e.onclick:()=>{});ge(we,{tag:"div",get onclick(){return s(g)},children:(B,ae)=>{var Q=ct(),se=v(Q);{var Be=t=>{var r=it(),k=v(r);{var D=o=>{var i=at(),w=b(i);Ge(w,()=>({"--size":"1.5em"})),Ze(w.lastChild,{variant:"error"}),l(w),a(o,i)},x=o=>{var i=P(),w=b(i);{var X=y=>{fe(y,{})},Y=y=>{var u=P(),m=b(u);{var Z=_=>{fe(_,{waiting:!0})};d(m,_=>{e.status==="queued"&&_(Z)},!0)}a(y,u)};d(w,y=>{e.status==="loading"?y(X):y(Y,!1)},!0)}a(o,i)};d(k,o=>{e.status==="errored"?o(D):o(x,!1)})}var n=h(k,2),F=v(n);{var Ie=o=>{var i=ve();G(()=>R(i,e.loadingStatusText)),a(o,i)},qe=o=>{var i=ve();G(()=>R(i,e.statusText||s(K))),a(o,i)};d(F,o=>{e.status==="loading"&&e.loadingStatusText?o(Ie):o(qe,!1)})}l(n);var We=h(n,2);{var He=o=>{var i=ot(),w=v(i);{var X=u=>{ce(u,{dangerous:!0,onclick:m=>{m.stopPropagation(),e.ondelete()},children:(m,Z)=>{var _=st(),p=b(_);Ue(p,{}),de(),a(m,_)},$$slots:{default:!0}})};d(w,u=>{e.ondelete&&u(X)})}var Y=h(w,2);{var y=u=>{ce(u,{onclick:m=>{m.stopPropagation(),e.onretry()},children:(m,Z)=>{var _=rt(),p=b(_);$e(p,{}),de(),a(m,_)},$$slots:{default:!0}})};d(Y,u=>{!s(T)&&e.onretry&&u(y)})}l(i),a(o,i)};d(We,o=>{(e.ondelete||e.onretry)&&o(He)})}l(r),a(t,r)};d(se,t=>{e.status!=="ok"&&t(Be)})}var O=h(se,2);let re;var oe=v(O);{var Le=t=>{var r=P(),k=b(r);{var D=n=>{Ye(n,{blurfill:!0,get src(){return e.image},get alt(){return e.title},get box(){return S()[0]}})},x=n=>{var F=lt();G(()=>{ue(F,"src",e.image),ue(F,"alt",e.title)}),a(n,F)};d(k,n=>{e.boxes==="apply-first"&&S().length>0?n(D):n(x,!1)})}a(t,r)},ze=t=>{var r=nt(),k=v(r);Qe(k,{}),l(r),a(t,r)};d(oe,t=>{e.image?t(Le):t(ze,!1)})}var Se=h(oe,2);{var Te=t=>{var r=P(),k=b(r);Je(k,17,S,Ke,(D,x)=>{var n=vt();G(()=>Re(n,`left: ${s(x).x*100}%; top: ${s(x).y*80}%; width: ${s(x).width*100}%; height: ${80*s(x).height}%;`)),a(D,n)}),a(t,r)};d(Se,t=>{e.boxes==="show-all"&&t(Te)})}l(O);var ie=h(O,2),U=v(ie),Ae=v(U);tt(Ae),l(U);var E=h(U,2),Ee=v(E,!0);l(E),Ne(E,t=>ne(W,t),()=>s(W)),De(()=>je(E,"offsetWidth",t=>ne(A,t))),$(E,(t,r)=>ee?.(t,r),()=>s(xe)?e.title:void 0);var M=h(E,2);M.__click=[dt,e];var Pe=v(M,!0);l(M),$(M,(t,r)=>ee?.(t,r),()=>`Cette observation regroupe ${z()} images. Cliquez pour les voir toutes.`),l(ie),l(Q),G(t=>{re=Oe(O,1,"boundingboxes-wrapper svelte-pa7bo1",null,re,t),R(Ee,e.title),M.disabled=s(T),R(Pe,z())},[()=>({"has-boxes":e.boxes==="show-all"})]),a(B,Q)},$$slots:{default:!0}})}l(N);var ye=h(N,2);{var Ce=g=>{var B=ut(),ae=v(B);ge(ae,{tag:"div"}),l(B),a(g,B)};d(ye,g=>{s(J)&&g(Ce)})}l(H),$(H,(g,B)=>ee?.(g,B),()=>e.tooltip),a(f,H),he()}Fe(["click"]);export{Et as C};
