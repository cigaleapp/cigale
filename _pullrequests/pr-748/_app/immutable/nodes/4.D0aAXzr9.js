import"../chunks/DsnmJJEf.js";import{A as E,J as M,G as k,i as d,B as q,F as b,aA as s,aB as _,K as l,t as P,g as c,aC as F,aD as G,D as x}from"../chunks/DLg_PPZ_.js";import{s as w}from"../chunks/9TbOa8jV.js";import{s as J}from"../chunks/USdlu_3B.js";import{a as K}from"../chunks/C_q2VfFz.js";import{i as I}from"../chunks/D67Hg_eN.js";import{s as O}from"../chunks/BNnFn6yw.js";import{t as R,f as U}from"../chunks/CKZ3iiSi.js";import{L as A}from"../chunks/Bx3yqWKm.js";import{P as j}from"../chunks/BidjZCUT.js";import{i as H,u as n}from"../chunks/yjQBtq-m.js";import{t as N}from"../chunks/BVoxKip6.js";import{s as Q}from"../chunks/Csf0LG85.js";const C=y=>{var i=M(),g=k(i);{var h=p=>{const v=x(()=>{const{model:o}=n.cropModels[n.selectedCropModel];return{model:o}}),a=x(()=>new URL(typeof c(v).model=="string"?c(v).model:c(v).model?.url));var e=T(),r=s(e),t=s(r,!0);l(r),l(e),P((o,m)=>{O(e,"href",o),w(t,m)},[()=>c(a).toString(),()=>c(a).pathname.split("/").at(-1)]),d(p,e)};I(g,p=>{n.cropInferenceAvailable&&p(h)})}d(y,i)};var T=b('<a target="_blank" class="svelte-9zb7ys"><code class="svelte-9zb7ys"> </code></a>'),V=b('<pre class="svelte-9zb7ys"> </pre>'),W=b('<section class="loading errored svelte-9zb7ys"><!> <h2 class="svelte-9zb7ys">Oops!</h2> <p class="svelte-9zb7ys">Impossible de charger le modèle de recadrage</p> <p class="source svelte-9zb7ys"><!></p> <p class="message svelte-9zb7ys"> </p> <!></section>'),X=b('<section class="loading svelte-9zb7ys"><!> <p>Chargement du modèle de recadrage…</p> <p class="source svelte-9zb7ys"><!></p> <div class="progressbar svelte-9zb7ys"><!></div></section>');function de(y,i){E(i,!0);let g=F(0);async function h(a){if(!n.currentProtocol||!n.cropInferenceAvailable)return;const e=n.currentProtocol.crop.infer?.[a]?.model;e&&await i.data.swarpc.loadModel.broadcast({protocolId:n.currentProtocol.id,request:e,task:"detection"},r=>{G(g,Q(r.values())/i.data.parallelism)}).catch(r=>{console.error(r),N.error("Erreur lors du chargement du modèle de détection")})}var p=M(),v=k(p);K(v,()=>h(n.selectedCropModel),a=>{var e=X(),r=s(e);A(r,{loading:!0});var t=_(r,4),o=s(t);C(o),l(t);var m=_(t,2),u=s(m);j(u,{percentage:!0,alwaysActive:!0,get progress(){return c(g)}}),l(m),l(e),R(1,e,()=>U,()=>({duration:100})),d(a,e)},(a,e)=>{var r=M(),t=k(r);J(t,()=>i.children),d(a,r)},(a,e)=>{var r=W(),t=s(r);A(t,{variant:"error"});var o=_(t,6),m=s(o);C(m),l(o);var u=_(o,2),L=s(u,!0);l(u);var B=_(u,2);{var D=f=>{var z=V(),S=s(z);l(z),P(()=>w(S,`
					${c(e)?.stack??"(no stack trace available)"??""}
				`)),d(f,z)};I(B,f=>{H()&&f(D)})}l(r),P(f=>w(L,f),[()=>c(e)?.toString()??"Erreur inattendue"]),d(a,r)}),d(y,p),q()}export{de as component};
