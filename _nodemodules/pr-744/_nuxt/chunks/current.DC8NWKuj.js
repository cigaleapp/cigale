import{B as e,Et as t,Gt as n,Ht as r,I as i,Mt as a,Nt as o,Ot as s,R as c,S as l,Tt as u,Zt as d,_ as f,b as p,en as m,fn as h,g,h as _,jt as v,kt as y,ln as b,qt as x,rn as S,t as C,w,x as T,z as E}from"../entry.CUq7HivD.js";function D(e){let t=new Map;for(let n of e)t.has(n.name)||t.set(n.name,[]),t.get(n.name).push(n);return t}function O(t){let n=u(t),r=u(()=>new Map(n.value.map(e=>[e.spec,e]))),i=u(()=>D(n.value)),a=u(()=>{let e=new Set;for(let t of n.value)for(let n of t.clusters)e.add(n);return e}),o=e=>typeof e==`string`?r.value.get(e):r.value.has(e.spec)?e:void 0,s=e=>r.value.has(typeof e==`string`?e:e.spec),l=e=>Array.from(function*(){for(let t of e){let e=o(t);e&&(yield e)}}()),f={dependencies:new Map,dependents:new Map,flatDependencies:new Map,flatDependents:new Map},p=new Map;d(n,()=>{f.dependencies.clear(),f.dependents.clear(),f.flatDependencies.clear(),f.flatDependents.clear(),p.clear()});function m(e){return t=>{let n=f[e].get(t.spec);if(n)return n;let r=l(t[e]);return f[e].set(t.spec,r),r}}let h=m(`flatDependents`),g=m(`flatDependencies`),_=m(`dependencies`),v=m(`dependents`);function y(e){let t=p.get(e.spec);if(t)return t;let n=new Set(e.clusters);for(let t of h(e))for(let e of t.clusters)n.add(e);return p.set(e.spec,n),n}function b(t,n){return y(t).has(n===`dev`?c:n===`prod`?e:E)}return S({packages:n,map:r,versions:i,clusters:a,has:s,get:o,getList:l,dependencies:_,dependents:v,flatDependents:h,flatDependencies:g,flatClusters:y,isInDepCluster:b})}var k=O(()=>Array.from(l.value?.packages.values()||[])),A=O(()=>Array.from(w.value?.packages.values()||[])),j=O(()=>{let e=new Set(k.packages.filter(f)),t=!0;for(;t;){t=!1;for(let n of k.packages){if(e.has(n)||!n.dependents.size)continue;let r=!0;for(let t of n.dependents){let n=k.map.get(t);if(!n||!e.has(n)){r=!1;break}}r&&(e.add(n),t=!0)}}if(g.state.excludeWorkspace)for(let t of k.packages)t.workspace&&e.add(t);return Array.from(e)}),M=O(()=>k.packages.filter(e=>e.workspace)),N=O(()=>k.packages.filter(e=>!j.map.has(e.spec)));const P={main:k,excluded:j,workspace:M,available:N,filtered:O(()=>N.packages.filter(_.value)),compareA:O(()=>{if(!g.state.compareA?.length)return[];let e=new Set(N.getList(g.state.compareA).flatMap(e=>[e,...N.flatDependencies(e)]));return Array.from(e)}),compareB:O(()=>{if(!g.state.compareB?.length)return[];let e=new Set(N.getList(g.state.compareB).flatMap(e=>[e,...N.flatDependencies(e)]));return Array.from(e)}),reference:A};function F(e){let t=P.main.get(e);return t&&(t.resolved.npmMeta||p.value.get(t.spec))||null}function I(e){let t=P.main.get(e);return t&&[t.resolved.npmMetaLatest,T.value.get(t.name)].filter(e=>!!e).sort((e,t)=>t.fetechedAt-e.fetechedAt)[0]||null}function L(e){let t=F(e)?.publishedAt;return t?new Date(t):null}function R(e){let t=F(e),n=I(e);return!t?.deprecated&&!n?.deprecated?null:{type:t?.deprecated&&n?.deprecated?`package`:t?.deprecated&&!n?.deprecated?`current`:`future`,current:t?.deprecated,latest:n?.deprecated,latestVersion:n?.version}}const z=u(()=>Array.from(P.available.packages).reduce((e,t)=>e+(t.resolved.installSize?.bytes||0),0));var B={"font-mono":``},V=o({__name:`PackageName`,props:{name:{}},setup(e){return(t,n)=>(r(),y(`span`,B,h(e.name),1))}}),H=Object.assign(V,{__name:`DisplayPackageName`}),U={key:0,"font-mono":``},W=o({__name:`Version`,props:{version:{},prefix:{}},setup(e){return(t,n)=>e.version?(r(),y(`span`,U,h(e.prefix||``)+h(e.version?.includes(`:`)?e.version:`${e.prefix?``:`v`}${e.version}`),1)):s(``,!0)}}),G=Object.assign(W,{__name:`DisplayVersion`});function K(e,t=2){let n=[`Bytes`,`KB`,`MB`,`GB`,`TB`],r=Math.floor(Math.log(e)/Math.log(1024));return r===0?[`<1`,`K`]:[(+(e/1024**r).toFixed(t)).toLocaleString(),n[r]]}var q={"text-xs":``,op75:``,"ml-0.4":``},J={key:0,"text-xs":``,ml1:``,"op-fade":``,border:`l base`,pl1:``},Y=1024,X=o({__name:`FileSizeBadge`,props:{bytes:{},colorize:{type:Boolean,default:!0},digits:{default:2},percent:{type:Boolean,default:!0},total:{},icon:{},percentRatio:{default:.5}},setup(e){let a=e,o=Y**2,c=[[80*Y,`color-scale-neutral`],[500*Y,`color-scale-low`],[1*o,`color-scale-medium`],[10*o,`color-scale-high`],[20*o,`color-scale-critical`]],l=u(()=>{if(!i.value.colorizePackageSize&&!a.colorize)return c[0];let e=a.bytes||0;for(let[t,n]of c)if(e<t)return n;return c[c.length-1][1]}),d=u(()=>(a.bytes||0)*100/(a.total??z.value)),f=u(()=>K(a.bytes||0,a.digits));return(i,a)=>e.bytes?(r(),y(`div`,{key:0,class:b([l.value,`px-0.4em py-0.2em font-mono line-height-none bg-gray:5 dark:bg-gray:4 flex items-center`])},[e.icon?(r(),y(`div`,{key:0,class:b([e.icon,`mr-1`])},null,2)):s(``,!0),v(` `+h(f.value[0]),1),t(`span`,q,h(f.value[1]),1),n(i.$slots,`after`,{},()=>[e.percent&&d.value>e.percentRatio?(r(),y(`span`,J,h(+d.value.toFixed(1))+`%`,1)):s(``,!0)])],2)):s(``,!0)}}),Z=Object.assign(X,{__name:`DisplayFileSizeBadge`}),Q={key:0,"h-1em":``,"w-1.5em":``,relative:``,"of-visible":``,"inline-block":``},$=o({__name:`PackageSpec`,props:{pkg:{}},setup(e){let n=e,i=u(()=>R(n.pkg));return(o,c)=>{let l=H,u=G,d=x(`tooltip`);return r(),y(`span`,null,[e.pkg.workspace?(r(),y(`span`,Q,[...c[0]||=[t(`div`,{title:`Workspace Package`,"i-catppuccin-folder-packages-open":``,"icon-catppuccin":``,mr2:``,absolute:``,"left-0":``,"top-0":``},null,-1)]])):s(``,!0),m(a(l,{name:n.pkg.name,pkg:n.pkg,class:b(i.value?.latest?i.value?.type===`future`?`text-orange line-through`:`text-red line-through`:void 0)},null,8,[`name`,`pkg`,`class`]),[[d,i.value?.latest?`Package is deprecated: ${i.value.latest}`:void 0]]),m(a(u,{"op-fade":``,version:n.pkg.version,prefix:`@`,class:b({"text-red line-through":i.value?.current})},null,8,[`version`,`class`]),[[d,i.value?.current?`Current version is deprecated: ${i.value.current}`:void 0]])])}}}),ee=Object.assign($,{__name:`DisplayPackageSpec`});const te=u({get(){return C.selected?P.main.get(C.selected):void 0},set(e){C.selected=e?.spec}});export{G as a,F as c,P as d,z as f,K as i,I as l,ee as n,H as o,Z as r,R as s,te as t,L as u};