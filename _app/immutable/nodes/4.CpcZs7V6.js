import{e as p}from"../chunks/ft-thZGf.js";import{g as u}from"../chunks/D9eftTZy.js";import{t as l,b,p as y,u as _}from"../chunks/Don2Ydo1.js";import{o as S}from"../chunks/BOvN9V9s.js";import{u as d}from"../chunks/BPJfxdhi.js";import"../chunks/DsnmJJEf.js";import{C as v,D as w,a as O}from"../chunks/BwdvgNQo.js";import{s as I}from"../chunks/DYy3QkOc.js";async function M({parent:r}){await r();const a=await l.Metadata.list(),e=b("js");d.currentSessionId||p(400,e(517));const t=await l.Session.get(d.currentSessionId);t||p(404,e(518));const s=await y("Observation","sessionId",t.id),m=t?.sort.classify??t?.sort.global,c=t?.group.classify??t?.group.global;if(m&&c){console.time("sort"),console.time("sort: make sorter");const i=await u({sortSettings:m,groupSettings:c});console.timeEnd("sort: make sorter"),console.time("sort: get all images");const n=await l.Image.getMany(_(s.flatMap(({images:o})=>o)));console.timeEnd("sort: get all images");const f=o=>({id:o.id,name:o.label,metadata:S({definitions:a,observation:o,images:n})});console.time("sort: sort array"),s.sort((o,g)=>i(f(o),f(g))),console.timeEnd("sort: sort array"),console.timeEnd("sort"),console.info(`Sorted ${s.length} observations for classification navigation`,s.map(o=>o.label))}return{currentSession:t,metadataDefinitions:a,observationsOrder:new Map(s.map(({id:i},n)=>[i,n]))}}const A=Object.freeze(Object.defineProperty({__proto__:null,load:M},Symbol.toStringTag,{value:"Module"}));function B(r,a){var e=v(),t=w(e);I(t,()=>a.children),O(r,e)}export{B as component,A as universal};
