import{g as L}from"../chunks/7XoH3LsZ.js";import{b as ht,V as Q,I as wt,C as yt,a9 as kt,t as et}from"../chunks/Don2Ydo1.js";import"../chunks/DsnmJJEf.js";import{p as ot,H as p,a as _,b as nt,ar as a,g as t,u as d,J as r,D as U,ap as i,G as E,at as jt,F as St,I as Tt,b2 as It}from"../chunks/BwdvgNQo.js";import{s as m}from"../chunks/HTLptRgQ.js";import{i as W}from"../chunks/CKH9F0ww.js";import{e as Nt}from"../chunks/CuPIRSst.js";import{t as Ot,f as qt}from"../chunks/BjiNJ5CV.js";import{p as st}from"../chunks/BzM0mbGE.js";import{s as Jt}from"../chunks/B2RSv_jY.js";import{a as Pt}from"../chunks/CEoeiZ5P.js";import{t as Et}from"../chunks/BYqiwRWy.js";import{Z as Mt}from"../chunks/5NMmPB3q.js";import{A as Rt}from"../chunks/Cyizp9nt.js";import{E as zt}from"../chunks/3hMEuLq3.js";import{g as at}from"../chunks/BDV6zAFm.js";import{B as rt}from"../chunks/DfpvCGjf.js";import{I as Ct}from"../chunks/DGHPOcQf.js";import{u as At}from"../chunks/B6HkNRPu.js";import{b as it}from"../chunks/08d27X49.js";import{R as A}from"../chunks/DWCXZatK.js";async function Dt({parent:D}){const l=await D(),o=[],{images:{cropped:x,original:y},metadata:{csv:T,json:O}}=l.exports??{images:{cropped:{toJSON:()=>"cropped/{{ sequence }}.{{ extension image.filename }}"},original:{toJSON:()=>"original/{{ sequence }}.{{ extension image.filename }}"}},metadata:{csv:"metadata.csv",json:"metadata.json"}},k=ht("js");return L({tree:o,provenance:"metadata.csv",paths:[T],help:k(494),contentType:()=>"text/csv"}),L({tree:o,provenance:"metadata.json",paths:[O],help:k(495),contentType:()=>"application/json"}),L({tree:o,provenance:"images.cropped",paths:[x.toJSON()],help:k(496),contentType:()=>"image/x-unknown"}),L({tree:o,provenance:"images.original",paths:[y.toJSON()],help:k(497),contentType:()=>"image/x-unknown"}),{protocol:l,initialTree:o}}const ye=Object.freeze(Object.defineProperty({__proto__:null,load:Dt},Symbol.toStringTag,{value:"Module"}));var Bt=p('<div class="text svelte-1kjizd4"><p class="svelte-1kjizd4"><!> </p> <small> </small></div> <div class="actions"><!></div>',1),Ht=p('<div class="text empty svelte-1kjizd4"><p class="svelte-1kjizd4"><!></p> <small> </small></div> <div class="actions"><!></div>',1),Lt=p('<div class="metadata-link svelte-1kjizd4"><!></div>');function Ft(D,l){ot(l,!0);const o=d(()=>it("main")),x=d(()=>l.key?wt(l.key):void 0),y=d(()=>st.params.id??""),T=d(()=>l.key?l.definitions.find(g=>Q(g.id,t(y))===Q(l.key,t(y))):void 0);var O=Lt(),k=a(O);{var F=g=>{var q=Bt(),j=U(q),h=a(j),M=a(h);Ct(M,{tooltip:!1,get type(){return t(T).type}});var I=i(M);r(h);var R=i(h,2),N=a(R,!0);r(R),r(j);var z=i(j,2),J=a(z);{const f=w=>{Rt(w,{})};rt(J,{onclick:async()=>at("/(app)/protocols/[id]/metadata/[metadata]/infos",{id:t(y),metadata:t(x)}),_w_snippet_0:f,children:(w,u)=>{{let C=d(()=>[f]),S=d(()=>t(o).c(225));A(w,{get t(){return t(C)},get x(){return t(S)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}r(z),E(()=>{m(I,` ${(t(T).label||t(x))??""}`),m(N,l.help)}),_(g,q)},H=g=>{var q=Ht(),j=U(q),h=a(j);{const f=w=>{zt(w,{})};var M=a(h);{let w=d(()=>[f]),u=d(()=>t(o).c(226));A(M,{get t(){return t(w)},get x(){return t(u)}})}r(h)}var I=i(h,2),R=a(I,!0);r(I),r(j);var N=i(j,2),z=a(N);{var J=f=>{{let w=d(()=>At(async u=>{if(!l.key)return;const C=Q(t(x),u.id);l.definitions.some(S=>S.id===C)||(await l.oncreate?.(t(x)),u.metadata.push(t(x))),l.onupdate?.(u,t(x)),await at("/(app)/protocols/[id]/metadata/[metadata]/infos",{id:u.id,metadata:t(x)})}));rt(f,{get onclick(){return t(w)},children:(u,C)=>{jt();var S=St();E(Z=>m(S,Z),[()=>t(o)(211)]),_(u,S)},$$slots:{default:!0}})}};W(z,f=>{l.oncreate&&f(J)})}r(N),E(()=>m(R,l["no-metadata"])),_(g,q)};W(k,g=>{t(T)?g(F):g(H,!1)})}r(O),_(D,O),nt()}var Zt=p("<strong><code></code></strong>"),Gt=p('<a target="_blank" href="https://handlebarsjs.com/guide/"> </a>'),Kt=p("<br/>"),Vt=p("<br/>"),Qt=p("<br/>"),Ut=p("<br/>"),Wt=p("<br/>"),Xt=p("<br/>"),Yt=p("<dt> <br/> </dt> <dd> </dd>",1),$t=p('<pre class="debug svelte-1aq0bmb"> </pre>'),te=p('<main class="svelte-1aq0bmb"><h2> </h2> <h3 class="svelte-1aq0bmb"> </h3> <!> <h3 class="svelte-1aq0bmb"> </h3> <!> <p><!></p> <p><!></p> <h3 class="svelte-1aq0bmb"> </h3> <dl class="variables-docs svelte-1aq0bmb"><dt><!></dt> <dd> </dd> <dt><!></dt> <dd> </dd> <dt></dt> <dd> </dd> <dt></dt> <dd> </dd> <!></dl> <!></main>');function ke(D,l){ot(l,!0);const o=d(()=>it("main"));Jt({title:t(o)(245,[st.params.id])});async function x(c,s){const[n,e]=c.split("."),{id:v,exports:b}=l.data.protocol;if(!b){Et.error(t(o)(246));return}const P={images:{cropped:b.images.cropped.toJSON(),original:b.images.original.toJSON()},metadata:{csv:b.metadata.csv,json:b.metadata.json}};P[n][e]=s.replace(/^\//,"").replace(/\/$/,""),await et.Protocol.update(v,"exports",P)}var y=te(),T=a(y),O=a(T,!0);r(T);var k=i(T,2),F=a(k,!0);r(k);var H=i(k,2);{let c=d(()=>l.data.protocol.exports?.images.mtime),s=d(()=>t(o)(355)),n=d(()=>t(o)(356));Ft(H,{get definitions(){return l.data.metadataDefinitions},get key(){return t(c)},get help(){return t(s)},get"no-metadata"(){return t(n)}})}var g=i(H,2),q=a(g,!0);r(g);var j=i(g,2);Mt(j,{get tree(){return l.data.initialTree},editable:!0,onedit:x});var h=i(j,2);{const c=s=>{var n=Zt(),e=a(n);e.textContent="{{ comme_ceci }}",r(n),_(s,n)};var M=a(h);{let s=d(()=>[c]),n=d(()=>t(o).c(247));A(M,{get t(){return t(s)},get x(){return t(n)}})}r(h)}var I=i(h,2);{const c=(s,n=Tt)=>{var e=Gt(),v=a(e,!0);r(e),E(b=>m(v,b),[()=>t(o).x(n())]),_(s,e)};var R=a(I);{let s=d(()=>[c]),n=d(()=>t(o).c(248));A(R,{get t(){return t(s)},get x(){return t(n)},a:["{{}}"]})}r(I)}var N=i(I,2),z=a(N,!0);r(N);var J=i(N,2),f=a(J);{const c=e=>{var v=Kt();_(e,v)},s=e=>{var v=Vt();_(e,v)},n=e=>{var v=Qt();_(e,v)};var w=a(f);{let e=d(()=>[c,s,n]),v=d(()=>t(o).c(250));A(w,{get t(){return t(e)},get x(){return t(v)},a:["{{ observation }}","{{ observation.label }}","{{ observation.protocolMetadata.species.confidence }}"]})}r(f)}var u=i(f,2),C=a(u,!0);r(u);var S=i(u,2);{const c=e=>{var v=Ut();_(e,v)},s=e=>{var v=Wt();_(e,v)},n=e=>{var v=Xt();_(e,v)};var Z=a(S);{let e=d(()=>[c,s,n]),v=d(()=>t(o).c(250));A(Z,{get t(){return t(e)},get x(){return t(v)},a:["{{ image }}","{{ image.filename }}","{{ image.protocolMetadata.shoot_date.value }}"]})}r(S)}var G=i(S,2),dt=a(G,!0);r(G);var X=i(G,2);X.textContent="{{ sequence }}";var K=i(X,2),lt=a(K,!0);r(K);var Y=i(K,2);Y.textContent="{{ numberInObservation }}";var V=i(Y,2),vt=a(V,!0);r(V);var ct=i(V,2);Nt(ct,17,()=>yt(kt),([c,{documentation:s,usage:n}])=>c,(c,s)=>{var n=d(()=>It(t(s),2));let e=()=>t(n)[1].documentation,v=()=>t(n)[1].usage;const b=d(()=>{const[ft,bt]=v().split("->").map(xt=>xt.trim());return{call:ft,result:bt}});var P=Yt(),B=U(P),$=a(B,!0),ut=i($,2);r(B);var tt=i(B,2),gt=a(tt,!0);r(tt),E(()=>{m($,t(b).call),m(ut,` â†’ ${t(b).result??""}`),m(gt,e())}),_(c,P)}),r(J);var mt=i(J,2);{var _t=c=>{var s=$t(),n=a(s,!0);r(s),E(e=>m(n,e),[()=>JSON.stringify(et.Protocol.state.find(e=>e.id===l.data.protocol.id)?.exports,null,2)]),_(c,s)},pt=d(()=>Pt().showTechnicalMetadata);W(mt,c=>{t(pt)&&c(_t)})}r(y),E((c,s,n,e,v,b,P,B)=>{m(O,c),m(F,s),m(q,n),m(z,e),m(C,v),m(dt,b),m(lt,P),m(vt,B)},[()=>t(o)(353),()=>t(o)(354),()=>t(o)(357),()=>t(o)(249),()=>t(o)(251),()=>t(o)(252),()=>t(o)(341),()=>t(o)(253)]),Ot(1,y,()=>qt,()=>({duration:100})),_(D,y),nt()}export{ke as component,ye as universal};
