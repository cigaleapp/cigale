import{b as Dt,a as pt,d as Oa,s as Ee,c as Tr}from"../chunks/08d27X49.js";import"../chunks/DsnmJJEf.js";import{ap as ei,an as ti}from"../chunks/CtvchpM1.js";import{o as ri,c as ai,bM as ii,h as mr,k as ni,Q as oi,a2 as Kr,P as Yr,B as Qr,j as si,bN as li,p as gt,ao as je,b as ht,C as Te,D as le,H as V,ar as $,J as S,ap as M,G as Y,g as t,u as h,a as E,b2 as Wr,f as wt,aq as be,aK as di,as as ae,at as Ct,F as Ot,I as Pt}from"../chunks/BwdvgNQo.js";import{e as ci}from"../chunks/ft-thZGf.js";import{g as fr,h as ui,z as mi,j as Zr,k as fi,l as vi,R as pi,m as Ia,n as Ra,s as Aa,o as gi}from"../chunks/YI6rRCuH.js";import{l as hi}from"../chunks/BAHerLWL.js";import{ak as wi,aK as bi,aL as It,aM as Fe,aN as Ue,aO as Ta,f as F,S as vr,aP as yi,b as or,aQ as _i,aR as ki,t as ye,a1 as Wa,o as Si,al as xi,C as Et,aJ as ea,aS as $i,aT as pr,I as ta,aU as ra,a6 as Mi,U as Pi,r as Na,D as aa,a as Nr,_ as Ei,R as Ci}from"../chunks/Don2Ydo1.js";import{f as Oi,m as Ii}from"../chunks/Xiow3_xo.js";import{g as ia,i as er,s as Ce,b as Da,a as Dr}from"../chunks/CEoeiZ5P.js";import{t as $e}from"../chunks/BYqiwRWy.js";import{N as Ri}from"../chunks/7XoH3LsZ.js";import{o as na}from"../chunks/BXq8bD8b.js";import{e as tr}from"../chunks/CuPIRSst.js";import{s as Ai}from"../chunks/DYy3QkOc.js";import{p as Rt,i as se,r as bt,s as La}from"../chunks/CKH9F0ww.js";import{w as Ti}from"../chunks/2OzU4e1W.js";import{u as j,a as ja}from"../chunks/BPJfxdhi.js";import{v as Lr}from"../chunks/BvLlM67q.js";import{g as Wi}from"../chunks/BDV6zAFm.js";import{r as Ae}from"../chunks/BRmTdaxr.js";import{p as we}from"../chunks/BzM0mbGE.js";import{l as Ni}from"../chunks/DfkTl275.js";import{d as rr,u as Di}from"../chunks/iDw1HNQ9.js";import{s as K,e as Li,d as za,b as Ha}from"../chunks/HTLptRgQ.js";import{c as ar}from"../chunks/CxwMZO45.js";import{K as ji,x as zi,a as gr,t as hr}from"../chunks/C6sIn56-.js";import{h as oa,M as Vr,B as Hi,t as qi,T as Fi}from"../chunks/5g7xaRkA.js";import{t as wr,f as br}from"../chunks/BjiNJ5CV.js";import{a as sa}from"../chunks/lhkQGyGN.js";import{A as yr}from"../chunks/CkHS13jn.js";import{C as Ui}from"../chunks/D0DqjGxz.js";import{B as mt}from"../chunks/LNwaZJFt.js";import{B as Bi}from"../chunks/DfpvCGjf.js";import{L as Vi}from"../chunks/72YJCPe-.js";import{g as rt}from"../chunks/DyfjURbU.js";import{P as qa}from"../chunks/BRQ5Qhft.js";import{L as Gi}from"../chunks/DkW1Bdbi.js";import{B as la}from"../chunks/DgJA6oA6.js";import{R as Oe}from"../chunks/DWCXZatK.js";import{c as jr}from"../chunks/CaPT1Hnn.js";import{a as Ji,I as Fa}from"../chunks/BWUfZxGx.js";import{B as zr}from"../chunks/CayOuDVJ.js";import{F as da}from"../chunks/CfpiF-ni.js";import{b as Xi}from"../chunks/DB45Zn9a.js";import{A as Ki}from"../chunks/BsYyX4S0.js";import{C as Yi}from"../chunks/D7fs65L7.js";import{L as Qi}from"../chunks/B-T9H-ER.js";import{I as Zi,S as en}from"../chunks/7yAVqGsj.js";import"../chunks/BUApaBEI.js";import{S as tn}from"../chunks/BW1llP4t.js";import{S as _r}from"../chunks/qerflRe8.js";import{g as rn}from"../chunks/BdwaJYMX.js";import{s as ca}from"../chunks/CuKI1hs9.js";import{A as an}from"../chunks/CMG_9Ef3.js";import{A as nn}from"../chunks/xJVponh6.js";import{C as on}from"../chunks/DZRaQp3m.js";import{D as sn}from"../chunks/Bsw8Srli.js";import{f as ln}from"../chunks/CTNR6MTR.js";import{m as ua}from"../chunks/Bd7_h5c3.js";import{b as dn}from"../chunks/CvTg-rNJ.js";function cn(e,r){let a=null,i=mr;var n;if(mr){a=si;for(var d=ni(document.head);d!==null&&(d.nodeType!==oi||d.data!==e);)d=Kr(d);if(d===null)Yr(!1);else{var s=Kr(d);d.remove(),Qr(s)}}mr||(n=document.head.appendChild(ri()));try{ai(()=>r(n),ii)}finally{i&&(Yr(!0),Qr(a))}}function un(e){const r={},a=wi();for(const i in a)Object.prototype.hasOwnProperty.call(a,i)&&(r[i]=a[i]);for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(e[i]===void 0?delete r[i]:r[i]=e[i]);bi(r)}const mn={lessThanXSeconds:{one:"moins d’une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins d’une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus d’un an",other:"plus de {{count}} ans"},almostXYears:{one:"presqu’un an",other:"presque {{count}} ans"}},fn=(e,r,a)=>{let i;const n=mn[e];return typeof n=="string"?i=n:r===1?i=n.one:i=n.other.replace("{{count}}",String(r)),a?.addSuffix?a.comparison&&a.comparison>0?"dans "+i:"il y a "+i:i},vn={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},pn={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},gn={full:"{{date}} 'à' {{time}}",long:"{{date}} 'à' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hn={date:It({formats:vn,defaultWidth:"full"}),time:It({formats:pn,defaultWidth:"full"}),dateTime:It({formats:gn,defaultWidth:"full"})},wn={lastWeek:"eeee 'dernier à' p",yesterday:"'hier à' p",today:"'aujourd’hui à' p",tomorrow:"'demain à' p'",nextWeek:"eeee 'prochain à' p",other:"P"},bn=(e,r,a,i)=>wn[e],yn={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jésus-Christ","après Jésus-Christ"]},_n={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2ème trim.","3ème trim.","4ème trim."],wide:["1er trimestre","2ème trimestre","3ème trimestre","4ème trimestre"]},kn={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],wide:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"]},Sn={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},xn={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"après-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de l’après-midi",evening:"du soir",night:"du matin"}},$n=(e,r)=>{const a=Number(e),i=r?.unit;if(a===0)return"0";const n=["year","week","hour","minute","second"];let d;return a===1?d=i&&n.includes(i)?"ère":"er":d="ème",a+d},Mn=["MMM","MMMM"],Pn={preprocessor:(e,r)=>e.getDate()===1||!r.some(i=>i.isToken&&Mn.includes(i.value))?r:r.map(i=>i.isToken&&i.value==="do"?{isToken:!0,value:"d"}:i),ordinalNumber:$n,era:Fe({values:yn,defaultWidth:"wide"}),quarter:Fe({values:_n,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Fe({values:kn,defaultWidth:"wide"}),day:Fe({values:Sn,defaultWidth:"wide"}),dayPeriod:Fe({values:xn,defaultWidth:"wide"})},En=/^(\d+)(ième|ère|ème|er|e)?/i,Cn=/\d+/i,On={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jésus-Christ|après Jésus-Christ)/i},In={any:[/^av/i,/^ap/i]},Rn={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|ème|e)? trim\.?/i,wide:/^[1234](er|ème|e)? trimestre/i},An={any:[/1/i,/2/i,/3/i,/4/i]},Tn={narrow:/^[jfmasond]/i,abbreviated:/^(janv|févr|mars|avr|mai|juin|juill|juil|août|sept|oct|nov|déc)\.?/i,wide:/^(janvier|février|mars|avril|mai|juin|juillet|août|septembre|octobre|novembre|décembre)/i},Wn={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},Nn={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},Dn={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Ln={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'après[-\s]midi|du soir|de la nuit)/i},jn={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},zn={ordinalNumber:Ta({matchPattern:En,parsePattern:Cn,valueCallback:e=>parseInt(e)}),era:Ue({matchPatterns:On,defaultMatchWidth:"wide",parsePatterns:In,defaultParseWidth:"any"}),quarter:Ue({matchPatterns:Rn,defaultMatchWidth:"wide",parsePatterns:An,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ue({matchPatterns:Tn,defaultMatchWidth:"wide",parsePatterns:Wn,defaultParseWidth:"any"}),day:Ue({matchPatterns:Nn,defaultMatchWidth:"wide",parsePatterns:Dn,defaultParseWidth:"any"}),dayPeriod:Ue({matchPatterns:Ln,defaultMatchWidth:"any",parsePatterns:jn,defaultParseWidth:"any"})},Hn={code:"fr",formatDistance:fn,formatLong:hn,formatRelative:bn,localize:Pn,match:zn,options:{weekStartsOn:1,firstWeekContainsDate:4}},qn={lessThanXSeconds:{one:"1秒未満",other:"{{count}}秒未満",oneWithSuffix:"約1秒",otherWithSuffix:"約{{count}}秒"},xSeconds:{one:"1秒",other:"{{count}}秒"},halfAMinute:"30秒",lessThanXMinutes:{one:"1分未満",other:"{{count}}分未満",oneWithSuffix:"約1分",otherWithSuffix:"約{{count}}分"},xMinutes:{one:"1分",other:"{{count}}分"},aboutXHours:{one:"約1時間",other:"約{{count}}時間"},xHours:{one:"1時間",other:"{{count}}時間"},xDays:{one:"1日",other:"{{count}}日"},aboutXWeeks:{one:"約1週間",other:"約{{count}}週間"},xWeeks:{one:"1週間",other:"{{count}}週間"},aboutXMonths:{one:"約1か月",other:"約{{count}}か月"},xMonths:{one:"1か月",other:"{{count}}か月"},aboutXYears:{one:"約1年",other:"約{{count}}年"},xYears:{one:"1年",other:"{{count}}年"},overXYears:{one:"1年以上",other:"{{count}}年以上"},almostXYears:{one:"1年近く",other:"{{count}}年近く"}},Fn=(e,r,a)=>{a=a||{};let i;const n=qn[e];return typeof n=="string"?i=n:r===1?a.addSuffix&&n.oneWithSuffix?i=n.oneWithSuffix:i=n.one:a.addSuffix&&n.otherWithSuffix?i=n.otherWithSuffix.replace("{{count}}",String(r)):i=n.other.replace("{{count}}",String(r)),a.addSuffix?a.comparison&&a.comparison>0?i+"後":i+"前":i},Un={full:"y年M月d日EEEE",long:"y年M月d日",medium:"y/MM/dd",short:"y/MM/dd"},Bn={full:"H時mm分ss秒 zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},Vn={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},Gn={date:It({formats:Un,defaultWidth:"full"}),time:It({formats:Bn,defaultWidth:"full"}),dateTime:It({formats:Vn,defaultWidth:"full"})},Jn={lastWeek:"先週のeeeeのp",yesterday:"昨日のp",today:"今日のp",tomorrow:"明日のp",nextWeek:"翌週のeeeeのp",other:"P"},Xn=(e,r,a,i)=>Jn[e],Kn={narrow:["BC","AC"],abbreviated:["紀元前","西暦"],wide:["紀元前","西暦"]},Yn={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["第1四半期","第2四半期","第3四半期","第4四半期"]},Qn={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},Zn={narrow:["日","月","火","水","木","金","土"],short:["日","月","火","水","木","金","土"],abbreviated:["日","月","火","水","木","金","土"],wide:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},eo={narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},to={narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},ro=(e,r)=>{const a=Number(e);switch(String(r?.unit)){case"year":return`${a}年`;case"quarter":return`第${a}四半期`;case"month":return`${a}月`;case"week":return`第${a}週`;case"date":return`${a}日`;case"hour":return`${a}時`;case"minute":return`${a}分`;case"second":return`${a}秒`;default:return`${a}`}},ao={ordinalNumber:ro,era:Fe({values:Kn,defaultWidth:"wide"}),quarter:Fe({values:Yn,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:Fe({values:Qn,defaultWidth:"wide"}),day:Fe({values:Zn,defaultWidth:"wide"}),dayPeriod:Fe({values:eo,defaultWidth:"wide",formattingValues:to,defaultFormattingWidth:"wide"})},io=/^第?\d+(年|四半期|月|週|日|時|分|秒)?/i,no=/\d+/i,oo={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^(紀元[前後]|西暦)/i,wide:/^(紀元[前後]|西暦)/i},so={narrow:[/^B/i,/^A/i],any:[/^(紀元前)/i,/^(西暦|紀元後)/i]},lo={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^第[1234一二三四１２３４]四半期/i},co={any:[/(1|一|１)/i,/(2|二|２)/i,/(3|三|３)/i,/(4|四|４)/i]},uo={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])月/i,wide:/^([123456789]|1[012])月/i},mo={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},fo={narrow:/^[日月火水木金土]/,short:/^[日月火水木金土]/,abbreviated:/^[日月火水木金土]/,wide:/^[日月火水木金土]曜日/},vo={any:[/^日/,/^月/,/^火/,/^水/,/^木/,/^金/,/^土/]},po={any:/^(AM|PM|午前|午後|正午|深夜|真夜中|夜|朝)/i},go={any:{am:/^(A|午前)/i,pm:/^(P|午後)/i,midnight:/^深夜|真夜中/i,noon:/^正午/i,morning:/^朝/i,afternoon:/^午後/i,evening:/^夜/i,night:/^深夜/i}},ho={ordinalNumber:Ta({matchPattern:io,parsePattern:no,valueCallback:function(e){return parseInt(e,10)}}),era:Ue({matchPatterns:oo,defaultMatchWidth:"wide",parsePatterns:so,defaultParseWidth:"any"}),quarter:Ue({matchPatterns:lo,defaultMatchWidth:"wide",parsePatterns:co,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ue({matchPatterns:uo,defaultMatchWidth:"wide",parsePatterns:mo,defaultParseWidth:"any"}),day:Ue({matchPatterns:fo,defaultMatchWidth:"wide",parsePatterns:vo,defaultParseWidth:"any"}),dayPeriod:Ue({matchPatterns:po,defaultMatchWidth:"any",parsePatterns:go,defaultParseWidth:"any"})},wo={code:"ja",formatDistance:Fn,formatLong:Gn,formatRelative:Xn,localize:ao,match:ho,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ma(e,r){if(!e)return;let a=Object.keys(e)[0];const i=Map.groupBy(r.values(),n=>n.nodeId);for(const n of Object.keys(e))i.has(n)||i.set(n,[]);for(const[n,d]of i.entries())n&&d.length<i.get(a).length&&(a=n);return console.debug("[SWARPC Load balancer] Choosing",a,"load map is",i),a}function bo(){return"N"+Math.random().toString(16).substring(2,5).toUpperCase()}const yo="(SW)";function ft(e){return e??yo}function kr(e,r){if(r&&Array.isArray(r))return r;let a=[void 0];return e&&(a=[...e]),typeof r=="number"&&(a=a.slice(0,r)),a}const fa=["onceBy","destroy"],Ke=new Map,_o=()=>{};let Ut=new Map;function ko(e,{worker:r,nodes:a,loglevel:i="debug",restartListener:n=!1,hooks:d={},localStorage:s={},nodeIds:k=[]}={}){const o=fr("client",i);n&&Ut.clear(),a??=navigator.hardwareConcurrency||1;let m;if(r){m={};for(const[g]of Array.from({length:a}).entries()){const _=k[g]??bo();typeof r=="string"?m[_]=new Worker(r,{name:_}):m[_]=new r({name:_})}o.info(null,`Started ${a} node${a>1?"s":""}`,Object.keys(m))}const w={[mi]:e,destroy(){for(const[g,_]of Ut.entries())o.debug(null,`Destroying listener for node ${g}`),_.disconnect(),Ut.delete(g);for(const[g,_]of Object.entries(m??{}))o.debug(null,`Terminating worker for node ${g}`),_ instanceof SharedWorker?_.port.close():_.terminate()}};function W(g,_){const{nodeIds:x,functionName:O,concurrencyKey:b}=_;if(!x&&!O&&!b)throw new Error("At least one criteria must be provided to cancel requests");if(x?.length===0){console.warn("[SWARPC Client] cancelRequests called with empty nodeIds array, no requests will be cancelled");return}const f=b?O?`${O}:${b}`:b:void 0,y=(P,q)=>P?q(P):!0,I=[...Ke.entries()].filter(([P,q])=>y(x,C=>!q.nodeId||C.includes(q.nodeId))&&y(O,C=>q.functionName===C)&&y(f,C=>q.concurrencyKey===C));for(const[P,{functionName:q}]of I)D(P,g,q)}function D(g,_,x){const O=Ke.get(g);if(!O)return;const b=O.nodeId,f=fr("client",i,ft(b),g);f.debug(g,`Cancelling ${x} with`,_),O.reject(new pi(_)),So(f,b?m?.[b]:void 0,{by:"sw&rpc",requestId:g,functionName:x,abort:{reason:_}}),Ke.delete(g)}const R=new Map;for(const g of Object.keys(e)){if(typeof g!="string")throw new Error("[SWARPC Client] Invalid function name, don't use symbols");if(fa.includes(g))throw new Error(`[SWARPC Client] Invalid function name: "${g}" is a reserved word and can't be used as a procedure name. Reserved names: ${fa}`);const _=async(b,f,y,I,P)=>{const q={logger:o,node:b,nodeId:f,allNodeIDs:new Set(m?Object.keys(m):[]),hooks:d,localStorage:s};return Ua(q,{...I,by:"sw&rpc",requestId:y,functionName:g},P)},x=async({input:b,onProgress:f,requestId:y,nodeId:I,concurrencyKey:P})=>{const q=e[g].input["~standard"].validate(b);if(q instanceof Promise)throw new Error("Validations must not be async");if(q.issues)throw new Error(`Invalid input: ${q.issues}`);const C=y??Sr();I??=ma(m,Ke);const T=m&&I?m[I]:void 0,z=fr("client",i,ft(I),C);return new Promise((U,N)=>{Ke.set(C,{nodeId:I,functionName:g,concurrencyKey:P,resolve:U,onProgress:f??_o,reject:N});const J=e[g].autotransfer==="always"?ui(b):[];return z.debug(`Requesting ${g} with`,b),_(T,I,C,{input:b},{transfer:J}).then(()=>{}).catch(N)})},O=async({input:b,onProgresses:f,nodesCountOrIDs:y,concurrencyKey:I})=>{const P=kr(m?Object.keys(m):void 0,y),q=new Map;function C(N){return f?J=>{q.set(ft(N),J),f(q)}:J=>{}}const T=await Promise.allSettled(P.map(async N=>x({input:b,onProgress:C(N),nodeId:N,concurrencyKey:I}))).then(N=>N.map((J,Z)=>({...J,node:ft(P[Z])}))),U={byNode:new Map(T.map(({node:N,...J})=>[N,J])),successes:Zr(vi(T).map(N=>N.value)),failures:Zr(fi(T)),get failureSummary(){return this.failures?.map(({node:N,reason:J})=>`Node ${N}: ${J}`).join(`;
`)},get ok(){return this.failures.length===0},get ko(){return this.successes.length===0},get status(){return this.ok?"fulfilled":this.ko?"rejected":"mixed"}};return Object.assign(T,U)};R.set(g,x),w[g]=(b,f)=>x({input:b,onProgress:f}),w[g].broadcast=(b,f,y)=>O({input:b,onProgresses:f,nodesCountOrIDs:y}),w[g].broadcast.orThrow=async(...b)=>xr(await w[g].broadcast(...b)),w[g].broadcast.once=async(b,f,y)=>{const I=kr(m?Object.keys(m):void 0,y);return W("Cancelled by .broadcast.once() call",{functionName:g,nodeIds:I.filter(P=>P!==void 0)}),O({input:b,onProgresses:f,nodesCountOrIDs:I})},w[g].broadcast.once.orThrow=async(...b)=>xr(await w[g].broadcast.once(...b)),w[g].broadcast.onceBy=async(b,f,y,I)=>{const P=kr(m?Object.keys(m):void 0,I);return W("Cancelled by .broadcast.once() call",{concurrencyKey:b,functionName:g,nodeIds:P.filter(q=>q!==void 0)}),O({input:f,onProgresses:y,nodesCountOrIDs:P,concurrencyKey:b})},w[g].broadcast.onceBy.orThrow=async(...b)=>xr(await w[g].broadcast.onceBy(...b)),w[g].cancelable=(b,f)=>{const y=Sr(),I=ma(m,Ke);return{request:x({input:b,onProgress:f,requestId:y,nodeId:I}),cancel(P){D(y,P,g)}}},w[g].once=async(b,f)=>(W("Cancelled by .once() call",{functionName:g}),await x({input:b,onProgress:f})),w[g].onceBy=async(b,f,y)=>(W(`Cancelled by .onceBy("${b}") call`,{functionName:g,concurrencyKey:b}),await x({input:f,onProgress:y,concurrencyKey:b}))}return w.onceBy=g=>{const _={};for(const x of Object.keys(e))typeof x=="string"&&(_[x]=async(O,b)=>{W(`Cancelled by global onceBy("${g}") call`,{concurrencyKey:g});const f=Sr(),y=R.get(x);if(!y)throw new Error(`No procedure found for ${x}`);return await y({input:O,onProgress:b,requestId:f,concurrencyKey:g})});return _},w}async function Ua(e,r,a){await xo(e);const{logger:i,node:n}=e;!n&&!navigator.serviceWorker.controller&&i.warn("","Service Worker is not controlling the page");const d=n instanceof SharedWorker?n.port:n===void 0?await navigator.serviceWorker.ready.then(s=>s.active):n;if(!d)throw new Error("[SWARPC Client] No active service worker found");d.postMessage(r,a)}function So(e,r,a,i){!r&&!navigator.serviceWorker.controller&&e.warn("Service Worker is not controlling the page");const n=r instanceof SharedWorker?r.port:r===void 0?navigator.serviceWorker.controller:r;if(!n)throw new Error("[SWARPC Client] No active service worker found");n.postMessage(a,i)}async function xo(e){if(Ut.has(ft(e.nodeId)))return;const{logger:r,node:a}=e;if(!a){if(!(await navigator.serviceWorker.ready)?.active)throw new Error("[SWARPC Client] Service Worker is not active");navigator.serviceWorker.controller||r.warn("","Service Worker is not controlling the page")}const i=a??navigator.serviceWorker;r.debug(null,"Starting client listener",{w:i,...e});const n=d=>{const s=d.data||{};if(s?.by!=="sw&rpc")return;const k=s;if("isInitializeRequest"in k){r.warn(null,"Ignoring unexpected #initialize from server",k);return}const{requestId:o,...m}=k;if(!o)throw new Error("[SWARPC Client] Message received without requestId");const w=Ke.get(o);if(!w)throw new Error(`[SWARPC Client] ${o} has no active request handlers, cannot process ${JSON.stringify(m)}`);"error"in m?(e.hooks.error?.({procedure:m.functionName,error:new Error(m.error.message)}),w.reject(new Error(m.error.message)),Ke.delete(o)):"progress"in m?(e.hooks.progress?.({procedure:m.functionName,data:m.progress}),w.onProgress(m.progress)):"result"in m&&(e.hooks.success?.({procedure:m.functionName,data:m.result}),w.resolve(m.result),Ke.delete(o))};i instanceof SharedWorker?(i.port.addEventListener("message",n),i.port.start()):i.addEventListener("message",n),Ut.set(ft(e.nodeId),{disconnect(){i instanceof SharedWorker?i.port.removeEventListener("message",n):i.removeEventListener("message",n)}}),await Ua(e,{by:"sw&rpc",functionName:"#initialize",isInitializeRequest:!0,localStorageData:e.localStorage,nodeId:ft(e.nodeId),allNodeIDs:e.allNodeIDs})}function Sr(){return Math.random().toString(16).substring(2,8).toUpperCase()}function xr(e){if(e.ok)return e.successes;throw new AggregateError(e.failures.map(r=>r.reason))}const $o={init:{input:F({databaseName:"string",databaseRevision:"number.integer >= 1"}),progress:F("undefined"),success:F("undefined")},loadModel:{input:F({model:"TypedArray.Uint8","classmapping?":"string | undefined",task:'"classification" | "detection"',"webgpu?":"boolean",inferenceSessionId:"string > 1"}),progress:F("undefined"),success:F("true")},inferenceSessionId:{input:F('"classification" | "detection"'),progress:F("undefined"),success:F("string | null")},inferBoundingBoxes:{input:F({fileId:"string",webgpu:"boolean = false",taskSettings:{input:vr.ModelInput,output:{"name?":"string",shape:vr.ModelDetectionOutputShape}}}),progress:F({}),success:F({boxes:F(["number","number","number","number"]).array(),scores:"number[]"})},classify:{input:F({imageId:"string","webgpu?":"boolean",metadataIds:{cropbox:"string",target:"string"},taskSettings:{input:vr.ModelInput,"output?":{name:"string"}}}),progress:F({}),success:F({scores:"number[]"})},importProtocol:{input:F({contents:"string",isJSON:"boolean = false"}),progress:F({phase:F.enumerated("parsing","filtering-builtin-metadata","input-validation","write-protocol","write-metadata","write-metadata-options","output-validation"),"detail?":"string"}),success:F({id:"string",name:"string","version?":"number | undefined",iconsToPreload:"string[]"})},generateResultsExport:{input:F({sessionId:"string",include:F.enumerated("croppedonly","full","metadataonly"),cropPadding:/^\d+(px|%)$/,jsonSchemaURL:"string.url.parse",format:'"zip" | "folder"'}),progress:F.or({event:'"progress"',data:"number"},{event:'"warning"',data:F.or(['"exif-write-error"',{filename:"string"}])},{event:'"writeFile"',data:{filepath:"string",contents:F.or("string",["instanceof",Uint8Array])}}),success:F("ArrayBuffer")},previewResultsZip:{input:F({sessionId:"string",include:F.enumerated("croppedonly","full","metadataonly")}),progress:F("undefined"),success:F.scope({NodeProvenance:Ri}).type({"[NodeProvenance]":[{path:"string",contentType:"string"},"[]"]})},estimateResultsZipSize:{input:F({sessionId:"string",include:F.enumerated("croppedonly","full","metadataonly"),cropPadding:/^\d+(px|%)$/}),progress:F("undefined"),success:F({uncompressed:["number.integer >= 0","@","bytes"],compressed:["number.integer >= 0","@","bytes, estimated"]})},diffProtocolWithRemote:{input:F({protocolId:"string"}),progress:F("0 <= number <= 1"),success:F({dirty:"boolean",changes:F.or({path:"(number|string)[]",type:'"CREATE"',value:"unknown"},{path:"(number|string)[]",type:'"CHANGE"',oldValue:"unknown",value:"unknown"},{path:"(number|string)[]",type:'"REMOVE"',oldValue:"unknown"}).array()})}};function Mo(e){return new Worker(""+new URL("../workers/start-Di3ewrCC.js",import.meta.url).href,{type:"module",name:e?.name})}const Po=!1,Eo="always";async function Co(){const e=await ia("language",{fallback:yi()});document.documentElement.lang=e,vt({fr:"Chargement des traductions…",en:"Loading translations…"}[e]),await hi(e),un({locale:{fr:Hn,en:xi,ja:wo}[e]}),await Oo();const r=await ia("parallelism",{fallback:1}),a=or("js");vt(a(500));const i=ko($o,{worker:Mo,nodes:r,hooks:{success({procedure:n,data:d}){n==="importProtocol"&&ei(d.iconsToPreload,(s,k)=>{console.info(`Preloaded ${s.length} icons, ${k.length} missing:`,k)})}}});try{const n=localStorage.getItem("currentSessionId");vt(a(502)),await i.init.broadcast.orThrow({databaseName:ki,databaseRevision:_i}),await ye.initialize(n),vt(a(503)),await Io(i),await ye.initialize(n)}catch(n){console.error(n),ci(400,{message:n?.toString()??a(85)})}return Oi(Wa(),i).then(n=>{n.length!==0&&$e.info(n.length===1?a(516,[n[0].name]):`${n.length} protocoles ont été mis à jour: ${n.map(d=>`"${d.name}"`).join(", ")}`)}),{swarpc:i,parallelism:r}}async function Oo(){const e=or("js");vt(e(489)),await Si(["Metadata","Protocol","Settings"],{},async r=>{await r.objectStore("Settings").put({id:"defaults",protocols:[],theme:"auto",gridSize:1,language:"fr",showInputHints:!0,showTechnicalMetadata:li,cropAutoNext:!1,gallerySort:{key:"date",direction:"asc"}})})}async function Io(e){const r=or("js");if(vt(r(487)),await ye.Protocol.count()===0)try{const i=await fetch("https://raw.githubusercontent.com/cigaleapp/cigale/main/examples/arthropods.cigaleprotocol.json").then(n=>n.text());await e.importProtocol({contents:i,isJSON:!0},({phase:n,detail:d})=>{let s="";switch(n){case"parsing":s=r(504);break;case"filtering-builtin-metadata":s=r(505);break;case"input-validation":s=r(506);break;case"write-protocol":s=r(507);break;case"write-metadata":s=r(508,[d]);break;case"write-metadata-options":s=r(509,[d]);break;case"output-validation":s=r(510);break;default:break}vt(`${r(487)}<br>${s}`)})}catch(i){console.error(i),$e.error(r(511))}}function vt(e){const r=(i,n)=>{const d=document.getElementById(i);d&&(d.innerHTML=n)},a=or("js");r("loading-title",a(56)),r("loading-message",e)}const od=Object.freeze(Object.defineProperty({__proto__:null,load:Co,ssr:Po,trailingSlash:Eo},Symbol.toStringTag,{value:"Module"}));var Ro=["Shift","Meta","Alt","Control"],Ba=typeof navigator=="object"?navigator.platform:"",Va=/Mac|iPod|iPhone|iPad/.test(Ba),Ao=Va?"Meta":"Control",To=Ba==="Win32"?["Control","Alt"]:Va?["Alt"]:[];function Hr(e,r){return typeof e.getModifierState=="function"&&(e.getModifierState(r)||To.includes(r)&&e.getModifierState("AltGraph"))}function Wo(e){return e.trim().split(" ").map(function(r){var a=r.split(/\b\+/),i=a.pop(),n=i.match(/^\((.+)\)$/);return n&&(i=new RegExp("^"+n[1]+"$")),[a=a.map(function(d){return d==="$mod"?Ao:d}),i]})}function No(e,r){var a=r[0],i=r[1];return!((i instanceof RegExp?!i.test(e.key)&&!i.test(e.code):i.toUpperCase()!==e.key.toUpperCase()&&i!==e.code)||a.find(function(n){return!Hr(e,n)})||Ro.find(function(n){return!a.includes(n)&&i!==n&&Hr(e,n)}))}function Do(e,r){var a;r===void 0&&(r={});var i=(a=r.timeout)!=null?a:1e3,n=Object.keys(e).map(function(k){return[Wo(k),e[k]]}),d=new Map,s=null;return function(k){k instanceof KeyboardEvent&&(n.forEach(function(o){var m=o[0],w=o[1],W=d.get(m)||m;No(k,W[0])?W.length>1?d.set(m,W.slice(1)):(d.delete(m),w(k)):Hr(k,k.key)||d.delete(m)}),s&&clearTimeout(s),s=setTimeout(d.clear.bind(d),i))}}function Lo(e,r,a){var i={},n=i.event,d=n===void 0?"keydown":n,s=i.capture,k=Do(r,{timeout:i.timeout});return e.addEventListener(d,k,s),function(){e.removeEventListener(d,k,s)}}var jo=V('<h2 class="svelte-6wpiuz"> </h2>'),zo=V('<dt class="svelte-6wpiuz"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></dt> <dd class="svelte-6wpiuz"> </dd>',1),Ho=V('<!> <dl class="svelte-6wpiuz"></dl>',1),qo=V('<dl class="svelte-6wpiuz"><div class="empty svelte-6wpiuz"><div class="sad svelte-6wpiuz"> </div> <p> </p></div></dl>');function Fo(e,r){gt(r,!0);const a=h(()=>Dt("main"));let i=Rt(r,"openHelp",15),n=Rt(r,"preventDefault",3,!1);const d=o=>(o instanceof KeyboardEvent||o instanceof MouseEvent)&&(o.target instanceof HTMLInputElement||o.target instanceof HTMLTextAreaElement);je(()=>Lo(window,Object.fromEntries(Object.entries(r.binds).flatMap(([o,m])=>{if(o.startsWith("Digit")&&!o.includes(" ")){const w=o.replace("Digit","");return[[o,m],[w,m],[`Shift+${w}`,m]]}return[[o,m]]}).map(([o,m])=>[o,async w=>{if(!m?.allowInModals&&oa(we)){console.warn(`a modal is open, ignoring keybinding ${o}`,we.state);return}if(d(w)&&!o.startsWith("$mod+")){console.warn(`in input, ignoring keybinding ${o}`,w.target);return}m.when&&!m.when(w)||m.debug&&!er()||(n()&&w.preventDefault(),await m.do(w))}]))));const s=["Recadrage","Observations","Général","Navigation","Debug mode"],k=h(()=>Et(Et(r.binds).reduce((o,[m,w])=>{if(w.hidden||w.debug&&!er())return o;const W=w.group??"Général";return o[W]||(o[W]=[]),o[W].push([m,w]),o},{})).toSorted(([o],[m])=>s.indexOf(o)-s.indexOf(m)));je(()=>{const o=m=>{m.key==="?"&&!d(m)&&!oa(we)&&i()?.()};return window.addEventListener("keyup",o),()=>window.removeEventListener("keyup",o)});{let o=h(()=>t(a)(137));Vr(e,{key:"modal_keyboard_shortcuts_help",get title(){return t(o)},get open(){return i()},set open(m){i(m)},children:(m,w)=>{var W=Te(),D=le(W);tr(D,17,()=>t(k),([R,g])=>R,(R,g,_,x)=>{var O=h(()=>Wr(t(g),2));let b=()=>t(O)[0],f=()=>t(O)[1];var y=Ho(),I=le(y);{var P=C=>{var T=jo(),z=$(T,!0);S(T),Y(()=>K(z,b())),E(C,T)};se(I,C=>{t(k).length>=2&&C(P)})}var q=M(I,2);tr(q,21,f,([C,{help:T}])=>C,(C,T)=>{var z=h(()=>Wr(t(T),2));let U=()=>t(z)[0],N=()=>t(z)[1].help;var J=zo(),Z=le(J),fe=$(Z);ar(fe,()=>({"--size":"1.2em"})),ji(fe.lastChild,{get shortcut(){return U()},get help(){return N()}}),S(fe),S(Z);var ve=M(Z,2),ke=$(ve,!0);S(ve),Y(()=>K(ke,N())),E(C,J)}),S(q),E(R,y)},R=>{var g=qo(),_=$(g),x=$(_),O=$(x,!0);S(x);var b=M(x,2),f=$(b,!0);S(b),S(_),S(g),Y((y,I)=>{K(O,y),K(f,I)},[()=>t(a)(183),()=>t(a)(35)]),E(R,g)}),E(m,W)},$$slots:{default:!0}})}ht()}var Uo=wt('<svg><path fill="currentColor" d="M22 20H2v-2h1v-6.969C3 6.043 7.03 2 12 2s9 4.043 9 9.031V18h1zM5 18h14v-6.969C19 7.148 15.866 4 12 4s-7 3.148-7 7.031zm4.5 3h5a2.5 2.5 0 0 1-5 0"></path></svg>');function Bo(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=Uo();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var Vo="2.0.9",Go=500,va="user-agent",At="",pa="?",de={FUNCTION:"function",OBJECT:"object",STRING:"string",UNDEFINED:"undefined"},Pe="browser",Qe="cpu",Be="device",ze="engine",Ie="os",Tt="result",u="name",l="type",p="vendor",v="version",_e="architecture",Bt="major",c="model",Qt="console",L="mobile",X="tablet",ue="smarttv",qe="wearable",Jt="xr",Ft="embedded",Jo="fetcher",kt="inapp",Gr="brands",ct="formFactors",Jr="fullVersionList",Wt="platform",Xr="platformVersion",sr="bitness",ot="sec-ch-ua",Xo=ot+"-full-version-list",Ko=ot+"-arch",Yo=ot+"-"+sr,Qo=ot+"-form-factors",Zo=ot+"-"+L,es=ot+"-"+c,Ga=ot+"-"+Wt,ts=Ga+"-version",Ja=[Gr,Jr,L,c,Wt,Xr,_e,ct,sr],Xt="Amazon",St="Apple",ga="ASUS",ha="BlackBerry",dt="Google",wa="Huawei",$r="Lenovo",ba="Honor",Kt="LG",Mr="Microsoft",Pr="Motorola",ya="Nvidia",_a="OnePlus",Er="OPPO",jt="Samsung",ka="Sharp",zt="Sony",Cr="Xiaomi",Or="Zebra",Sa="Chrome",xa="Chromium",at="Chromecast",Zt="Edge",Ht="Firefox",xt="Opera",Ir="Facebook",$a="Sogou",$t="Mobile ",Mt=" Browser",qr="Windows",rs=typeof window!==de.UNDEFINED,Me=rs&&window.navigator?window.navigator:void 0,ut=Me&&Me.userAgentData?Me.userAgentData:void 0,as=function(e,r){var a={},i=r;if(!ir(r)){i={};for(var n in r)for(var d in r[n])i[d]=r[n][d].concat(i[d]?i[d]:[])}for(var s in e)a[s]=i[s]&&i[s].length%2===0?i[s].concat(e[s]):e[s];return a},lr=function(e){for(var r={},a=0;a<e.length;a++)r[e[a].toUpperCase()]=e[a];return r},Fr=function(e,r){if(typeof e===de.OBJECT&&e.length>0){for(var a in e)if(it(r)==it(e[a]))return!0;return!1}return Vt(e)?it(r)==it(e):!1},ir=function(e,r){for(var a in e)return/^(browser|cpu|device|engine|os)$/.test(a)||(r?ir(e[a]):!1)},Vt=function(e){return typeof e===de.STRING},Rr=function(e){if(e){for(var r=[],a=Nt(/\\?\"/g,e).split(","),i=0;i<a.length;i++)if(a[i].indexOf(";")>-1){var n=nr(a[i]).split(";v=");r[i]={brand:n[0],version:n[1]}}else r[i]=nr(a[i]);return r}},it=function(e){return Vt(e)?e.toLowerCase():e},Ur=function(e){return Vt(e)?Nt(/[^\d\.]/g,e).split(".")[0]:void 0},Ye=function(e){for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];typeof a==de.OBJECT&&a.length==2?this[a[0]]=a[1]:this[a]=void 0}return this},Nt=function(e,r){return Vt(r)?r.replace(e,At):r},qt=function(e){return Nt(/\\?\"/g,e)},nr=function(e,r){return e=Nt(/^\s\s*/,String(e)),typeof r===de.UNDEFINED?e:e.substring(0,r)},Br=function(e,r){if(!(!e||!r))for(var a=0,i,n,d,s,k,o;a<r.length&&!k;){var m=r[a],w=r[a+1];for(i=n=0;i<m.length&&!k&&m[i];)if(k=m[i++].exec(e),k)for(d=0;d<w.length;d++)o=k[++n],s=w[d],typeof s===de.OBJECT&&s.length>0?s.length===2?typeof s[1]==de.FUNCTION?this[s[0]]=s[1].call(this,o):this[s[0]]=s[1]:s.length>=3&&(typeof s[1]===de.FUNCTION&&!(s[1].exec&&s[1].test)?s.length>3?this[s[0]]=o?s[1].apply(this,s.slice(2)):void 0:this[s[0]]=o?s[1].call(this,o,s[2]):void 0:s.length==3?this[s[0]]=o?o.replace(s[1],s[2]):void 0:s.length==4?this[s[0]]=o?s[3].call(this,o.replace(s[1],s[2])):void 0:s.length>4&&(this[s[0]]=o?s[3].apply(this,[o.replace(s[1],s[2])].concat(s.slice(4))):void 0)):this[s]=o||void 0;a+=2}},Le=function(e,r){for(var a in r)if(typeof r[a]===de.OBJECT&&r[a].length>0){for(var i=0;i<r[a].length;i++)if(Fr(r[a][i],e))return a===pa?void 0:a}else if(Fr(r[a],e))return a===pa?void 0:a;return r.hasOwnProperty("*")?r["*"]:e},Ma={ME:"4.90","NT 3.51":"3.51","NT 4.0":"4.0",2e3:["5.0","5.01"],XP:["5.1","5.2"],Vista:"6.0",7:"6.1",8:"6.2","8.1":"6.3",10:["6.4","10.0"],NT:""},Pa={embedded:"Automotive",mobile:"Mobile",tablet:["Tablet","EInk"],smarttv:"TV",wearable:"Watch",xr:["VR","XR"],"?":["Desktop","Unknown"],"*":void 0},is={Chrome:"Google Chrome",Edge:"Microsoft Edge","Edge WebView2":"Microsoft Edge WebView2","Chrome WebView":"Android WebView","Chrome Headless":"HeadlessChrome","Huawei Browser":"HuaweiBrowser","MIUI Browser":"Miui Browser","Opera Mobi":"OperaMobile",Yandex:"YaBrowser"},Ea={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[u,$t+"Chrome"]],[/webview.+edge\/([\w\.]+)/i],[v,[u,Zt+" WebView"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[u,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[u,v],[/opios[\/ ]+([\w\.]+)/i],[v,[u,xt+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[v,[u,xt+" GX"]],[/\bopr\/([\w\.]+)/i],[v,[u,xt]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[v,[u,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[v,[u,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(atlas|flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon|otter|dooble|(?:hi|lg |ovi|qute)browser|palemoon)\/v?([-\w\.]+)/i,/(brave)(?: chrome)?\/([\d\.]+)/i,/(aloha|heytap|ovi|115|surf|qwant)browser\/([\d\.]+)/i,/(qwant)(?:ios|mobile)\/([\d\.]+)/i,/(ecosia|weibo)(?:__| \w+@)([\d\.]+)/i],[u,v],[/quark(?:pc)?\/([-\w\.]+)/i],[v,[u,"Quark"]],[/\bddg\/([\w\.]+)/i],[v,[u,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[u,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[v,[u,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[u,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[u,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[v,[u,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[v,[u,"Smart "+$r+Mt]],[/(av(?:ast|g|ira))\/([\w\.]+)/i],[[u,/(.+)/,"$1 Secure"+Mt],v],[/norton\/([\w\.]+)/i],[v,[u,"Norton Private"+Mt]],[/\bfocus\/([\w\.]+)/i],[v,[u,Ht+" Focus"]],[/ mms\/([\w\.]+)$/i],[v,[u,xt+" Neon"]],[/ opt\/([\w\.]+)$/i],[v,[u,xt+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[u,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[u,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[u,xt+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[u,"MIUI"+Mt]],[/fxios\/([\w\.-]+)/i],[v,[u,$t+Ht]],[/\bqihoobrowser\/?([\w\.]*)/i],[v,[u,"360"]],[/\b(qq)\/([\w\.]+)/i],[[u,/(.+)/,"$1Browser"],v],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[u,/(.+)/,"$1"+Mt],v],[/samsungbrowser\/([\w\.]+)/i],[v,[u,jt+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[v,[u,$a+" Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[u,$a+" Mobile"],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[u,v],[/(lbbrowser|luakit|rekonq|steam(?= (clie|tenf|gameo)))/i],[u],[/ome\/([\w\.]+).+(iron(?= saf)|360(?=[es]e$))/i],[v,u],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[u,Ir],v,[l,kt]],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/(daum)apps[\/ ]([\w\.]+)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(bing)(?:web|sapphire)\/([\w\.]+)/i,/(instagram|snapchat|klarna)[\/ ]([-\w\.]+)/i],[u,v,[l,kt]],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[u,"GSA"],[l,kt]],[/(?:musical_ly|trill)(?:.+app_?version\/|_)([\w\.]+)/i],[v,[u,"TikTok"],[l,kt]],[/\[(linkedin)app\]/i],[u,[l,kt]],[/(zalo(?:app)?)[\/\sa-z]*([\w\.-]+)/i],[[u,/(.+)/,"Zalo"],v,[l,kt]],[/(chromium)[\/ ]([-\w\.]+)/i],[u,v],[/ome-(lighthouse)$/i],[u,[l,Jo]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[u,Sa+" Headless"]],[/wv\).+chrome\/([\w\.]+).+edgw\//i],[v,[u,Zt+" WebView2"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[u,Sa+" WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[u,"Android"+Mt]],[/chrome\/([\w\.]+) mobile/i],[v,[u,$t+"Chrome"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[u,v],[/version\/([\w\.\,]+) .*mobile(?:\/\w+ | ?)safari/i],[v,[u,$t+"Safari"]],[/iphone .*mobile(?:\/\w+ | ?)safari/i],[[u,$t+"Safari"]],[/version\/([\w\.\,]+) .*(safari)/i],[v,u],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[u,[v,"1"]],[/(webkit|khtml)\/([\w\.]+)/i],[u,v],[/(?:mobile|tablet);.*(firefox)\/([\w\.-]+)/i],[[u,$t+Ht],v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[u,"Netscape"],v],[/(wolvic|librewolf)\/([\w\.]+)/i],[u,v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[u,Ht+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+(?= .+rv\:.+gecko\/\d+)|[0-4][\w\.]+(?!.+compatible))/i,/(amaya|dillo|doris|icab|ladybird|lynx|mosaic|netsurf|obigo|polaris|w3m|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/\b(links) \(([\w\.]+)/i],[u,[v,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[u,[v,/[^\d\.]+./,At]]],cpu:[[/\b((amd|x|x86[-_]?|wow|win)64)\b/i],[[_e,"amd64"]],[/(ia32(?=;))/i,/\b((i[346]|x)86)(pc)?\b/i],[[_e,"ia32"]],[/\b(aarch64|arm(v?[89]e?l?|_?64))\b/i],[[_e,"arm64"]],[/\b(arm(v[67])?ht?n?[fl]p?)\b/i],[[_e,"armhf"]],[/( (ce|mobile); ppc;|\/[\w\.]+arm\b)/i],[[_e,"arm"]],[/ sun4\w[;\)]/i],[[_e,"sparc"]],[/\b(avr32|ia64(?=;)|68k(?=\))|\barm(?=v([1-7]|[5-7]1)l?|;|eabi)|(irix|mips|sparc)(64)?\b|pa-risc)/i,/((ppc|powerpc)(64)?)( mac|;|\))/i,/(?:osf1|[freopnt]{3,4}bsd) (alpha)/i],[[_e,/ower/,At,it]],[/mc680.0/i],[[_e,"68k"]],[/winnt.+\[axp/i],[[_e,"alpha"]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[c,[p,jt],[l,X]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr]|browser)[-\w]+)/i,/sec-(sgh\w+)/i],[c,[p,jt],[l,L]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)[\/\);]/i],[c,[p,St],[l,L]],[/\b(?:ios|apple\w+)\/.+[\(\/](ipad)/i,/\b(ipad)[\d,]*[;\] ].+(mac |i(pad)?)os/i],[c,[p,St],[l,X]],[/(macintosh);/i],[c,[p,St]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[c,[p,ka],[l,L]],[/\b((?:brt|eln|hey2?|gdi|jdn)-a?[lnw]09|(?:ag[rm]3?|jdn2|kob2)-a?[lw]0[09]hn)(?: bui|\)|;)/i],[c,[p,ba],[l,X]],[/honor([-\w ]+)[;\)]/i],[c,[p,ba],[l,L]],[/\b((?:ag[rs][2356]?k?|bah[234]?|bg[2o]|bt[kv]|cmr|cpn|db[ry]2?|jdn2|got|kob2?k?|mon|pce|scm|sht?|[tw]gr|vrd)-[ad]?[lw][0125][09]b?|605hw|bg2-u03|(?:gem|fdr|m2|ple|t1)-[7a]0[1-4][lu]|t1-a2[13][lw]|mediapad[\w\. ]*(?= bui|\)))\b(?!.+d\/s)/i],[c,[p,wa],[l,X]],[/(?:huawei) ?([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][\dc][adnt]?)\b(?!.+d\/s)/i],[c,[p,wa],[l,L]],[/oid[^\)]+; (2[\dbc]{4}(182|283|rp\w{2})[cgl]|m2105k81a?c)(?: bui|\))/i,/\b(?:xiao)?((?:red)?mi[-_ ]?pad[\w- ]*)(?: bui|\))/i],[[c,/_/g," "],[p,Cr],[l,X]],[/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/oid[^\)]+; (redmi[\-_ ]?(?:note|k)?[\w_ ]+|m?[12]\d[01]\d\w{3,6}|poco[\w ]+|(shark )?\w{3}-[ah]0|qin ?[1-3](s\+|ultra| pro)?)( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note|max|cc)?[_ ]?(?:\d{0,2}\w?)[_ ]?(?:plus|se|lite|pro)?( 5g|lte)?)(?: bui|\))/i,/ ([\w ]+) miui\/v?\d/i],[[c,/_/g," "],[p,Cr],[l,L]],[/droid.+; (cph2[3-6]\d[13579]|((gm|hd)19|(ac|be|in|kb)20|(d[en]|eb|le|mt)21|ne22)[0-2]\d|p[g-l]\w[1m]10)\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[c,[p,_a],[l,L]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[c,[p,Er],[l,L]],[/\b(opd2(\d{3}a?))(?: bui|\))/i],[c,[p,Le,{OnePlus:["203","304","403","404","413","415"],"*":Er}],[l,X]],[/(vivo (5r?|6|8l?|go|one|s|x[il]?[2-4]?)[\w\+ ]*)(?: bui|\))/i],[c,[p,"BLU"],[l,L]],[/; vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[c,[p,"Vivo"],[l,L]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[c,[p,"Realme"],[l,L]],[/(ideatab[-\w ]+|602lv|d-42a|a101lv|a2109a|a3500-hv|s[56]000|pb-6505[my]|tb-?x?\d{3,4}(?:f[cu]|xu|[av])|yt\d?-[jx]?\d+[lfmx])( bui|;|\)|\/)/i,/lenovo ?(b[68]0[08]0-?[hf]?|tab(?:[\w- ]+?)|tb[\w-]{6,7})( bui|;|\)|\/)/i],[c,[p,$r],[l,X]],[/lenovo[-_ ]?([-\w ]+?)(?: bui|\)|\/)/i],[c,[p,$r],[l,L]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ]([\w\s]+)(\)| bui)/i,/((?:moto(?! 360)[-\w\(\) ]+|xt\d{3,4}[cgkosw\+]?[-\d]*|nexus 6)(?= bui|\)))/i],[c,[p,Pr],[l,L]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[c,[p,Pr],[l,X]],[/\b(?:lg)?([vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[c,[p,Kt],[l,X]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+(?!.*(?:browser|netcast|android tv|watch|webos))(\w+)/i,/\blg-?([\d\w]+) bui/i],[c,[p,Kt],[l,L]],[/(nokia) (t[12][01])/i],[p,c,[l,X]],[/(?:maemo|nokia).*(n900|lumia \d+|rm-\d+)/i,/nokia[-_ ]?(([-\w\. ]*?))( bui|\)|;|\/)/i],[[c,/_/g," "],[l,L],[p,"Nokia"]],[/(pixel (c|tablet))\b/i],[c,[p,dt],[l,X]],[/droid.+;(?: google)? (g(01[13]a|020[aem]|025[jn]|1b60|1f8f|2ybb|4s1m|576d|5nz6|8hhn|8vou|a02099|c15s|d1yq|e2ae|ec77|gh2x|kv4x|p4bc|pj41|r83y|tt9q|ur25|wvk6)|pixel[\d ]*a?( pro)?( xl)?( fold)?( \(5g\))?)( bui|\))/i],[c,[p,dt],[l,L]],[/(google) (pixelbook( go)?)/i],[p,c],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-\w\w\d\d)(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[c,[p,zt],[l,L]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[c,"Xperia Tablet"],[p,zt],[l,X]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[c,[p,Xt],[l,X]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[c,/(.+)/g,"Fire Phone $1"],[p,Xt],[l,L]],[/(playbook);[-\w\),; ]+(rim)/i],[c,p,[l,X]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/(?:blackberry|\(bb10;) (\w+)/i],[c,[p,ha],[l,L]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[c,[p,ga],[l,X]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[c,[p,ga],[l,L]],[/(nexus 9)/i],[c,[p,"HTC"],[l,X]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[c,/_/g," "],[l,L]],[/tcl (xess p17aa)/i,/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])(_\w(\w|\w\w))?(\)| bui)/i],[c,[p,"TCL"],[l,X]],[/droid [\w\.]+; (418(?:7d|8v)|5087z|5102l|61(?:02[dh]|25[adfh]|27[ai]|56[dh]|59k|65[ah])|a509dl|t(?:43(?:0w|1[adepqu])|50(?:6d|7[adju])|6(?:09dl|10k|12b|71[efho]|76[hjk])|7(?:66[ahju]|67[hw]|7[045][bh]|71[hk]|73o|76[ho]|79w|81[hks]?|82h|90[bhsy]|99b)|810[hs]))(_\w(\w|\w\w))?(\)| bui)/i],[c,[p,"TCL"],[l,L]],[/(itel) ((\w+))/i],[[p,it],c,[l,Le,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[c,[p,"Acer"],[l,X]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[c,[p,"Meizu"],[l,L]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[c,[p,"Ulefone"],[l,L]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[c,[p,"Energizer"],[l,L]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[c,[p,"Cat"],[l,L]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[c,[p,"Smartfren"],[l,L]],[/droid.+; (a(in)?(0(15|59|6[35])|142)p?)/i],[c,[p,"Nothing"],[l,L]],[/; (x67 5g|tikeasy \w+|ac[1789]\d\w+)( b|\))/i,/archos ?(5|gamepad2?|([\w ]*[t1789]|hello) ?\d+[\w ]*)( b|\))/i],[c,[p,"Archos"],[l,X]],[/archos ([\w ]+)( b|\))/i,/; (ac[3-6]\d\w{2,8})( b|\))/i],[c,[p,"Archos"],[l,L]],[/; (n159v)/i],[c,[p,"HMD"],[l,L]],[/(imo) (tab \w+)/i,/(infinix|tecno) (x1101b?|p904|dp(7c|8d|10a)( pro)?|p70[1-3]a?|p904|t1101)/i],[p,c,[l,X]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus(?! zenw)|dell|jolla|meizu|motorola|polytron|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (blu|hmd|imo|infinix|lava|oneplus|tcl|wiko)[_ ]([\w\+ ]+?)(?: bui|\)|; r)/i,/(hp) ([\w ]+\w)/i,/(microsoft); (lumia[\w ]+)/i,/(oppo) ?([\w ]+) bui/i,/(hisense) ([ehv][\w ]+)\)/i,/droid[^;]+; (philips)[_ ]([sv-x][\d]{3,4}[xz]?)/i],[p,c,[l,L]],[/(kobo)\s(ereader|touch)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i],[p,c,[l,X]],[/(surface duo)/i],[c,[p,Mr],[l,X]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[c,[p,"Fairphone"],[l,L]],[/((?:tegranote|shield t(?!.+d tv))[\w- ]*?)(?: b|\))/i],[c,[p,ya],[l,X]],[/(sprint) (\w+)/i],[p,c,[l,L]],[/(kin\.[onetw]{3})/i],[[c,/\./g," "],[p,Mr],[l,L]],[/droid.+; ([c6]+|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[c,[p,Or],[l,X]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[c,[p,Or],[l,L]],[/(philips)[\w ]+tv/i,/smart-tv.+(samsung)/i],[p,[l,ue]],[/hbbtv.+maple;(\d+)/i],[[c,/^/,"SmartTV"],[p,jt],[l,ue]],[/(vizio)(?: |.+model\/)(\w+-\w+)/i,/tcast.+(lg)e?. ([-\w]+)/i],[p,c,[l,ue]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,Kt],[l,ue]],[/(apple) ?tv/i],[p,[c,St+" TV"],[l,ue]],[/crkey.*devicetype\/chromecast/i],[[c,at+" Third Generation"],[p,dt],[l,ue]],[/crkey.*devicetype\/([^/]*)/i],[[c,/^/,"Chromecast "],[p,dt],[l,ue]],[/fuchsia.*crkey/i],[[c,at+" Nest Hub"],[p,dt],[l,ue]],[/crkey/i],[[c,at],[p,dt],[l,ue]],[/(portaltv)/i],[c,[p,Ir],[l,ue]],[/droid.+aft(\w+)( bui|\))/i],[c,[p,Xt],[l,ue]],[/(shield \w+ tv)/i],[c,[p,ya],[l,ue]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[c,[p,ka],[l,ue]],[/(bravia[\w ]+)( bui|\))/i],[c,[p,zt],[l,ue]],[/(mi(tv|box)-?\w+) bui/i],[c,[p,Cr],[l,ue]],[/Hbbtv.*(technisat) (.*);/i],[p,c,[l,ue]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,/.+\/(\w+)/,"$1",Le,{LG:"lge"}],[c,nr],[l,ue]],[/(playstation \w+)/i],[c,[p,zt],[l,Qt]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[c,[p,Mr],[l,Qt]],[/(ouya)/i,/(nintendo) (\w+)/i,/(retroid) (pocket ([^\)]+))/i,/(valve).+(steam deck)/i,/droid.+; ((shield|rgcube|gr0006))( bui|\))/i],[[p,Le,{Nvidia:"Shield",Anbernic:"RGCUBE",Logitech:"GR0006"}],c,[l,Qt]],[/\b(sm-[lr]\d\d[0156][fnuw]?s?|gear live)\b/i],[c,[p,jt],[l,qe]],[/((pebble))app/i,/(asus|google|lg|oppo|xiaomi) ((pixel |zen)?watch[\w ]*)( bui|\))/i],[p,c,[l,qe]],[/(ow(?:19|20)?we?[1-3]{1,3})/i],[c,[p,Er],[l,qe]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[c,[p,St],[l,qe]],[/(opwwe\d{3})/i],[c,[p,_a],[l,qe]],[/(moto 360)/i],[c,[p,Pr],[l,qe]],[/(smartwatch 3)/i],[c,[p,zt],[l,qe]],[/(g watch r)/i],[c,[p,Kt],[l,qe]],[/droid.+; (wt63?0{2,3})\)/i],[c,[p,Or],[l,qe]],[/droid.+; (glass) \d/i],[c,[p,dt],[l,Jt]],[/(pico) ([\w ]+) os\d/i],[p,c,[l,Jt]],[/(quest( \d| pro)?s?).+vr/i],[c,[p,Ir],[l,Jt]],[/mobile vr; rv.+firefox/i],[[l,Jt]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[l,Ft]],[/(aeobc)\b/i],[c,[p,Xt],[l,Ft]],[/(homepod).+mac os/i],[c,[p,St],[l,Ft]],[/windows iot/i],[[l,Ft]],[/droid.+; ([\w- ]+) (4k|android|smart|google)[- ]?tv/i],[c,[l,ue]],[/\b((4k|android|smart|opera)[- ]?tv|tv; rv:|large screen[\w ]+safari)\b/i],[[l,ue]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew|; hmsc).+?(mobile|vr|\d) safari/i],[c,[l,Le,{mobile:"Mobile",xr:"VR","*":X}]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,X]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,L]],[/droid .+?; ([\w\. -]+)( bui|\))/i],[c,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[u,Zt+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[u,v],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[u,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links|dillo)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[u,v],[/ladybird\//i],[[u,"LibWeb"]],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,u]],os:[[/(windows nt) (6\.[23]); arm/i],[[u,/N/,"R"],[v,Le,Ma]],[/(windows (?:phone|mobile|iot))(?: os)?[\/ ]?([\d\.]*( se)?)/i,/(windows)[\/ ](1[01]|2000|3\.1|7|8(\.1)?|9[58]|me|server 20\d\d( r2)?|vista|xp)/i],[u,v],[/windows nt ?([\d\.\)]*)(?!.+xbox)/i,/\bwin(?=3| ?9|n)(?:nt| 9x )?([\d\.;]*)/i],[[v,/(;|\))/g,"",Le,Ma],[u,qr]],[/(windows ce)\/?([\d\.]*)/i],[u,v],[/[adehimnop]{4,7}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv|ios(?=.+ip(?:ad|hone)|.+apple ?tv)|ip(?:ad|hone)(?: |.+i(?:pad)?)os|apple ?tv.+ios)[\/ ]([\w\.]+)/i,/\btvos ?([\w\.]+)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[u,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+(haiku|morphos))/i],[[u,"macOS"],[v,/_/g,"."]],[/android ([\d\.]+).*crkey/i],[v,[u,at+" Android"]],[/fuchsia.*crkey\/([\d\.]+)/i],[v,[u,at+" Fuchsia"]],[/crkey\/([\d\.]+).*devicetype\/smartspeaker/i],[v,[u,at+" SmartSpeaker"]],[/linux.*crkey\/([\d\.]+)/i],[v,[u,at+" Linux"]],[/crkey\/([\d\.]+)/i],[v,[u,at]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[v,u],[/(ubuntu) ([\w\.]+) like android/i],[[u,/(.+)/,"$1 Touch"],v],[/(harmonyos)[\/ ]?([\d\.]*)/i,/(android|bada|blackberry|kaios|maemo|meego|openharmony|qnx|rim tablet os|sailfish|series40|symbian|tizen)\w*[-\/\.; ]?([\d\.]*)/i],[u,v],[/\(bb(10);/i],[v,[u,ha]],[/(?:symbian ?os|symbos|s60(?=;)|series ?60)[-\/ ]?([\w\.]*)/i],[v,[u,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile[;\w ]*|tablet|tv|[^\)]*(?:viera|lg(?:l25|-d300)|alcatel ?o.+|y300-f1)); rv:([\w\.]+)\).+gecko\//i],[v,[u,Ht+" OS"]],[/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i,/webos(?:[ \/]?|\.tv-20(?=2[2-9]))(\d[\d\.]*)/i],[v,[u,"webOS"]],[/web0s;.+?(?:chr[o0]me|safari)\/(\d+)/i],[[v,Le,{25:"120",24:"108",23:"94",22:"87",6:"79",5:"68",4:"53",3:"38",2:"538",1:"537","*":"TV"}],[u,"webOS"]],[/watch(?: ?os[,\/ ]|\d,\d\/)([\d\.]+)/i],[v,[u,"watchOS"]],[/cros [\w]+(?:\)| ([\w\.]+)\b)/i],[v,[u,"Chrome OS"]],[/kepler ([\w\.]+); (aft|aeo)/i],[v,[u,"Vega OS"]],[/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) (\w+)/i,/(xbox); +xbox ([^\);]+)/i,/(pico) .+os([\w\.]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/linux.+(mint)[\/\(\) ]?([\w\.]*)/i,/(mageia|vectorlinux|fuchsia|arcaos|arch(?= ?linux))[;l ]([\d\.]*)/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire|knoppix)(?: gnu[\/ ]linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/\b(aix)[; ]([1-9\.]{0,4})/i,/(hurd|linux|morphos)(?: (?:arm|x86|ppc)\w*| ?)([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) ?(r\d)?/i],[u,v],[/(sunos) ?([\d\.]*)/i],[[u,"Solaris"],v],[/\b(beos|os\/2|amigaos|openvms|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[u,v]]},Yt=(function(){var e={init:{},isIgnore:{},isIgnoreRgx:{},toString:{}};return Ye.call(e.init,[[Pe,[u,v,Bt,l]],[Qe,[_e]],[Be,[l,c,p]],[ze,[u,v]],[Ie,[u,v]]]),Ye.call(e.isIgnore,[[Pe,[v,Bt]],[ze,[v]],[Ie,[v]]]),Ye.call(e.isIgnoreRgx,[[Pe,/ ?browser$/i],[Ie,/ ?os$/i]]),Ye.call(e.toString,[[Pe,[u,v]],[Qe,[_e]],[Be,[p,c]],[ze,[u,v]],[Ie,[u,v]]]),e})(),ns=function(e,r){var a=Yt.init[r],i=Yt.isIgnore[r]||0,n=Yt.isIgnoreRgx[r]||0,d=Yt.toString[r]||0;function s(){Ye.call(this,a)}return s.prototype.getItem=function(){return e},s.prototype.withClientHints=function(){return ut?ut.getHighEntropyValues(Ja).then(function(k){return e.setCH(new Xa(k,!1)).parseCH().get()}):e.parseCH().get()},s.prototype.withFeatureCheck=function(){return e.detectFeature().get()},r!=Tt&&(s.prototype.is=function(k){var o=!1;for(var m in this)if(this.hasOwnProperty(m)&&!Fr(i,m)&&it(n?Nt(n,this[m]):this[m])==it(n?Nt(n,k):k)){if(o=!0,k!=de.UNDEFINED)break}else if(k==de.UNDEFINED&&o){o=!o;break}return o},s.prototype.toString=function(){var k=At;for(var o in d)typeof this[d[o]]!==de.UNDEFINED&&(k+=(k?" ":At)+this[d[o]]);return k||de.UNDEFINED}),s.prototype.then=function(k){var o=this,m=function(){for(var W in o)o.hasOwnProperty(W)&&(this[W]=o[W])};m.prototype={is:s.prototype.is,toString:s.prototype.toString,withClientHints:s.prototype.withClientHints,withFeatureCheck:s.prototype.withFeatureCheck};var w=new m;return k(w),w},new s};function Xa(e,r){if(e=e||{},Ye.call(this,Ja),r)Ye.call(this,[[Gr,Rr(e[ot])],[Jr,Rr(e[Xo])],[L,/\?1/.test(e[Zo])],[c,qt(e[es])],[Wt,qt(e[Ga])],[Xr,qt(e[ts])],[_e,qt(e[Ko])],[ct,Rr(e[Qo])],[sr,qt(e[Yo])]]);else for(var a in e)this.hasOwnProperty(a)&&typeof e[a]!==de.UNDEFINED&&(this[a]=e[a])}function nt(e,r,a,i){return Ye.call(this,[["itemType",e],["ua",r],["uaCH",i],["rgxMap",a],["data",ns(this,e)]]),this}nt.prototype.get=function(e){return e?this.data.hasOwnProperty(e)?this.data[e]:void 0:this.data};nt.prototype.set=function(e,r){return this.data[e]=r,this};nt.prototype.setCH=function(e){return this.uaCH=e,this};nt.prototype.detectFeature=function(){if(Me&&Me.userAgent==this.ua)switch(this.itemType){case Pe:Me.brave&&typeof Me.brave.isBrave==de.FUNCTION&&this.set(u,"Brave");break;case Be:!this.get(l)&&ut&&ut[L]&&this.set(l,L),this.get(c)=="Macintosh"&&Me&&typeof Me.standalone!==de.UNDEFINED&&Me.maxTouchPoints&&Me.maxTouchPoints>2&&this.set(c,"iPad").set(l,X);break;case Ie:!this.get(u)&&ut&&ut[Wt]&&this.set(u,ut[Wt]);break;case Tt:var e=this.data,r=function(a){return e[a].getItem().detectFeature().get()};this.set(Pe,r(Pe)).set(Qe,r(Qe)).set(Be,r(Be)).set(ze,r(ze)).set(Ie,r(Ie))}return this};nt.prototype.parseUA=function(){switch(this.itemType!=Tt&&Br.call(this.data,this.ua,this.rgxMap),this.itemType){case Pe:this.set(Bt,Ur(this.get(v)));break;case Ie:if(this.get(u)=="iOS"&&this.get(v)=="18.6"){var e=/\) Version\/([\d\.]+)/.exec(this.ua);e&&parseInt(e[1].substring(0,2),10)>=26&&this.set(v,e[1])}break}return this};nt.prototype.parseCH=function(){var e=this.uaCH,r=this.rgxMap;switch(this.itemType){case Pe:case ze:var a=e[Jr]||e[Gr],i;if(a)for(var n=0;n<a.length;n++){var d=a[n].brand||a[n],s=a[n].version;this.itemType==Pe&&!/not.a.brand/i.test(d)&&(!i||/Chrom/.test(i)&&d!=xa||i==Zt&&/WebView2/.test(d))&&(d=Le(d,is),i=this.get(u),i&&!/Chrom/.test(i)&&/Chrom/.test(d)||this.set(u,d).set(v,s).set(Bt,Ur(s)),i=d),this.itemType==ze&&d==xa&&this.set(v,s)}break;case Qe:var k=e[_e];k&&(k&&e[sr]=="64"&&(k+="64"),Br.call(this.data,k+";",r));break;case Be:if(e[L]&&this.set(l,L),e[c]&&(this.set(c,e[c]),!this.get(l)||!this.get(p))){var o={};Br.call(o,"droid 9; "+e[c]+")",r),!this.get(l)&&o.type&&this.set(l,o.type),!this.get(p)&&o.vendor&&this.set(p,o.vendor)}if(e[ct]){var m;if(typeof e[ct]!="string")for(var w=0;!m&&w<e[ct].length;)m=Le(e[ct][w++],Pa);else m=Le(e[ct],Pa);this.set(l,m)}break;case Ie:var W=e[Wt];if(W){var D=e[Xr];W==qr&&(D=parseInt(Ur(D),10)>=13?"11":"10"),this.set(u,W).set(v,D)}this.get(u)==qr&&e[c]=="Xbox"&&this.set(u,"Xbox").set(v,void 0);break;case Tt:var R=this.data,g=function(_){return R[_].getItem().setCH(e).parseCH().get()};this.set(Pe,g(Pe)).set(Qe,g(Qe)).set(Be,g(Be)).set(ze,g(ze)).set(Ie,g(Ie))}return this};function Ze(e,r,a){if(typeof e===de.OBJECT?(ir(e,!0)?(typeof r===de.OBJECT&&(a=r),r=e):(a=e,r=void 0),e=void 0):typeof e===de.STRING&&!ir(r,!0)&&(a=r,r=void 0),a)if(typeof a.append===de.FUNCTION){var i={};a.forEach(function(w,W){i[String(W).toLowerCase()]=w}),a=i}else{var n={};for(var d in a)a.hasOwnProperty(d)&&(n[String(d).toLowerCase()]=a[d]);a=n}if(!(this instanceof Ze))return new Ze(e,r,a).getResult();var s=typeof e===de.STRING?e:a&&a[va]?a[va]:Me&&Me.userAgent?Me.userAgent:At,k=new Xa(a,!0),o=r?as(Ea,r):Ea,m=function(w){return w==Tt?function(){return new nt(w,s,o,k).set("ua",s).set(Pe,this.getBrowser()).set(Qe,this.getCPU()).set(Be,this.getDevice()).set(ze,this.getEngine()).set(Ie,this.getOS()).get()}:function(){return new nt(w,s,o[w],k).parseUA().get()}};return Ye.call(this,[["getBrowser",m(Pe)],["getCPU",m(Qe)],["getDevice",m(Be)],["getEngine",m(ze)],["getOS",m(Ie)],["getResult",m(Tt)],["getUA",function(){return s}],["setUA",function(w){return Vt(w)&&(s=nr(w,Go)),this}]]).setUA(s),this}Ze.VERSION=Vo;Ze.BROWSER=lr([u,v,Bt,l]);Ze.CPU=lr([_e]);Ze.DEVICE=lr([c,p,l,Qt,L,ue,X,qe,Ft]);Ze.ENGINE=Ze.OS=lr([u,v]);var os=wt('<svg><path fill="currentColor" d="M9.973 18H11v-5h2v5h1.027c.132-1.202.745-2.193 1.74-3.277c.113-.122.832-.867.917-.973a6 6 0 1 0-9.37-.002c.086.107.807.853.918.974c.996 1.084 1.609 2.076 1.741 3.278M10 20v1h4v-1zm-4.246-5a8 8 0 1 1 12.49.002C17.624 15.774 16 17 16 18.5V21a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-2.5C8 17 6.375 15.774 5.754 15"></path></svg>');function ss(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=os();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var ls=V("<p> </p>"),ds=V('<textarea rows="6"></textarea>'),cs=V('<form class="svelte-2tf4df"><!> <!> <details><summary> </summary> <!></details> <!></form>'),us=V("<!> <!>",1);function Ca(e,r){gt(r,!0);let a=be(""),i=be(""),n=be(void 0),d=be(void 0),s=be(!1);const k=h(()=>r.type==="bug"?Hi:ss),o=h(()=>Dt("main"));rr("general",{[r.type==="bug"?"$mod+!":"$mod+*"]:{help:r.type==="bug"?t(o)(393):t(o)(394),do:()=>t(n)?.()}});const m=h(()=>{const R=Ze(navigator.userAgent),g=Wa(),_=(f,y="")=>"\n```"+y+`
`+f+"\n```",x=f=>_(JSON.stringify(f,null,2),"json"),O=(f,y)=>Object.values(y).flatMap(I=>I.map(P=>`<dt>${f}</dt> <dd><code>(${P.kind}, ignored: ${P.ignored})</code> ${P.message} 
		<details><summary>Stack trace</summary><pre>${zi(P.stack)}</pre></details></dd>`)),b=[...ye.Observation.state.flatMap(f=>O(f.label,f.metadataErrors)),...ye.Image.state.flatMap(f=>O(f.filename,f.metadataErrors))];return{Version:Lr,[t(o)(461)]:navigator.userAgent,Route:we.route.id,OS:R.os.toString(),Browser:R.browser.toString(),Device:R.device.toString(),Protocol:j.currentProtocol?`${j.currentProtocol.id} v${j.currentProtocol.version}`:"_None_",[t(o)(462)]:g.version.toString(),[t(o)(463)]:["Observation","Image","Session","Metadata","Protocol"].map(f=>`${ye[f].state.length} ${f.toLowerCase()}s`).join(", "),[t(o)(464)]:`${b.length}
<dl>`+b.join("")+`</dl>
`,[t(o)(465)]:x(j.currentSession)}});var w=us(),W=le(w);{let R=h(()=>r.type==="bug"?"Signaler un bug":"Proposer une fonctionnalité");Vr(W,{get key(){return`modal_submit_issue_${r.type??""}`},get title(){return t(R)},get open(){return t(n)},set open(g){ae(n,g,!0)},get close(){return t(d)},set close(g){ae(d,g,!0)},children:(g,_)=>{var x=cs(),O=$(x);da(O,{label:T=>{const z=U=>{var N=Te(),J=le(N);{var Z=fe=>{var ve=ls(),ke=$(ve,!0);S(ve),Y(Re=>K(ke,Re),[()=>t(o)(409)]),E(fe,ve)};se(J,fe=>{r.type==="bug"&&fe(Z)})}E(U,N)};{let U=h(()=>[z]),N=h(()=>t(o).c(395));Oe(T,{get t(){return t(U)},get x(){return t(N)}})}},children:(T,z)=>{var U=ds();di(U),Ji(U,()=>t(a),N=>ae(a,N)),E(T,U)},$$slots:{label:!0,default:!0}});var b=M(O,2);{let C=h(()=>t(o)(396));da(b,{get label(){return t(C)},children:(T,z)=>{{let U=h(()=>t(o)(396));Fa(T,{required:!0,get label(){return t(U)},get value(){return t(i)},set value(N){ae(i,N,!0)}})}},$$slots:{default:!0}})}var f=M(b,2),y=$(f),I=$(y,!0);S(y);var P=M(y,2);{let C=h(()=>Object.entries(t(m)).map(([T,z])=>`- **${T}**: ${z}`).join(`
`));ti(P,{get source(){return t(C)}})}S(f);var q=M(f,2);{let C=h(()=>t(s)?"always":!1);zr(q,{submits:!0,get loading(){return t(C)},onclick:void 0,children:(T,z)=>{Ct();var U=Ot();Y(N=>K(U,N),[()=>t(o)(400)]),E(T,U)},$$slots:{default:!0}})}S(x),Y(C=>K(I,C),[()=>t(o)(466)]),Li("submit",x,async C=>{ae(s,!0),C.preventDefault();const T=await fetch("https://mkissue.cigale.gwen.works/submit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:r.type,title:t(i),body:t(a),metadata:t(m)})});if(ae(s,!1),t(d)?.(),T.ok){const z=await T.json();$e.success(t(o)(397),{data:!0,lifetime:1/0,action:new URL(z.url),labels:{action:t(o)(398)}})}else console.error("Error submitting issue:",T.statusText,await T.text()),$e.error(t(o)(399))}),E(g,x)},$$slots:{default:!0}})}var D=M(W,2);{let R=h(()=>r.type==="bug"?"Signaler un bug":"Proposer une fonctionnalité"),g=h(()=>r.type==="bug"?"open-bug-report":"open-feature-request");mt(D,{onclick:()=>t(n)?.(),get help(){return t(R)},get"data-testid"(){return t(g)},children:(_,x)=>{var O=Te(),b=le(O);jr(b,()=>t(k),(f,y)=>{y(f,{})}),E(_,O)},$$slots:{default:!0}})}E(e,w),ht()}var ms=wt('<svg><path fill="currentColor" d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2h.1A6.98 6.98 0 0 0 10 7m-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938A8 8 0 0 0 4 12"></path></svg>');function fs(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=ms();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var vs=wt('<svg><path fill="currentColor" d="M3.34 17a10 10 0 0 1-.979-2.326a3 3 0 0 0 .003-5.347a10 10 0 0 1 2.5-4.337a3 3 0 0 0 4.632-2.674a10 10 0 0 1 5.007.003a3 3 0 0 0 4.632 2.671a10.06 10.06 0 0 1 2.503 4.336a3 3 0 0 0-.002 5.347a10 10 0 0 1-2.501 4.337a3 3 0 0 0-4.632 2.674a10 10 0 0 1-5.007-.002a3 3 0 0 0-4.631-2.672A10 10 0 0 1 3.339 17m5.66.196a5 5 0 0 1 2.25 2.77q.75.07 1.499.002a5 5 0 0 1 2.25-2.772a5 5 0 0 1 3.526-.564q.435-.614.748-1.298A5 5 0 0 1 18 12c0-1.26.47-2.437 1.273-3.334a8 8 0 0 0-.75-1.298A5 5 0 0 1 15 6.804a5 5 0 0 1-2.25-2.77q-.75-.071-1.5-.001A5 5 0 0 1 9 6.804a5 5 0 0 1-3.526.564q-.436.614-.747 1.298A5 5 0 0 1 6 12c0 1.26-.471 2.437-1.273 3.334a8 8 0 0 0 .75 1.298A5 5 0 0 1 9 17.196M12 15a3 3 0 1 1 0-6a3 3 0 0 1 0 6m0-2a1 1 0 1 0 0-2a1 1 0 0 0 0 2"></path></svg>');function ps(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=vs();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var gs=wt('<svg><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12a6 6 0 0 1 0 12m0-2a4 4 0 1 0 0-8a4 4 0 0 0 0 8M11 1h2v3h-2zm0 19h2v3h-2zM3.515 4.929l1.414-1.414L7.05 5.636L5.636 7.05zM16.95 18.364l1.414-1.414l2.121 2.121l-1.414 1.414zm2.121-14.85l1.414 1.415l-2.121 2.121l-1.414-1.414zM5.636 16.95l1.414 1.414l-2.121 2.121l-1.414-1.414zM23 11v2h-3v-2zM4 11v2H1v-2z"></path></svg>');function hs(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=gs();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var ws=V('<p class="details svelte-qprabs"> </p>'),bs=V('<p class="details svelte-qprabs"> </p>'),ys=V("<a> </a>"),_s=V("<a> </a>"),ks=V('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <dialog class="container svelte-qprabs" data-testid="app-settings"><header class="svelte-qprabs"> </header> <div class="listParam svelte-qprabs"><div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!> <div class="number-input svelte-qprabs"><!></div> <!></div></div> <section class="actions svelte-qprabs"><!> <!></section> <footer class="svelte-qprabs"><!></footer></dialog>',1);function Ss(e,r){gt(r,!0);const a=h(()=>Dt("main"));let i=be(!1),n=be(void 0);const d=h(()=>Ra()&&Dr().notifications);je(()=>{window.addEventListener("mouseup",({target:A})=>{A!==t(n)&&(t(n)?.contains(A)||ae(i,!1))})});const s=h(Dr),k=h(()=>t(s).showTechnicalMetadata),o=h(()=>t(s).gridSize),m=h(()=>t(s).language),w=h(()=>t(s).parallelism),W=rn();je(()=>{window.nativeWindow?.setControlsColor(getComputedStyle(document.documentElement).getPropertyValue(`--${W.effective}__fg-primary`))});var D=ks(),R=le(D);{let A=h(()=>t(i)?"Fermer":"Réglages");ar(R,()=>({"--fg":"var(--trigger-fg)","--bg":"var(--trigger-bg)","--hover-fg":"var(--trigger-hover-fg)","--hover-bg":"var(--trigger-hover-bg)"})),mt(R.lastChild,{"data-testid":"settings-button",get help(){return t(A)},onclick:()=>{ae(i,!t(i))},children:(H,B)=>{var G=Te(),te=le(G);{var he=xe=>{Yi(xe,{})},tt=xe=>{ps(xe,{})};se(te,xe=>{t(i)?xe(he):xe(tt,!1)})}E(H,G)},$$slots:{default:!0}}),S(R)}var g=M(R,2);let _;var x=$(g),O=$(x,!0);S(x);var b=M(x,2),f=$(b),y=$(f,!0);S(f);var I=M(f,2),P=$(I);{let A=h(()=>W.effective==="light"),H=h(()=>({on:hs,off:fs}));_r(P,{get value(){return t(A)},onchange:async B=>{await Ce("theme",B?"light":"dark")},get icons(){return t(H)}})}var q=M(P,2);{let A=h(()=>W.setting==="auto"),H=h(()=>t(a)(158));mt(q,{get disabled(){return t(A)},onclick:async()=>await Ce("theme","auto"),get help(){return t(H)},children:(B,G)=>{Qi(B,{})},$$slots:{default:!0}})}S(I);var C=M(I,2);{const A=(H,B=Pt)=>{var G=ws(),te=$(G,!0);S(G),Y(he=>K(te,he),[()=>t(a).x(B())]),E(H,G)};var T=$(C);{let H=h(()=>[A]),B=h(()=>t(a).c(339));Oe(T,{get t(){return t(H)},get x(){return t(B)}})}S(C)}var z=M(C,2),U=$(z);_r(U,{"data-testid":"notifications",get value(){return t(d)},onchange:async A=>{A?(await Ia(),Ce("notifications",!0)):Ce("notifications",!1)}}),S(z);var N=M(z,2),J=$(N,!0);S(N);var Z=M(N,2),fe=$(Z);_r(fe,{"data-testid":"debug-mode",get value(){return t(k)},onchange:async A=>{await Ce("showTechnicalMetadata",A)}}),S(Z);var ve=M(Z,2),ke=$(ve,!0);S(ve);var Re=M(ve,2),yt=$(Re),ne=()=>t(o),st=A=>{const H=ye.Settings.state;H[H.findIndex(B=>B.id==="user")].gridSize=A};Zi(yt,{min:.5,max:2,granularity:.01,ticks:[1],onblur:async()=>Ce("gridSize",t(o)),get value(){return ne()},set value(A){st(A)}}),S(Re);var et=M(Re,2),Gt=$(et,!0);S(et);var _t=M(et,2),Lt=$(_t);{const A=(B,G=Pt)=>{const te=h(()=>({en:"English",fr:"Français",ja:"日本語"}));Ct();var he=Ot();Y(()=>K(he,t(te)[G()]||G())),E(B,he)};let H=h(()=>t(a)(112));tn(Lt,{"data-testid":"language-selection",get"aria-label"(){return t(H)},"clickable-custom-options":!0,options:["en","fr"],get value(){return t(m)},onchange:async B=>{await Ce("language",B),window.location.reload()},customOption:A,$$slots:{customOption:!0}})}S(_t);var ee=M(_t,2);{const A=(H,B=Pt)=>{var G=bs(),te=$(G,!0);S(G),Y(he=>K(te,he),[()=>t(a).x(B())]),E(H,G)};var ie=$(ee);{let H=h(()=>[A]),B=h(()=>t(a).c(321));Oe(ie,{get t(){return t(H)},get x(){return t(B)}})}S(ee)}var me=M(ee,2),We=$(me);{let A=h(()=>t(a)(322));mt(We,{get help(){return t(A)},onclick:async()=>{await Ce("parallelism",Math.max(1,t(w)-1))},children:(H,B)=>{en(H,{})},$$slots:{default:!0}})}var Se=M(We,2),Ve=$(Se);{let A=h(()=>t(a)(323));Fa(Ve,{get label(){return t(A)},get value(){return t(w)},onblur:async H=>{await Ce("parallelism",Number.parseInt(H))}})}S(Se);var pe=M(Se,2);{let A=h(()=>t(a)(324));mt(pe,{get help(){return t(A)},onclick:async()=>{await Ce("parallelism",t(w)+1)},children:(H,B)=>{Ki(H,{})},$$slots:{default:!0}})}S(me),S(b);var ce=M(b,2),ge=$(ce);la(ge,{onclick:()=>{r.openKeyboardShortcuts?.()},children:(A,H)=>{Ct();var B=Ot();Y(G=>K(B,G),[()=>t(a)(137)]),E(A,B)},$$slots:{default:!0}});var Ge=M(ge,2);{let A=h(()=>t(a)(170));la(Ge,{get help(){return t(A)},onclick:()=>{r.openPrepareForOfflineUse?.()},children:(H,B)=>{Ct();var G=Ot();Y(te=>K(G,te),[()=>t(a)(135)]),E(H,G)},$$slots:{default:!0}})}S(ce);var He=M(ce,2);{const A=B=>{var G=ys(),te=$(G,!0);S(G),Y(he=>{Ee(G,"href","https://github.com/cigaleapp/cigale/tree/e7c0a3fac1321ecb36764bdce01e4982185ea8f3"),K(te,he)},[()=>"e7c0a3fac1321ecb36764bdce01e4982185ea8f3".slice(0,7)]),E(B,G)},H=(B,G=Pt)=>{var te=_s(),he=$(te,!0);S(te),Y((tt,xe)=>{Ee(te,"href",tt),K(he,xe)},[()=>Ae("/about"),()=>t(a).x(G())]),Ha("click",te,()=>{ae(i,!1)}),E(B,te)};var lt=$(He);{let B=h(()=>[A,H]),G=h(()=>t(a).c(45));Oe(lt,{get t(){return t(B)},get x(){return t(G)}})}S(He)}S(g),Xi(g,A=>ae(n,A),()=>t(n)),Y((A,H,B,G,te,he)=>{g.open=t(i)?!0:void 0,_=Oa(g,"",_,A),K(O,H),K(y,B),K(J,G),K(ke,te),K(Gt,he)},[()=>({"color-scheme":Da()}),()=>t(a)(147),()=>t(a)(166),()=>t(a)(122),()=>t(a)(163),()=>t(a)(111)]),E(e,D),ht()}za(["click"]);var xs=wt('<svg><path fill="currentColor" d="m19 3l4 5h-3v12h-2V8h-3zm-5 15v2H3v-2zm0-7v2H3v-2zm-2-7v2H3V4z"></path></svg>');function $s(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=xs();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var Ms=wt('<svg><path fill="currentColor" d="M20 4v12h3l-4 5l-4-5h3V4zm-8 14v2H3v-2zm2-7v2H3v-2zm0-7v2H3V4z"></path></svg>');function Ps(e,r){const a=bt(r,["$$slots","$$events","$$legacy"]);var i=Ms();pt(i,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...a})),E(e,i)}var Es=V('<code class="svelte-1w1wea9"> </code>'),Cs=V('<div class="icon svelte-1w1wea9"><!></div> <div class="label svelte-1w1wea9"><!> </div> <div class="icon svelte-1w1wea9"><!></div>',1),Os=V('<div class="inference svelte-1w1wea9"><!></div>');function Ar(e,r){gt(r,!0);const a=h(()=>{switch(we.route.id){case"/(app)/(sidepanel)/crop":return r.tab==="crop";case"/(app)/(sidepanel)/classify":return r.tab==="classify";case"/(app)/(sidepanel)/import":return r.tab==="import";default:return!1}});function i(D,R){return{type:"selectable",data:{direction:null},key:D,label:R,selected:r.currentModelIndex===D,async onclick(){await r.setModel(D),t(a)&&r.currentModelIndex!==D&&window.location.reload()}}}const n=h(()=>Ii(j.currentProtocol??{metadataOrder:void 0})),d=h(()=>ye.Metadata.state.filter(D=>Pi(D.id)===j.currentProtocolId).sort(t(n))),s=h(()=>t(d).filter(D=>D.sortable)),k=h(()=>t(d).filter(D=>D.groupable)),o=h(()=>j.currentSession?{sort:j.currentSession.sort[r.tab]??j.currentSession.sort.global,group:j.currentSession.group[r.tab]??j.currentSession.group.global}:void 0);async function m(D,R){if(!j.currentSession||!t(o))return;const g={...t(o)[D],...R};if(pr(D,g.field)&&!g.metadata){console.warn("Not updating in DB yet, user needs to select metadata too");return}if(D==="sort"){const _=ca({...j.currentSession.sort,[r.tab]:{direction:"asc",...g}});await ye.Session.update(j.currentSession.id,"sort",_)}else{const _=ca({...j.currentSession.group,[r.tab]:{...g}});await ye.Session.update(j.currentSession.id,"group",_)}}var w=Os(),W=$(w);{const D=(_,x=Pt)=>{mt(_,La({get help(){return r.label}},x,{children:(O,b)=>{an(O,{})},$$slots:{default:!0}}))},R=(_,x,O)=>{let b=()=>x?.().direction,f=()=>x?.().icon,y=()=>O?.().label,I=()=>O?.().selected,P=()=>O?.().type;var q=Cs(),C=le(q),T=$(C);{var z=ne=>{Ps(ne,{})},U=ne=>{$s(ne,{})},N=ne=>{on(ne,{})};se(T,ne=>{I()&&b()==="asc"?ne(z):I()&&b()==="desc"?ne(U,1):I()&&ne(N,2)})}S(C);var J=M(C,2),Z=$(J);{var fe=ne=>{var st=Es(),et=$(st,!0);S(st),Y(()=>K(et,f())),E(ne,st)};se(Z,ne=>{f()&&ne(fe)})}var ve=M(Z);S(J);var ke=M(J,2),Re=$(ke);{var yt=ne=>{nn(ne,{})};se(Re,ne=>{P()==="submenu"&&ne(yt)})}S(ke),Y(()=>K(ve,` ${y()??""}`)),E(_,q)};let g=h(()=>[{testid:`${r.tab}-settings-sort`,label:"Trier par…",items:Et($i).map(([_,{label:x}])=>{const O=t(o)?.sort.direction??null,b=t(o)?.sort.field,f=t(o)?.sort.metadata,y=b===_;return pr("sort",_)?{type:"submenu",data:{direction:null},label:x,selected:y,submenu:{label:"Métadonnée",testid:`${r.tab}-settings-sort-by-${_}-metadata`,empty:"Le protocole ne définit aucune métadonnée triable.",items:t(s).map(P=>({type:"selectable",data:{direction:O},key:P.id,label:P.label||ta(P.id),selected:y&&f===P.id,closeOnSelect:!1,async onclick(){y&&f===P.id?await m("sort",{direction:O==="asc"?"desc":"asc"}):await m("sort",{metadata:P.id,field:_})}}))}}:{key:_,label:x,selected:y,data:{direction:O},type:"selectable",closeOnSelect:!1,async onclick(){y?await m("sort",{direction:O==="asc"?"desc":"asc"}):await m("sort",{field:_})}}})},{label:"Regrouper par…",items:Et(ra).map(([_,{label:x}])=>{const O=t(o)?.group.field,b=t(o)?.group.metadata,f=O===_;return pr("group",_)?{type:"submenu",data:{direction:null},label:x,selected:f,submenu:{label:"Métadonnée",testid:`${r.tab}-settings-group-by-${_}-metadata`,empty:"Le protocole ne définit aucune métadonnée groupable.",items:t(k).map(I=>({type:"selectable",data:{direction:null},key:I.id,label:I.label||ta(I.id),selected:f&&b===I.id,closeOnSelect:!1,async onclick(){f&&b===I.id?await m("group",{field:"none"}):await m("group",{metadata:I.id,field:_})}}))}}:{type:"selectable",data:{direction:null},key:_,label:x,selected:f,closeOnSelect:!1,async onclick(){await m("group",{field:_})}}})},...ea(ra[t(o)?.group.field??"none"].needsTolerance,{label:"Précision des groupes",testid:`${r.tab}-settings-group-tolerances`,items:Et(Mi).filter(([,{affectedTypes:_}])=>{if(!t(o)?.group.metadata)return!1;const x=ye.Metadata.getFromState(t(o).group.metadata);return x?_.includes(x.type):!1}).map(([_,{options:x,label:O,help:b}])=>({type:"submenu",data:{direction:null},label:O,submenu:{label:b,items:Et(x).map(([f,{scientific:y,casual:I}])=>({type:"selectable",label:I,data:{direction:null,icon:y},closeOnSelect:!1,key:y,selected:t(o)?.group.tolerances[_]===f,async onclick(){t(o)&&await m("group",{tolerances:{...t(o).group.tolerances,[_]:f}})}}))}}))}),...ea(j.currentProtocol&&r.models.length>0,{label:"Modèle d'inférence",testid:`${r.tab}-settings-inference-model`,items:[i(-1,"Aucune inférence"),...r.models.map((_,x)=>i(x,_.name??`Modèle ${x+1}`))]})]);sn(W,{get testid(){return`${r.tab??""}-settings`},get items(){return t(g)},trigger:D,item:R,$$slots:{trigger:!0,item:!0}})}S(w),E(e,w),ht()}var Is=V('<div class="progress-overlay svelte-1nmekgl"> </div>'),Rs=V('<div class="line svelte-1nmekgl"></div>'),As=V('<div class="line svelte-1nmekgl"></div>'),Ts=V('<div class="line svelte-1nmekgl"></div>'),Ws=V('<div class="line svelte-1nmekgl"></div>'),Ns=V('<div class="line svelte-1nmekgl"></div>'),Ds=V('<div class="steps svelte-1nmekgl"><a class="session-link svelte-1nmekgl" data-testid="goto-current-session"> <!></a> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-import" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-crop" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-classify" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <a data-testid="goto-results" class="svelte-1nmekgl"><!></a></div>'),Ls=V('<div class="line svelte-1nmekgl"></div>'),js=V('<div class="line svelte-1nmekgl"></div>'),zs=V('<div class="steps svelte-1nmekgl"><a data-testid="goto-sessions" class="svelte-1nmekgl"><!></a> <a data-testid="goto-protocols" class="svelte-1nmekgl"><!></a></div>'),Hs=V('<div class="notifications svelte-1nmekgl"><!> <!></div>'),qs=V('<nav data-testid="app-nav" class="svelte-1nmekgl"><div class="logo svelte-1nmekgl"><button data-testid="goto-home" class="svelte-1nmekgl"><!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></button> <!></div> <!> <aside><!> <!> <!> <div class="settings svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div></aside></nav>'),Fs=V('<!> <header><div class="progressbar svelte-1nmekgl"><!></div> <!></header>',1);function Us(e,r){gt(r,!0);let a=Rt(r,"progress",3,0),i=Rt(r,"eta",3,1/0),n=Rt(r,"progressbarOnly",3,!1);const d=h(()=>Ae(we.url.pathname)),s=h(()=>ye.Image.state.length>0);let k=be(void 0),o=be(void 0),m=be(!0),w=be(!1),W=be(!1);je(()=>{ae(W,"nativeWindow"in window)}),je(()=>{t(o)&&window.nativeWindow?.setControlsHeight(t(o))}),je(()=>{window.nativeWindow?.setProgress(Na(a(),0,1)),a()>=1&&window.nativeWindow?.startCallingAttention()});const D=h(()=>i()<1/0&&a()>0&&a()<1);je(()=>{if(t(W))return;const P=document.title.replace(/^(⏳ \d+% ·|🆗) /,"");a()>=1||t(w)?document.title=`🆗 ${P}`:a()===0?document.title=P:document.title=`⏳ ${aa(a())} · ${P}`}),je(()=>{document.addEventListener("processing-queue-drained",()=>{t(m)||ae(w,!0)}),window.addEventListener("focus",()=>{ae(w,!1),ae(m,!0)}),window.addEventListener("blur",()=>{ae(m,!1)})});const R=h(()=>Dt("main"));rr("navigation",{"g p":{do:()=>rt("/"),help:t(R)(58)},"g i":{do:()=>rt("/import"),help:t(R)(105)},"g r":{do:()=>rt("/crop"),help:t(R)(140)},"g n":{do:()=>rt("/classify"),help:t(R)(63)},"g x":{do:()=>rt("/results"),help:t(R)(91)},"g m":{do:()=>rt("/protocols"),help:t(R)(97)}});var g=Fs(),_=le(g);se(_,P=>{});var x=M(_,2);let O;var b=$(x),f=$(b);qa(f,{get progress(){return a()}}),S(b);var y=M(b,2);{var I=P=>{var q=qs(),C=$(q),T=$(C),z=$(T);{var U=ee=>{var ie=Is(),me=$(ie,!0);S(ie),Y(We=>K(me,We),[()=>aa(a())]),wr(3,ie,()=>br),E(ee,ie)};se(z,ee=>{t(D)&&ee(U)})}var N=M(z,2);ar(N,()=>({"--stroke-width":"75","--size":"2rem","--fill":"transparent"})),Vi(N.lastChild,{}),S(N),S(T),gr(T,(ee,ie)=>hr?.(ee,ie),()=>t(D)?`Termine ${ln(Date.now()+i(),{addSuffix:!0,includeSeconds:!0})}`:"Accueil");var J=M(T,2);se(J,ee=>{}),S(C);var Z=M(C,2);{var fe=ee=>{var ie=Ds(),me=$(ie),We=$(me),Se=M(We);{var Ve=re=>{var Q=Rs();E(re,Q)};se(Se,re=>{t(d)===`/sessions/${j.currentSession.id}/`&&re(Ve)})}S(me),gr(me,(re,Q)=>hr?.(re,Q),()=>"Session");var pe=M(me,2),ce=$(pe);{const re=Q=>{var oe=Te(),Je=le(oe);{var Xe=Ne=>{var De=As();E(Ne,De)};se(Je,Ne=>{t(d)=="/import/"&&Ne(Xe)})}E(Q,oe)};var ge=$(ce);{let Q=h(()=>[re]),oe=h(()=>t(R).c(104));Oe(ge,{get t(){return t(Q)},get x(){return t(oe)}})}S(ce)}var Ge=M(ce,2);{let re=h(()=>t(R)(421));Ar(Ge,{get label(){return t(re)},tab:"import",models:[],currentModelIndex:-1,setModel:async()=>{}})}S(pe);var He=M(pe,2),lt=$(He);yr(lt,{}),S(He);var A=M(He,2),H=$(A);{const re=Q=>{var oe=Te(),Je=le(oe);{var Xe=De=>{var ur=Ts();E(De,ur)},Ne=h(()=>t(d).startsWith("/crop"));se(Je,De=>{t(Ne)&&De(Xe)})}E(Q,oe)};var B=$(H);{let Q=h(()=>[re]),oe=h(()=>t(R).c(139));Oe(B,{get t(){return t(Q)},get x(){return t(oe)}})}S(H)}var G=M(H,2);{let re=h(()=>t(R)(422));Ar(G,{get label(){return t(re)},tab:"crop",get models(){return j.cropModels},get currentModelIndex(){return j.selectedCropModel},setModel:async Q=>j.setModelSelections({crop:Q})})}S(A);var te=M(A,2),he=$(te);yr(he,{}),S(te);var tt=M(te,2),xe=$(tt);{const re=Q=>{var oe=Te(),Je=le(oe);{var Xe=De=>{var ur=Ws();E(De,ur)},Ne=h(()=>t(d).startsWith("/classify"));se(Je,De=>{t(Ne)&&De(Xe)})}E(Q,oe)};var Ka=$(xe);{let Q=h(()=>[re]),oe=h(()=>t(R).c(62));Oe(Ka,{get t(){return t(Q)},get x(){return t(oe)}})}S(xe)}var Ya=M(xe,2);{let re=h(()=>t(R)(423));Ar(Ya,{tab:"classify",get label(){return t(re)},get models(){return j.classificationModels},get currentModelIndex(){return j.selectedClassificationModel},setModel:async Q=>j.setModelSelections({classification:Q})})}S(tt),gr(tt,(re,Q)=>hr?.(re,Q),()=>j.processing.task==="detection"&&j.processing.progress<1?"Veuillez attendre la fin de l'analyse des images avant de les classifier":void 0);var dr=M(tt,2),Qa=$(dr);yr(Qa,{}),S(dr);var cr=M(dr,2);{const re=Q=>{var oe=Te(),Je=le(oe);{var Xe=Ne=>{var De=Ns();E(Ne,De)};se(Je,Ne=>{t(d)=="/results/"&&Ne(Xe)})}E(Q,oe)};var Za=$(cr);{let Q=h(()=>[re]),oe=h(()=>t(R).c(404));Oe(Za,{get t(){return t(Q)},get x(){return t(oe)}})}S(cr)}S(ie),Y((re,Q,oe,Je,Xe)=>{Ee(me,"href",re),K(We,`${j.currentSession.name??""} `),Ee(ce,"href",Q),Ee(ce,"aria-disabled",!j.currentProtocol),Ee(H,"href",oe),Ee(H,"aria-disabled",!j.currentProtocol||!t(s)),Ee(xe,"href",Je),Ee(xe,"aria-disabled",!j.currentProtocol||!t(s)||j.processing.task==="detection"&&j.processing.progress<1),Ee(cr,"href",Xe)},[()=>Ae("/(app)/sessions/[id]",{id:j.currentSession.id}),()=>Ae("/import"),()=>we.route.id!=="/(app)/(sidepanel)/crop/[image]"&&j.imageOpenedInCropper?Ae("/(app)/(sidepanel)/crop/[image]",{image:j.imageOpenedInCropper}):Ae("/crop"),()=>Ae("/classify"),()=>Ae("/results")]),wr(1,ie,()=>br,()=>({duration:100})),E(ee,ie)},ve=ee=>{var ie=zs(),me=$(ie);{const pe=ce=>{var ge=Te(),Ge=le(ge);{var He=A=>{var H=Ls();E(A,H)},lt=h(()=>t(d).startsWith("/sessions"));se(Ge,A=>{t(lt)&&A(He)})}E(ce,ge)};var We=$(me);{let ce=h(()=>[pe]),ge=h(()=>t(R).c(366));Oe(We,{get t(){return t(ce)},get x(){return t(ge)}})}S(me)}var Se=M(me,2);{const pe=ce=>{var ge=Te(),Ge=le(ge);{var He=A=>{var H=js();E(A,H)},lt=h(()=>t(d).startsWith("/protocols"));se(Ge,A=>{t(lt)&&A(He)})}E(ce,ge)};var Ve=$(Se);{let ce=h(()=>[pe]),ge=h(()=>t(R).c(367));Oe(Ve,{get t(){return t(ce)},get x(){return t(ge)}})}S(Se)}S(ie),Y((pe,ce)=>{Ee(me,"href",pe),Ee(Se,"href",ce)},[()=>Ae("/sessions"),()=>Ae("/protocols")]),wr(1,ie,()=>br,()=>({duration:100})),E(ee,ie)};se(Z,ee=>{j.currentSession&&we.route.id!=="/(app)/sessions"&&we.route.id!=="/(app)/protocols"?ee(fe):ee(ve,!1)})}var ke=M(Z,2);let Re;var yt=$(ke);{var ne=ee=>{var ie=Hs(),me=$(ie);{const Se=pe=>{Bo(pe,{})};let Ve=h(()=>t(R)(336));Bi(me,{get help(){return t(Ve)},onclick:async()=>{await Ia(),Ce("notifications",Ra())},_w_snippet_6:Se,children:(pe,ce)=>{{let ge=h(()=>[Se]),Ge=h(()=>t(R).c(337));Oe(pe,{get t(){return t(ge)},get x(){return t(Ge)}})}},$$slots:{_w_snippet_6:!0,default:!0}})}var We=M(me,2);{let Se=h(()=>t(R)(338));mt(We,{onclick:()=>Ce("notifications",!1),get help(){return t(Se)},children:(Ve,pe)=>{Ui(Ve,{})},$$slots:{default:!0}})}S(ie),E(ee,ie)},st=h(()=>Dr().notifications===null);se(yt,ee=>{t(st)&&ee(ne)})}var et=M(yt,2);Ca(et,{type:"bug"});var Gt=M(et,2);Ca(Gt,{type:"feature"});var _t=M(Gt,2),Lt=$(_t);ar(Lt,()=>({"--navbar-height":`${t(k)??""}px`})),Ss(Lt.lastChild,{get openPrepareForOfflineUse(){return r.openPrepareForOfflineUse},get openKeyboardShortcuts(){return r.openKeyboardShortcuts}}),S(Lt),S(_t),S(ke),S(q),Y(()=>Re=Tr(ke,1,"svelte-1nmekgl",null,Re,{native:t(W)})),Ha("click",T,async()=>{j.currentSession?(await rt("/(app)/sessions"),await Aa(null)):await rt("/")}),sa(q,"clientHeight",ee=>ae(o,ee)),E(P,q)};se(y,P=>{n()||P(I)})}S(x),Y(()=>O=Tr(x,1,"svelte-1nmekgl",null,O,{"native-window":t(W)})),sa(x,"clientHeight",P=>ae(k,P)),E(e,g),ht()}za(["click"]);async function Bs(e,r){const a=ye.Protocol.state.filter(d=>e.includes(d.id));if(a.length<e.length)throw new Error(`Some protocols not found in ${e.join(", ")}`);const i=[...a.flatMap(d=>d.metadata.map(s=>ye.Metadata.getFromState(s)).filter(Nr).flatMap(({infer:s})=>s?"neural"in s?s.neural.map(({model:k})=>k):[]:[]))],n=await Promise.allSettled(i.map((d,s)=>Ei(d,{cacheAs:"model",onProgress({total:k,transferred:o}){r?.({done:o,total:k,modelNo:s,modelURL:ua(d)})}})));if(n.some(d=>d.status==="rejected"))throw new Error("Could not download all models: "+n.map((d,s)=>{if(d.status!=="fulfilled")return`${ua(i[s])}: ${d.reason}`}).filter(Nr).join("; "))}var Vs=V('<li class="svelte-au9nsu"><span class="url svelte-au9nsu"> </span> <!></li>'),Gs=V("<!> ",1),Js=V('<p> </p> <ul class="bars svelte-au9nsu"></ul> <section class="state svelte-au9nsu"><!></section>',1);function Xs(e,r){gt(r,!0);const a=h(()=>Dt("main"));let i=Rt(r,"open",15),n=be(void 0),d=be(void 0);async function s(){await Bs(ye.Protocol.state.map(w=>w.id),({modelNo:w,...W})=>{k.set(w,W)}).catch(w=>{ae(n,w,!0)})}je(()=>{t(o)&&k.values().every(w=>w.done>=w.total)&&ae(n,!0)});let k=new ja;const o=h(()=>k.size>0),m=h(()=>qi(t(n)===!0?"success":"error"));{const w=(D,R)=>{let g=()=>R?.().close;var _=Te(),x=le(_);{var O=f=>{zr(f,{get loading(){return t(o)},onclick:s,children:(y,I)=>{Ct();var P=Ot();Y(q=>K(P,q),[()=>t(a)(74)]),E(y,P)},$$slots:{default:!0}})},b=f=>{zr(f,{onclick:()=>{k.clear(),ae(n,void 0),g()?.()},children:(y,I)=>{Ct();var P=Ot();Y(q=>K(P,q),[()=>t(a)(92)]),E(y,P)},$$slots:{default:!0}})};se(x,f=>{t(n)!==!0?f(O):f(b,!1)})}E(D,_)};let W=h(()=>t(a)(135));Vr(e,{key:"modal_prepare_for_offline",get title(){return t(W)},get open(){return i()},set open(D){i(D)},get close(){return t(d)},set close(D){ae(d,D,!0)},footer:w,children:(D,R)=>{var g=Js(),_=le(g),x=$(_,!0);S(_);var O=M(_,2);tr(O,21,()=>k,([C,{done:T,total:z,modelURL:U}])=>C,(C,T)=>{var z=h(()=>Wr(t(T),2));let U=()=>t(z)[1].done,N=()=>t(z)[1].total,J=()=>t(z)[1].modelURL;var Z=Vs(),fe=$(Z),ve=$(fe,!0);S(fe);var ke=M(fe,2);{let Re=h(()=>Na(U()/N(),0,1));qa(ke,{alwaysActive:!0,get progress(){return t(Re)}})}S(Z),Y(()=>K(ve,J())),E(C,Z)}),S(O);var b=M(O,2);let f;var y=$(b);{var I=C=>{const T=z=>{var U=Te(),N=le(U);jr(N,()=>t(m),(J,Z)=>{Z(J,{})}),E(z,U)};{let z=h(()=>[T]),U=h(()=>t(a).c(8));Oe(C,{get t(){return t(z)},get x(){return t(U)}})}},P=C=>{var T=Gs(),z=le(T);jr(z,()=>t(m),(N,J)=>{J(N,{})});var U=M(z);Y(()=>K(U,` ${t(n)??""}`)),E(C,T)},q=C=>{const T=z=>{Gi(z,{})};{let z=h(()=>[T]),U=h(()=>t(a).c(2));Oe(C,{get t(){return t(z)},get x(){return t(U)}})}};se(y,C=>{t(n)===!0?C(I):t(n)!==void 0?C(P,1):k.size>0&&C(q,2)})}S(b),Y(C=>{K(x,C),f=Oa(b,"",f,{color:`var(--fg-${t(n)===!0?"success":t(o)?"secondary":"error"})`})},[()=>t(a)(169)]),E(D,g)},$$slots:{footer:!0,default:!0}})}ht()}const Ks=new ja;var Ys=V("<base/>"),Qs=V('<!> <!> <!> <section class="toasts svelte-1v2axqk" data-testid="toasts-area"></section> <div><!></div>',1);function sd(e,r){gt(r,!0);const a=h(()=>r.data.swarpc),i=h(()=>r.data.parallelism);gi({swarpc:t(a),cancellers:Ks,parallelism:t(i)});const n=h(()=>we.route.id==="/(app)/(sidepanel)/classify/[observation]"||we.route.id==="/(app)/(sidepanel)/crop/[image]/[[from]]"||we.route.id?.startsWith("/(app)/protocols/[id]")?"hidden":"full");Di.initialize(100),na(()=>{we.url.hash.startsWith("#/")&&Wi(dn+we.url.hash.slice(1))});const d={capture(){return Ci(j,"currentSessionId")},async restore({currentSessionId:f}){await Aa(f)}},s=h(()=>ye.Image.state.map(f=>f.fileId).filter(Nr));Ti(()=>t(s),f=>{for(const y of f)(async()=>j.hasPreviewURL(y)||await Ni(y))()});const k=h(()=>Dt("main"));rr("general",{"$mod+s":{help:"",hidden:!0,do:()=>$e.info(t(k)(130))},"i d e v":{help:t(k)(25),do:async()=>{await Ce("showTechnicalMetadata",!er())}}}),rr("debugmode",Object.fromEntries(["warn","error","info","debug","success"].map(f=>{const y={warn:()=>$e.warn("Example warning toast"),error:()=>$e.error("Example error toast"),info:()=>$e.info("Example info toast"),debug:()=>$e.add("debug","Example debug toast"),success:()=>$e.success("Example success toast")};return[`t t ${f.charAt(0)}`,{help:`Summon a ${f} toast`,debug:!0,allowInModals:!0,when:er,do:y[f]}]}))),je(()=>{document.documentElement.style.colorScheme=Da()}),na(()=>{navigator.serviceWorker.ready.then(f=>{localStorage.getItem("sw-version")!==Lr&&(localStorage.setItem("sw-version",Lr),$e.info(t(k)(349))),f.addEventListener("updatefound",()=>{console.info("Update found in service worker"),$e.info(t(k)(350),{lifetime:1/0,labels:{action:t(k)(351)},action(){location.reload()}})})})});let o=be(void 0),m=be(void 0);var w={snapshot:d},W=Qs();cn("1v2axqk",f=>{var y=Ys();Y(I=>Ee(y,"href",I),[()=>Ae("/")==="/"?"":Ae("/")+"index.html"]),E(f,y)});var D=le(W);Fo(D,{preventDefault:!0,get binds(){return j.keybinds},get openHelp(){return t(o)},set openHelp(f){ae(o,f,!0)}});var R=M(D,2);Xs(R,{get open(){return t(m)},set open(f){ae(m,f,!0)}});var g=M(R,2);{let f=h(()=>t(n)==="hidden");Us(g,{get openKeyboardShortcuts(){return t(o)},get openPrepareForOfflineUse(){return t(m)},get progressbarOnly(){return t(f)},get progress(){return j.processing.progress},get eta(){return j.eta}})}var _=M(g,2);tr(_,21,()=>$e.items("default"),f=>f.id,(f,y)=>{{let I=h(()=>t(y).callbacks.action instanceof URL?t(y).callbacks.action:async()=>t(y).callbacks.action?.(t(y)));Fi(f,La(()=>t(y),{get action(){return t(y).labels.action},get dismiss(){return t(y).labels.close},get onaction(){return t(I)},ondismiss:async()=>{await t(y).callbacks.closed?.(t(y)),$e.remove(t(y).id)}}))}}),S(_);var x=M(_,2);let O;var b=$(x);return Ai(b,()=>r.children??Pt),S(x),Y(f=>O=Tr(x,1,"contents svelte-1v2axqk",null,O,f),[()=>({padded:!we.route.id?.includes("/(sidepanel)")&&!we.route.id?.includes("protocols/[id]/")})]),E(e,W),ht(w)}export{sd as component,od as universal};
