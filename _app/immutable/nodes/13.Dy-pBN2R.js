import{e as Ft}from"../chunks/ft-thZGf.js";import{t as Pe,c as Qt,l as bn,b as _n,d as rt,aD as We,aE as yn,D as xn,a1 as wn,aF as Sn,aG as Xt,C as On,a as In,U as Mn}from"../chunks/Don2Ydo1.js";import{m as kn,a as Yt,c as Ln}from"../chunks/BhEwWWID.js";import{o as Wt}from"../chunks/BOvN9V9s.js";import{u as se}from"../chunks/BPJfxdhi.js";import"../chunks/DsnmJJEf.js";import{a as Ge,b as Se,c as xt,d as je,s as pe}from"../chunks/08d27X49.js";import{R as De}from"../chunks/DWCXZatK.js";import{f as Je,a as E,p as ye,g as t,u as S,H as j,b as xe,ap as F,ar as P,J as A,D as te,G as $,I as wt,as as re,aq as fe,at as Cn,F as gt,ao as lt,C as he,aR as jt}from"../chunks/BwdvgNQo.js";import{d as $t,b as en,s as be,e as An}from"../chunks/HTLptRgQ.js";import{a as ut}from"../chunks/DbetVW2v.js";import{r as Ke,i as W,p as Ve,s as En}from"../chunks/CKH9F0ww.js";import{e as $e,i as zt}from"../chunks/CuPIRSst.js";import{h as Tn}from"../chunks/CrbDnXoH.js";import{t as Ee,f as Te}from"../chunks/BjiNJ5CV.js";import{a as de}from"../chunks/DJvCDsRa.js";import{ao as Pn}from"../chunks/CtvchpM1.js";import{A as Dn}from"../chunks/D1KTsvKZ.js";import{C as Vn}from"../chunks/Bgm-Cmsg.js";import{F as dt}from"../chunks/CfpiF-ni.js";import{M as Bn,F as Fn,a as jn,L as zn}from"../chunks/DEX3zmBU.js";import{g as Nn}from"../chunks/BeqcFVE5.js";import{s as ft}from"../chunks/CeMO3KJO.js";import{i as Rn}from"../chunks/CEoeiZ5P.js";import{d as Fe,u as pt}from"../chunks/iDw1HNQ9.js";import{K as Nt,a as et,t as ht}from"../chunks/C6sIn56-.js";import{a as St,C as Hn,A as tn,b as Un}from"../chunks/CUcmaFVW.js";import{C as qn}from"../chunks/Bf6VYV6I.js";import{E as Gn}from"../chunks/3hMEuLq3.js";import{F as Jn}from"../chunks/BbsYXVtf.js";import{i as Ot,g as Le,d as Rt}from"../chunks/BDV6zAFm.js";import{B as Ht}from"../chunks/DfpvCGjf.js";import{e as Kn}from"../chunks/DfkTl275.js";import{I as Zn}from"../chunks/BWUfZxGx.js";import{g as Ut}from"../chunks/DyfjURbU.js";import{r as tt}from"../chunks/BRmTdaxr.js";import{A as nn}from"../chunks/xJVponh6.js";import{C as Qn}from"../chunks/DZRaQp3m.js";import{B as Be}from"../chunks/LNwaZJFt.js";import{B as ze}from"../chunks/DgJA6oA6.js";import{P as qt}from"../chunks/BRQ5Qhft.js";import{t as Xn}from"../chunks/BYqiwRWy.js";import{A as Yn}from"../chunks/k3WAnOGP.js";import{A as Wn}from"../chunks/Cyizp9nt.js";import{E as $n}from"../chunks/CUbNYyyV.js";import{C as vt}from"../chunks/BPQ-1h3f.js";import{c as er}from"../chunks/CxwMZO45.js";import{p as tr}from"../chunks/BzM0mbGE.js";import{s as bt}from"../chunks/DYy3QkOc.js";import{k as nr}from"../chunks/DcdGX-PW.js";import{L as rr}from"../chunks/72YJCPe-.js";import{F as or,t as sr}from"../chunks/Bd7_h5c3.js";import{C as ar}from"../chunks/BlwUordC.js";let mt={metadataId:void 0,options:[]};async function ir({params:n,depends:e,parent:s}){const{currentSession:o,metadataDefinitions:c,observationsOrder:a}=await s(),r=await Pe.Observation.list("sessionId",o.id);r.sort(Qt(({id:_})=>a.get(_)??-1));const f=o?.fullscreenClassifier.focusedMetadata??se.classificationMetadataId,i=f?c.find(({id:_})=>_===f):void 0;i&&se.currentProtocolId&&mt.metadataId!==i.id&&(mt={metadataId:i.id,options:await bn("MetadataOption",kn(se.currentProtocolId,i.id))});const u=await Pe.Observation.get(n.observation),x=_n("js");u||Ft(404,x(520)),e(rt("Observation",u.id));const v=await Pe.Image.getMany(u.images),d=r.findIndex(({id:_})=>_===u.id);d===-1&&Ft(500,x(519));const b=d+1,m=d-1,h=b<r.length?r[b]:null,g=m>=0?r[m]:null,l=await Pe.Image.getMany(r.flatMap(({images:_})=>_)),p=new Map(r.map(_=>[_.id,Wt({definitions:c,observation:_,images:l})[i?.id??""]])),y=r.filter(({id:_})=>p.get(_)!==void 0).length,C=r.filter(({id:_})=>p.get(_)?.confirmed).length,w=r.find(({id:_},O)=>O>d&&p.get(_)?.confirmed===!1);return{observation:u,metadataDefinitions:c,images:v,focusedMetadata:i,allOptions:mt.options,navigation:{nextObservation:h,prevObservation:g,currentObservationIndex:d,totalObservations:r.length,classifiedObservationsCount:y,confirmedClassificationsCount:C,nextUnconfirmedObservation:w}}}const Ns=Object.freeze(Object.defineProperty({__proto__:null,load:ir},Symbol.toStringTag,{value:"Module"}));var cr=Je('<svg><path fill="currentColor" d="m13.06 8.111l1.415 1.414a7 7 0 0 1 0 9.9l-.354.353a7 7 0 1 1-9.9-9.9l1.415 1.415a5 5 0 1 0 7.071 7.071l.354-.354a5 5 0 0 0 0-7.07l-1.415-1.415zm6.718 6.01l-1.414-1.414a5 5 0 0 0-7.071-7.07l-.354.353a5 5 0 0 0 0 7.07l1.415 1.415l-1.415 1.414l-1.414-1.414a7 7 0 0 1 0-9.9l.354-.353a7 7 0 1 1 9.9 9.9"></path></svg>');function lr(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var o=cr();Ge(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s})),E(n,o)}var ur=j('<div class="confirmed svelte-1p4jszt"><!></div>'),dr=j('<div class="unconfirmed svelte-1p4jszt"><!></div>'),fr=j("<!> <!>",1),vr=j('<header class="svelte-1p4jszt"><div class="line svelte-1p4jszt"><!> <!></div> <div class="line svelte-1p4jszt"><h1 class="svelte-1p4jszt"><!></h1></div></header>');function mr(n,e){ye(e,!0);const s=S(()=>({image:Kn(e.currentImage.id),from:e.observation.id})),o=S(()=>Se("main"));Fe("classification",{Escape:{help:t(o)(429),async do(){await Ut("/(app)/(sidepanel)/classify")}},B:{help:t(o)(430),when:()=>!!t(s),async do(){t(s)&&await Ut("/(app)/(sidepanel)/crop/[image]/[[from]]",t(s))}}});var c=vr(),a=P(c),r=P(a);{const d=h=>{Jn(h,{})},b=h=>{Nt(h,{shortcut:"Escape"})};let m=S(()=>tt("/classify"));Ht(r,{inline:!0,get href(){return t(m)},_w_snippet_0:d,_w_snippet_1:b,children:(h,g)=>{{let l=S(()=>[d,b]),p=S(()=>t(o).c(456));De(h,{get t(){return t(l)},get x(){return t(p)}})}},$$slots:{_w_snippet_0:!0,_w_snippet_1:!0,default:!0}})}var f=F(r,2);{const d=g=>{qn(g,{})},b=g=>{Nt(g,{shortcut:"B"})};let m=S(()=>tt("/(app)/(sidepanel)/crop/[image]/[[from]]",t(s))),h=S(()=>!t(s));Ht(f,{inline:!0,get href(){return t(m)},get disabled(){return t(h)},_w_snippet_2:d,_w_snippet_3:b,children:(g,l)=>{{let p=S(()=>[d,b]),y=S(()=>t(o).c(431));De(g,{get t(){return t(p)},get x(){return t(y)}})}},$$slots:{_w_snippet_2:!0,_w_snippet_3:!0,default:!0}})}A(a);var i=F(a,2),u=P(i),x=P(u);{var v=d=>{var b=fr(),m=te(b);{var h=p=>{var y=ur(),C=P(y);St(C,{}),A(y),et(y,(w,_)=>ht?.(w,_),()=>"Classification confirmée"),E(p,y)},g=p=>{var y=dr(),C=P(y);Gn(C,{}),A(y),et(y,(w,_)=>ht?.(w,_),()=>"Classification non confirmée"),E(p,y)};W(m,p=>{e.focusedMetadata&&e.observation.metadataOverrides[e.focusedMetadata.id]?.confirmed?p(h):p(g,!1)})}var l=F(m,2);{let p=S(()=>t(o)(125));Zn(l,{discreet:!0,get label(){return t(p)},get value(){return e.observation.label},onblur:async y=>{y!==e.observation.label&&(await Pe.Observation.update(e.observation.id,"label",y),await Ot(rt("Observation",e.observation.id)))}})}E(d,b)};W(x,d=>{e.observation&&d(v)})}A(u),A(i),A(c),E(n,c),xe()}var gr=Je('<svg><path fill="currentColor" d="M20 3a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1zm-9 10H5v6h6zm2 6h6V5h-6zM11 5H5v6h6z"></path></svg>');function pr(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var o=gr();Ge(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s})),E(n,o)}var hr=j("<div><!></div>"),br=j('<button class="layout-switcher svelte-108ltfp"></button>');function _r(n,e){ye(e,!0);const s=S(()=>se.currentSession?.fullscreenClassifier.layout??"top-bottom");async function o(){se.currentSessionId&&(e.toggleLayoutTransitions(!1),await Pe.Session.update(se.currentSessionId,"fullscreenClassifier",{...se.currentSession?.fullscreenClassifier,layout:We[(We.indexOf(t(s))+1)%We.length]}),await yn(50),e.toggleLayoutTransitions(!0))}const c=S(()=>Se("main"));Fe("classification",{"Alt+L":{help:t(c)(432),do:()=>o()}});var a=br();$e(a,20,()=>We,r=>r,(r,f)=>{var i=hr();let u;var x=P(i);{let v=S(()=>f==="left-right"?"rotate: 90deg;":"");pr(x,{get style(){return t(v)}})}A(i),$(()=>u=xt(i,1,"icon svelte-108ltfp",null,u,{active:t(s)===f})),E(r,i)}),A(a),et(a,(r,f)=>ht?.(r,f),()=>({text:"Changer de disposition",keyboard:"Alt+L"})),en("click",a,()=>o()),E(n,a),xe()}$t(["click"]);var yr=j('<code class="svelte-hgsp6m"> </code>'),xr=j('<!> <section class="progress svelte-hgsp6m"><div class="bar svelte-hgsp6m"><p class="svelte-hgsp6m"><!></p> <!></div> <div class="bar svelte-hgsp6m"><p class="svelte-hgsp6m"><!></p> <!></div></section> <nav class="svelte-hgsp6m"><div class="image-switcher svelte-hgsp6m"><!> <code class="numbers svelte-hgsp6m"> <div class="separator">⁄</div> </code> <!></div> <div class="continue"><!></div></nav>',1);function wr(n,e){ye(e,!0);let s=fe(async()=>{});function o(V){return tt("/(app)/(sidepanel)/classify/[observation]",{observation:V.id})}const c=S(()=>e.currentObservation.metadataOverrides[e.focusedMetadata?.id??""]),a=S(()=>e.totalObservations===e.confirmedClassificationsCount),r=S(()=>Se("main"));async function f(V){e.focusedMetadata&&se.currentSessionId&&(t(c)?(await Yt({db:wn(),metadataId:e.focusedMetadata.id,sessionId:se.currentSessionId,subjectId:e.currentObservation.id,...t(c),confirmed:V}),!t(c).confirmed&&V&&await t(s)()):Xn.warn(t(r)(433)),await Ot(rt("Observation",e.currentObservation.id)))}async function i(){await f(!0),e.nextUnconfirmedObservation?await Le(o(e.nextUnconfirmedObservation)):t(a)&&await Le(tt("/results"))}Fe("classification",{"$mod+ArrowRight":{help:t(r)(457),do:async()=>e.nextObservation&&Le(o(e.nextObservation))},Space:{help:t(r)(458),do:async()=>i()},"$mod+ArrowLeft":{help:t(r)(459),do:async()=>e.prevObservation&&Le(o(e.prevObservation))},"Shift+Space":{help:t(r)(459),do:async()=>e.prevObservation&&Le(o(e.prevObservation))}});var u=xr(),x=te(u);Hn(x,{get show(){return t(s)},set show(V){re(s,V,!0)}});var v=F(x,2);{const V=(N,B=wt)=>{var z=yr(),Z=P(z,!0);A(z),$(ne=>be(Z,ne),[()=>xn(B()/e.totalObservations)]),E(N,z)};var d=P(v),b=P(d);{const N=z=>{Qn(z,{})},B=z=>{V(z,()=>e.classifiedObservationsCount)};var m=P(b);{let z=S(()=>[N,B]),Z=S(()=>t(r).c(460));De(m,{get t(){return t(z)},get x(){return t(Z)}})}A(b)}var h=F(b,2);{let N=S(()=>e.classifiedObservationsCount/e.totalObservations);qt(h,{alwaysActive:!0,get progress(){return t(N)}})}A(d);var g=F(d,2),l=P(g);{const N=z=>{St(z,{})},B=z=>{V(z,()=>e.confirmedClassificationsCount)};var p=P(l);{let z=S(()=>[N,B]),Z=S(()=>t(r).c(434));De(p,{get t(){return t(z)},get x(){return t(Z)}})}A(l)}var y=F(l,2);{let N=S(()=>e.confirmedClassificationsCount/e.totalObservations);qt(y,{alwaysActive:!0,get progress(){return t(N)}})}A(g),A(v)}var C=F(v,2),w=P(C),_=P(w);{let V=S(()=>t(r)(459)),N=S(()=>!e.prevObservation);Be(_,{get help(){return t(V)},keyboard:"$mod+ArrowLeft",get disabled(){return t(N)},preload:()=>{e.prevObservation&&Rt(o(e.prevObservation))},onclick:async()=>{e.prevObservation&&await Le(o(e.prevObservation))},children:(B,z)=>{tn(B,{})},$$slots:{default:!0}})}var O=F(_,2),I=P(O),k=F(I,2);A(O);var T=F(O,2);{let V=S(()=>t(r)(457)),N=S(()=>!e.nextObservation);Be(T,{get help(){return t(V)},keyboard:"$mod+ArrowRight",get disabled(){return t(N)},preload:()=>{e.nextObservation&&Rt(o(e.nextObservation))},onclick:async()=>{e.nextObservation&&await Le(o(e.nextObservation))},children:(B,z)=>{nn(B,{})},$$slots:{default:!0}})}A(w);var L=F(w,2),D=P(L);{let V=S(()=>t(r)(435)),N=S(()=>!t(c));ze(D,{keyboard:"Space",get help(){return t(V)},get disabled(){return t(N)},onclick:async()=>{await i()},children:(B,z)=>{Cn();var Z=gt();$(ne=>be(Z,ne),[()=>t(r)(68)]),E(B,Z)},$$slots:{default:!0}})}A(L),A(C),$(()=>{be(I,`${e.currentObservationIndex+1} `),be(k,` ${e.totalObservations??""}`)}),E(n,u),xe()}var Sr=j('<div class="button-contents prev svelte-11pqxwe"><!> <!> <!></div>'),Or=j("<!> <!> <!>",1),Ir=j('<div class="button-contents svelte-11pqxwe"><!> <!> <!></div>'),Mr=j('<div class="button-contents svelte-11pqxwe"><!></div>'),kr=j('<div class="confirmation" data-testid="confirmation"><!></div>'),Lr=j('<div class="bar svelte-11pqxwe"><div class="prev svelte-11pqxwe"><!></div> <div class="current svelte-11pqxwe" data-testid="current"><!></div> <div class="next svelte-11pqxwe"><!></div> <!></div>');function Cr(n,e){ye(e,!0);const s=S(()=>se.currentSession?.fullscreenClassifier.layout??"top-bottom");let o=fe(w=>{});const c=S(()=>e.options.find(w=>w.key===e.currentMetadataValue?.value?.toString())),a=S(()=>e.currentMetadataValue?t(c)?{...Sn(e.currentMetadataValue.alternatives,w=>JSON.parse(w).toString()),[t(c).key]:e.currentMetadataValue.confidence}:{}:{}),r=S(()=>Object.entries(t(a)).map(([w,_])=>({key:w,confidence:_})).sort(Qt("confidence")).reverse().map(({key:w})=>e.options.find(_=>_.key===w)).filter(In)),f=S(()=>t(r).findIndex(w=>w.key===t(c)?.key)),i=S(()=>t(r)[t(f)+1]),u=S(()=>t(r)[t(f)-1]);async function x(w,_,{confirmed:O=!1,manuallyModified:I=!1,pushToUndoStack:k=!0}={}){if(!e.observation)throw new Error("Image not found");if(!e.focusedMetadata)throw new Error("No metadata focused");const T=e.currentMetadataValue?{value:e.currentMetadataValue.value,confidence:e.currentMetadataValue.confidence}:void 0;await Yt({db:await Xt(),metadataId:e.focusedMetadata.id,subjectId:e.observation.id,type:"enum",value:w.key,confidence:_[w.key]??1,manuallyModified:I,confirmed:O,alternatives:[...T?[T]:[],...On(_).map(([L,D])=>({value:L,confidence:D}))]}),k&&e.currentMetadataValue&&pt.push("classify/enum/edit",{observationId:e.observation.id,metadataId:e.focusedMetadata.id,before:{key:e.currentMetadataValue.value.toString()},after:{key:w.key}}),await Ot(rt("Observation",e.observation.id))}pt.on("classify/enum/edit",async({metadataId:w,observationId:_,before:O})=>{_===e.observation.id&&w===e.focusedMetadata.id&&await x(O,t(a),{pushToUndoStack:!1})});const v=S(()=>Se("main"));Fe("classification",{L:{help:t(v)(436),async do(){t(i)&&await x(t(i),t(a))}},J:{help:t(v)(437),async do(){t(u)&&await x(t(u),t(a))}},"$mod+F":{help:t(v)(438),do:w=>{w.preventDefault(),t(o)?.("toggle")}},M:{help:t(v)(439),when:()=>!!t(c)?.learnMore,do(){window.open(t(c).learnMore,"_blank")}},ArrowUp:{help:t(v)(440),async do(){t(c)&&await x(t(c),t(a),{confirmed:!0,pushToUndoStack:!1})}},ArrowDown:{help:t(v)(441),async do(){t(c)&&await x(t(c),t(a),{confirmed:!1,pushToUndoStack:!1})}}});var d=Lr(),b=P(d);je(b,"",{},{"grid-area":"prev"});var m=P(b);{let w=S(()=>t(v)(437)),_=S(()=>!t(u)),O=S(()=>({text:t(u)?.label??"",keyboard:"J"}));ze(m,{get"aria-label"(){return t(w)},get disabled(){return t(_)},onclick:async()=>x(t(u),t(a)),get help(){return t(O)},children:(I,k)=>{var T=Sr(),L=P(T);{let B=S(()=>t(u)?t(a)[t(u).key]:void 0);vt(L,{tooltip:()=>"",get value(){return t(B)}})}var D=F(L,2);{var V=B=>{var z=gt();$(Z=>be(z,Z),[()=>t(v)(442)]),E(B,z)};W(D,B=>{t(s)==="left-right"&&B(V)})}var N=F(D,2);Yn(N,{}),A(T),E(I,T)},$$slots:{default:!0}})}A(b);var h=F(b,2);je(h,"",{},{"grid-area":"current"});var g=P(h);ze(g,{onclick:()=>t(o)("focus"),help:{text:"Voir toutes les options",keyboard:"$mod+F"},children:(w,_)=>{var O=Or(),I=te(O);{let L=S(()=>t(c)?.key??"");Bn(I,{get confidences(){return t(a)},get options(){return e.options},get metadata(){return e.focusedMetadata},type:"single",get value(){return t(L)},onValueChange:async D=>{D&&await x({key:D},t(a),{manuallyModified:!0})},get focuser(){return t(o)},set focuser(D){re(o,D,!0)}})}var k=F(I,2);{let L=S(()=>e.currentMetadataValue?.confidence);vt(k,{get value(){return t(L)}})}var T=F(k,2);$n(T,{}),E(w,O)},$$slots:{default:!0}}),A(h);var l=F(h,2);je(l,"",{},{"grid-area":"next"});var p=P(l);{let w=S(()=>t(v)(436)),_=S(()=>!t(i)),O=S(()=>({text:t(i)?.label??"",keyboard:"L"}));ze(p,{get"aria-label"(){return t(w)},get disabled(){return t(_)},onclick:async()=>x(t(i),t(a)),get help(){return t(O)},children:(I,k)=>{var T=Ir(),L=P(T);Wn(L,{});var D=F(L,2);{var V=B=>{var z=gt();$(Z=>be(z,Z),[()=>t(v)(443)]),E(B,z)};W(D,B=>{t(s)==="left-right"&&B(V)})}var N=F(D,2);{let B=S(()=>t(i)?t(a)[t(i).key]:void 0);vt(N,{tooltip:()=>"",get value(){return t(B)}})}A(T),E(I,T)},$$slots:{default:!0}})}A(l);var y=F(l,2);{var C=w=>{var _=kr();je(_,"",{},{"grid-area":"confirmation"});var O=P(_);{let I=S(()=>({text:e.currentMetadataValue?.confirmed?"Marquer comme non confirmée ":"Confirmer la classification ",keyboard:e.currentMetadataValue?.confirmed?"ArrowDown":"ArrowUp"}));ze(O,{onclick:async()=>{t(c)&&await x(t(c),t(a),{confirmed:!e.currentMetadataValue?.confirmed,pushToUndoStack:!1})},get help(){return t(I)},children:(k,T)=>{var L=Mr(),D=P(L);{var V=B=>{Un(B,{})},N=B=>{St(B,{})};W(D,B=>{e.currentMetadataValue?.confirmed?B(V):B(N,!1)})}A(L),E(k,L)},$$slots:{default:!0}})}A(_),E(w,_)};W(y,w=>{t(s)==="top-bottom"&&w(C)})}A(d),$(()=>pe(d,"data-layout",t(s))),E(n,d),xe()}function Ar(n){return Object.prototype.toString.call(n)==="[object Object]"}function Gt(n){return Ar(n)||Array.isArray(n)}function Er(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function It(n,e){const s=Object.keys(n),o=Object.keys(e);if(s.length!==o.length)return!1;const c=JSON.stringify(Object.keys(n.breakpoints||{})),a=JSON.stringify(Object.keys(e.breakpoints||{}));return c!==a?!1:s.every(r=>{const f=n[r],i=e[r];return typeof f=="function"?`${f}`==`${i}`:!Gt(f)||!Gt(i)?f===i:It(f,i)})}function Jt(n){return n.concat().sort((e,s)=>e.name>s.name?1:-1).map(e=>e.options)}function Tr(n,e){if(n.length!==e.length)return!1;const s=Jt(n),o=Jt(e);return s.every((c,a)=>{const r=o[a];return It(c,r)})}function Mt(n){return typeof n=="number"}function _t(n){return typeof n=="string"}function ot(n){return typeof n=="boolean"}function Kt(n){return Object.prototype.toString.call(n)==="[object Object]"}function X(n){return Math.abs(n)}function kt(n){return Math.sign(n)}function Re(n,e){return X(n-e)}function Pr(n,e){if(n===0||e===0||X(n)<=X(e))return 0;const s=Re(X(n),X(e));return X(s/n)}function Dr(n){return Math.round(n*100)/100}function He(n){return Ue(n).map(Number)}function _e(n){return n[Ze(n)]}function Ze(n){return Math.max(0,n.length-1)}function Lt(n,e){return e===Ze(n)}function Zt(n,e=0){return Array.from(Array(n),(s,o)=>e+o)}function Ue(n){return Object.keys(n)}function rn(n,e){return[n,e].reduce((s,o)=>(Ue(o).forEach(c=>{const a=s[c],r=o[c],f=Kt(a)&&Kt(r);s[c]=f?rn(a,r):r}),s),{})}function yt(n,e){return typeof e.MouseEvent<"u"&&n instanceof e.MouseEvent}function Vr(n,e){const s={start:o,center:c,end:a};function o(){return 0}function c(i){return a(i)/2}function a(i){return e-i}function r(i,u){return _t(n)?s[n](i):n(e,i,u)}return{measure:r}}function qe(){let n=[];function e(c,a,r,f={passive:!0}){let i;if("addEventListener"in c)c.addEventListener(a,r,f),i=()=>c.removeEventListener(a,r,f);else{const u=c;u.addListener(r),i=()=>u.removeListener(r)}return n.push(i),o}function s(){n=n.filter(c=>c())}const o={add:e,clear:s};return o}function Br(n,e,s,o){const c=qe(),a=1e3/60;let r=null,f=0,i=0;function u(){c.add(n,"visibilitychange",()=>{n.hidden&&m()})}function x(){b(),c.clear()}function v(g){if(!i)return;r||(r=g,s(),s());const l=g-r;for(r=g,f+=l;f>=a;)s(),f-=a;const p=f/a;o(p),i&&(i=e.requestAnimationFrame(v))}function d(){i||(i=e.requestAnimationFrame(v))}function b(){e.cancelAnimationFrame(i),r=null,f=0,i=0}function m(){r=null,f=0}return{init:u,destroy:x,start:d,stop:b,update:s,render:o}}function Fr(n,e){const s=e==="rtl",o=n==="y",c=o?"y":"x",a=o?"x":"y",r=!o&&s?-1:1,f=x(),i=v();function u(m){const{height:h,width:g}=m;return o?h:g}function x(){return o?"top":s?"right":"left"}function v(){return o?"bottom":s?"left":"right"}function d(m){return m*r}return{scroll:c,cross:a,startEdge:f,endEdge:i,measureSize:u,direction:d}}function Ce(n=0,e=0){const s=X(n-e);function o(u){return u<n}function c(u){return u>e}function a(u){return o(u)||c(u)}function r(u){return a(u)?o(u)?n:e:u}function f(u){return s?u-s*Math.ceil((u-e)/s):u}return{length:s,max:e,min:n,constrain:r,reachedAny:a,reachedMax:c,reachedMin:o,removeOffset:f}}function on(n,e,s){const{constrain:o}=Ce(0,n),c=n+1;let a=r(e);function r(d){return s?X((c+d)%c):o(d)}function f(){return a}function i(d){return a=r(d),v}function u(d){return x().set(f()+d)}function x(){return on(n,f(),s)}const v={get:f,set:i,add:u,clone:x};return v}function jr(n,e,s,o,c,a,r,f,i,u,x,v,d,b,m,h,g,l,p){const{cross:y,direction:C}=n,w=["INPUT","SELECT","TEXTAREA"],_={passive:!1},O=qe(),I=qe(),k=Ce(50,225).constrain(b.measure(20)),T={mouse:300,touch:400},L={mouse:500,touch:600},D=m?43:25;let V=!1,N=0,B=0,z=!1,Z=!1,ne=!1,ve=!1;function q(M){if(!p)return;function U(R){(ot(p)||p(M,R))&&me(R)}const J=e;O.add(J,"dragstart",R=>R.preventDefault(),_).add(J,"touchmove",()=>{},_).add(J,"touchend",()=>{}).add(J,"touchstart",U).add(J,"mousedown",U).add(J,"touchcancel",Y).add(J,"contextmenu",Y).add(J,"click",ie,!0)}function Q(){O.clear(),I.clear()}function ue(){const M=ve?s:e;I.add(M,"touchmove",ae,_).add(M,"touchend",Y).add(M,"mousemove",ae,_).add(M,"mouseup",Y)}function we(M){const U=M.nodeName||"";return w.includes(U)}function oe(){return(m?L:T)[ve?"mouse":"touch"]}function Oe(M,U){const J=v.add(kt(M)*-1),R=x.byDistance(M,!m).distance;return m||X(M)<k?R:g&&U?R*.5:x.byIndex(J.get(),0).distance}function me(M){const U=yt(M,o);ve=U,ne=m&&U&&!M.buttons&&V,V=Re(c.get(),r.get())>=2,!(U&&M.button!==0)&&(we(M.target)||(z=!0,a.pointerDown(M),u.useFriction(0).useDuration(0),c.set(r),ue(),N=a.readPoint(M),B=a.readPoint(M,y),d.emit("pointerDown")))}function ae(M){if(!yt(M,o)&&M.touches.length>=2)return Y(M);const J=a.readPoint(M),R=a.readPoint(M,y),G=Re(J,N),K=Re(R,B);if(!Z&&!ve&&(!M.cancelable||(Z=G>K,!Z)))return Y(M);const ee=a.pointerMove(M);G>h&&(ne=!0),u.useFriction(.3).useDuration(.75),f.start(),c.add(C(ee)),M.preventDefault()}function Y(M){const J=x.byDistance(0,!1).index!==v.get(),R=a.pointerUp(M)*oe(),G=Oe(C(R),J),K=Pr(R,G),ee=D-10*K,le=l+K/50;Z=!1,z=!1,I.clear(),u.useDuration(ee).useFriction(le),i.distance(G,!m),ve=!1,d.emit("pointerUp")}function ie(M){ne&&(M.stopPropagation(),M.preventDefault(),ne=!1)}function ce(){return z}return{init:q,destroy:Q,pointerDown:ce}}function zr(n,e){let o,c;function a(v){return v.timeStamp}function r(v,d){const m=`client${(d||n.scroll)==="x"?"X":"Y"}`;return(yt(v,e)?v:v.touches[0])[m]}function f(v){return o=v,c=v,r(v)}function i(v){const d=r(v)-r(c),b=a(v)-a(o)>170;return c=v,b&&(o=v),d}function u(v){if(!o||!c)return 0;const d=r(c)-r(o),b=a(v)-a(o),m=a(v)-a(c)>170,h=d/b;return b&&!m&&X(h)>.1?h:0}return{pointerDown:f,pointerMove:i,pointerUp:u,readPoint:r}}function Nr(){function n(s){const{offsetTop:o,offsetLeft:c,offsetWidth:a,offsetHeight:r}=s;return{top:o,right:c+a,bottom:o+r,left:c,width:a,height:r}}return{measure:n}}function Rr(n){function e(o){return n*(o/100)}return{measure:e}}function Hr(n,e,s,o,c,a,r){const f=[n].concat(o);let i,u,x=[],v=!1;function d(g){return c.measureSize(r.measure(g))}function b(g){if(!a)return;u=d(n),x=o.map(d);function l(p){for(const y of p){if(v)return;const C=y.target===n,w=o.indexOf(y.target),_=C?u:x[w],O=d(C?n:o[w]);if(X(O-_)>=.5){g.reInit(),e.emit("resize");break}}}i=new ResizeObserver(p=>{(ot(a)||a(g,p))&&l(p)}),s.requestAnimationFrame(()=>{f.forEach(p=>i.observe(p))})}function m(){v=!0,i&&i.disconnect()}return{init:b,destroy:m}}function Ur(n,e,s,o,c,a){let r=0,f=0,i=c,u=a,x=n.get(),v=0;function d(){const _=o.get()-n.get(),O=!i;let I=0;return O?(r=0,s.set(o),n.set(o),I=_):(s.set(n),r+=_/i,r*=u,x+=r,n.add(r),I=x-v),f=kt(I),v=x,w}function b(){const _=o.get()-e.get();return X(_)<.001}function m(){return i}function h(){return f}function g(){return r}function l(){return y(c)}function p(){return C(a)}function y(_){return i=_,w}function C(_){return u=_,w}const w={direction:h,duration:m,velocity:g,seek:d,settled:b,useBaseFriction:p,useBaseDuration:l,useFriction:C,useDuration:y};return w}function qr(n,e,s,o,c){const a=c.measure(10),r=c.measure(50),f=Ce(.1,.99);let i=!1;function u(){return!(i||!n.reachedAny(s.get())||!n.reachedAny(e.get()))}function x(b){if(!u())return;const m=n.reachedMin(e.get())?"min":"max",h=X(n[m]-e.get()),g=s.get()-e.get(),l=f.constrain(h/r);s.subtract(g*l),!b&&X(g)<a&&(s.set(n.constrain(s.get())),o.useDuration(25).useBaseFriction())}function v(b){i=!b}return{shouldConstrain:u,constrain:x,toggleActive:v}}function Gr(n,e,s,o,c){const a=Ce(-e+n,0),r=v(),f=x(),i=d();function u(m,h){return Re(m,h)<=1}function x(){const m=r[0],h=_e(r),g=r.lastIndexOf(m),l=r.indexOf(h)+1;return Ce(g,l)}function v(){return s.map((m,h)=>{const{min:g,max:l}=a,p=a.constrain(m),y=!h,C=Lt(s,h);return y?l:C||u(g,p)?g:u(l,p)?l:p}).map(m=>parseFloat(m.toFixed(3)))}function d(){if(e<=n+c)return[a.max];if(o==="keepSnaps")return r;const{min:m,max:h}=f;return r.slice(m,h)}return{snapsContained:i,scrollContainLimit:f}}function Jr(n,e,s){const o=e[0],c=s?o-n:_e(e);return{limit:Ce(c,o)}}function Kr(n,e,s,o){const a=e.min+.1,r=e.max+.1,{reachedMin:f,reachedMax:i}=Ce(a,r);function u(d){return d===1?i(s.get()):d===-1?f(s.get()):!1}function x(d){if(!u(d))return;const b=n*(d*-1);o.forEach(m=>m.add(b))}return{loop:x}}function Zr(n){const{max:e,length:s}=n;function o(a){const r=a-e;return s?r/-s:0}return{get:o}}function Qr(n,e,s,o,c){const{startEdge:a,endEdge:r}=n,{groupSlides:f}=c,i=v().map(e.measure),u=d(),x=b();function v(){return f(o).map(h=>_e(h)[r]-h[0][a]).map(X)}function d(){return o.map(h=>s[a]-h[a]).map(h=>-X(h))}function b(){return f(u).map(h=>h[0]).map((h,g)=>h+i[g])}return{snaps:u,snapsAligned:x}}function Xr(n,e,s,o,c,a){const{groupSlides:r}=c,{min:f,max:i}=o,u=x();function x(){const d=r(a),b=!n||e==="keepSnaps";return s.length===1?[a]:b?d:d.slice(f,i).map((m,h,g)=>{const l=!h,p=Lt(g,h);if(l){const y=_e(g[0])+1;return Zt(y)}if(p){const y=Ze(a)-_e(g)[0]+1;return Zt(y,_e(g)[0])}return m})}return{slideRegistry:u}}function Yr(n,e,s,o,c){const{reachedAny:a,removeOffset:r,constrain:f}=o;function i(m){return m.concat().sort((h,g)=>X(h)-X(g))[0]}function u(m){const h=n?r(m):f(m),g=e.map((p,y)=>({diff:x(p-h,0),index:y})).sort((p,y)=>X(p.diff)-X(y.diff)),{index:l}=g[0];return{index:l,distance:h}}function x(m,h){const g=[m,m+s,m-s];if(!n)return m;if(!h)return i(g);const l=g.filter(p=>kt(p)===h);return l.length?i(l):_e(g)-s}function v(m,h){const g=e[m]-c.get(),l=x(g,h);return{index:m,distance:l}}function d(m,h){const g=c.get()+m,{index:l,distance:p}=u(g),y=!n&&a(g);if(!h||y)return{index:l,distance:m};const C=e[l]-p,w=m+x(C,0);return{index:l,distance:w}}return{byDistance:d,byIndex:v,shortcut:x}}function Wr(n,e,s,o,c,a,r){function f(v){const d=v.distance,b=v.index!==e.get();a.add(d),d&&(o.duration()?n.start():(n.update(),n.render(1),n.update())),b&&(s.set(e.get()),e.set(v.index),r.emit("select"))}function i(v,d){const b=c.byDistance(v,d);f(b)}function u(v,d){const b=e.clone().set(v),m=c.byIndex(b.get(),d);f(m)}return{distance:i,index:u}}function $r(n,e,s,o,c,a,r,f){const i={passive:!0,capture:!0};let u=0;function x(b){if(!f)return;function m(h){if(new Date().getTime()-u>10)return;r.emit("slideFocusStart"),n.scrollLeft=0;const p=s.findIndex(y=>y.includes(h));Mt(p)&&(c.useDuration(0),o.index(p,0),r.emit("slideFocus"))}a.add(document,"keydown",v,!1),e.forEach((h,g)=>{a.add(h,"focus",l=>{(ot(f)||f(b,l))&&m(g)},i)})}function v(b){b.code==="Tab"&&(u=new Date().getTime())}return{init:x}}function Ne(n){let e=n;function s(){return e}function o(i){e=r(i)}function c(i){e+=r(i)}function a(i){e-=r(i)}function r(i){return Mt(i)?i:i.get()}return{get:s,set:o,add:c,subtract:a}}function sn(n,e){const s=n.scroll==="x"?r:f,o=e.style;let c=null,a=!1;function r(d){return`translate3d(${d}px,0px,0px)`}function f(d){return`translate3d(0px,${d}px,0px)`}function i(d){if(a)return;const b=Dr(n.direction(d));b!==c&&(o.transform=s(b),c=b)}function u(d){a=!d}function x(){a||(o.transform="",e.getAttribute("style")||e.removeAttribute("style"))}return{clear:x,to:i,toggleActive:u}}function eo(n,e,s,o,c,a,r,f,i){const x=He(c),v=He(c).reverse(),d=l().concat(p());function b(O,I){return O.reduce((k,T)=>k-c[T],I)}function m(O,I){return O.reduce((k,T)=>b(k,I)>0?k.concat([T]):k,[])}function h(O){return a.map((I,k)=>({start:I-o[k]+.5+O,end:I+e-.5+O}))}function g(O,I,k){const T=h(I);return O.map(L=>{const D=k?0:-s,V=k?s:0,N=k?"end":"start",B=T[L][N];return{index:L,loopPoint:B,slideLocation:Ne(-1),translate:sn(n,i[L]),target:()=>f.get()>B?D:V}})}function l(){const O=r[0],I=m(v,O);return g(I,s,!1)}function p(){const O=e-r[0]-1,I=m(x,O);return g(I,-s,!0)}function y(){return d.every(({index:O})=>{const I=x.filter(k=>k!==O);return b(I,e)<=.1})}function C(){d.forEach(O=>{const{target:I,translate:k,slideLocation:T}=O,L=I();L!==T.get()&&(k.to(L),T.set(L))})}function w(){d.forEach(O=>O.translate.clear())}return{canLoop:y,clear:w,loop:C,loopPoints:d}}function to(n,e,s){let o,c=!1;function a(i){if(!s)return;function u(x){for(const v of x)if(v.type==="childList"){i.reInit(),e.emit("slidesChanged");break}}o=new MutationObserver(x=>{c||(ot(s)||s(i,x))&&u(x)}),o.observe(n,{childList:!0})}function r(){o&&o.disconnect(),c=!0}return{init:a,destroy:r}}function no(n,e,s,o){const c={};let a=null,r=null,f,i=!1;function u(){f=new IntersectionObserver(m=>{i||(m.forEach(h=>{const g=e.indexOf(h.target);c[g]=h}),a=null,r=null,s.emit("slidesInView"))},{root:n.parentElement,threshold:o}),e.forEach(m=>f.observe(m))}function x(){f&&f.disconnect(),i=!0}function v(m){return Ue(c).reduce((h,g)=>{const l=parseInt(g),{isIntersecting:p}=c[l];return(m&&p||!m&&!p)&&h.push(l),h},[])}function d(m=!0){if(m&&a)return a;if(!m&&r)return r;const h=v(m);return m&&(a=h),m||(r=h),h}return{init:u,destroy:x,get:d}}function ro(n,e,s,o,c,a){const{measureSize:r,startEdge:f,endEdge:i}=n,u=s[0]&&c,x=m(),v=h(),d=s.map(r),b=g();function m(){if(!u)return 0;const p=s[0];return X(e[f]-p[f])}function h(){if(!u)return 0;const p=a.getComputedStyle(_e(o));return parseFloat(p.getPropertyValue(`margin-${i}`))}function g(){return s.map((p,y,C)=>{const w=!y,_=Lt(C,y);return w?d[y]+x:_?d[y]+v:C[y+1][f]-p[f]}).map(X)}return{slideSizes:d,slideSizesWithGaps:b,startGap:x,endGap:v}}function oo(n,e,s,o,c,a,r,f,i){const{startEdge:u,endEdge:x,direction:v}=n,d=Mt(s);function b(l,p){return He(l).filter(y=>y%p===0).map(y=>l.slice(y,y+p))}function m(l){return l.length?He(l).reduce((p,y,C)=>{const w=_e(p)||0,_=w===0,O=y===Ze(l),I=c[u]-a[w][u],k=c[u]-a[y][x],T=!o&&_?v(r):0,L=!o&&O?v(f):0,D=X(k-L-(I+T));return C&&D>e+i&&p.push(y),O&&p.push(l.length),p},[]).map((p,y,C)=>{const w=Math.max(C[y-1]||0);return l.slice(w,p)}):[]}function h(l){return d?b(l,s):m(l)}return{groupSlides:h}}function so(n,e,s,o,c,a,r){const{align:f,axis:i,direction:u,startIndex:x,loop:v,duration:d,dragFree:b,dragThreshold:m,inViewThreshold:h,slidesToScroll:g,skipSnaps:l,containScroll:p,watchResize:y,watchSlides:C,watchDrag:w,watchFocus:_}=a,O=2,I=Nr(),k=I.measure(e),T=s.map(I.measure),L=Fr(i,u),D=L.measureSize(k),V=Rr(D),N=Vr(f,D),B=!v&&!!p,z=v||!!p,{slideSizes:Z,slideSizesWithGaps:ne,startGap:ve,endGap:q}=ro(L,k,T,s,z,c),Q=oo(L,D,g,v,k,T,ve,q,O),{snaps:ue,snapsAligned:we}=Qr(L,N,k,T,Q),oe=-_e(ue)+_e(ne),{snapsContained:Oe,scrollContainLimit:me}=Gr(D,oe,we,p,O),ae=B?Oe:we,{limit:Y}=Jr(oe,ae,v),ie=on(Ze(ae),x,v),ce=ie.clone(),H=He(s),M=({dragHandler:Ae,scrollBody:it,scrollBounds:ct,options:{loop:Ye}})=>{Ye||ct.constrain(Ae.pointerDown()),it.seek()},U=({scrollBody:Ae,translate:it,location:ct,offsetLocation:Ye,previousLocation:un,scrollLooper:dn,slideLooper:fn,dragHandler:vn,animation:mn,eventHandler:Et,scrollBounds:gn,options:{loop:Tt}},Pt)=>{const Dt=Ae.settled(),pn=!gn.shouldConstrain(),Vt=Tt?Dt:Dt&&pn,Bt=Vt&&!vn.pointerDown();Bt&&mn.stop();const hn=ct.get()*Pt+un.get()*(1-Pt);Ye.set(hn),Tt&&(dn.loop(Ae.direction()),fn.loop()),it.to(Ye.get()),Bt&&Et.emit("settle"),Vt||Et.emit("scroll")},J=Br(o,c,()=>M(at),Ae=>U(at,Ae)),R=.68,G=ae[ie.get()],K=Ne(G),ee=Ne(G),le=Ne(G),ge=Ne(G),Ie=Ur(K,le,ee,ge,d,R),Me=Yr(v,ae,oe,Y,ge),ke=Wr(J,ie,ce,Ie,Me,ge,r),Qe=Zr(Y),Xe=qe(),st=no(e,s,r,h),{slideRegistry:At}=Xr(B,p,ae,me,Q,H),ln=$r(n,s,At,ke,Ie,Xe,r,_),at={ownerDocument:o,ownerWindow:c,eventHandler:r,containerRect:k,slideRects:T,animation:J,axis:L,dragHandler:jr(L,n,o,c,ge,zr(L,c),K,J,ke,Ie,Me,ie,r,V,b,m,l,R,w),eventStore:Xe,percentOfView:V,index:ie,indexPrevious:ce,limit:Y,location:K,offsetLocation:le,previousLocation:ee,options:a,resizeHandler:Hr(e,r,c,s,L,y,I),scrollBody:Ie,scrollBounds:qr(Y,le,ge,Ie,V),scrollLooper:Kr(oe,Y,le,[K,le,ee,ge]),scrollProgress:Qe,scrollSnapList:ae.map(Qe.get),scrollSnaps:ae,scrollTarget:Me,scrollTo:ke,slideLooper:eo(L,D,oe,Z,ne,ue,ae,le,s),slideFocus:ln,slidesHandler:to(e,r,C),slidesInView:st,slideIndexes:H,slideRegistry:At,slidesToScroll:Q,target:ge,translate:sn(L,e)};return at}function ao(){let n={},e;function s(u){e=u}function o(u){return n[u]||[]}function c(u){return o(u).forEach(x=>x(e,u)),i}function a(u,x){return n[u]=o(u).concat([x]),i}function r(u,x){return n[u]=o(u).filter(v=>v!==x),i}function f(){n={}}const i={init:s,emit:c,off:r,on:a,clear:f};return i}const io={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function co(n){function e(a,r){return rn(a,r||{})}function s(a){const r=a.breakpoints||{},f=Ue(r).filter(i=>n.matchMedia(i).matches).map(i=>r[i]).reduce((i,u)=>e(i,u),{});return e(a,f)}function o(a){return a.map(r=>Ue(r.breakpoints||{})).reduce((r,f)=>r.concat(f),[]).map(n.matchMedia)}return{mergeOptions:e,optionsAtMedia:s,optionsMediaQueries:o}}function lo(n){let e=[];function s(a,r){return e=r.filter(({options:f})=>n.optionsAtMedia(f).active!==!1),e.forEach(f=>f.init(a,n)),r.reduce((f,i)=>Object.assign(f,{[i.name]:i}),{})}function o(){e=e.filter(a=>a.destroy())}return{init:s,destroy:o}}function nt(n,e,s){const o=n.ownerDocument,c=o.defaultView,a=co(c),r=lo(a),f=qe(),i=ao(),{mergeOptions:u,optionsAtMedia:x,optionsMediaQueries:v}=a,{on:d,off:b,emit:m}=i,h=L;let g=!1,l,p=u(io,nt.globalOptions),y=u(p),C=[],w,_,O;function I(){const{container:H,slides:M}=y;_=(_t(H)?n.querySelector(H):H)||n.children[0];const J=_t(M)?_.querySelectorAll(M):M;O=[].slice.call(J||_.children)}function k(H){const M=so(n,_,O,o,c,H,i);if(H.loop&&!M.slideLooper.canLoop()){const U=Object.assign({},H,{loop:!1});return k(U)}return M}function T(H,M){g||(p=u(p,H),y=x(p),C=M||C,I(),l=k(y),v([p,...C.map(({options:U})=>U)]).forEach(U=>f.add(U,"change",L)),y.active&&(l.translate.to(l.location.get()),l.animation.init(),l.slidesInView.init(),l.slideFocus.init(ce),l.eventHandler.init(ce),l.resizeHandler.init(ce),l.slidesHandler.init(ce),l.options.loop&&l.slideLooper.loop(),_.offsetParent&&O.length&&l.dragHandler.init(ce),w=r.init(ce,C)))}function L(H,M){const U=Q();D(),T(u({startIndex:U},H),M),i.emit("reInit")}function D(){l.dragHandler.destroy(),l.eventStore.clear(),l.translate.clear(),l.slideLooper.clear(),l.resizeHandler.destroy(),l.slidesHandler.destroy(),l.slidesInView.destroy(),l.animation.destroy(),r.destroy(),f.clear()}function V(){g||(g=!0,f.clear(),D(),i.emit("destroy"),i.clear())}function N(H,M,U){!y.active||g||(l.scrollBody.useBaseFriction().useDuration(M===!0?0:y.duration),l.scrollTo.index(H,U||0))}function B(H){const M=l.index.add(1).get();N(M,H,-1)}function z(H){const M=l.index.add(-1).get();N(M,H,1)}function Z(){return l.index.add(1).get()!==Q()}function ne(){return l.index.add(-1).get()!==Q()}function ve(){return l.scrollSnapList}function q(){return l.scrollProgress.get(l.offsetLocation.get())}function Q(){return l.index.get()}function ue(){return l.indexPrevious.get()}function we(){return l.slidesInView.get()}function oe(){return l.slidesInView.get(!1)}function Oe(){return w}function me(){return l}function ae(){return n}function Y(){return _}function ie(){return O}const ce={canScrollNext:Z,canScrollPrev:ne,containerNode:Y,internalEngine:me,destroy:V,off:b,on:d,emit:m,plugins:Oe,previousScrollSnap:ue,reInit:h,rootNode:ae,scrollNext:B,scrollPrev:z,scrollProgress:q,scrollSnapList:ve,scrollTo:N,selectedScrollSnap:Q,slideNodes:ie,slidesInView:we,slidesNotInView:oe};return T(e,s),setTimeout(()=>i.emit("init"),0),ce}nt.globalOptions=void 0;function Ct(n,e={options:{},plugins:[]}){let s=e,o;return Er()&&(nt.globalOptions=Ct.globalOptions,o=nt(n,s.options,s.plugins),o.on("init",()=>n.dispatchEvent(new CustomEvent("emblaInit",{detail:o})))),{destroy:()=>{o&&o.destroy()},update:c=>{const a=!It(s.options,c.options),r=!Tr(s.plugins,c.plugins);!a&&!r||(s=c,o&&o.reInit(s.options,s.plugins))}}}Ct.globalOptions=void 0;var uo=j("<button></button>"),fo=j('<section role="group" class="controls svelte-er9umx"><!> <div class="dots svelte-er9umx"></div> <!></section>'),vo=j('<div class="embla__slide svelte-er9umx" role="group" aria-roledescription="slide"><!></div>'),mo=j('<!> <div class="embla__viewport svelte-er9umx"><div class="embla__container svelte-er9umx" aria-atomic="false" aria-live="polite"></div></div>',1),go=j('<div class="embla svelte-er9umx" aria-roledescription="carousel"><!></div>');function an(n,e){ye(e,!0);const s=S(()=>Se("main"));let o=Ve(e,"scrollers",15),c=Ve(e,"currentItem",15),a=fe(!0),r=fe(!1),f=fe(0),i=fe(void 0);lt(()=>{c(e.items[t(f)])}),lt(()=>{t(i)&&o({next:()=>t(i)?.scrollNext(),prev:()=>t(i)?.scrollPrev()})}),lt(()=>{function v(){re(r,t(i)?.canScrollPrev()??!1,!0),re(a,t(i)?.canScrollNext()??!1,!0),re(f,t(i)?.selectedScrollSnap()??0,!0)}return t(i)?.on("settle",v),t(i)?.on("select",v),()=>{t(i)?.off("settle",v),t(i)?.off("select",v)}});var u=go(),x=P(u);nr(x,()=>e.items,v=>{var d=mo(),b=te(d);{var m=l=>{var p=fo(),y=P(p);{let _=S(()=>t(s)(101)),O=S(()=>e["keyboard-prev"]??""),I=S(()=>!t(r));Be(y,{get help(){return t(_)},get keyboard(){return t(O)},class:"embla__prev",get disabled(){return t(I)},onclick:()=>{t(i)?.scrollPrev()},children:(k,T)=>{tn(k,{})},$$slots:{default:!0}})}var C=F(y,2);$e(C,21,()=>e.items,zt,(_,O,I)=>{var k=uo();let T;$(L=>{T=xt(k,1,"dot svelte-er9umx",null,T,{active:t(f)===I}),pe(k,"aria-label",L),pe(k,"aria-disabled",t(f)===I)},[()=>t(s)(424,[I+1])]),en("click",k,()=>{t(i)?.scrollTo(I)}),E(_,k)}),A(C);var w=F(C,2);{let _=S(()=>t(s)(102)),O=S(()=>e["keyboard-next"]??""),I=S(()=>!t(a));Be(w,{get help(){return t(_)},get keyboard(){return t(O)},class:"embla__next",get disabled(){return t(I)},onclick:()=>{t(i)?.scrollNext()},children:(k,T)=>{nn(k,{})},$$slots:{default:!0}})}A(p),E(l,p)};W(b,l=>{e.items.length>1&&l(m)})}var h=F(b,2),g=P(h);$e(g,21,()=>e.items,zt,(l,p,y)=>{var C=vo(),w=P(C);bt(w,()=>e.item,()=>t(p)),A(C),$(_=>{pe(C,"data-current-slide",t(f)===y),pe(C,"aria-label",_)},[()=>e.slideName(t(p),y)]),E(l,C)}),A(g),A(h),et(h,(l,p)=>Ct?.(l,p),()=>({options:{duration:12}})),An("emblaInit",h,l=>{re(i,l.detail,!0)}),E(v,d)}),A(u),E(n,u),xe()}$t(["click"]);var po=Je('<svg><path fill="currentColor" d="M18 7h4v2h-6V3h2zM8 9H2V7h4V3h2zm10 8v4h-2v-6h6v2zM8 15v6H6v-4H2v-2z"></path></svg>');function ho(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var o=po();Ge(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s})),E(n,o)}var bo=j('<div class="with-expand-button svelte-jbxuws"><div><!> <!></div> <!></div>');function cn(n,e){ye(e,!0);let s=Ve(e,"expand",15,!1);const o=S(()=>e.corner.split("-",2));var c=bo(),a=P(c);let r,f;var i=P(a);{let d=S(()=>s()?"Réduire":"Agrandir");Be(i,{get help(){return t(d)},get keyboard(){return e.keyboard},onclick:()=>{s(!s())},children:(b,m)=>{var h=he(),g=te(h);{var l=y=>{ho(y,{})},p=y=>{Fn(y,{})};W(g,y=>{s()?y(l):y(p,!1)})}E(b,h)},$$slots:{default:!0}})}var u=F(i,2);{var x=d=>{var b=he(),m=te(b);bt(m,()=>e.otherButtons),E(d,b)};W(u,d=>{e.otherButtons&&d(x)})}A(a);var v=F(a,2);bt(v,()=>e.children),A(c),$((d,b)=>{r=xt(a,1,"buttons svelte-jbxuws",null,r,d),f=je(a,b,f,{"flex-direction":t(o)[1]==="left"?"row":"row-reverse"})},[()=>({"has-other-buttons":!!e.otherButtons}),()=>t(o).map(d=>`${d}: var(--offset);`).join(" ")]),E(n,c),xe()}var _o=j('<img class="svelte-5jkq0m"/>'),yo=j('<img class="svelte-5jkq0m"/>'),xo=j("<br/>"),wo=j("<em> </em>"),So=j("<code> </code>"),Oo=j('<div class="empty svelte-5jkq0m"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <p class="svelte-5jkq0m"><!></p></div>');function Io(n,e){ye(e,!0);let s=fe(void 0),o=Ve(e,"expand",15);const c=S(()=>e.option.image),a=S(()=>e.option.images),r=S(()=>e.option.label),f=S(()=>e.option.key),i=S(()=>se.currentSession?.fullscreenClassifier.layout??"top-bottom"),u=S(()=>Se("main"));Fe("classification",{"Shift+L":{help:t(u)(444),do:()=>t(s)?.next()},"Shift+J":{help:t(u)(445),do:()=>t(s)?.prev()},E:{help:t(u)(446),do:()=>{o(o()==="references"?"none":"references")}}});var x=he(),v=te(x);{var d=m=>{var h=()=>o()==="references",g=l=>{o(l?"references":"none")};{let l=S(()=>t(i)==="top-bottom"?"bottom-left":"top-left");cn(m,{get corner(){return t(l)},keyboard:"E",get expand(){return h()},set expand(p){g(p)},children:(p,y)=>{{const C=(_,O=wt)=>{var I=he(),k=te(I);{var T=D=>{var V=_o();$(()=>pe(V,"src",`https://cors.gwen.works/${O()??""}`)),E(D,V)},L=D=>{var V=yo();$(()=>pe(V,"src",O())),E(D,V)};W(k,D=>{O()&&tr.url.hostname==="localhost"?D(T):D(L,!1)})}E(_,I)};let w=S(()=>t(a)??[t(c)]);an(p,{get items(){return t(w)},slideName:(_,O)=>`Image de référence ${O+1} sur ${t(a)?.length??1}`,"keyboard-prev":"Shift+J","keyboard-next":"Shift+L",get scrollers(){return t(s)},set scrollers(_){re(s,_,!0)},item:C,$$slots:{item:!0}})}},$$slots:{default:!0}})}},b=m=>{var h=Oo(),g=P(h);er(g,()=>({"--size":"4em"})),rr(g.lastChild,{variant:"empty"}),A(g);var l=F(g,2);{const y=w=>{var _=xo();E(w,_)},C=w=>{var _=he(),O=te(_);{var I=T=>{var L=wo(),D=P(L,!0);A(L),$(()=>be(D,t(r))),E(T,L)},k=T=>{var L=So(),D=P(L,!0);A(L),$(()=>be(D,t(f))),E(T,L)};W(O,T=>{t(r)?T(I):T(k,!1)})}E(w,_)};var p=P(l);{let w=S(()=>[y,C]),_=S(()=>t(u).c(447));De(p,{get t(){return t(w)},get x(){return t(_)}})}A(l)}A(h),E(m,h)};W(v,m=>{t(a)||t(c)?m(d):m(b,!1)})}E(n,x),xe()}var Mo=Je('<svg><path fill="currentColor" d="m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617m-2.006-.742A6.98 6.98 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.98 6.98 0 0 0 4.875-1.975zM10 10V7h2v3h3v2h-3v3h-2v-3H7v-2z"></path></svg>');function ko(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var o=Mo();Ge(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s})),E(n,o)}var Lo=Je('<svg><path fill="currentColor" d="m18.031 16.617l4.283 4.282l-1.415 1.415l-4.282-4.283A8.96 8.96 0 0 1 11 20c-4.968 0-9-4.032-9-9s4.032-9 9-9s9 4.032 9 9a8.96 8.96 0 0 1-1.969 5.617m-2.006-.742A6.98 6.98 0 0 0 18 11c0-3.867-3.133-7-7-7s-7 3.133-7 7s3.133 7 7 7a6.98 6.98 0 0 0 4.875-1.975zM7 10h8v2H7z"></path></svg>');function Co(n,e){const s=Ke(e,["$$slots","$$events","$$legacy"]);var o=Lo();Ge(o,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s})),E(n,o)}var Ao=j('<picture><img alt=""/></picture>');function Eo(n,e){ye(e,!0);let s=Ve(e,"currentImage",15),o=Ve(e,"expand",15);const c=S(()=>se.currentSession?.fullscreenClassifier.layout??"top-bottom");let a=fe(!0),r=fe(!1),f=fe(void 0);const i=S(()=>Se("main"));Fe("classification",{ArrowRight:{help:t(i)(102),do:()=>t(f)?.next()},ArrowLeft:{help:t(i)(101),do:()=>t(f)?.prev()},O:{help:t(i)(448),do(){re(r,!1),o(o()==="subject"?"none":"subject")}},Z:{help:t(i)(449),do(){re(r,!0),re(a,!t(a)),setTimeout(()=>{re(r,!1)},200)}}});var u=()=>o()==="subject",x=v=>{o(v?"subject":"none")};{const v=b=>{{let m=S(()=>t(a)?"Voir l'image entière":"Voir l'image recadrée");Be(b,{get help(){return t(m)},keyboard:"Z",onclick:()=>{re(a,!t(a))},children:(h,g)=>{var l=he(),p=te(l);{var y=w=>{Co(w,{})},C=w=>{ko(w,{})};W(p,w=>{t(a)?w(y):w(C,!1)})}E(h,l)},$$slots:{default:!0}})}};let d=S(()=>t(c)==="top-bottom"?"top-left":"top-right");cn(n,{get corner(){return t(d)},keyboard:"O",get expand(){return u()},set expand(b){x(b)},otherButtons:v,children:(b,m)=>{an(b,{get items(){return e.images},slideName:(g,l)=>`${g.filename} (${l+1} sur ${e.images.length})`,"keyboard-prev":"ArrowLeft","keyboard-next":"ArrowRight",get scrollers(){return t(f)},set scrollers(g){re(f,g,!0)},get currentItem(){return s()},set currentItem(g){s(g)},item:(g,l=wt)=>{const p=S(()=>t(a)?se.cropMetadataValueOf(l())?.value:or);var y=he(),C=te(y);{var w=O=>{{let I=S(()=>se.getPreviewURL(l().fileId)),k=S(()=>sr(t(p)));ar(O,{get dimensions(){return l().dimensions},get src(){return t(I)},get alt(){return l().filename},get box(){return t(k)},get transitions(){return t(r)},background:!0})}},_=O=>{var I=Ao(),k=P(I);A(I),$(T=>pe(k,"src",T),[()=>se.getPreviewURL(l().fileId)]),E(O,I)};W(C,O=>{t(p)?O(w):O(_,!1)})}E(g,y)},$$slots:{item:!0}})},$$slots:{otherButtons:!0,default:!0}})}xe()}var To=j("<p> </p>"),Po=j("<li> </li>"),Do=j('<ul class="svelte-1xhhove"></ul>'),Vo=j('<p class="error"><!></p>'),Bo=j("<!> ",1),Fo=j('<div class="learn-more svelte-1xhhove"><!></div>'),jo=j("<!> <!>",1),zo=j('<div class="cascades svelte-1xhhove"><!></div> <div class="synonyms svelte-1xhhove"><!></div> <div class="description svelte-1xhhove"><!></div>',1),No=j('<main class="svelte-1xhhove"><div class="references svelte-1xhhove"><!></div> <div class="subject svelte-1xhhove"><!></div> <div class="panel svelte-1xhhove"><div class="header svelte-1xhhove"><!></div> <div class="layout-switcher svelte-1xhhove"><!></div> <div class="focused-option svelte-1xhhove"><!></div> <!> <div class="nav svelte-1xhhove"><!></div></div></main>');function Rs(n,e){ye(e,!0);const s=S(()=>Se("main")),o=S(()=>e.data.observation),c=S(()=>e.data.images),a=S(()=>e.data.navigation),r=S(()=>e.data.focusedMetadata),f=S(()=>e.data.metadataDefinitions),i=S(()=>e.data.allOptions),u=jt({}),x=S(()=>se.currentSession?.fullscreenClassifier.layout??"top-bottom"),v=S(()=>{if(!t(o)||!t(r))return;const q=Wt({definitions:t(f),observation:t(o),images:t(c)});return Nn({metadata:q},"enum",t(r).id)}),d=S(()=>t(i).find(q=>q.key===t(v)?.value?.toString()));let b=fe("none"),m=fe(!0),h=fe(jt(t(c)[0]));pt.initialize(100);function g(q){return Q=>{Q instanceof HTMLElement&&(Q.style.gridArea=q,Q.dataset.testid=q)}}var l=No(),p=P(l),y=P(p);{var C=q=>{Io(q,{get option(){return t(d)},get expand(){return t(b)},set expand(Q){re(b,Q,!0)}})};W(y,q=>{t(d)&&q(C)})}A(p),de(p,()=>g("references"));var w=F(p,2),_=P(w);{var O=q=>{Eo(q,{get images(){return t(c)},get expand(){return t(b)},set expand(Q){re(b,Q,!0)},get currentImage(){return t(h)},set currentImage(Q){re(h,Q,!0)}})};W(_,q=>{t(o)&&q(O)})}A(w),de(w,()=>g("subject"));var I=F(w,2),k=P(I),T=P(k);mr(T,{get observation(){return t(o)},get focusedMetadata(){return t(r)},get currentImage(){return t(h)}}),A(k),de(k,()=>g("header"));var L=F(k,2),D=P(L);_r(D,{toggleLayoutTransitions:q=>{re(m,q,!0)}}),A(L),de(L,()=>g("layout-switcher"));var V=F(L,2),N=P(V);{var B=q=>{Cr(q,{get options(){return t(i)},get observation(){return t(o)},get focusedMetadata(){return t(r)},get currentMetadataValue(){return t(v)}})};W(N,q=>{t(o)&&t(r)&&q(B)})}A(V),de(V,()=>g("focused-option"));var z=F(V,2);{var Z=q=>{var Q=zo(),ue=te(Q),we=P(ue);{let Y=S(()=>t(s)(427));dt(we,{composite:!0,get label(){return t(Y)},get Icon(){return Vn},"indent-icon":!1,children:(ie,ce)=>{var H=he(),M=te(H);ut(M,Xt,null,(U,J)=>{var R=he(),G=te(R);ut(G,()=>Ln({cache:u,db:t(J),protocolId:Mn(t(r).id),option:t(d)}),null,(K,ee)=>{jn(K,{get cascades(){return t(ee)}})}),E(U,R)}),E(ie,H)},$$slots:{default:!0}})}A(ue),de(ue,()=>g("cascades")),de(ue,()=>ft);var oe=F(ue,2),Oe=P(oe);{let Y=S(()=>t(s)(344));dt(Oe,{composite:!0,get label(){return t(Y)},get Icon(){return lr},"indent-icon":!1,children:(ie,ce)=>{var H=he(),M=te(H);{var U=R=>{var G=To(),K=P(G,!0);A(G),$(ee=>be(K,ee),[()=>t(s)(428)]),E(R,G)},J=R=>{var G=Do();$e(G,20,()=>t(d).synonyms,K=>K,(K,ee)=>{var le=Po(),ge=P(le,!0);A(le),$(()=>be(ge,ee)),E(K,le)}),A(G),E(R,G)};W(M,R=>{t(d).synonyms.length===0?R(U):R(J,!1)})}E(ie,H)},$$slots:{default:!0}})}A(oe),de(oe,()=>g("synonyms")),de(oe,()=>ft);var me=F(oe,2),ae=P(me);{let Y=S(()=>t(s)(260));dt(ae,{composite:!0,get label(){return t(Y)},get Icon(){return Dn},"indent-icon":!1,children:(ie,ce)=>{var H=jo(),M=te(H);ut(M,()=>Pn(t(d).description??""),null,(R,G)=>{var K=he(),ee=te(K);Tn(ee,()=>t(G)),E(R,K)},(R,G)=>{var K=Bo(),ee=te(K);{var le=Me=>{var ke=Vo(),Qe=P(ke);{let Xe=S(()=>t(s).c(116)),st=S(()=>[t(G)]);De(Qe,{get x(){return t(Xe)},get a(){return t(st)}})}A(ke),E(Me,ke)},ge=S(()=>Rn());W(ee,Me=>{t(ge)&&Me(le)})}var Ie=F(ee);$(()=>be(Ie,` ${t(d).description??""}`)),E(R,K)});var U=F(M,2);{var J=R=>{var G=Fo(),K=P(G);zn(K,{get href(){return t(d).learnMore}}),A(G),E(R,G)};W(U,R=>{t(d).learnMore&&R(J)})}E(ie,H)},$$slots:{default:!0}})}A(me),de(me,()=>g("description")),de(me,()=>ft),Ee(1,ue,()=>Te,()=>({duration:200})),Ee(1,oe,()=>Te,()=>({duration:200})),Ee(1,me,()=>Te,()=>({duration:200})),E(q,Q)};W(z,q=>{t(d)&&t(r)&&q(Z)})}var ne=F(z,2),ve=P(ne);wr(ve,En(()=>t(a),{get focusedMetadata(){return t(r)},get currentObservation(){return t(o)}})),A(ne),de(ne,()=>g("nav")),A(I),de(I,()=>g("panel")),A(l),$(()=>{pe(l,"data-layout",t(x)),pe(l,"data-expand",t(b)),pe(l,"data-layout-transitions",t(m))}),Ee(1,p,()=>Te,()=>({duration:200})),Ee(1,w,()=>Te,()=>({duration:200})),Ee(1,V,()=>Te,()=>({duration:200})),E(n,l),xe()}export{Rs as component,Ns as universal};
