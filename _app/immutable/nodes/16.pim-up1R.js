import"../chunks/DsnmJJEf.js";import{p as R,H as k,G as I,a as y,b as L,ap as T,ar as v,g as n,u as m,I as B,J as _,C as V,D as W}from"../chunks/BwdvgNQo.js";import{d as X,e as S,s as G,b as Z}from"../chunks/HTLptRgQ.js";import{p as $,i as D}from"../chunks/CKH9F0ww.js";import{t as ee,f as te}from"../chunks/BjiNJ5CV.js";import{c as H,b as J,s as ae}from"../chunks/08d27X49.js";import{A as re}from"../chunks/BgBcKoa6.js";import{C as se}from"../chunks/Dqw32fY-.js";import{C as ie}from"../chunks/CUiAmgj5.js";import{s as ne}from"../chunks/DYy3QkOc.js";import{p as oe}from"../chunks/Xiow3_xo.js";import{u as le,t as j}from"../chunks/Don2Ydo1.js";import{d as z}from"../chunks/DfkTl275.js";import{i as E,A as M,b as O}from"../chunks/YI6rRCuH.js";import{L as me}from"../chunks/72YJCPe-.js";import{d as ue}from"../chunks/BOvN9V9s.js";import{u as c}from"../chunks/BPJfxdhi.js";var de=k('<input type="file" multiple="" class="svelte-1n47qnw"/>'),fe=k('<section role="form"><!> <div class="dragging-overlay svelte-1n47qnw"><p> </p></div> <!></section>');function ce(w,r){R(r,!0);const C=m(()=>J("main"));let u=$(r,"dragging",15,!1);function h(e){if(u(!1),!e.dataTransfer)return;e.preventDefault();let a;if(e.dataTransfer.items?a=[...e.dataTransfer.items].map(t=>{if(t.kind==="file")return t.getAsFile()}).filter(t=>!!t):a=[...e.dataTransfer.files],r.filetypes&&r.filetypes.length>0&&a.some(t=>!r.filetypes.includes(t.type))){r.onunacceptable?.(a);return}r.onfiles?.({event:e,files:a})}var s=fe();let o;var d=v(s);ne(d,()=>r.children??B);var l=T(d,2),f=v(l),p=v(f,!0);_(f),_(l);var q=T(l,2);{var F=e=>{var a=de();I(t=>ae(a,"accept",t),[()=>r.filetypes?.join(",")]),Z("input",a,t=>{t.currentTarget.files&&r.onfiles?.({event:t,files:[...t.currentTarget.files]})}),y(e,a)};D(q,e=>{r.clickable&&e(F)})}_(s),I(e=>{o=H(s,1,"dropzone svelte-1n47qnw",null,o,{dragging:u(),clickable:r.clickable}),G(p,e)},[()=>n(C)(77)]),S("dragover",s,e=>{e.dataTransfer&&(e.preventDefault(),u(!0))}),S("drop",s,h),y(w,s),L()}X(["input"]);var pe=k('<div class="empty-state svelte-1urkjm2"><!> <p> </p></div>'),ge=k("<section><!> <!></section>");function je(w,r){R(r,!0);const C=m(()=>J("main")),u=m(()=>[...le(j.Image.state.map(({filename:s,id:o,addedAt:d,fileId:l,sessionId:f,metadata:p})=>({id:l??o,addedAt:d,sessionId:f,metadata:p,name:s,virtual:!1,data:j.Image.getFromState(o)})),s=>s.id),...c.processing.files.map(({name:s,id:o,addedAt:d})=>({id:o,sessionId:c.currentSessionId,addedAt:d,name:s,metadata:{},virtual:!0,data:null}))]),h=m(()=>n(u).length===0);{let s=m(()=>n(u).length===0);ce(w,{get filetypes(){return M},get clickable(){return n(s)},onfiles:({files:o})=>E(o),children:(o,d)=>{var l=ge();let f;var p=v(l);re(p,{get items(){return n(u)},zone:"import",onemptyclick:async()=>{c.selection.length>0||E(await oe({accept:M,multiple:!0}))},item:(a,t=B,b)=>{let i=()=>b?.().id,x=()=>b?.().name;var A=V(),Y=W(A);{var K=g=>{se(g,{boxes:"none",get image(){return t()},ondelete:async()=>{O(i(),"Cancelled by user"),c.processing.removeFile(i()),await z(i())}})},N=g=>{const P=m(()=>c.erroredImages.get(i())),Q=m(()=>c.queuedImages.has(i()));{let U=m(()=>n(P)?"errored":n(Q)?"queued":"loading");ie(g,{get id(){return i()},get title(){return x()},get status(){return n(U)},get tooltip(){return n(P)},image:void 0,dimensions:void 0,ondelete:async()=>{O(i(),"Cancelled by user"),c.processing.removeFile(i()),await ue(i()),await z(i())}})}};D(Y,g=>{t()?g(K):g(N,!1)})}y(a,A)},$$slots:{item:!0}});var q=T(p,2);{var F=e=>{var a=pe(),t=v(a);me(t,{variant:"empty"});var b=T(t,2),i=v(b,!0);_(b),_(a),I(x=>G(i,x),[()=>n(C)(64)]),y(e,a)};D(q,e=>{n(h)&&e(F)})}_(l),I(()=>f=H(l,1,"observations svelte-1urkjm2",null,f,{empty:n(h)})),ee(1,l,()=>te,()=>({duration:100})),y(o,l)},$$slots:{default:!0}})}L()}export{je as component};
