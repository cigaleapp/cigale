import"./DsnmJJEf.js";import{a as Be,C as qe,c as Ae,s as X,d as Ie,b as Re}from"./08d27X49.js";import{R as Y}from"./DWCXZatK.js";import{f as De,a as i,p as Me,H as b,b as Pe,g as t,u as _,ap as f,ar as l,J as o,G as q,C as Z,D as J,F as $}from"./BwdvgNQo.js";import{d as Oe,s as j,b as Ee}from"./HTLptRgQ.js";import{p as C,i as m,r as Fe}from"./CKH9F0ww.js";import{c as Ge}from"./CxwMZO45.js";import{e as He,i as Je}from"./CuPIRSst.js";import{a as ee,t as te}from"./C6sIn56-.js";import{A as je}from"./BAWXbWKH.js";import{D as Ke}from"./DBaFXsNm.js";import{I as Ne}from"./T09AO1QC.js";import"./69_IOA4Y.js";import{B as ae}from"./DfpvCGjf.js";import{C as se}from"./oavC55LJ.js";import{C as Qe}from"./BlwUordC.js";import{L as re}from"./DkW1Bdbi.js";import{L as Ue}from"./72YJCPe-.js";import{O as Ve}from"./gmcJWo7k.js";var We=De('<svg width="1.2em" height="1.2em" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 8L5.5 11.5L13 4" stroke="currentColor" stroke-linecap="round"></path></svg>');function Xe(R){var e=We();i(R,e)}var Ye=b('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1),Ze=b('<section class="errored-actions svelte-pa7bo1"><!> <!></section>'),$e=b('<div class="loading-overlay svelte-pa7bo1"><!> <span class="text smol svelte-pa7bo1"><!></span> <!></div>'),et=b('<img class="svelte-pa7bo1"/>'),tt=b('<div class="img-placeholder svelte-pa7bo1"><!></div>'),at=b('<div data-testid="card-observation-bounding-box" class="bb svelte-pa7bo1"></div>'),st=b('<div class="inner svelte-pa7bo1"><!> <div><!> <!></div> <footer class="svelte-pa7bo1"><div class="check-icon svelte-pa7bo1"><!></div> <h2 class="svelte-pa7bo1"><!></h2> <button class="stack-count svelte-pa7bo1"> </button></footer></div>'),rt=b('<div class="stack-background-card svelte-pa7bo1"><!></div>'),ot=b('<article><div class="main-card svelte-pa7bo1"><!></div> <!></article>');function St(R,e){Me(e,!0);let oe=C(e,"selected",3,!1),K=C(e,"selectable",3,!0),n=C(e,"status",7),D=C(e,"loadingStatusText",7),M=C(e,"stacksize",3,1),P=C(e,"boundingBoxes",19,()=>[]),ie=Fe(e,["$$slots","$$events","$$legacy","onclick","ondoubleclick","onstacksizeclick","ondelete","onretry","title","image","dimensions","selected","selectable","highlighted","status","statusText","loadingStatusText","stacksize","boundingBoxes","boxes","tooltip","id"]);const N=_(()=>M()>1),A=_(()=>n()==="loading"||n()==="queued"),le=_(()=>n()==="errored"),y=_(()=>Re("main")),ne=_(()=>n()==="loading"?t(y)(56):n()==="queued"?t(y)(82):n()==="errored"?t(y)(84):"");var S=ot();Be(S,()=>({class:"observation","data-selectable":K()?"":void 0,"data-id":e.id,"aria-label":e.title,...ie,[qe]:{selected:oe(),selectable:K(),highlighted:e.highlighted,loading:t(A),stacked:t(N)}}),void 0,void 0,void 0,"svelte-pa7bo1");var O=l(S),de=l(O);se(de,{tag:"div",get ondoubleclick(){return e.ondoubleclick},onclick:g=>{t(A)||t(le)||g instanceof MouseEvent&&e.onclick?.(g,v=>{v.status&&n(v.status),v.loadingStatusText&&D(v.loadingStatusText)})},children:(g,v)=>{var T=st(),Q=l(T);{var ue=s=>{var r=$e(),h=l(r);{var L=a=>{var d=Ye(),w=J(d);Ge(w,()=>({"--size":"1.5em"})),Ue(w.lastChild,{variant:"error"}),o(w),i(a,d)},x=a=>{re(a,{})},c=a=>{re(a,{waiting:!0})};m(h,a=>{n()==="errored"?a(L):n()==="loading"?a(x,1):n()==="queued"&&a(c,2)})}var k=f(h,2),ke=l(k);{var pe=a=>{var d=$();q(()=>j(d,D())),i(a,d)},we=a=>{var d=$();q(()=>j(d,e.statusText||t(ne))),i(a,d)};m(ke,a=>{n()==="loading"&&D()?a(pe):a(we,!1)})}o(k);var Ce=f(k,2);{var ye=a=>{var d=Ze(),w=l(d);{var Se=p=>{{const B=u=>{Ke(u,{})};ae(p,{dangerous:!0,onclick:u=>{u.stopPropagation(),e.ondelete()},_w_snippet_0:B,children:(u,Le)=>{{let G=_(()=>[B]),H=_(()=>t(y).c(15));Y(u,{get t(){return t(G)},get x(){return t(H)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}};m(w,p=>{e.ondelete&&p(Se)})}var Te=f(w,2);{var ze=p=>{{const B=u=>{je(u,{})};ae(p,{onclick:u=>{u.stopPropagation(),e.onretry()},_w_snippet_1:B,children:(u,Le)=>{{let G=_(()=>[B]),H=_(()=>t(y).c(14));Y(u,{get t(){return t(G)},get x(){return t(H)}})}},$$slots:{_w_snippet_1:!0,default:!0}})}};m(Te,p=>{!t(A)&&e.onretry&&p(ze)})}o(d),i(a,d)};m(Ce,a=>{(e.ondelete||e.onretry)&&a(ye)})}o(r),i(s,r)};m(Q,s=>{n()!=="ok"&&s(ue)})}var I=f(Q,2);let U;var V=l(I);{var ge=s=>{var r=Z(),h=J(r);{var L=c=>{Qe(c,{blurfill:!0,get dimensions(){return e.dimensions},get src(){return e.image},get alt(){return e.title},get box(){return P()[0]}})},x=c=>{var k=et();q(()=>{X(k,"src",e.image),X(k,"alt",e.title)}),i(c,k)};m(h,c=>{e.boxes==="apply-first"&&P().length>0&&e.dimensions?c(L):c(x,!1)})}i(s,r)},me=s=>{var r=tt(),h=l(r);Ne(h,{}),o(r),i(s,r)};m(V,s=>{e.image?s(ge):s(me,!1)})}var _e=f(V,2);{var fe=s=>{var r=Z(),h=J(r);He(h,17,P,Je,(L,x)=>{var c=at();q(()=>Ie(c,`left: ${t(x).x*100}%; top: ${t(x).y*80}%; width: ${t(x).width*100}%; height: ${80*t(x).height}%;`)),i(L,c)}),i(s,r)};m(_e,s=>{e.boxes==="show-all"&&s(fe)})}o(I);var W=f(I,2),E=l(W),be=l(E);Xe(be),o(E);var F=f(E,2),he=l(F);Ve(he,{get text(){return e.title}}),o(F);var z=f(F,2),xe=l(z,!0);o(z),ee(z,(s,r)=>te?.(s,r),()=>`Cette observation regroupe ${M()} images. Cliquez pour les voir toutes.`),o(W),o(T),q(()=>{U=Ae(I,1,"boundingboxes-wrapper svelte-pa7bo1",null,U,{"has-boxes":e.boxes==="show-all"}),z.disabled=t(A),j(xe,M())}),Ee("click",z,s=>{s.stopPropagation(),e.onstacksizeclick?.()}),i(g,T)},$$slots:{default:!0}}),o(O);var ve=f(O,2);{var ce=g=>{var v=rt(),T=l(v);se(T,{tag:"div"}),o(v),i(g,v)};m(ve,g=>{t(N)&&g(ce)})}o(S),ee(S,(g,v)=>te?.(g,v),()=>e.tooltip),i(R,S),Pe()}Oe(["click"]);export{St as C};
