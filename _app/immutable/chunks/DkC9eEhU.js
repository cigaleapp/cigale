import"./DsnmJJEf.js";import{o as jr,a as Ur}from"./CNplBLUs.js";import{j as Br,p as de,k as we,b as fe,e as F,d as k,c as L,ay as y,r as w,az as P,aa as W,g as o,u as b,a as _,aY as mt,t as Wr,n as le,a3 as Vr,s as ee,h as Lt,i as A,bD as Jr,a9 as Ee,aA as Ge,a8 as Yr,f as Ze,aX as Xr,a6 as Qr}from"./Bn_ZbADV.js";import{c as Zr,a as G,m as en,u as tn,o as ot,d as Nt,e as rn,k as nn}from"./C0Q0tU0C.js";import{p as E,i as q,r as xe,s as st}from"./dHQvgpC_.js";import{e as Qe}from"./WunZNVQx.js";import{s as ie}from"./D9gih6mG.js";import{_ as Je,g as Ye,a as he,s as Ae,b as dt,c as ur,C as on,r as sn}from"./ByTqR5TD.js";import{w as dr}from"./CwN-qvm4.js";import{S as fr}from"./DP2HZFad.js";import{b as an,g as tt,a as rt,r as Jt}from"./BIF72yv3.js";import{p as je}from"./CEIzszct.js";import{t as ze,q as ln,y as cn}from"./D9uJnc4X.js";import{o as ct,f as Ot}from"./AV-wdjIE.js";import{c as vt}from"./Ceb8Mi8c.js";import{K as un,a as vr,t as pr}from"./DX-V7JoH.js";import{h as Yt,a as Dt,b as dn,t as fn,M as vn,T as pn}from"./CZ0-Cwox.js";import{i as _t,s as Fe,a as Tt}from"./pVp6lB6C.js";import{e as Xt,c as hr,n as Et,x as hn,p as gn}from"./DvdFYW7d.js";import{e as mn,g as _n}from"./C41GwNKA.js";import{u as H}from"./B5baxliF.js";import{t as ye}from"./Dw8a8pSN.js";import{b as Qt}from"./DqeZ7boJ.js";import{R as Ue}from"./DHI2XP9K.js";import{j as bt,o as zt,l as Kt,k as pt,c as U,U as gr,a0 as mr,Q as _r,w as Ve,n as Re,O as bn,R as wn,E as br,S as Ht,a1 as wr,i as $t,a2 as at,a3 as qt,a4 as yn,a5 as yr,a6 as xn,a7 as Mn,C as it,a8 as kn,u as lt,g as xr,V as Mr,a as Pn,a9 as Sn,Z as Xe,T as Cn,aa as An,ab as In,ac as On,m as De,ad as Tn,ae as En,b as et,f as $n,P as Fn,d as Rn,e as Zt,F as Ln,A as Nn}from"./BtJKZU4V.js";import{A as St}from"./BoC_Jw-8.js";import{C as kr}from"./DCQ6EIJ0.js";import{B as nt}from"./r5lbXpLP.js";import{B as wt}from"./BxDhQTq4.js";import{c as Te}from"./C-HhNZ1M.js";import{s as We}from"./hWH8XGqh.js";import{k as Dn,B as zn}from"./KXNcRkIt.js";import{L as Kn}from"./i04FUm_M.js";import{P as Gt}from"./BbqYytGl.js";import{D as Hn}from"./BtdpP2ae.js";import{d as qn}from"./DTQgbNX7.js";import{I as Pr,a as Gn}from"./01ygbV9Q.js";import{L as Sr}from"./Db2b552w.js";import{R as jn}from"./CTdw5bTr.js";import{e as Un}from"./UkrbtdNH.js";import{A as Bn}from"./62pvB83o.js";import{b as Wn}from"./CoBO7ZM6.js";import{A as Vn}from"./DiOs4Ftk.js";import{C as Jn}from"./D6Cki-wO.js";import{L as Yn}from"./BlzppQ7h.js";import{S as er}from"./BvoE5eAZ.js";import{B as tr}from"./DZqYbAHH.js";import{m as rr}from"./DWOfE_Fn.js";import{e as Xn,s as Qn,g as Zn,f as eo}from"./yVjYDlYc.js";function to(t){let e;const r=Zr(s=>{let f=!1;const a=t.subscribe(u=>{e=u,f&&s()});return f=!0,a});function n(){return Br()?(r(),e):Xn(t)}return"set"in t?{get current(){return n()},set current(s){t.set(s)}}:{get current(){return n()}}}var ro=["Shift","Meta","Alt","Control"],Cr=typeof navigator=="object"?navigator.platform:"",Ar=/Mac|iPod|iPhone|iPad/.test(Cr),no=Ar?"Meta":"Control",oo=Cr==="Win32"?["Control","Alt"]:Ar?["Alt"]:[];function Ft(t,e){return typeof t.getModifierState=="function"&&(t.getModifierState(e)||oo.includes(e)&&t.getModifierState("AltGraph"))}function so(t){return t.trim().split(" ").map(function(e){var r=e.split(/\b\+/),n=r.pop(),s=n.match(/^\((.+)\)$/);return s&&(n=new RegExp("^"+s[1]+"$")),[r=r.map(function(f){return f==="$mod"?no:f}),n]})}function ao(t,e){var r=e[0],n=e[1];return!((n instanceof RegExp?!n.test(t.key)&&!n.test(t.code):n.toUpperCase()!==t.key.toUpperCase()&&n!==t.code)||r.find(function(s){return!Ft(t,s)})||ro.find(function(s){return!r.includes(s)&&n!==s&&Ft(t,s)}))}function io(t,e){var r;e===void 0&&(e={});var n=(r=e.timeout)!=null?r:1e3,s=Object.keys(t).map(function(u){return[so(u),t[u]]}),f=new Map,a=null;return function(u){u instanceof KeyboardEvent&&(s.forEach(function(c){var v=c[0],d=c[1],i=f.get(v)||v;ao(u,i[0])?i.length>1?f.set(v,i.slice(1)):(f.delete(v),d(u)):Ft(u,u.key)||f.delete(v)}),a&&clearTimeout(a),a=setTimeout(f.clear.bind(f),n))}}function lo(t,e,r){var n={},s=n.event,f=s===void 0?"keydown":s,a=n.capture,u=io(e,{timeout:n.timeout});return t.addEventListener(f,u,a),function(){t.removeEventListener(f,u,a)}}var co=L('<h2 class="svelte-6wpiuz"> </h2>'),uo=L('<dt class="svelte-6wpiuz"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></dt> <dd class="svelte-6wpiuz"> </dd>',1),fo=L('<!> <dl class="svelte-6wpiuz"></dl>',1),vo=L('<dl class="svelte-6wpiuz"><div class="empty svelte-6wpiuz"><div class="sad svelte-6wpiuz"> </div> <p> </p></div></dl>');function po(t,e){de(e,!0);const r=b(()=>Je(Ye("main")));let n=E(e,"openHelp",15),s=E(e,"preventDefault",3,!1);const f=c=>(c instanceof KeyboardEvent||c instanceof MouseEvent)&&(c.target instanceof HTMLInputElement||c.target instanceof HTMLTextAreaElement);we(()=>lo(window,Object.fromEntries(Object.entries(e.binds).flatMap(([c,v])=>{if(c.startsWith("Digit")&&!c.includes(" ")){const d=c.replace("Digit","");return[[c,v],[d,v],[`Shift+${d}`,v]]}return[[c,v]]}).map(([c,v])=>[c,async d=>{if(!v?.allowInModals&&Yt(je)){console.warn(`a modal is open, ignoring keybinding ${c}`,je.state);return}if(f(d)&&!c.startsWith("$mod+")){console.warn(`in input, ignoring keybinding ${c}`,d.target);return}v.when&&!v.when(d)||v.debug&&!_t()||(s()&&d.preventDefault(),await v.do(d))}]))));const a=["Recadrage","Observations","Général","Navigation","Debug mode"],u=b(()=>Xt(Xt(e.binds).reduce((c,[v,d])=>{if(d.hidden||d.debug&&!_t())return c;const i=d.group??"Général";return c[i]||(c[i]=[]),c[i].push([v,d]),c},{})).toSorted(([c],[v])=>a.indexOf(c)-a.indexOf(v)));we(()=>{const c=v=>{v.key==="?"&&!f(v)&&!Yt(je)&&n()?.()};return window.addEventListener("keyup",c),()=>window.removeEventListener("keyup",c)});{let c=b(()=>o(r).t(153));Dt(t,{key:"modal_keyboard_shortcuts_help",get title(){return o(c)},get open(){return n()},set open(v){n(v)},children:(v,d)=>{var i=F(),g=k(i);Qe(g,17,()=>o(u),([p,l])=>p,(p,l,h,m)=>{var M=b(()=>mt(o(l),2));let S=()=>o(M)[0],R=()=>o(M)[1];var O=fo(),I=k(O);{var x=T=>{var K=co(),N=y(K,!0);w(K),W(()=>G(N,S())),_(T,K)};q(I,T=>{o(u).length>=2&&T(x)})}var C=P(I,2);Qe(C,21,R,([T,{help:K}])=>T,(T,K)=>{var N=b(()=>mt(o(K),2));let Y=()=>o(N)[0],B=()=>o(N)[1].help;var j=uo(),D=k(j),J=y(D);vt(J,()=>({"--size":"1.2em"})),un(J.lastChild,{get shortcut(){return Y()},get help(){return B()}}),w(J),w(D);var X=P(D,2),ne=y(X,!0);w(X),W(()=>G(ne,B())),_(T,j)}),w(C),_(p,O)},p=>{var l=vo(),h=y(l),m=y(h),M=y(m,!0);w(m);var S=P(m,2),R=y(S,!0);w(S),w(h),w(l),W((O,I)=>{G(M,O),G(R,I)},[()=>o(r).t(204),()=>o(r).t(36)]),_(p,l)}),_(v,i)},$$slots:{default:!0}})}fe()}function ho(t){we(()=>Wr(()=>t()))}function go(t){return window.getComputedStyle(t).getPropertyValue("direction")}function mo(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?Kt:zt,vertical:pt}[e]}function _o(t="ltr",e="horizontal"){return{horizontal:t==="rtl"?zt:Kt,vertical:bt}[e]}function bo(t="ltr",e="horizontal"){return["ltr","rtl"].includes(t)||(t="ltr"),["horizontal","vertical"].includes(e)||(e="horizontal"),{nextKey:mo(t,e),prevKey:_o(t,e)}}function wo(t){const e=U(null);function r(){if(!mr)return[];const a=document.getElementById(t.rootNodeId.current);return a?t.candidateSelector?Array.from(a.querySelectorAll(t.candidateSelector)):t.candidateAttr?Array.from(a.querySelectorAll(`[${t.candidateAttr}]:not([data-disabled])`)):[]:[]}function n(){const a=r();a.length&&a[0]?.focus()}function s(a,u,c=!1){const v=document.getElementById(t.rootNodeId.current);if(!v||!a)return;const d=r();if(!d.length)return;const i=d.indexOf(a),g=go(v),{nextKey:p,prevKey:l}=bo(g,t.orientation.current),h=t.loop.current,m={[p]:i+1,[l]:i-1,[_r]:0,[gr]:d.length-1};if(c){const R=p===pt?zt:pt,O=l===bt?Kt:bt;m[R]=i+1,m[O]=i-1}let M=m[u.key];if(M===void 0)return;u.preventDefault(),M<0&&h?M=d.length-1:M===d.length&&h&&(M=0);const S=d[M];if(S)return S.focus(),e.current=S.id,t.onCandidateFocus?.(S),S}function f(a){const u=r(),c=e.current!==null;return a&&!c&&u[0]===a?(e.current=a.id,0):a?.id===e.current?0:-1}return{setCurrentTabStopId(a){e.current=a},getTabIndex:f,handleKeydown:s,focusFirstCandidate:n,currentTabStopId:e}}function yo(t,e){var r=F(),n=k(r);Dn(n,()=>e.children,s=>{var f=F(),a=k(f);ie(a,()=>e.children??le),_(s,f)}),_(t,r)}function xo(t,e){de(e,!0);let r=E(e,"to",3,"body");const n=Vr();let s=b(f);function f(){if(!mr||e.disabled)return null;let i=null;return typeof r()=="string"?i=document.querySelector(r()):(r()instanceof HTMLElement||r()instanceof DocumentFragment)&&(i=r()),i}let a;function u(){a&&(tn(a),a=null)}Ve([()=>o(s),()=>e.disabled],([i,g])=>{if(!i||g){u();return}return a=en(yo,{target:i,props:{children:e.children},context:n}),()=>{u()}});var c=F(),v=k(c);{var d=i=>{var g=F(),p=k(g);ie(p,()=>e.children??le),_(i,g)};q(v,i=>{e.disabled&&i(d)})}_(t,c),fe()}function $i(t,e,r=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===t.length-1?r?t[0]:void 0:t[e+1]}function Fi(t,e,r=!0){if(!(t.length===0||e<0||e>=t.length))return t.length===1&&e===0?t[0]:e===0?r?t[t.length-1]:void 0:t[e-1]}function Ri(t,e,r,n=!0){if(t.length===0||e<0||e>=t.length)return;let s=e+r;return n?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Li(t,e,r,n=!0){if(t.length===0||e<0||e>=t.length)return;let s=e-r;return n?s=(s%t.length+t.length)%t.length:s=Math.max(0,Math.min(s,t.length-1)),t[s]}function Ir(t,e,r){const n=e.toLowerCase();if(n.endsWith(" ")){const i=n.slice(0,-1);if(t.filter(h=>h.toLowerCase().startsWith(i)).length<=1)return Ir(t,i,r);const p=r?.toLowerCase();if(p&&p.startsWith(i)&&p.charAt(i.length)===" "&&e.trim()===i)return r;const l=t.filter(h=>h.toLowerCase().startsWith(n));if(l.length>0){const h=r?t.indexOf(r):-1;return nr(l,Math.max(h,0)).find(S=>S!==r)||r}}const f=e.length>1&&Array.from(e).every(i=>i===e[0])?e[0]:e,a=f.toLowerCase(),u=r?t.indexOf(r):-1;let c=nr(t,Math.max(u,0));f.length===1&&(c=c.filter(i=>i!==r));const d=c.find(i=>i?.toLowerCase().startsWith(a));return d!==r?d:void 0}function nr(t,e){return t.map((r,n)=>t[(e+n)%t.length])}function Or(t,e=1e4,r=Re){let n=null,s=ee(Lt(t));function f(){return window.setTimeout(()=>{A(s,t,!0),r(t)},e)}return we(()=>()=>{n&&clearTimeout(n)}),U.with(()=>o(s),a=>{A(s,a,!0),r(a),n&&clearTimeout(n),n=f()})}function Mo(t){const e=Or("",1e3),r=(a=>a.focus()),n=(()=>document.activeElement);function s(a,u){if(!u.length)return;e.current=e.current+a;const c=n(),v=u.find(p=>p===c)?.textContent?.trim()??"",d=u.map(p=>p.textContent?.trim()??""),i=Ir(d,e.current,v),g=u.find(p=>p.textContent?.trim()===i);return g&&r(g),g}function f(){e.current=""}return{search:e,handleTypeaheadSearch:s,resetTypeahead:f}}function or(t,e){de(e,!0);let r=E(e,"mounted",15,!1),n=E(e,"onMountedChange",3,Re);ho(()=>(r(!0),n()(!0),()=>{r(!1),n()(!1)})),fe()}const ko=[br,Ht],Po=[pt,bn,_r],Tr=[bt,wn,gr],So=[...Po,...Tr];function Co(t){return t==="indeterminate"}function Ao(t){return Co(t)?"indeterminate":t?"checked":"unchecked"}function sr(t){return t.pointerType==="mouse"}function Io(t){const e=b(()=>t.enabled()),r=Or(!1,t.transitTimeout??300,a=>{o(e)&&t.setIsPointerInTransit?.(a)});let n=ee(null);function s(){A(n,null),r.current=!1}function f(a,u){const c=a.currentTarget;if(!at(c))return;const v={x:a.clientX,y:a.clientY},d=Oo(v,c.getBoundingClientRect()),i=To(v,d),g=Eo(u.getBoundingClientRect()),p=Fo([...i,...g]);A(n,p,!0),r.current=!0}return Ve([t.triggerNode,t.contentNode,t.enabled],([a,u,c])=>{if(!a||!u||!c)return;const v=i=>{f(i,u)},d=i=>{f(i,a)};return wr(ot(a,"pointerleave",v),ot(u,"pointerleave",d))}),Ve(()=>o(n),()=>ot(document,"pointermove",u=>{if(!o(n))return;const c=u.target;if(!$t(c))return;const v={x:u.clientX,y:u.clientY},d=t.triggerNode()?.contains(c)||t.contentNode()?.contains(c),i=!$o(v,o(n));d?s():i&&(s(),t.onPointerExit())})),{isPointerInTransit:r}}function Oo(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),f=Math.abs(e.left-t.x);switch(Math.min(r,n,s,f)){case f:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function To(t,e,r=5){const n=r*1.5;switch(e){case"top":return[{x:t.x-r,y:t.y+r},{x:t.x,y:t.y-n},{x:t.x+r,y:t.y+r}];case"bottom":return[{x:t.x-r,y:t.y-r},{x:t.x,y:t.y+n},{x:t.x+r,y:t.y-r}];case"left":return[{x:t.x+r,y:t.y-r},{x:t.x-n,y:t.y},{x:t.x+r,y:t.y+r}];case"right":return[{x:t.x-r,y:t.y-r},{x:t.x+n,y:t.y},{x:t.x-r,y:t.y+r}]}}function Eo(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function $o(t,e){const{x:r,y:n}=t;let s=!1;for(let f=0,a=e.length-1;f<e.length;a=f++){const u=e[f].x,c=e[f].y,v=e[a].x,d=e[a].y;c>n!=d>n&&r<(v-u)*(n-c)/(d-c)+u&&(s=!s)}return s}function Fo(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),Ro(e)}function Ro(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const f=e[e.length-1],a=e[e.length-2];if((f.x-a.x)*(s.y-a.y)>=(f.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const f=r[r.length-1],a=r[r.length-2];if((f.x-a.x)*(s.y-a.y)>=(f.y-a.y)*(s.x-a.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}function ft(){return{getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"}}function Lo(t,e){if(!qt(t,ft()))return No(t,e);const r=yn(yr(t).body,ft());e==="prev"&&r.reverse();const n=r.indexOf(t);return n===-1?document.body:r.slice(n+1)[0]}function No(t,e){if(!xn(t,ft()))return document.body;const r=Mn(yr(t).body,ft());e==="prev"&&r.reverse();const n=r.indexOf(t);return n===-1?document.body:r.slice(n+1).find(f=>qt(f,ft()))??document.body}const Er=new it("Menu.Root"),jt=new it("Menu.Root | Menu.Sub"),xt=new it("Menu.Content"),$r=new it("Menu.Group | Menu.RadioGroup"),Do=new it("Menu.RadioGroup"),Ut=new it("Menu.CheckboxGroup"),zo=new Sn("bitsmenuopen",{bubbles:!1,cancelable:!0});class Ko{opts;isUsingKeyboard=new Be;#e=ee(!1);get ignoreCloseAutoFocus(){return o(this.#e)}set ignoreCloseAutoFocus(e){A(this.#e,e,!0)}#t=ee(!1);get isPointerInTransit(){return o(this.#t)}set isPointerInTransit(e){A(this.#t,e,!0)}constructor(e){this.opts=e}getAttr(e){return`data-${this.opts.variant.current}-${e}`}}class Ho{opts;root;parentMenu;contentId=U.with(()=>"");#e=ee(null);get contentNode(){return o(this.#e)}set contentNode(e){A(this.#e,e,!0)}#t=ee(null);get triggerNode(){return o(this.#t)}set triggerNode(e){A(this.#t,e,!0)}constructor(e,r,n){this.opts=e,this.root=r,this.parentMenu=n,n&&Ve(()=>n.opts.open.current,()=>{n.opts.open.current||(this.opts.open.current=!1)})}toggleOpen(){this.opts.open.current=!this.opts.open.current}onOpen(){this.opts.open.current=!0}onClose(){this.opts.open.current=!1}}class qo{opts;parentMenu;#e=ee("");get search(){return o(this.#e)}set search(e){A(this.#e,e,!0)}#t=0;#r;rovingFocusGroup;#o=ee(!1);get mounted(){return o(this.#o)}set mounted(e){A(this.#o,e,!0)}#s;constructor(e,r){this.opts=e,this.parentMenu=r,r.contentId=e.id,this.#s=e.isSub??!1,this.onkeydown=this.onkeydown.bind(this),this.onblur=this.onblur.bind(this),this.onfocus=this.onfocus.bind(this),this.handleInteractOutside=this.handleInteractOutside.bind(this),lt({...e,deps:()=>this.parentMenu.opts.open.current,onRefChange:n=>{this.parentMenu.contentNode!==n&&(this.parentMenu.contentNode=n)}}),Io({contentNode:()=>this.parentMenu.contentNode,triggerNode:()=>this.parentMenu.triggerNode,enabled:()=>this.parentMenu.opts.open.current&&!!this.parentMenu.triggerNode?.hasAttribute(this.parentMenu.root.getAttr("sub-trigger")),onPointerExit:()=>{this.parentMenu.opts.open.current=!1},setIsPointerInTransit:n=>{this.parentMenu.root.isPointerInTransit=n}}),this.#r=Mo().handleTypeaheadSearch,this.rovingFocusGroup=wo({rootNodeId:this.parentMenu.contentId,candidateAttr:this.parentMenu.root.getAttr("item"),loop:this.opts.loop,orientation:U.with(()=>"vertical")}),Ve(()=>this.parentMenu.contentNode,n=>{if(!n)return;const s=()=>{Xe(()=>{this.parentMenu.root.isUsingKeyboard.current&&this.rovingFocusGroup.focusFirstCandidate()})};return zo.listen(n,s)}),we(()=>{this.parentMenu.opts.open.current||window.clearTimeout(this.#t)})}#l(){const e=this.parentMenu.contentNode;return e?Array.from(e.querySelectorAll(`[${this.parentMenu.root.getAttr("item")}]:not([data-disabled])`)):[]}#n(){return this.parentMenu.root.isPointerInTransit}onCloseAutoFocus=e=>{this.opts.onCloseAutoFocus.current(e),!(e.defaultPrevented||this.#s)&&this.parentMenu.triggerNode&&qt(this.parentMenu.triggerNode)&&this.parentMenu.triggerNode.focus()};handleTabKeyDown(e){let r=this.parentMenu;for(;r.parentMenu!==null;)r=r.parentMenu;if(!r.triggerNode)return;e.preventDefault();const n=Lo(r.triggerNode,e.shiftKey?"prev":"next");n?(this.parentMenu.root.ignoreCloseAutoFocus=!0,r.onClose(),Xe(()=>{n.focus(),Xe(()=>{this.parentMenu.root.ignoreCloseAutoFocus=!1})})):document.body.focus()}onkeydown(e){if(e.defaultPrevented)return;if(e.key===Cn){this.handleTabKeyDown(e);return}const r=e.target,n=e.currentTarget;if(!at(r)||!at(n))return;const s=r.closest(`[${this.parentMenu.root.getAttr("content")}]`)?.id===this.parentMenu.contentId.current,f=e.ctrlKey||e.altKey||e.metaKey,a=e.key.length===1;if(this.rovingFocusGroup.handleKeydown(r,e)||e.code==="Space")return;const c=this.#l();s&&!f&&a&&this.#r(e.key,c),e.target?.id===this.parentMenu.contentId.current&&So.includes(e.key)&&(e.preventDefault(),Tr.includes(e.key)&&c.reverse(),An(c))}onblur(e){$t(e.currentTarget)&&$t(e.target)&&(e.currentTarget.contains?.(e.target)||(window.clearTimeout(this.#t),this.search=""))}onfocus(e){this.parentMenu.root.isUsingKeyboard.current&&Xe(()=>this.rovingFocusGroup.focusFirstCandidate())}onItemEnter(){return this.#n()}onItemLeave(e){if(e.currentTarget.hasAttribute(this.parentMenu.root.getAttr("sub-trigger"))||this.#n()||this.parentMenu.root.isUsingKeyboard.current)return;this.parentMenu.contentNode?.focus(),this.rovingFocusGroup.setCurrentTabStopId("")}onTriggerLeave(){return!!this.#n()}onOpenAutoFocus=e=>{if(e.defaultPrevented)return;e.preventDefault(),this.parentMenu.contentNode?.focus()};handleInteractOutside(e){if(!In(e.target))return;const r=this.parentMenu.triggerNode?.id;if(e.target.id===r){e.preventDefault();return}e.target.closest(`#${r}`)&&e.preventDefault()}#a=b(()=>({open:this.parentMenu.opts.open.current}));get snippetProps(){return o(this.#a)}set snippetProps(e){A(this.#a,e)}#i=b(()=>({id:this.opts.id.current,role:"menu","aria-orientation":On("vertical"),[this.parentMenu.root.getAttr("content")]:"","data-state":xr(this.parentMenu.opts.open.current),onkeydown:this.onkeydown,onblur:this.onblur,onfocus:this.onfocus,dir:this.parentMenu.root.opts.dir.current,style:{pointerEvents:"auto"}}));get props(){return o(this.#i)}set props(e){A(this.#i,e)}popperProps={onCloseAutoFocus:e=>this.onCloseAutoFocus(e)}}class Fr{opts;content;#e=ee(!1);constructor(e,r){this.opts=e,this.content=r,this.onpointermove=this.onpointermove.bind(this),this.onpointerleave=this.onpointerleave.bind(this),this.onfocus=this.onfocus.bind(this),this.onblur=this.onblur.bind(this),lt({...e,deps:()=>this.content.mounted})}onpointermove(e){if(!e.defaultPrevented&&sr(e))if(this.opts.disabled.current)this.content.onItemLeave(e);else{if(this.content.onItemEnter())return;const n=e.currentTarget;if(!at(n))return;n.focus()}}onpointerleave(e){e.defaultPrevented||sr(e)&&this.content.onItemLeave(e)}onfocus(e){Xe(()=>{e.defaultPrevented||this.opts.disabled.current||A(this.#e,!0)})}onblur(e){Xe(()=>{e.defaultPrevented||A(this.#e,!1)})}#t=b(()=>({id:this.opts.id.current,tabindex:-1,role:"menuitem","aria-disabled":Tn(this.opts.disabled.current),"data-disabled":Mr(this.opts.disabled.current),"data-highlighted":o(this.#e)?"":void 0,[this.content.parentMenu.root.getAttr("item")]:"",onpointermove:this.onpointermove,onpointerleave:this.onpointerleave,onfocus:this.onfocus,onblur:this.onblur}));get props(){return o(this.#t)}set props(e){A(this.#t,e)}}class Rr{opts;item;#e=!1;root;constructor(e,r){this.opts=e,this.item=r,this.root=r.content.parentMenu.root,this.onkeydown=this.onkeydown.bind(this),this.onclick=this.onclick.bind(this),this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this)}#t(){if(this.item.opts.disabled.current)return;const e=new CustomEvent("menuitemselect",{bubbles:!0,cancelable:!0});this.opts.onSelect.current(e),Xe(()=>{if(e.defaultPrevented){this.item.content.parentMenu.root.isUsingKeyboard.current=!1;return}this.opts.closeOnSelect.current&&this.item.content.parentMenu.root.opts.onClose()})}onkeydown(e){const r=this.item.content.search!=="";if(!(this.item.opts.disabled.current||r&&e.key===Ht)&&ko.includes(e.key)){if(!at(e.currentTarget))return;e.currentTarget.click(),e.preventDefault()}}onclick(e){this.item.opts.disabled.current||this.#t()}onpointerup(e){if(!e.defaultPrevented&&!this.#e){if(!at(e.currentTarget))return;e.currentTarget?.click()}}onpointerdown(e){this.#e=!0}#r=b(()=>De(this.item.props,{onclick:this.onclick,onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return o(this.#r)}set props(e){A(this.#r,e)}}class Go{opts;item;group;constructor(e,r,n=null){this.opts=e,this.item=r,this.group=n,this.group&&(Ve(()=>this.group.opts.value.current,s=>{this.opts.checked.current=s.includes(this.opts.value.current)}),Ve(()=>this.opts.checked.current,s=>{s?this.group.addValue(this.opts.value.current):this.group.removeValue(this.opts.value.current)}))}toggleChecked(){this.opts.indeterminate.current?(this.opts.indeterminate.current=!1,this.opts.checked.current=!0):this.opts.checked.current=!this.opts.checked.current}#e=b(()=>({checked:this.opts.checked.current,indeterminate:this.opts.indeterminate.current}));get snippetProps(){return o(this.#e)}set snippetProps(e){A(this.#e,e)}#t=b(()=>({...this.item.props,role:"menuitemcheckbox","aria-checked":En(this.opts.checked.current,this.opts.indeterminate.current),"data-state":Ao(this.opts.checked.current),[this.item.root.getAttr("checkbox-item")]:""}));get props(){return o(this.#t)}set props(e){A(this.#t,e)}}class jo{opts;root;#e=ee(void 0);get groupHeadingId(){return o(this.#e)}set groupHeadingId(e){A(this.#e,e,!0)}constructor(e,r){this.opts=e,this.root=r,lt(this.opts)}#t=b(()=>({id:this.opts.id.current,role:"group","aria-labelledby":this.groupHeadingId,[this.root.getAttr("group")]:""}));get props(){return o(this.#t)}set props(e){A(this.#t,e)}}class Ct{opts;group;constructor(e,r){this.opts=e,this.group=r,lt({...e,onRefChange:n=>{this.group.groupHeadingId=n?.id}})}#e=b(()=>({id:this.opts.id.current,role:"group",[this.group.root.getAttr("group-heading")]:""}));get props(){return o(this.#e)}set props(e){A(this.#e,e)}}class Uo{opts;parentMenu;constructor(e,r){this.opts=e,this.parentMenu=r,this.onpointerdown=this.onpointerdown.bind(this),this.onpointerup=this.onpointerup.bind(this),this.onkeydown=this.onkeydown.bind(this),lt({...e,onRefChange:n=>{this.parentMenu.triggerNode=n}})}onpointerdown(e){if(!this.opts.disabled.current){if(e.pointerType==="touch")return e.preventDefault();e.button===0&&e.ctrlKey===!1&&(this.parentMenu.toggleOpen(),this.parentMenu.opts.open.current||e.preventDefault())}}onpointerup(e){this.opts.disabled.current||e.pointerType==="touch"&&(e.preventDefault(),this.parentMenu.toggleOpen())}onkeydown(e){if(!this.opts.disabled.current){if(e.key===Ht||e.key===br){this.parentMenu.toggleOpen(),e.preventDefault();return}e.key===pt&&(this.parentMenu.onOpen(),e.preventDefault())}}#e=b(()=>{if(this.parentMenu.opts.open.current&&this.parentMenu.contentId.current)return this.parentMenu.contentId.current});#t=b(()=>({id:this.opts.id.current,disabled:this.opts.disabled.current,"aria-haspopup":"menu","aria-expanded":Pn(this.parentMenu.opts.open.current),"aria-controls":o(this.#e),"data-disabled":Mr(this.opts.disabled.current),"data-state":xr(this.parentMenu.opts.open.current),[this.parentMenu.root.getAttr("trigger")]:"",onpointerdown:this.onpointerdown,onpointerup:this.onpointerup,onkeydown:this.onkeydown}));get props(){return o(this.#t)}set props(e){A(this.#t,e)}}class Bo{opts;content;#e=ee(null);get groupHeadingId(){return o(this.#e)}set groupHeadingId(e){A(this.#e,e,!0)}root;constructor(e,r){this.opts=e,this.content=r,this.root=r.parentMenu.root,lt(e)}addValue(e){if(e&&!this.opts.value.current.includes(e)){const r=[...We(this.opts.value.current),e];this.opts.value.current=r,this.opts.onValueChange.current(r)}}removeValue(e){if(!e||this.opts.value.current.indexOf(e)===-1)return;const n=this.opts.value.current.filter(s=>s!==e);this.opts.value.current=n,this.opts.onValueChange.current(n)}#t=b(()=>({id:this.opts.id.current,[this.root.getAttr("checkbox-group")]:"",role:"group","aria-labelledby":this.groupHeadingId}));get props(){return o(this.#t)}set props(e){A(this.#t,e)}}function Wo(t){const e=new Ko(t);return kn.set({get ignoreCloseAutoFocus(){return e.ignoreCloseAutoFocus}}),Er.set(e)}function Vo(t,e){return jt.set(new Ho(e,t,null))}function Jo(t){return new Uo(t,jt.get())}function Yo(t){return xt.set(new qo(t,jt.get()))}function Xo(t){const e=new Fr(t,xt.get());return new Rr(t,e)}function Qo(t,e){const r=new Rr(t,new Fr(t,xt.get()));return new Go(t,r,e)}function Zo(t){return $r.set(new jo(t,Er.get()))}function es(t){const e=Ut.getOr(null);if(e)return new Ct(t,e);const r=Do.getOr(null);return r?new Ct(t,r):new Ct(t,$r.get())}function ts(t){return Ut.set(new Bo(t,xt.get()))}var rs=L("<div><!></div>");function ns(t,e){de(e,!0);let r=E(e,"ref",15,null),n=E(e,"id",19,et),s=E(e,"disabled",3,!1),f=E(e,"onSelect",3,Re),a=E(e,"closeOnSelect",3,!0),u=xe(e,["$$slots","$$events","$$legacy","child","children","ref","id","disabled","onSelect","closeOnSelect"]);const c=Xo({id:U.with(()=>n()),disabled:U.with(()=>s()),onSelect:U.with(()=>f()),ref:U.with(()=>r(),l=>r(l)),closeOnSelect:U.with(()=>a())}),v=b(()=>De(u,c.props));var d=F(),i=k(d);{var g=l=>{var h=F(),m=k(h);ie(m,()=>e.child,()=>({props:o(v)})),_(l,h)},p=l=>{var h=rs();he(h,()=>({...o(v)}));var m=y(h);ie(m,()=>e.children??le),w(h),_(l,h)};q(i,l=>{e.child?l(g):l(p,!1)})}_(t,d),fe()}var os=L("<div><!></div>");function ss(t,e){de(e,!0);let r=E(e,"ref",15,null),n=E(e,"id",19,et),s=xe(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const f=Zo({id:U.with(()=>n()),ref:U.with(()=>r(),i=>r(i))}),a=b(()=>De(s,f.props));var u=F(),c=k(u);{var v=i=>{var g=F(),p=k(g);ie(p,()=>e.child,()=>({props:o(a)})),_(i,g)},d=i=>{var g=os();he(g,()=>({...o(a)}));var p=y(g);ie(p,()=>e.children??le),w(g),_(i,g)};q(c,i=>{e.child?i(v):i(d,!1)})}_(t,u),fe()}var as=L("<div><!></div>");function ar(t,e){de(e,!0);let r=E(e,"ref",15,null),n=E(e,"id",19,et),s=xe(e,["$$slots","$$events","$$legacy","children","child","ref","id"]);const f=es({id:U.with(()=>n()),ref:U.with(()=>r(),i=>r(i))}),a=b(()=>De(s,f.props));var u=F(),c=k(u);{var v=i=>{var g=F(),p=k(g);ie(p,()=>e.child,()=>({props:o(a)})),_(i,g)},d=i=>{var g=as();he(g,()=>({...o(a)}));var p=y(g);ie(p,()=>e.children??le),w(g),_(i,g)};q(c,i=>{e.child?i(v):i(d,!1)})}_(t,u),fe()}var is=L("<div><!></div>");function ls(t,e){de(e,!0);let r=E(e,"ref",15,null),n=E(e,"checked",15,!1),s=E(e,"id",19,et),f=E(e,"onCheckedChange",3,Re),a=E(e,"disabled",3,!1),u=E(e,"onSelect",3,Re),c=E(e,"closeOnSelect",3,!0),v=E(e,"indeterminate",15,!1),d=E(e,"onIndeterminateChange",3,Re),i=E(e,"value",3,""),g=xe(e,["$$slots","$$events","$$legacy","child","children","ref","checked","id","onCheckedChange","disabled","onSelect","closeOnSelect","indeterminate","onIndeterminateChange","value"]);const p=Ut.getOr(null);p&&i()&&(p.opts.value.current.includes(i())?n(!0):n(!1)),Ve.pre(()=>i(),()=>{p&&i()&&(p.opts.value.current.includes(i())?n(!0):n(!1))});const l=Qo({checked:U.with(()=>n(),I=>{n(I),f()(I)}),id:U.with(()=>s()),disabled:U.with(()=>a()),onSelect:U.with(()=>h),ref:U.with(()=>r(),I=>r(I)),closeOnSelect:U.with(()=>c()),indeterminate:U.with(()=>v(),I=>{v(I),d()(I)}),value:U.with(()=>i())},p);function h(I){u()(I),!I.defaultPrevented&&l.toggleChecked()}const m=b(()=>De(g,l.props));var M=F(),S=k(M);{var R=I=>{var x=F(),C=k(x);{let T=b(()=>({props:o(m),...l.snippetProps}));ie(C,()=>e.child,()=>o(T))}_(I,x)},O=I=>{var x=is();he(x,()=>({...o(m)}));var C=y(x);ie(C,()=>e.children??le,()=>l.snippetProps),w(x),_(I,x)};q(S,I=>{e.child?I(R):I(O,!1)})}_(t,M),fe()}var cs=L("<div><!></div>");function us(t,e){de(e,!0);let r=E(e,"id",19,et),n=E(e,"ref",15,null),s=E(e,"value",31,()=>Lt([])),f=E(e,"onValueChange",3,Re),a=xe(e,["$$slots","$$events","$$legacy","id","children","child","ref","value","onValueChange"]);const u=ts({value:U.with(()=>We(s()),p=>{s(We(p)),f()(p)}),onValueChange:U.with(()=>f()),ref:U.with(()=>n(),p=>n(p)),id:U.with(()=>r())}),c=b(()=>De(a,u.props));var v=F(),d=k(v);{var i=p=>{var l=F(),h=k(l);ie(h,()=>e.child,()=>({props:o(c)})),_(p,l)},g=p=>{var l=cs();he(l,()=>({...o(c)}));var h=y(l);ie(h,()=>e.children??le),w(l),_(p,l)};q(d,p=>{e.child?p(i):p(g,!1)})}_(t,v),fe()}function ds(t,e){de(e,!0);let r=E(e,"open",15,!1),n=E(e,"dir",3,"ltr"),s=E(e,"onOpenChange",3,Re),f=E(e,"_internal_variant",3,"dropdown-menu");const a=Wo({variant:U.with(()=>f()),dir:U.with(()=>n()),onClose:()=>{r(!1),s()(!1)}});Vo(a,{open:U.with(()=>r(),u=>{r(u),s()(u)})}),$n(t,{children:(u,c)=>{var v=F(),d=k(v);ie(d,()=>e.children??le),_(u,v)},$$slots:{default:!0}}),fe()}var fs=L("<div><div><!></div></div>"),vs=L("<!> <!>",1),ps=L("<div><div><!></div></div>"),hs=L("<!> <!>",1);function gs(t,e){de(e,!0);let r=E(e,"id",19,et),n=E(e,"ref",15,null),s=E(e,"loop",3,!0),f=E(e,"onInteractOutside",3,Re),a=E(e,"onEscapeKeydown",3,Re),u=E(e,"onCloseAutoFocus",3,Re),c=E(e,"forceMount",3,!1),v=xe(e,["$$slots","$$events","$$legacy","id","child","children","ref","loop","onInteractOutside","onEscapeKeydown","onCloseAutoFocus","forceMount"]);const d=Yo({id:U.with(()=>r()),loop:U.with(()=>s()),ref:U.with(()=>n(),S=>n(S)),onCloseAutoFocus:U.with(()=>u())}),i=b(()=>De(v,d.props));function g(S){d.handleInteractOutside(S),!S.defaultPrevented&&(f()(S),!S.defaultPrevented&&d.parentMenu.onClose())}function p(S){a()(S),!S.defaultPrevented&&d.parentMenu.onClose()}var l=F(),h=k(l);{var m=S=>{Fn(S,st(()=>o(i),()=>d.popperProps,{get enabled(){return d.parentMenu.opts.open.current},onInteractOutside:g,onEscapeKeydown:p,trapFocus:!0,get loop(){return s()},forceMount:!0,get id(){return r()},popper:(O,I)=>{let x=()=>I?.().props,C=()=>I?.().wrapperProps;const T=b(()=>De(x(),{style:Zt("dropdown-menu")}));var K=vs(),N=k(K);{var Y=D=>{var J=F(),X=k(J);{let ne=b(()=>({props:o(T),wrapperProps:C(),...d.snippetProps}));ie(X,()=>e.child,()=>o(ne))}_(D,J)},B=D=>{var J=fs();he(J,()=>({...C()}));var X=y(J);he(X,()=>({...o(T)}));var ne=y(X);ie(ne,()=>e.children??le),w(X),w(J),_(D,J)};q(N,D=>{e.child?D(Y):D(B,!1)})}var j=P(N,2);or(j,{get mounted(){return d.mounted},set mounted(D){d.mounted=D}}),_(O,K)},$$slots:{popper:!0}}))},M=S=>{var R=F(),O=k(R);{var I=x=>{Rn(x,st(()=>o(i),()=>d.popperProps,{get present(){return d.parentMenu.opts.open.current},onInteractOutside:g,onEscapeKeydown:p,trapFocus:!0,get loop(){return s()},forceMount:!1,get id(){return r()},popper:(T,K)=>{let N=()=>K?.().props,Y=()=>K?.().wrapperProps;const B=b(()=>De(N(),{style:Zt("dropdown-menu")}));var j=hs(),D=k(j);{var J=ae=>{var ve=F(),ge=k(ve);{let ce=b(()=>({props:o(B),wrapperProps:Y(),...d.snippetProps}));ie(ge,()=>e.child,()=>o(ce))}_(ae,ve)},X=ae=>{var ve=ps();he(ve,()=>({...Y()}));var ge=y(ve);he(ge,()=>({...o(B)}));var ce=y(ge);ie(ce,()=>e.children??le),w(ge),w(ve),_(ae,ve)};q(D,ae=>{e.child?ae(J):ae(X,!1)})}var ne=P(D,2);or(ne,{get mounted(){return d.mounted},set mounted(ae){d.mounted=ae}}),_(T,j)},$$slots:{popper:!0}}))};q(O,x=>{c()||x(I)},!0)}_(S,R)};q(h,S=>{c()?S(m):S(M,!1)})}_(t,l),fe()}var ms=L("<button><!></button>");function _s(t,e){de(e,!0);let r=E(e,"id",19,et),n=E(e,"ref",15,null),s=E(e,"disabled",3,!1),f=E(e,"type",3,"button"),a=xe(e,["$$slots","$$events","$$legacy","id","ref","child","children","disabled","type"]);const u=Jo({id:U.with(()=>r()),disabled:U.with(()=>s()??!1),ref:U.with(()=>n(),v=>n(v))}),c=b(()=>De(a,u.props,{type:f()}));Ln(t,{get id(){return r()},children:(v,d)=>{var i=F(),g=k(i);{var p=h=>{var m=F(),M=k(m);ie(M,()=>e.child,()=>({props:o(c)})),_(h,m)},l=h=>{var m=ms();he(m,()=>({...o(c)}));var M=y(m);ie(M,()=>e.children??le),w(m),_(h,m)};q(g,h=>{e.child?h(p):h(l,!1)})}_(v,i)},$$slots:{default:!0}}),fe()}let ut=ee(!1);class Be{static _refs=0;static _cleanup;constructor(){we(()=>(Be._refs===0&&(Be._cleanup=Jr(()=>{const e=[],r=s=>{A(ut,!1)},n=s=>{A(ut,!0)};return e.push(ot(document,"pointerdown",r,{capture:!0}),ot(document,"pointermove",r,{capture:!0}),ot(document,"keydown",n,{capture:!0})),wr(...e)})),Be._refs++,()=>{Be._refs--,Be._refs===0&&(A(ut,!1),Be._cleanup?.())}))}get current(){return o(ut)}set current(e){A(ut,e,!0)}}var bs=L("<!> <!>",1),ws=L("<!> <!>",1),ys=L("<!> <!>",1),xs=L("<!> <!>",1);function Lr(t,e){de(e,!0);const r=E(e,"selectableItems",19,()=>[]),n=E(e,"help",3,""),s=xe(e,["$$slots","$$events","$$legacy","items","item","selectableItems","trigger","testid","help"]),f=b(()=>({trigger:e.testid?`${e.testid}-open`:void 0,content:e.testid?`${e.testid}-options`:void 0}));let a=ee(!1);var u=F(),c=k(u);Te(c,()=>ds,(v,d)=>{d(v,{get open(){return o(a)},children:(i,g)=>{var p=xs(),l=k(p);{const m=(M,S)=>{let R=()=>S?.().props;var O=F(),I=k(O);{let x=b(()=>({...R(),onclick:()=>{A(a,!o(a))}}));ie(I,()=>e.trigger,()=>o(x))}_(M,O)};Te(l,()=>_s,(M,S)=>{S(M,st(()=>s,{get"data-testid"(){return o(f).trigger},child:m,$$slots:{child:!0}}))})}var h=P(l,2);Te(h,()=>xo,(m,M)=>{M(m,{children:(S,R)=>{var O=F(),I=k(O);Te(I,()=>gs,(x,C)=>{C(x,{get"data-testid"(){return o(f).content},children:(T,K)=>{var N=ys(),Y=k(N);{let j=b(()=>r().filter(D=>D.selected).map(D=>D.key.toString()));Te(Y,()=>us,(D,J)=>{J(D,{get value(){return o(j)},children:(X,ne)=>{var ae=bs(),ve=k(ae);{var ge=se=>{var oe=F(),Se=k(oe);Te(Se,()=>ar,(Ie,Me)=>{Me(Ie,{children:(Le,Oe)=>{Ge();var Ce=Ee();W(()=>G(Ce,n())),_(Le,Ce)},$$slots:{default:!0}})}),_(se,oe)};q(ve,se=>{n()&&se(ge)})}var ce=P(ve,2);Qe(ce,17,r,se=>se.label,(se,oe)=>{var Se=F(),Ie=k(Se);{let Me=b(()=>o(oe).key.toString());Te(Ie,()=>ls,(Le,Oe)=>{Oe(Le,{get checked(){return o(oe).selected},get onSelect(){return o(oe).onclick},get value(){return o(Me)},get textValue(){return o(oe).label},get"aria-label"(){return o(oe).label},children:(Ce,Ke)=>{var He=F(),qe=k(He);{var ke=te=>{var re=F(),me=k(re);ie(me,()=>e.item,()=>o(oe)),_(te,re)},z=te=>{var re=Ee();W(()=>G(re,o(oe).label)),_(te,re)};q(qe,te=>{e.item?te(ke):te(z,!1)})}_(Ce,He)},$$slots:{default:!0}})})}_(se,Se)}),_(X,ae)},$$slots:{default:!0}})})}var B=P(Y,2);Te(B,()=>ss,(j,D)=>{D(j,{children:(J,X)=>{var ne=ws(),ae=k(ne);{var ve=ce=>{var se=F(),oe=k(se);Te(oe,()=>ar,(Se,Ie)=>{Ie(Se,{children:(Me,Le)=>{Ge();var Oe=Ee();W(()=>G(Oe,n())),_(Me,Oe)},$$slots:{default:!0}})}),_(ce,se)};q(ae,ce=>{n()&&!r().length&&ce(ve)})}var ge=P(ae,2);Qe(ge,17,()=>e.items,ce=>ce.label,(ce,se)=>{var oe=F(),Se=k(oe);Te(Se,()=>ns,(Ie,Me)=>{Me(Ie,{get textValue(){return o(se).label},get onSelect(){return o(se).onclick},get"aria-label"(){return o(se).label},children:(Le,Oe)=>{var Ce=F(),Ke=k(Ce);{var He=ke=>{var z=F(),te=k(z);ie(te,()=>e.item,()=>o(se)),_(ke,z)},qe=ke=>{var z=Ee();W(()=>G(z,o(se).label)),_(ke,z)};q(Ke,ke=>{e.item?ke(He):ke(qe,!1)})}_(Le,Ce)},$$slots:{default:!0}})}),_(ce,oe)}),_(J,ne)},$$slots:{default:!0}})}),_(T,N)},$$slots:{default:!0}})}),_(S,O)},$$slots:{default:!0}})}),_(i,p)},$$slots:{default:!0}})}),_(t,u),fe()}var Ms=L('<button role="radio" class="option svelte-13njdm8"> </button>'),ks=L("<div></div>");function Rt(t,e){de(e,!0);let r=E(e,"value",15),n=xe(e,["$$slots","$$events","$$legacy","options","labels","value","customOption","clickable-custom-options","onchange"]);var s=ks();he(s,()=>({class:"segmented-group",role:"radiogroup",...n}),void 0,void 0,"svelte-13njdm8"),Qe(s,20,()=>e.options,f=>f,(f,a)=>{var u=F(),c=k(u);{var v=i=>{var g=Ms();g.__click=()=>{r(a),e.onchange?.(a)};var p=y(g,!0);w(g),W(()=>{Ae(g,"aria-checked",a===r()),G(p,e.labels?.[a]??a)}),_(i,g)},d=i=>{var g=F(),p=k(g);Un(p,()=>e["clickable-custom-options"]?"button":"div",!1,(l,h)=>{var m=()=>{e["clickable-custom-options"]&&(r(a),e.onchange?.(a))};he(l,()=>({role:"radio","aria-checked":a===r(),class:"option",onclick:m}),void 0,void 0,"svelte-13njdm8");var M=F(),S=k(M);ie(S,()=>e.customOption,()=>a),_(h,M)}),_(i,g)};q(c,i=>{!e.customOption||e.labels?.[a]?i(v):i(d,!1)})}_(f,u)}),w(s),_(t,s),fe()}Nt(["click"]);var Ps=L('<!> <section class="progress svelte-1h3fgf1"><!></section> <!>',1),Ss=L('<div class="numeric svelte-1h3fgf1"><!> </div>'),Cs=L('<div class="include svelte-1h3fgf1"><!></div> <section><div class="label svelte-1h3fgf1"> </div> <!> <p class="fineprint svelte-1h3fgf1"> </p></section>',1),As=L('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Is(t,e){de(e,!0);const r=b(()=>Je(Ye("main")));let n=E(e,"open",15);const s=b(()=>H.processing.progress);let f=ee(!1),a=ee("croppedonly"),u=b(()=>ct(H.currentProtocol?.crop.padding??"0px")),c=b(()=>o(u).unitless===0?"none":o(u).unit==="px"?"customPixels":o(u).unitless===5?"small":o(u).unitless===10?"medium":"customPercent");we(()=>{switch(o(c)){case"none":A(u,ct("0px"));break;case"small":A(u,ct("5%"));break;case"medium":A(u,ct("10%"));break}});async function v(){await ye.clear("exporter"),H.processing.reset(),A(f,!0);const g=ze.Protocol.state.find(p=>p.id===H.currentProtocolId);if(!g){ye.error(o(r).t(35)),A(f,!1);return}try{await mn(),H.processing.task="export",H.processing.total=1,H.processing.done=0;const p=await e.swarpc.generateResultsZip({include:o(a),protocolId:g.id,cropPadding:o(u).withUnit,jsonSchemaURL:new URL(an("/results.schema.json"),je.url.origin).toString()},({warning:l,progress:h})=>{if(l){const[m,{filename:M}]=l;switch(m){case"exif-write-error":ye.warn(`Impossible d'ajouter les métadonnées EXIF à l'image ${M}`);break}}h&&(H.processing.done=h)});qn(p,"results.zip","application/zip")}catch(p){console.error(p),ye.error(`Erreur lors de l'exportation des résultats: ${p}`)}finally{A(f,!1)}}var d=As(),i=k(d);{const g=l=>{var h=Ps(),m=k(h);dn(m,{pool:"exporter"});var M=P(m,2),S=y(M);Gt(S,{percentage:!0,alwaysActive:!0,get progress(){return o(s)}}),w(M);var R=P(M,2);{const O=I=>{var x=F(),C=k(x);{var T=N=>{Sr(N,{})},K=N=>{Hn(N,{})};q(C,N=>{o(f)?N(T):N(K,!1)})}_(I,x)};wt(R,{onclick:v,_w_snippet_0:O,children:(I,x)=>{{let C=b(()=>[O]),T=b(()=>o(r).cx(21));Ue(I,{get t(){return o(C)},get x(){return o(T)}})}},$$slots:{_w_snippet_0:!0,default:!0}})}_(l,h)};let p=b(()=>o(r).t(95));vt(i,()=>({"--footer-direction":"column"})),Dt(i.lastChild,{key:"modal_export_results",get title(){return o(p)},onopen:()=>{ye.setCurrentPool("exporter")},onclose:()=>{ye.setCurrentPool("default"),H.processing.reset()},get open(){return n()},set open(l){n(l)},footer:g,children:(l,h)=>{var m=Cs(),M=k(m),S=y(M);jn(S,{options:[{key:"metadataonly",label:"Métadonnées seulement"},{key:"croppedonly",label:"Métadonnées et images recadrées"},{key:"full",label:"Métadonnées, images recadrées et images originales",subtext:"Permet de ré-importer les résultats ultérieurement"}],get value(){return o(a)},set value(N){A(a,N,!0)}}),w(M);var R=P(M,2);let O;var I=y(R),x=y(I,!0);w(I);var C=P(I,2);Rt(C,{options:["none","small","medium","customPercent","customPixels"],labels:{none:"Aucune",small:"5%",medium:"10%"},get value(){return o(c)},set value(Y){A(c,Y)},customOption:(Y,B=le)=>{const j=b(()=>B()==="customPercent"?"%":"px");var D=Ss();let J;var X=y(D);{let ae=b(()=>B()==="customPercent"?"en pourcentage des dimensions de l'image":"en pixels"),ve=b(()=>o(u).unitless===0?"0":o(u).unit===o(j)?o(u).unitless.toString():"?");Pr(X,{get label(){return o(ae)},get value(){return o(ve)},onblur:async ge=>{await Yr();const ce=Number.parseInt(ge,10);!isNaN(ce)&&ce>0&&(A(u,ct(ce+o(j))),A(c,B()))}})}var ne=P(X);w(D),W(()=>{J=ur(D,"",J,{"--width":o(j)==="%"?"3ch":"4ch"}),G(ne,` ${o(j)??""}`)}),_(Y,D)},$$slots:{customOption:!0}});var T=P(C,2),K=y(T,!0);w(T),w(R),W((N,Y)=>{O=dt(R,1,"crop-padding svelte-1h3fgf1",null,O,{irrelevant:o(a)==="metadataonly"}),G(x,N),G(K,Y)},[()=>o(r).t(126),()=>o(r).t(190)]),_(l,m)},$$slots:{footer:!0,default:!0}}),w(i)}_(t,d),fe()}var Os=Ze('<svg><path fill="currentColor" d="M18.207 9.043L12 2.836L5.793 9.043l1.414 1.414L12 5.664l4.793 4.793zM5.793 14.957L12 21.164l6.207-6.207l-1.414-1.414L12 18.336l-4.793-4.793z"></path></svg>');function Ts(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Os();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Es=L("<button><!> <!></button>"),$s=L('<code class="svelte-1b302ru"> </code>'),Fs=L("<!> <!>",1),Rs=L('<div class="item svelte-1b302ru"><div class="label svelte-1b302ru"><div class="icon svelte-1b302ru"><!></div> </div> <div class="version svelte-1b302ru"><!></div></div>');function Ls(t,e){de(e,!0);const r=b(()=>Je(Ye("main")));{const n=(a,u=le)=>{var c=Es();he(c,()=>({class:"trigger",...u(),[on]:{"none-selected":!H.currentProtocol}}),void 0,void 0,"svelte-1b302ru");var v=y(c);{var d=p=>{var l=Ee();W(()=>G(l,H.currentProtocol?.name)),_(p,l)},i=p=>{var l=Ee();W(h=>G(l,h),[()=>o(r).t(35)]),_(p,l)};q(v,p=>{H.currentProtocol?p(d):p(i,!1)})}var g=P(v,2);Ts(g,{}),w(c),_(a,c)},s=(a,u)=>{let c=()=>u?.().label,v=()=>u?.().protocol;var d=Rs(),i=y(d),g=y(i),p=y(g);{var l=O=>{kr(O,{})},h=O=>{var I=F(),x=k(I);{var C=T=>{Bn(T,{})};q(x,T=>{v()||T(C)},!0)}_(O,I)};q(p,O=>{H.currentProtocolId===v()?.id?O(l):O(h,!1)})}w(g);var m=P(g);w(i);var M=P(i,2),S=y(M);{var R=O=>{var I=Fs(),x=k(I);{var C=K=>{var N=$s(),Y=y(N);w(N),vr(N,(B,j)=>pr?.(B,j),()=>"Version du protocole"),W(()=>G(Y,`v${v().version??""}`)),_(K,N)};q(x,K=>{v().version&&K(C)})}var T=P(x,2);zn(T,st({compact:!0},v)),_(O,I)};q(S,O=>{v()&&O(R)})}w(M),w(d),W(()=>G(m,` ${c()??""}`)),_(a,d)};let f=b(()=>ze.Protocol.state.map(a=>({protocol:a,key:a.id,label:a.name,selected:H.currentProtocolId===a.id,onclick(){H.setCurrentProtocolId(a.id)}})));Lr(t,{testid:"protocol-switcher",items:[{protocol:null,label:"Gérer les protocoles",onclick(){tt("/protocols")}}],get selectableItems(){return o(f)},trigger:n,item:s,$$slots:{trigger:!0,item:!0}})}fe()}var Ns=Ze('<svg><path fill="currentColor" d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2h.1A6.98 6.98 0 0 0 10 7m-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938A8 8 0 0 0 4 12"></path></svg>');function Ds(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Ns();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var zs=Ze('<svg><path fill="currentColor" d="M3.34 17a10 10 0 0 1-.979-2.326a3 3 0 0 0 .003-5.347a10 10 0 0 1 2.5-4.337a3 3 0 0 0 4.632-2.674a10 10 0 0 1 5.007.003a3 3 0 0 0 4.632 2.671a10.06 10.06 0 0 1 2.503 4.336a3 3 0 0 0-.002 5.347a10 10 0 0 1-2.501 4.337a3 3 0 0 0-4.632 2.674a10 10 0 0 1-5.007-.002a3 3 0 0 0-4.631-2.672A10 10 0 0 1 3.339 17m5.66.196a5 5 0 0 1 2.25 2.77q.75.07 1.499.002a5 5 0 0 1 2.25-2.772a5 5 0 0 1 3.526-.564q.435-.614.748-1.298A5 5 0 0 1 18 12c0-1.26.47-2.437 1.273-3.334a8 8 0 0 0-.75-1.298A5 5 0 0 1 15 6.804a5 5 0 0 1-2.25-2.77q-.75-.071-1.5-.001A5 5 0 0 1 9 6.804a5 5 0 0 1-3.526.564q-.436.614-.747 1.298A5 5 0 0 1 6 12c0 1.26-.471 2.437-1.273 3.334a8 8 0 0 0 .75 1.298A5 5 0 0 1 9 17.196M12 15a3 3 0 1 1 0-6a3 3 0 0 1 0 6m0-2a1 1 0 1 0 0-2a1 1 0 0 0 0 2"></path></svg>');function Ks(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=zs();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Hs=Ze('<svg><path fill="currentColor" d="m19 3l4 5h-3v12h-2V8h-3zm-5 15v2H3v-2zm0-7v2H3v-2zm-2-7v2H3V4z"></path></svg>');function qs(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Hs();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Gs=Ze('<svg><path fill="currentColor" d="M20 4v12h3l-4 5l-4-5h3V4zm-8 14v2H3v-2zm2-7v2H3v-2zm0-7v2H3V4z"></path></svg>');function js(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Gs();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Us=Ze('<svg><path fill="currentColor" d="M5 11v2h14v-2z"></path></svg>');function Bs(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Us();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Ws=Ze('<svg><path fill="currentColor" d="M12 18a6 6 0 1 1 0-12a6 6 0 0 1 0 12m0-2a4 4 0 1 0 0-8a4 4 0 0 0 0 8M11 1h2v3h-2zm0 19h2v3h-2zM3.515 4.929l1.414-1.414L7.05 5.636L5.636 7.05zM16.95 18.364l1.414-1.414l2.121 2.121l-1.414 1.414zm2.121-14.85l1.414 1.415l-2.121 2.121l-1.414-1.414zM5.636 16.95l1.414 1.414l-2.121 2.121l-1.414-1.414zM23 11v2h-3v-2zM4 11v2H1v-2z"></path></svg>');function Vs(t,e){const r=xe(e,["$$slots","$$events","$$legacy"]);var n=Ws();he(n,()=>({class:"icon",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...r})),_(t,n)}var Js=L('<p class="details svelte-qprabs"> </p>'),Ys=L("<a> </a>"),Xs=L("<a> </a>"),Qs=L('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <dialog class="container svelte-qprabs" data-testid="app-settings"><header class="svelte-qprabs"> </header> <div class="listParam svelte-qprabs"><div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!> <!></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><input type="range" min="0.5" max="2" step="0.01" list="gridsize-marks"/> <datalist id="gridsize-marks"><option></option></datalist></div> <div class="label svelte-qprabs"> </div> <div class="setting svelte-qprabs"><!></div> <div class="label svelte-qprabs"><!></div> <div class="setting svelte-qprabs"><!> <div class="number-input svelte-qprabs"><!></div> <!></div></div> <section class="actions svelte-qprabs"><!> <!></section> <footer class="svelte-qprabs"><!></footer></dialog>',1);function Zs(t,e){de(e,!0);const r=b(()=>Je(Ye("main")));let n=ee(!1),s=ee(void 0);we(()=>{window.addEventListener("mouseup",({target:$})=>{$!==o(s)&&(o(s)?.contains($)||A(n,!1))})});const f=b(Tt),a=b(()=>o(f).theme),u=b(()=>o(f).showTechnicalMetadata),c=b(()=>o(f).gallerySort),v=b(()=>o(f).gridSize),d=b(()=>o(f).language),i=b(()=>o(f).parallelism);let g=ee(!0);we(()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",$=>{A(g,!$.matches)})});const p=b(()=>{const $=Tt().theme;return $==="auto"?o(g)?"light":"dark":$});dr(()=>o(p),$=>{window.nativeWindow?.setControlsColor(getComputedStyle(document.documentElement).getPropertyValue(`--${$}__fg-primary`))});var l=Qs(),h=k(l);{let $=b(()=>o(n)?"Fermer":"Réglages");vt(h,()=>({"--fg":"var(--trigger-fg)","--bg":"var(--trigger-bg)","--hover-fg":"var(--trigger-hover-fg)","--hover-bg":"var(--trigger-hover-bg)"})),nt(h.lastChild,{"data-testid":"settings-button",get help(){return o($)},onclick:()=>{A(n,!o(n))},children:(V,Q)=>{var Z=F(),ue=k(Z);{var pe=_e=>{Jn(_e,{})},Pe=_e=>{Ks(_e,{})};q(ue,_e=>{o(n)?_e(pe):_e(Pe,!1)})}_(V,Z)},$$slots:{default:!0}}),w(h)}var m=P(h,2),M=y(m),S=y(M,!0);w(M);var R=P(M,2),O=y(R),I=y(O,!0);w(O);var x=P(O,2),C=y(x);{let $=b(()=>o(a)==="auto"?o(g):o(a)==="light"),V=b(()=>({on:Vs,off:Ds}));er(C,{get value(){return o($)},onchange:async Q=>{await Fe("theme",Q?"light":"dark")},get icons(){return o(V)}})}var T=P(C,2);{let $=b(()=>o(a)==="auto"),V=b(()=>o(r).t(176));nt(T,{get disabled(){return o($)},onclick:async()=>await Fe("theme","auto"),get help(){return o(V)},children:(Q,Z)=>{Yn(Q,{})},$$slots:{default:!0}})}w(x);var K=P(x,2),N=y(K,!0);w(K);var Y=P(K,2),B=y(Y);er(B,{"data-testid":"debug-mode",get value(){return o(u)},onchange:async $=>{await Fe("showTechnicalMetadata",$)}}),w(Y);var j=P(Y,2),D=y(j,!0);w(j);var J=P(j,2),X=y(J),ne=()=>o(c).key,ae=$=>Fe("gallerySort",{...o(c),key:$});{let $=b(()=>o(r).t(144));Rt(X,{get"aria-label"(){return o($)},options:["filename","date"],get value(){return ne()},set value(V){ae(V)},labels:{filename:"Fichier",date:"Date"}})}var ve=P(X,2);{let $=b(()=>o(c).direction==="asc"?"Trier par ordre décroissant":"Trier par ordre croissant");nt(ve,{"data-testid":"toggle-sort-direction",onclick:async()=>await Fe("gallerySort",{...o(c),direction:o(c).direction==="asc"?"desc":"asc"}),get help(){return o($)},children:(V,Q)=>{var Z=F(),ue=k(Z);{var pe=_e=>{qs(_e,{})},Pe=_e=>{js(_e,{})};q(ue,_e=>{o(c).direction==="asc"?_e(pe):_e(Pe,!1)})}_(V,Z)},$$slots:{default:!0}})}w(J);var ge=P(J,2),ce=y(ge,!0);w(ge);var se=P(ge,2),oe=y(se);sn(oe);var Se=P(oe,2),Ie=y(Se);Ie.value=Ie.__value="1",w(Se),w(se);var Me=P(se,2),Le=y(Me,!0);w(Me);var Oe=P(Me,2),Ce=y(Oe);{const $=(Q,Z=le)=>{const ue=b(()=>({en:"English",fr:"Français",ja:"日本語"}));Ge();var pe=Ee();W(()=>G(pe,o(ue)[Z()]||Z())),_(Q,pe)};let V=b(()=>o(r).t(122));Rt(Ce,{"data-testid":"language-selection",get"aria-label"(){return o(V)},"clickable-custom-options":!0,options:["en","fr"],get value(){return o(d)},onchange:async Q=>{await Fe("language",Q),window.location.reload()},customOption:$,$$slots:{customOption:!0}})}w(Oe);var Ke=P(Oe,2);{const $=(V,Q=le)=>{var Z=Js(),ue=y(Z,!0);w(Z),W(pe=>G(ue,pe),[()=>o(r).tx(Q())]),_(V,Z)};var He=y(Ke);{let V=b(()=>[$]),Q=b(()=>o(r).cx(372));Ue(He,{get t(){return o(V)},get x(){return o(Q)}})}w(Ke)}var qe=P(Ke,2),ke=y(qe);{let $=b(()=>o(r).t(373));nt(ke,{get help(){return o($)},onclick:async()=>{await Fe("parallelism",Math.max(1,o(i)-1))},children:(V,Q)=>{Bs(V,{})},$$slots:{default:!0}})}var z=P(ke,2),te=y(z);{let $=b(()=>o(r).t(374));Pr(te,{get label(){return o($)},get value(){return o(i)},onblur:async V=>{await Fe("parallelism",Number.parseInt(V))}})}w(z);var re=P(z,2);{let $=b(()=>o(r).t(375));nt(re,{get help(){return o($)},onclick:async()=>{await Fe("parallelism",o(i)+1)},children:(V,Q)=>{Vn(V,{})},$$slots:{default:!0}})}w(qe),w(R);var me=P(R,2),$e=y(me);wt($e,{onclick:()=>{e.openKeyboardShortcuts?.()},children:($,V)=>{Ge();var Q=Ee();W(Z=>G(Q,Z),[()=>o(r).t(153)]),_($,Q)},$$slots:{default:!0}});var be=P($e,2);{let $=b(()=>o(r).t(189));wt(be,{get help(){return o($)},onclick:()=>{e.openPrepareForOfflineUse?.()},children:(V,Q)=>{Ge();var Z=Ee();W(ue=>G(Z,ue),[()=>o(r).t(151)]),_(V,Z)},$$slots:{default:!0}})}w(me);var Ne=P(me,2);{const $=Q=>{var Z=Ys(),ue=y(Z,!0);w(Z),W(pe=>{Ae(Z,"href","https://github.com/cigaleapp/cigale/tree/6370a5b592af438ca09fd971001db68c0182e248"),G(ue,pe)},[()=>"6370a5b592af438ca09fd971001db68c0182e248".slice(0,7)]),_(Q,Z)},V=(Q,Z=le)=>{var ue=Xs();ue.__click=()=>{A(n,!1)};var pe=y(ue,!0);w(ue),W((Pe,_e)=>{Ae(ue,"href",Pe),G(pe,_e)},[()=>rt("/about"),()=>o(r).tx(Z())]),_(Q,ue)};var Mt=y(Ne);{let Q=b(()=>[$,V]),Z=b(()=>o(r).cx(46));Ue(Mt,{get t(){return o(Q)},get x(){return o(Z)}})}w(Ne)}w(m),Wn(m,$=>A(s,$),()=>o(s)),W(($,V,Q,Z,ue,pe)=>{Ae(m,"data-theme",o(a)),m.open=o(n)?!0:void 0,G(S,$),G(I,V),G(N,Q),G(D,Z),G(ce,ue),G(Le,pe)},[()=>o(r).t(163),()=>o(r).t(184),()=>o(r).t(133),()=>o(r).t(187),()=>o(r).t(181),()=>o(r).t(121)]),rn("blur",oe,async()=>Fe("gridSize",o(v))),Gn(oe,()=>o(v),$=>{const V=ze.Settings.state;V[V.findIndex(Q=>Q.id==="user")].gridSize=$}),_(t,l),fe()}Nt(["click"]);var ea=L('<div class="selected-model-indicator svelte-1nmekgl"><!></div> ',1),ta=L('<div class="inference svelte-1nmekgl"><!></div>'),ra=L('<div class="line svelte-1nmekgl"></div>'),na=L('<div class="line svelte-1nmekgl"></div>'),oa=L('<div class="line svelte-1nmekgl"></div>'),sa=L('<!> <!> <header><div class="progressbar svelte-1nmekgl"><!></div> <nav data-testid="app-nav"><div class="logo svelte-1nmekgl"><a class="svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></a> <!></div> <div class="steps svelte-1nmekgl"><a data-testid="goto-import" class="svelte-1nmekgl"><!></a> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-crop" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <div class="with-inference-indicator svelte-1nmekgl"><a data-testid="goto-classify" class="svelte-1nmekgl"><!></a> <!></div> <div class="separator svelte-1nmekgl"><!></div> <!></div> <aside><!> <div class="settings svelte-1nmekgl"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div></aside></nav></header>',1);function aa(t,e){de(e,!0);const r=(z,te=le,re=le,me=le,$e=le)=>{var be=ta(),Ne=y(be);{var Mt=$=>{{const V=(pe,Pe=le)=>{nt(pe,st({help:""},Pe,{children:(_e,Wt)=>{Nn(_e,{})},$$slots:{default:!0}}))},Q=(pe,Pe)=>{let _e=()=>Pe?.().label,Wt=()=>Pe?.().key;var Vt=ea(),kt=k(Vt),Hr=y(kt);{var qr=Pt=>{kr(Pt,{})};q(Hr,Pt=>{Wt()===me()&&Pt(qr)})}w(kt);var Gr=P(kt);W(()=>G(Gr,` ${_e()??""}`)),_(pe,Vt)};let Z=b(()=>o(n).t(134)),ue=b(()=>[{key:-1,label:"Aucune inférence",selected:me()===-1,onclick:()=>$e()(-1)},...re().map((pe,Pe)=>({key:Pe,label:pe.name??"",onclick:()=>$e()(Pe),selected:me()===Pe}))]);Lr($,{get testid(){return`${te()??""}-models`},get help(){return o(Z)},items:[],get selectableItems(){return o(ue)},trigger:V,item:Q,$$slots:{trigger:!0,item:!0}})}};q(Ne,$=>{H.currentProtocol&&$(Mt)})}w(be),_(z,be)},n=b(()=>Je(Ye("main")));let s=E(e,"progress",3,0),f=E(e,"floating",3,!1);const a=b(()=>je.url.hash.replace(/^#/,"")),u=b(()=>ze.Image.state.length>0);let c=ee(void 0),v=ee(void 0),d=ee(void 0),i=ee(!0),g=ee(!1),p=ee(!1);we(()=>{A(p,"nativeWindow"in window)}),we(()=>{o(v)&&window.nativeWindow?.setControlsHeight(o(v))}),we(()=>{window.nativeWindow?.setProgress(hr(s(),0,1)),s()>=1&&window.nativeWindow?.startCallingAttention()}),we(()=>{if(o(p))return;const z=document.title.replace(/^(⏳ \d+% ·|🆗) /,"");s()>=1||o(g)?document.title=`🆗 ${z}`:s()===0?document.title=z:document.title=`⏳ ${ln(s())} · ${z}`}),we(()=>{document.addEventListener("processing-queue-drained",()=>{o(i)||A(g,!0)}),window.addEventListener("focus",()=>{A(g,!1),A(i,!0)}),window.addEventListener("blur",()=>{A(i,!1)})}),Ot("navigation",{"g p":{do:()=>tt("/"),help:o(n).t(61)},"g i":{do:()=>tt("/import"),help:o(n).t(110)},"g r":{do:()=>tt("/crop"),help:o(n).t(156)},"g n":{do:()=>tt("/classify"),help:o(n).t(66)},"g x":{do:()=>o(d)(),help:o(n).t(95)},"g m":{do:()=>tt("/protocols/"),help:o(n).t(101)}});var l=sa(),h=k(l);Is(h,{get swarpc(){return e.swarpc},get open(){return o(d)},set open(z){A(d,z,!0)}});var m=P(h,2);q(m,z=>{});var M=P(m,2);let S;var R=y(M),O=y(R);{let z=b(()=>H.processing.task==="export"?0:s());Gt(O,{get progress(){return o(z)}})}w(R);var I=P(R,2);let x;var C=y(I),T=y(C),K=y(T);vt(K,()=>({"--stroke-width":"75","--size":"2rem","--fill":"transparent"})),Kn(K.lastChild,{}),w(K),w(T);var N=P(T,2);q(N,z=>{}),w(C);var Y=P(C,2),B=y(Y);{const z=te=>{var re=F(),me=k(re);{var $e=be=>{var Ne=ra();_(be,Ne)};q(me,be=>{o(a)=="/import"&&be($e)})}_(te,re)};var j=y(B);{let te=b(()=>[z]),re=b(()=>o(n).cx(109));Ue(j,{get t(){return o(te)},get x(){return o(re)}})}w(B)}var D=P(B,2),J=y(D);St(J,{}),w(D);var X=P(D,2),ne=y(X);{const z=te=>{var re=F(),me=k(re);{var $e=be=>{var Ne=na();_(be,Ne)};q(me,be=>{o(a).startsWith("/crop")&&be($e)})}_(te,re)};var ae=y(ne);{let te=b(()=>[z]),re=b(()=>o(n).cx(155));Ue(ae,{get t(){return o(te)},get x(){return o(re)}})}w(ne)}var ve=P(ne,2);r(ve,()=>"crop",()=>H.cropModels,()=>H.selectedCropModel,()=>z=>H.setModelSelections({crop:z})),w(X);var ge=P(X,2),ce=y(ge);St(ce,{}),w(ge);var se=P(ge,2),oe=y(se);{const z=te=>{var re=F(),me=k(re);{var $e=be=>{var Ne=oa();_(be,Ne)};q(me,be=>{o(a)=="/classify"&&be($e)})}_(te,re)};var Se=y(oe);{let te=b(()=>[z]),re=b(()=>o(n).cx(65));Ue(Se,{get t(){return o(te)},get x(){return o(re)}})}w(oe)}var Ie=P(oe,2);r(Ie,()=>"classify",()=>H.classificationModels,()=>H.selectedClassificationModel,()=>z=>H.setModelSelections({classification:z})),w(se),vr(se,(z,te)=>pr?.(z,te),()=>H.processing.task==="detection"&&H.processing.progress<1?"Veuillez attendre la fin de l'analyse des images avant de les classifier":void 0);var Me=P(se,2),Le=y(Me);St(Le,{}),w(Me);var Oe=P(Me,2);wt(Oe,{testid:"export-results-button",tight:!0,get onclick(){return o(d)},children:(z,te)=>{Ge();var re=Ee();W(me=>G(re,me),[()=>o(n).t(13)]),_(z,re)},$$slots:{default:!0}}),w(Y);var Ce=P(Y,2);let Ke;var He=y(Ce);Ls(He,{});var qe=P(He,2),ke=y(qe);vt(ke,()=>({"--navbar-height":`${o(c)??""}px`})),Zs(ke.lastChild,{get openPrepareForOfflineUse(){return e.openPrepareForOfflineUse},get openKeyboardShortcuts(){return e.openKeyboardShortcuts}}),w(ke),w(qe),w(Ce),w(I),w(M),W((z,te,re,me)=>{S=dt(M,1,"svelte-1nmekgl",null,S,{"native-window":o(p)}),x=dt(I,1,"svelte-1nmekgl",null,x,{floating:f()}),Ae(T,"href",z),Ae(B,"href",te),Ae(B,"aria-disabled",!H.currentProtocol),Ae(ne,"href",re),Ae(ne,"aria-disabled",!H.currentProtocol||!o(u)),Ae(oe,"href",me),Ae(oe,"aria-disabled",!H.currentProtocol||!o(u)||H.processing.task==="detection"&&H.processing.progress<1),Ke=dt(Ce,1,"svelte-1nmekgl",null,Ke,{native:o(p)})},[()=>rt("/"),()=>rt("/import"),()=>je.route.id!=="/(app)/(sidepanel)/crop/[image]"&&H.imageOpenedInCropper?rt("/(app)/(sidepanel)/crop/[image]",{image:H.imageOpenedInCropper}):rt("/crop"),()=>rt("/classify")]),Qt(I,"clientHeight",z=>A(v,z)),Qt(M,"clientHeight",z=>A(c,z)),_(t,l),fe()}Nt(["click"]);async function ia(t,e){const r=ze.Protocol.state.filter(f=>t.includes(f.id));if(r.length<t.length)throw new Error(`Some protocols not found in ${t.join(", ")}`);const n=[...r.flatMap(f=>f.crop.infer?.map(a=>a.model)??[]),...r.flatMap(f=>f.metadata.map(a=>ze.Metadata.getFromState(a)).filter(Et).flatMap(({infer:a})=>a&&"neural"in a?a.neural.map(({model:u})=>u):[]))],s=await Promise.allSettled(n.map((f,a)=>hn(f,{cacheAs:"model",onProgress({total:u,transferred:c}){e?.({done:c,total:u,modelNo:a,modelURL:rr(f)})}})));if(s.some(f=>f.status==="rejected"))throw new Error("Could not download all models: "+s.map((f,a)=>{if(f.status!=="fulfilled")return`${rr(n[a])}: ${f.reason}`}).filter(Et).join("; "))}var la=L('<li class="svelte-au9nsu"><span class="url svelte-au9nsu"> </span> <!></li>'),ca=L("<!> ",1),ua=L('<p> </p> <ul class="bars svelte-au9nsu"></ul> <section class="state svelte-au9nsu"><!></section>',1);function da(t,e){de(e,!0);const r=b(()=>Je(Ye("main")));let n=E(e,"open",15),s=ee(void 0),f=ee(void 0);async function a(){await ia(ze.Protocol.state.map(d=>d.id),({modelNo:d,...i})=>{u.set(d,i)}).catch(d=>{A(s,d,!0)})}we(()=>{o(c)&&u.values().every(d=>d.done>=d.total)&&A(s,!0)});let u=new fr;const c=b(()=>u.size>0),v=b(()=>fn(o(s)===!0?"success":"error"));{const d=(g,p)=>{let l=()=>p?.().close;var h=F(),m=k(h);{var M=R=>{tr(R,{get loading(){return o(c)},onclick:a,children:(O,I)=>{Ge();var x=Ee();W(C=>G(x,C),[()=>o(r).t(77)]),_(O,x)},$$slots:{default:!0}})},S=R=>{tr(R,{onclick:()=>{u.clear(),A(s,void 0),l()?.()},children:(O,I)=>{Ge();var x=Ee();W(C=>G(x,C),[()=>o(r).t(96)]),_(O,x)},$$slots:{default:!0}})};q(m,R=>{o(s)!==!0?R(M):R(S,!1)})}_(g,h)};let i=b(()=>o(r).t(151));Dt(t,{key:"modal_prepare_for_offline",get title(){return o(i)},get open(){return n()},set open(g){n(g)},get close(){return o(f)},set close(g){A(f,g,!0)},footer:d,children:(g,p)=>{var l=ua(),h=k(l),m=y(h,!0);w(h);var M=P(h,2);Qe(M,21,()=>u,([C,{done:T,total:K,modelURL:N}])=>C,(C,T)=>{var K=b(()=>mt(o(T),2));let N=()=>o(K)[1].done,Y=()=>o(K)[1].total,B=()=>o(K)[1].modelURL;var j=la(),D=y(j),J=y(D,!0);w(D);var X=P(D,2);{let ne=b(()=>hr(N()/Y(),0,1));Gt(X,{alwaysActive:!0,get progress(){return o(ne)}})}w(j),W(()=>G(J,B())),_(C,j)}),w(M);var S=P(M,2);let R;var O=y(S);{var I=C=>{const T=K=>{var N=F(),Y=k(N);Te(Y,()=>o(v),(B,j)=>{j(B,{})}),_(K,N)};{let K=b(()=>[T]),N=b(()=>o(r).cx(8));Ue(C,{get t(){return o(K)},get x(){return o(N)}})}},x=C=>{var T=F(),K=k(T);{var N=B=>{var j=ca(),D=k(j);Te(D,()=>o(v),(X,ne)=>{ne(X,{})});var J=P(D);W(()=>G(J,` ${o(s)??""}`)),_(B,j)},Y=B=>{var j=F(),D=k(j);{var J=X=>{const ne=ae=>{Sr(ae,{})};{let ae=b(()=>[ne]),ve=b(()=>o(r).cx(2));Ue(X,{get t(){return o(ae)},get x(){return o(ve)}})}};q(D,X=>{u.size>0&&X(J)},!0)}_(B,j)};q(K,B=>{o(s)!==void 0?B(N):B(Y,!1)},!0)}_(C,T)};q(O,C=>{o(s)===!0?C(I):C(x,!1)})}w(S),W(C=>{G(m,C),R=ur(S,"",R,{color:`var(--fg-${o(s)===!0?"success":o(c)?"secondary":"error"})`})},[()=>o(r).t(188)]),_(g,l)},$$slots:{footer:!0,default:!0}})}fe()}function fa(t){const e={encode:n=>JSON.stringify(n),decode:n=>{if(n===null)return null;try{return JSON.parse(n)}catch{return null}},defaultValue:t};function r(n){return{...e,equalityFn:n}}return Object.assign(r,e)}function va(t){const e={encode:n=>JSON.stringify(n),decode:n=>{if(n===null)return null;try{return JSON.parse(n)}catch{return null}},defaultValue:t};function r(n){return{...e,equalityFn:n}}return Object.assign(r,e)}let ht=String.fromCharCode,Nr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",gt={};function pa(t,e){if(!gt[t]){gt[t]={};for(let r=0;r<t.length;r++)gt[t][t.charAt(r)]=r}return gt[t][e]}function ha(t){return t==null?"":ma(t,6,function(e){return Nr.charAt(e)})}function ga(t){return t==null?"":t==""?null:_a((t=t.replace(/ /g,"+")).length,32,function(e){return pa(Nr,t.charAt(e))})}function ma(t,e,r){if(t==null)return"";let n,s,f={},a={},u="",c="",v="",d=2,i=3,g=2,p=[],l=0,h=0,m;for(m=0;m<t.length;m+=1)if(u=t.charAt(m),Object.prototype.hasOwnProperty.call(f,u)||(f[u]=i++,a[u]=!0),c=v+u,Object.prototype.hasOwnProperty.call(f,c))v=c;else{if(Object.prototype.hasOwnProperty.call(a,v)){if(256>v.charCodeAt(0)){for(n=0;n<g;n++)l<<=1,h==e-1?(h=0,p.push(r(l)),l=0):h++;for(n=0,s=v.charCodeAt(0);n<8;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1}else{for(n=0,s=1;n<g;n++)l=l<<1|s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s=0;for(n=0,s=v.charCodeAt(0);n<16;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1}--d==0&&(d=Math.pow(2,g),g++),delete a[v]}else for(n=0,s=f[v];n<g;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1;--d==0&&(d=Math.pow(2,g),g++),f[c]=i++,v=String(u)}if(v!==""){if(Object.prototype.hasOwnProperty.call(a,v)){if(256>v.charCodeAt(0)){for(n=0;n<g;n++)l<<=1,h==e-1?(h=0,p.push(r(l)),l=0):h++;for(n=0,s=v.charCodeAt(0);n<8;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1}else{for(n=0,s=1;n<g;n++)l=l<<1|s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s=0;for(n=0,s=v.charCodeAt(0);n<16;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1}--d==0&&(d=Math.pow(2,g),g++),delete a[v]}else for(n=0,s=f[v];n<g;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1;--d==0&&(d=Math.pow(2,g),g++)}for(n=0,s=2;n<g;n++)l=l<<1|1&s,h==e-1?(h=0,p.push(r(l)),l=0):h++,s>>=1;for(;;){if(l<<=1,h==e-1){p.push(r(l));break}h++}return p.join("")}function _a(t,e,r){let n=[],s=4,f=4,a=3,u="",c=[],v,d,i,g,p,l,h,m={val:r(0),position:e,index:1};for(v=0;v<3;v+=1)n[v]=v;for(i=0,p=4,l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;switch(i){case 0:for(i=0,p=256,l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;h=ht(i);break;case 1:for(i=0,p=65536,l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;h=ht(i);break;case 2:return""}for(n[3]=h,d=h,c.push(h);;){if(m.index>t)return"";for(i=0,p=Math.pow(2,a),l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;switch(h=i){case 0:for(i=0,p=256,l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;n[f++]=ht(i),h=f-1,s--;break;case 1:for(i=0,p=65536,l=1;l!=p;)g=m.val&m.position,m.position>>=1,m.position==0&&(m.position=e,m.val=r(m.index++)),i|=(g>0?1:0)*l,l<<=1;n[f++]=ht(i),h=f-1,s--;break;case 2:return c.join("")}if(s==0&&(s=Math.pow(2,a),a++),n[h])u=n[h];else{if(h!==f)return null;u=d+d.charAt(0)}c.push(u),n[f++]=d+u.charAt(0),s--,d=u,s==0&&(s=Math.pow(2,a),a++)}}function ba(t){const e={encode:n=>ha(JSON.stringify(n)),decode:n=>{if(!n)return null;try{return JSON.parse(ga(n)??"")}catch{return null}},defaultValue:t};function r(n){return{...e,equalityFn:n}}return Object.assign(r,e)}function At({encode:t,decode:e}){function r(n){return{encode:t,decode:e,defaultValue:n}}return r}const wa={number:At({encode:t=>t.toString(),decode:t=>t?parseFloat(t):null}),boolean:At({encode:t=>t+"",decode:t=>t!==null&&t!=="false"}),string:At({encode:t=>t??"",decode:t=>t}),object:fa,array:va,lz:ba},ya=()=>{const t=Qn;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},xa={subscribe(t){return ya().page.subscribe(t)}};let Dr;Dr=xa;function Ma(t,e,r=(n,s)=>JSON.stringify(n)===JSON.stringify(s)){return typeof t=="object"&&typeof e=="object"&&r(t,e)}const ka={keepFocus:!0,noScroll:!0,replaceState:!0},Pa={keepFocus:!0,noScroll:!0,replaceState:!1},It=new Set;let ir;const lr=new Map,zr=to(Dr),yt={encode:t=>t.toString(),decode:t=>t?t.toString():null},cr=Symbol("raw");function Bt(t,e,r,n,s){n[t]=e;const{debounceHistory:f=0,pushHistory:a=!0,sort:u=!0}=s,c=window.location.hash,v=i=>{if(e==null)i.delete(t);else{const g=(r.get(t)??yt.encode)(e);g==null?i.delete(t):i.set(t,g)}};It.add(v),clearTimeout(ir);const d=new URLSearchParams(window.location.search);ir=setTimeout(async()=>{It.forEach(i=>{i(d)}),clearTimeout(lr.get(t));{async function i(){u&&d.sort(),await Zn(`?${d}${c}`,a?Pa:ka),n[t]=void 0}f===0?i():lr.set(t,setTimeout(i,f))}It.clear()})}function Sa(t,e,r,n){return(s,f,a)=>{const u=[...s],c=u.shift(),v=structuredClone(We(r[c])??t);let d=v;for(const i of u)d=d[i];d[f]=a,Bt(c,Array.isArray(v)&&f==="length"?structuredClone(v):v,e,r,n)}}function Kr(t,e,r,n,s,f,a,u=[],c){return new Proxy(t,{get(v,d){if(d===cr)return v;const i=Reflect.get(v,d);if(typeof d=="symbol"||u.length!==0)return i;if(i)return Reflect.get(e,d);if(d==="toJSON")return()=>{const p=We(e),l=new URLSearchParams(window.location.search);for(const[h,m]of l.entries())h in e||(p[h]=m);return p};const g=e[d]??(r.get(d)??yt.decode)(zr.current.url.searchParams.get(d));return g!=null&&typeof g=="object"?Kr(g,e,r,n,s,f,a,[...u,d],c??Sa(g,n,s,a)):g},set(v,d,i){return typeof d=="symbol"?Reflect.set(v,d,i):c?(c(u,d,i),!0):(Bt(d,i,n,s,a),!0)},has(v,d){return d===cr?!0:Reflect.has(v,d)}})}function Ca(t,e,r,n,s,f,a){return t==null&&typeof r!="boolean"&&r.defaultValue!=null?(n&&Bt(e,r.defaultValue,s,f,a),!0):!1}function Aa(t,e={}){const{showDefaults:r=!0}=e,n={},s=new Map,f=new Map,a=new Map,u=Lt({});for(const c in t){const v=typeof t?.[c]=="boolean"?yt.decode:t?.[c].decode,d=typeof t?.[c]=="boolean"?yt.encode:t?.[c].encode;s.set(c,v),f.set(c,d);const i=b(()=>{const g=u[c]??v(zr.current.url.searchParams.get(c)),p=a.get(c)??null;return Ma(We(g),We(p),typeof t[c]=="boolean"?void 0:t[c].equalityFn)?p:(a.set(c,We(g)),g)});Xr(()=>{Ca(o(i),c,t[c],r,f,u,e)&&(u[c]=t[c].defaultValue)}),Object.defineProperty(n,c,{get(){return o(i)},enumerable:!0})}return Kr({},n,s,f,u,a,e)}var Ia=L(" <strong> </strong> ",1),Oa=L("<a><!></a>");function Ta(t,e){de(e,!0);const r=g=>{Ge();var p=Ia(),l=k(p,!0),h=P(l),m=y(h,!0);w(h);var M=P(h,1,!0);W(()=>{G(l,o(a)),G(m,o(n)),G(M,o(u))}),_(g,p)},n=b(()=>URL.canParse(e.url)?new URL(e.url).hostname:""),s=b(()=>e.url.split(o(n),2)),f=b(()=>mt(o(s),2)),a=b(()=>o(f)[0]),u=b(()=>o(f)[1]);var c=F(),v=k(c);{var d=g=>{var p=Oa(),l=y(p);r(l),w(p),W(()=>Ae(p,"href",e.url)),_(g,p)},i=g=>{r(g)};q(v,g=>{e.linkify?g(d):g(i,!1)})}_(t,c),fe()}var Ea=L("<p> </p>"),$a=L('<section class="modal-import-loading svelte-1qpv17f"><!></section>');function Fa(t,e){de(e,!0);const r=b(()=>Je(Ye("main"))),n=b(()=>je.data),s=b(()=>o(n).swarpc);let f=ee(!1);const a={encode:d=>d===null?void 0:(Number(d)+1).toString(),decode:d=>d===null?null:Number(d)-1},u=Aa({protocol:wa.string(),classificationModel:a,cropModel:a});let c=ee(void 0);const v=b(()=>!!(u.protocol?.startsWith("https:")&&URL.canParse(u.protocol)));eo(()=>{o(v)&&o(c)&&!o(f)&&o(c)()}),we(()=>{o(v)||(u.protocol&&(H.setCurrentProtocolId(u.protocol),u.protocol=null),H.setModelSelections({classification:u.classificationModel,crop:u.cropModel}).then(()=>{u.classificationModel!==null&&(u.classificationModel=null),u.cropModel!==null&&(u.cropModel=null)}))});{const d=l=>{var h=F(),m=k(h);{var M=S=>{Ta(S,{linkify:!0,get url(){return u.protocol}})};q(m,S=>{u.protocol&&o(v)&&S(M)})}_(l,h)},i=(l,h=le)=>{var m=$a(),M=y(m);{var S=R=>{var O=Ea(),I=y(O,!0);w(O),W(x=>G(I,x),[()=>o(r).t(385)]),_(R,O)};q(M,R=>{o(f)&&R(S)})}w(m),_(l,m)};let g=b(()=>o(r).t(111)),p=b(()=>o(r).t(108));vn(t,{get title(){return o(g)},key:"modal_import_remote_protocol",get confirm(){return o(p)},oncancel:()=>{u.protocol=null},onconfirm:async()=>{if(!u.protocol)return;A(f,!0);const l=await fetch(u.protocol).then(h=>h.text()).catch(h=>(ye.error(o(r).t(90,[h])),null));if(l)try{const{id:h}=await o(s).importProtocol({contents:l});await ze.Protocol.refresh(),await ze.Metadata.refresh(),H.setCurrentProtocolId(h),u.protocol=null}catch(h){ye.error(`Erreur lors de l'import du protocole distant: ${h}`)}finally{A(f,!1)}},get open(){return o(c)},set open(l){A(c,l,!0)},_w_snippet_0:d,_w_snippet_1:i,children:(l,h)=>{{let m=b(()=>[d,i]),M=b(()=>o(r).cx(48));Ue(l,{get t(){return o(m)},get x(){return o(M)}})}},$$slots:{_w_snippet_0:!0,_w_snippet_1:!0,default:!0}})}fe()}const Ra=new fr;var La=L("<base/>"),Na=L('<!> <!> <!> <!> <section class="toasts svelte-1v2axqk" data-testid="toasts-area"></section> <div><!></div>',1);function Ni(t,e){de(e,!0);const r=b(()=>Je(Ye("main"))),n=b(()=>e.data.swarpc),s=b(()=>e.data.parallelism);let f=ee("full");Qr("setNavbarAppearance",x=>{jr(()=>{A(f,x,!0)}),Ur(()=>{A(f,"full")})}),_n({swarpc:o(n),cancellers:Ra,parallelism:o(s)});const a={capture(){return gn(H,"currentProtocolId")},restore({currentProtocolId:x}){H.setCurrentProtocolId(x)}},u=b(()=>ze.Image.state.map(x=>x.fileId).filter(Et));dr(()=>o(u),x=>{for(const C of x)(async()=>{if(H.hasPreviewURL(C))return;const T=await cn("ImagePreviewFile",C);if(!T)return;const K=new Blob([T.bytes],{type:T.contentType});H.setPreviewURL(C,URL.createObjectURL(K))})()}),Ot("general",{"$mod+s":{help:"",hidden:!0,do:()=>ye.info(o(r).t(146))},"i d e v":{help:o(r).t(26),do:async()=>{await Fe("showTechnicalMetadata",!_t())}}}),Ot("debugmode",Object.fromEntries(["warn","error","info","debug","success"].map(x=>{const C={warn:()=>ye.warn("Example warning toast"),error:()=>ye.error("Example error toast"),info:()=>ye.info("Example info toast"),debug:()=>ye.add("debug","Example debug toast"),success:()=>ye.success("Example success toast")};return[`t t ${x.charAt(0)}`,{help:`Summon a ${x} toast`,debug:!0,allowInModals:!0,when:_t,do:C[x]}]})));const c=b(Tt);we(()=>{document.documentElement.dataset.theme=o(c).theme});let v=ee(void 0),d=ee(void 0);var i={snapshot:a},g=Na();nn(x=>{var C=La();W(T=>Ae(C,"href",T),[()=>Jt("/")==="/"?"":Jt("/")+"index.html"]),_(x,C)});var p=k(g);po(p,{preventDefault:!0,get binds(){return H.keybinds},get openHelp(){return o(v)},set openHelp(x){A(v,x,!0)}});var l=P(p,2);da(l,{get open(){return o(d)},set open(x){A(d,x,!0)}});var h=P(l,2);Fa(h,{});var m=P(h,2);{var M=x=>{{let C=b(()=>o(f)==="floating");aa(x,{get swarpc(){return o(n)},get openKeyboardShortcuts(){return o(v)},get openPrepareForOfflineUse(){return o(d)},get floating(){return o(C)},get progress(){return H.processing.progress}})}};q(m,x=>{o(f)!=="hidden"&&x(M)})}var S=P(m,2);Qe(S,21,()=>ye.items("default"),x=>x.id,(x,C)=>{pn(x,st(()=>o(C),{get action(){return o(C).labels.action},get dismiss(){return o(C).labels.close},onaction:()=>{o(C).callbacks?.action?.(o(C))},ondismiss:()=>{ye.remove(o(C).id)}}))}),w(S);var R=P(S,2);let O;var I=y(R);return ie(I,()=>e.children??le),w(R),W(x=>O=dt(R,1,"contents svelte-1v2axqk",null,O,x),[()=>({padded:!je.route.id?.includes("/(sidepanel)")&&!je.route.id?.includes("protocols/[id]/")})]),_(t,g),fe(i)}export{or as M,xo as P,Bs as S,Ni as _,Li as b,Ra as c,Ri as f,$i as n,Fi as p};
